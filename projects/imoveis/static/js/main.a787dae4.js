/*! For license information please see main.a787dae4.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,s={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:c,props:s,_owner:a.current}}t.Fragment=s,t.jsx=u,t.jsxs=u},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),A=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function m(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var _=v.prototype=new y;_.constructor=v,p(_,m.prototype),_.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,E={current:null},x={key:!0,ref:!0,__self:!0,__source:!0};function D(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,i)&&!x.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:E.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var S=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+T(l,0):s,b(o)?(i="",null!=e&&(i=e.replace(S,"$&/")+"/"),I(o,t,i,"",function(e){return e})):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(S,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",b(e))for(var u=0;u<e.length;u++){var c=s+T(a=e[u],u);l+=I(a,t,i,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(a=e.next()).done;)l+=I(a=a.value,t,i,c=s+T(a,u++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function F(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",function(e){return t.call(n,e,i++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var k={current:null},P={transition:null},M={ReactCurrentDispatcher:k,ReactCurrentBatchConfig:P,ReactCurrentOwner:E};function B(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:F,forEach:function(e,t,n){F(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return F(e,function(){t++}),t},toArray:function(e){return F(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=o,t.PureComponent=v,t.StrictMode=s,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=B,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=p({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=E.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)w.call(t,u)&&!x.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=D,t.createFactory=function(e){var t=D.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:A,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=B,t.useCallback=function(e,t){return k.current.useCallback(e,t)},t.useContext=function(e){return k.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return k.current.useDeferredValue(e)},t.useEffect=function(e,t){return k.current.useEffect(e,t)},t.useId=function(){return k.current.useId()},t.useImperativeHandle=function(e,t,n){return k.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return k.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return k.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return k.current.useMemo(e,t)},t.useReducer=function(e,t,n){return k.current.useReducer(e,t,n)},t.useRef=function(e){return k.current.useRef(e)},t.useState=function(e){return k.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return k.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return k.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],u=a+1,c=e[u];if(0>s(l,n))u<i&&0>s(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[a]=n,r=a);else{if(!(u<i&&0>s(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],c=[],A=1,h=null,d=3,f=!1,p=!1,g=!1,m="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function b(e){if(g=!1,_(e),!p)if(null!==r(u))p=!0,P(w);else{var t=r(c);null!==t&&M(b,t.startTime-e)}}function w(e,n){p=!1,g&&(g=!1,y(C),C=-1),f=!0;var s=d;try{for(_(n),h=r(u);null!==h&&(!(h.expirationTime>n)||e&&!I());){var o=h.callback;if("function"===typeof o){h.callback=null,d=h.priorityLevel;var a=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===r(u)&&i(u),_(n)}else i(u);h=r(u)}if(null!==h)var l=!0;else{var A=r(c);null!==A&&M(b,A.startTime-n),l=!1}return l}finally{h=null,d=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,x=!1,D=null,C=-1,S=5,T=-1;function I(){return!(t.unstable_now()-T<S)}function F(){if(null!==D){var e=t.unstable_now();T=e;var n=!0;try{n=D(!0,e)}finally{n?E():(x=!1,D=null)}}else x=!1}if("function"===typeof v)E=function(){v(F)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,k=R.port2;R.port1.onmessage=F,E=function(){k.postMessage(null)}}else E=function(){m(F,0)};function P(e){D=e,x||(x=!0,E())}function M(e,n){C=m(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,P(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:A++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(c,e),null===r(u)&&e===r(c)&&(g?(y(C),C=-1):g=!0,M(b,s-o))):(e.sortIndex=a,n(u,e),p||f||(p=!0,P(w))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),A=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function p(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new p(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new p(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new p(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new p(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new p(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)});var m=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function v(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!A.call(f,e)||!A.call(d,e)&&(h.test(e)?f[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(m,y);g[t]=new p(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(m,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(m,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)});var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),w=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),S=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),k=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function B(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var L,O=Object.assign;function N(e){if(void 0===L)try{throw Error()}catch(zA){var t=zA.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function z(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(jA){var r=jA}Reflect.construct(e,[],t)}else{try{t.call()}catch(jA){r=jA}e.call(t.prototype)}else{try{throw Error()}catch(jA){r=jA}e()}}catch(jA){if(jA&&r&&"string"===typeof jA.stack){for(var i=jA.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?N(e):""}function j(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case w:return"Portal";case D:return"Profiler";case x:return"StrictMode";case I:return"Suspense";case F:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case S:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case k:t=e._payload,e=e._init;try{return V(e(t))}catch(zA){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Q(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(JA){return e.body}}function q(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function J(e,t){Z(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n)})}:e}(function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ae(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},de=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function pe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(he).forEach(function(e){de.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]})});var ge=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function me(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var be=null,we=null,Ee=null;function xe(e){if(e=yi(e)){if("function"!==typeof be)throw Error(s(280));var t=e.stateNode;t&&(t=_i(t),be(e.stateNode,e.type,t))}}function De(e){we?Ee?Ee.push(e):Ee=[e]:we=e}function Ce(){if(we){var e=we,t=Ee;if(Ee=we=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function Se(e,t){return e(t)}function Te(){}var Ie=!1;function Fe(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return Se(e,t,n)}finally{Ie=!1,(null!==we||null!==Ee)&&(Te(),Ce())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var ke=!1;if(c)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){ke=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(OA){ke=!1}function Me(e,t,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(XA){this.onError(XA)}}var Be=!1,Le=null,Oe=!1,Ne=null,Ue={onError:function(e){Be=!0,Le=e}};function ze(e,t,n,r,i,s,o,a,l){Be=!1,Le=null,Me.apply(Ue,arguments)}function je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(je(e)!==e)throw Error(s(188))}function We(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Ge(i),e;if(o===r)return Ge(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),null!==e?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Qe=i.unstable_scheduleCallback,Xe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,qe=i.unstable_requestPaint,Ke=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,Je=i.unstable_ImmediatePriority,$e=i.unstable_UserBlockingPriority,et=i.unstable_NormalPriority,tt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,rt=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/at|0)|0},ot=Math.log,at=Math.LN2;var lt=64,ut=4194304;function ct(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function At(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ct(a):0!==(s&=o)&&(r=ct(s))}else 0!==(o=n&~i)?r=ct(o):0!==s&&(r=ct(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function dt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function pt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function mt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var yt=0;function vt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,bt,wt,Et,xt,Dt=!1,Ct=[],St=null,Tt=null,It=null,Ft=new Map,Rt=new Map,kt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":St=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Ft.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Bt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&bt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Lt(e){var t=mi(e.target);if(null!==t){var n=je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void xt(e.priority,function(){wt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yi(n))&&bt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ve=r,n.target.dispatchEvent(r),ve=null,t.shift()}return!0}function Nt(e,t,n){Ot(e)&&n.delete(t)}function Ut(){Dt=!1,null!==St&&Ot(St)&&(St=null),null!==Tt&&Ot(Tt)&&(Tt=null),null!==It&&Ot(It)&&(It=null),Ft.forEach(Nt),Rt.forEach(Nt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Dt||(Dt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function jt(e){function t(t){return zt(t,e)}if(0<Ct.length){zt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==St&&zt(St,e),null!==Tt&&zt(Tt,e),null!==It&&zt(It,e),Ft.forEach(t),Rt.forEach(t),n=0;n<kt.length;n++)(r=kt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<kt.length&&null===(n=kt[0]).blockedOn;)Lt(n),null===n.blockedOn&&kt.shift()}var Vt=_.ReactCurrentBatchConfig,Gt=!0;function Wt(e,t,n,r){var i=yt,s=Vt.transition;Vt.transition=null;try{yt=1,Qt(e,t,n,r)}finally{yt=i,Vt.transition=s}}function Ht(e,t,n,r){var i=yt,s=Vt.transition;Vt.transition=null;try{yt=4,Qt(e,t,n,r)}finally{yt=i,Vt.transition=s}}function Qt(e,t,n,r){if(Gt){var i=Yt(e,t,n,r);if(null===i)Gr(e,t,r,Xt,n),Mt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return St=Bt(St,e,t,n,r,i),!0;case"dragenter":return Tt=Bt(Tt,e,t,n,r,i),!0;case"mouseover":return It=Bt(It,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ft.set(s,Bt(Ft.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Rt.set(s,Bt(Rt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==i;){var s=yi(i);if(null!==s&&_t(s),null===(s=Yt(e,t,n,r))&&Gr(e,t,r,Xt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=mi(e=_e(r))))if(null===(t=je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Je:return 1;case $e:return 4;case et:case tt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Kt=null,Zt=null,Jt=null;function $t(){if(Jt)return Jt;var e,t,n=Zt,r=n.length,i="value"in Kt?Kt.value:Kt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function en(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function tn(){return!0}function nn(){return!1}function rn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?tn:nn,this.isPropagationStopped=nn,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tn)},persist:function(){},isPersistent:tn}),t}var sn,on,an,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=rn(ln),cn=O({},ln,{view:0,detail:0}),An=rn(cn),hn=O({},cn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==an&&(an&&"mousemove"===e.type?(sn=e.screenX-an.screenX,on=e.screenY-an.screenY):on=sn=0,an=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),dn=rn(hn),fn=rn(O({},hn,{dataTransfer:0})),pn=rn(O({},cn,{relatedTarget:0})),gn=rn(O({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),mn=O({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=rn(mn),vn=rn(O({},ln,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function xn(){return En}var Dn=O({},cn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=en(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?en(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?en(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=rn(Dn),Sn=rn(O({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=rn(O({},cn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),In=rn(O({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Fn=O({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=rn(Fn),kn=[9,13,27,32],Pn=c&&"CompositionEvent"in window,Mn=null;c&&"documentMode"in document&&(Mn=document.documentMode);var Bn=c&&"TextEvent"in window&&!Mn,Ln=c&&(!Pn||Mn&&8<Mn&&11>=Mn),On=String.fromCharCode(32),Nn=!1;function Un(e,t){switch(e){case"keyup":return-1!==kn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Wn(e,t,n,r){De(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Qn=null;function Xn(e){Or(e,0)}function Yn(e){if(X(vi(e)))return e}function qn(e,t){if("change"===e)return t}var Kn=!1;if(c){var Zn;if(c){var Jn="oninput"in document;if(!Jn){var $n=document.createElement("div");$n.setAttribute("oninput","return;"),Jn="function"===typeof $n.oninput}Zn=Jn}else Zn=!1;Kn=Zn&&(!document.documentMode||9<document.documentMode)}function er(){Hn&&(Hn.detachEvent("onpropertychange",tr),Qn=Hn=null)}function tr(e){if("value"===e.propertyName&&Yn(Qn)){var t=[];Wn(t,Qn,e,_e(e)),Fe(Xn,t)}}function nr(e,t,n){"focusin"===e?(er(),Qn=n,(Hn=t).attachEvent("onpropertychange",tr)):"focusout"===e&&er()}function rr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Qn)}function ir(e,t){if("click"===e)return Yn(t)}function sr(e,t){if("input"===e||"change"===e)return Yn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ar(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!A.call(t,i)||!or(e[i],t[i]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function cr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?cr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Ar(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(QA){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function dr(e){var t=Ar(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&cr(n.ownerDocument.documentElement,n)){if(null!==r&&hr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var o=ur(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=c&&"documentMode"in document&&11>=document.documentMode,pr=null,gr=null,mr=null,yr=!1;function vr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==pr||pr!==Y(r)||("selectionStart"in(r=pr)&&hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},mr&&ar(mr,r)||(mr=r,0<(r=Hr(gr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=pr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var br={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},wr={},Er={};function xr(e){if(wr[e])return wr[e];if(!br[e])return e;var t,n=br[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return wr[e]=n[t];return e}c&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete br.animationend.animation,delete br.animationiteration.animation,delete br.animationstart.animation),"TransitionEvent"in window||delete br.transitionend.transition);var Dr=xr("animationend"),Cr=xr("animationiteration"),Sr=xr("animationstart"),Tr=xr("transitionend"),Ir=new Map,Fr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Ir.set(e,t),l(t,[e])}for(var kr=0;kr<Fr.length;kr++){var Pr=Fr[kr];Rr(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Rr(Dr,"onAnimationEnd"),Rr(Cr,"onAnimationIteration"),Rr(Sr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Tr,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Br=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,u){if(ze.apply(this,arguments),Be){if(!Be)throw Error(s(198));var c=Le;Be=!1,Le=null,Oe||(Oe=!0,Ne=c)}}(r,t,void 0,e),e.currentTarget=null}function Or(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,a,u),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,a,u),s=l}}}if(Oe)throw e=Ne,Oe=!1,Ne=null,e}function Nr(e,t){var n=t[fi];void 0===n&&(n=t[fi]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function jr(e){if(!e[zr]){e[zr]=!0,o.forEach(function(t){"selectionchange"!==t&&(Br.has(t)||Ur(t,!1,e),Ur(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Ur("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(qt(t)){case 1:var i=Wt;break;case 4:i=Ht;break;default:i=Qt}n=i.bind(null,t,n,e),i=void 0,!ke||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=mi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Fe(function(){var r=s,i=_e(n),o=[];e:{var a=Ir.get(e);if(void 0!==a){var l=un,u=e;switch(e){case"keypress":if(0===en(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":u="focus",l=pn;break;case"focusout":u="blur",l=pn;break;case"beforeblur":case"afterblur":l=pn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Dr:case Cr:case Sr:l=gn;break;case Tr:l=In;break;case"scroll":l=An;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Sn}var c=0!==(4&t),A=!c&&"scroll"===e,h=c?null!==a?a+"Capture":null:a;c=[];for(var d,f=r;null!==f;){var p=(d=f).stateNode;if(5===d.tag&&null!==p&&(d=p,null!==h&&(null!=(p=Re(f,h))&&c.push(Wr(f,p,d)))),A)break;f=f.return}0<c.length&&(a=new l(a,u,null,n,i),o.push({event:a,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===ve||!(u=n.relatedTarget||n.fromElement)||!mi(u)&&!u[di])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?mi(u):null)&&(u!==(A=je(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=dn,p="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(c=Sn,p="onPointerLeave",h="onPointerEnter",f="pointer"),A=null==l?a:vi(l),d=null==u?a:vi(u),(a=new c(p,f+"leave",l,n,i)).target=A,a.relatedTarget=d,p=null,mi(i)===r&&((c=new c(h,f+"enter",u,n,i)).target=d,c.relatedTarget=A,p=c),A=p,l&&u)e:{for(h=u,f=0,d=c=l;d;d=Qr(d))f++;for(d=0,p=h;p;p=Qr(p))d++;for(;0<f-d;)c=Qr(c),f--;for(;0<d-f;)h=Qr(h),d--;for(;f--;){if(c===h||null!==h&&c===h.alternate)break e;c=Qr(c),h=Qr(h)}c=null}else c=null;null!==l&&Xr(o,a,l,c,!1),null!==u&&null!==A&&Xr(o,A,u,c,!0)}if("select"===(l=(a=r?vi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=qn;else if(Gn(a))if(Kn)g=sr;else{g=rr;var m=nr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=ir);switch(g&&(g=g(e,r))?Wn(o,g,n,i):(m&&m(e,a,r),"focusout"===e&&(m=a._wrapperState)&&m.controlled&&"number"===a.type&&ee(a,"number",a.value)),m=r?vi(r):window,e){case"focusin":(Gn(m)||"true"===m.contentEditable)&&(pr=m,gr=r,mr=null);break;case"focusout":mr=gr=pr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,vr(o,n,i);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":vr(o,n,i)}var y;if(Pn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else jn?Un(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(Ln&&"ko"!==n.locale&&(jn||"onCompositionStart"!==v?"onCompositionEnd"===v&&jn&&(y=$t()):(Zt="value"in(Kt=i)?Kt.value:Kt.textContent,jn=!0)),0<(m=Hr(r,v)).length&&(v=new vn(v,e,null,n,i),o.push({event:v,listeners:m}),y?v.data=y:null!==(y=zn(n))&&(v.data=y))),(y=Bn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Nn=!0,On);case"textInput":return(e=t.data)===On&&Nn?null:e;default:return null}}(e,n):function(e,t){if(jn)return"compositionend"===e||!Pn&&Un(e,t)?(e=$t(),Jt=Zt=Kt=null,jn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new vn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}Or(o,t)})}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Re(e,n))&&r.unshift(Wr(e,s,i)),null!=(s=Re(e,t))&&r.push(Wr(e,s,i))),e=e.return}return r}function Qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==u&&(a=u,i?null!=(l=Re(n,s))&&o.unshift(Wr(n,l,a)):i||null!=(l=Re(n,s))&&o.push(Wr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,qr=/\u0000|\uFFFD/g;function Kr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(qr,"")}function Zr(e,t,n){if(t=Kr(t),Kr(e)!==t&&n)throw Error(s(425))}function Jr(){}var $r=null,ei=null;function ti(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"===typeof setTimeout?setTimeout:void 0,ri="function"===typeof clearTimeout?clearTimeout:void 0,ii="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ii?function(e){return ii.resolve(null).then(e).catch(oi)}:ni;function oi(e){setTimeout(function(){throw e})}function ai(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void jt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);jt(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ci=Math.random().toString(36).slice(2),Ai="__reactFiber$"+ci,hi="__reactProps$"+ci,di="__reactContainer$"+ci,fi="__reactEvents$"+ci,pi="__reactListeners$"+ci,gi="__reactHandles$"+ci;function mi(e){var t=e[Ai];if(t)return t;for(var n=e.parentNode;n;){if(t=n[di]||n[Ai]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[Ai])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function yi(e){return!(e=e[Ai]||e[di])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function _i(e){return e[hi]||null}var bi=[],wi=-1;function Ei(e){return{current:e}}function xi(e){0>wi||(e.current=bi[wi],bi[wi]=null,wi--)}function Di(e,t){wi++,bi[wi]=e.current,e.current=t}var Ci={},Si=Ei(Ci),Ti=Ei(!1),Ii=Ci;function Fi(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ri(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ki(){xi(Ti),xi(Si)}function Pi(e,t,n){if(Si.current!==Ci)throw Error(s(168));Di(Si,t),Di(Ti,n)}function Mi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,G(e)||"Unknown",i));return O({},n,r)}function Bi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Ii=Si.current,Di(Si,e),Di(Ti,Ti.current),!0}function Li(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Mi(e,t,Ii),r.__reactInternalMemoizedMergedChildContext=e,xi(Ti),xi(Si),Di(Si,e)):xi(Ti),Di(Ti,n)}var Oi=null,Ni=!1,Ui=!1;function zi(e){null===Oi?Oi=[e]:Oi.push(e)}function ji(){if(!Ui&&null!==Oi){Ui=!0;var e=0,t=yt;try{var n=Oi;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Oi=null,Ni=!1}catch(kA){throw null!==Oi&&(Oi=Oi.slice(e+1)),Qe(Je,ji),kA}finally{yt=t,Ui=!1}}return null}var Vi=[],Gi=0,Wi=null,Hi=0,Qi=[],Xi=0,Yi=null,qi=1,Ki="";function Zi(e,t){Vi[Gi++]=Hi,Vi[Gi++]=Wi,Wi=e,Hi=t}function Ji(e,t,n){Qi[Xi++]=qi,Qi[Xi++]=Ki,Qi[Xi++]=Yi,Yi=e;var r=qi;e=Ki;var i=32-st(r)-1;r&=~(1<<i),n+=1;var s=32-st(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,qi=1<<32-st(t)+i|n<<i|r,Ki=s+e}else qi=1<<s|n<<i|r,Ki=e}function $i(e){null!==e.return&&(Zi(e,1),Ji(e,1,0))}function es(e){for(;e===Wi;)Wi=Vi[--Gi],Vi[Gi]=null,Hi=Vi[--Gi],Vi[Gi]=null;for(;e===Yi;)Yi=Qi[--Xi],Qi[Xi]=null,Ki=Qi[--Xi],Qi[Xi]=null,qi=Qi[--Xi],Qi[Xi]=null}var ts=null,ns=null,rs=!1,is=null;function ss(e,t){var n=Fu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ts=e,ns=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ts=e,ns=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:qi,overflow:Ki}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Fu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ts=e,ns=null,!0);default:return!1}}function as(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ls(e){if(rs){var t=ns;if(t){var n=t;if(!os(e,t)){if(as(e))throw Error(s(418));t=li(n.nextSibling);var r=ts;t&&os(e,t)?ss(r,n):(e.flags=-4097&e.flags|2,rs=!1,ts=e)}}else{if(as(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ts=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ts=e}function cs(e){if(e!==ts)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ti(e.type,e.memoizedProps)),t&&(t=ns)){if(as(e))throw As(),Error(s(418));for(;t;)ss(e,t),t=li(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ns=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ns=null}}else ns=ts?li(e.stateNode.nextSibling):null;return!0}function As(){for(var e=ns;e;)e=li(e.nextSibling)}function hs(){ns=ts=null,rs=!1}function ds(e){null===is?is=[e]:is.push(e)}var fs=_.ReactCurrentBatchConfig;function ps(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function gs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ms(e){return(0,e._init)(e._payload)}function ys(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=ku(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lu(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var s=n.type;return s===E?A(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===k&&ms(s)===t.type)?((r=i(t,n.props)).ref=ps(e,t,n),r.return=e,r):((r=Pu(n.type,n.key,n.props,null,e.mode,r)).ref=ps(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ou(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function A(e,t,n,r,s){return null===t||7!==t.tag?((t=Mu(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Pu(t.type,t.key,t.props,null,e.mode,n)).ref=ps(e,null,t),n.return=e,n;case w:return(t=Ou(t,e.mode,n)).return=e,t;case k:return h(e,(0,t._init)(t._payload),n)}if(te(t)||B(t))return(t=Mu(t,e.mode,n,null)).return=e,t;gs(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?u(e,t,n,r):null;case w:return n.key===i?c(e,t,n,r):null;case k:return d(e,t,(i=n._init)(n._payload),r)}if(te(n)||B(n))return null!==i?null:A(e,t,n,r,null);gs(e,n)}return null}function f(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return f(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||B(r))return A(t,e=e.get(n)||null,r,i,null);gs(t,r)}return null}function p(i,s,a,l){for(var u=null,c=null,A=s,p=s=0,g=null;null!==A&&p<a.length;p++){A.index>p?(g=A,A=null):g=A.sibling;var m=d(i,A,a[p],l);if(null===m){null===A&&(A=g);break}e&&A&&null===m.alternate&&t(i,A),s=o(m,s,p),null===c?u=m:c.sibling=m,c=m,A=g}if(p===a.length)return n(i,A),rs&&Zi(i,p),u;if(null===A){for(;p<a.length;p++)null!==(A=h(i,a[p],l))&&(s=o(A,s,p),null===c?u=A:c.sibling=A,c=A);return rs&&Zi(i,p),u}for(A=r(i,A);p<a.length;p++)null!==(g=f(A,i,p,a[p],l))&&(e&&null!==g.alternate&&A.delete(null===g.key?p:g.key),s=o(g,s,p),null===c?u=g:c.sibling=g,c=g);return e&&A.forEach(function(e){return t(i,e)}),rs&&Zi(i,p),u}function g(i,a,l,u){var c=B(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var A=c=null,p=a,g=a=0,m=null,y=l.next();null!==p&&!y.done;g++,y=l.next()){p.index>g?(m=p,p=null):m=p.sibling;var v=d(i,p,y.value,u);if(null===v){null===p&&(p=m);break}e&&p&&null===v.alternate&&t(i,p),a=o(v,a,g),null===A?c=v:A.sibling=v,A=v,p=m}if(y.done)return n(i,p),rs&&Zi(i,g),c;if(null===p){for(;!y.done;g++,y=l.next())null!==(y=h(i,y.value,u))&&(a=o(y,a,g),null===A?c=y:A.sibling=y,A=y);return rs&&Zi(i,g),c}for(p=r(i,p);!y.done;g++,y=l.next())null!==(y=f(p,i,g,y.value,u))&&(e&&null!==y.alternate&&p.delete(null===y.key?g:y.key),a=o(y,a,g),null===A?c=y:A.sibling=y,A=y);return e&&p.forEach(function(e){return t(i,e)}),rs&&Zi(i,g),c}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case b:e:{for(var u=o.key,c=s;null!==c;){if(c.key===u){if((u=o.type)===E){if(7===c.tag){n(r,c.sibling),(s=i(c,o.props.children)).return=r,r=s;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===k&&ms(u)===c.type){n(r,c.sibling),(s=i(c,o.props)).ref=ps(r,c,o),s.return=r,r=s;break e}n(r,c);break}t(r,c),c=c.sibling}o.type===E?((s=Mu(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Pu(o.type,o.key,o.props,null,r.mode,l)).ref=ps(r,s,o),l.return=r,r=l)}return a(r);case w:e:{for(c=o.key;null!==s;){if(s.key===c){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Ou(o,r.mode,l)).return=r,r=s}return a(r);case k:return e(r,s,(c=o._init)(o._payload),l)}if(te(o))return p(r,s,o,l);if(B(o))return g(r,s,o,l);gs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Lu(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var vs=ys(!0),_s=ys(!1),bs=Ei(null),ws=null,Es=null,xs=null;function Ds(){xs=Es=ws=null}function Cs(e){var t=bs.current;xi(bs),e._currentValue=t}function Ss(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ts(e,t){ws=e,xs=Es=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ya=!0),e.firstContext=null)}function Is(e){var t=e._currentValue;if(xs!==e)if(e={context:e,memoizedValue:t,next:null},null===Es){if(null===ws)throw Error(s(308));Es=e,ws.dependencies={lanes:0,firstContext:e}}else Es=Es.next=e;return t}var Fs=null;function Rs(e){null===Fs?Fs=[e]:Fs.push(e)}function ks(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Rs(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ps(e,r)}function Ps(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ms=!1;function Bs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Os(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ns(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Sl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ps(e,n)}return null===(i=r.interleaved)?(t.next=t,Rs(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ps(e,n)}function Us(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,mt(e,n)}}function zs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function js(e,t,n,r){var i=e.updateQueue;Ms=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,u=l.next;l.next=null,null===o?s=u:o.next=u,o=l;var c=e.alternate;null!==c&&((a=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===a?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(null!==s){var A=i.baseState;for(o=0,c=u=l=null,a=s;;){var h=a.lane,d=a.eventTime;if((r&h)===h){null!==c&&(c=c.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,p=a;switch(h=t,d=n,p.tag){case 1:if("function"===typeof(f=p.payload)){A=f.call(d,A,h);break e}A=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=p.payload)?f.call(d,A,h):f)||void 0===h)break e;A=O({},A,h);break e;case 2:Ms=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else d={eventTime:d,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===c?(u=c=d,l=A):c=c.next=d,o|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===c&&(l=A),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Bl|=o,e.lanes=o,e.memoizedState=A}}function Vs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Gs={},Ws=Ei(Gs),Hs=Ei(Gs),Qs=Ei(Gs);function Xs(e){if(e===Gs)throw Error(s(174));return e}function Ys(e,t){switch(Di(Qs,t),Di(Hs,e),Di(Ws,Gs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(Ws),Di(Ws,t)}function qs(){xi(Ws),xi(Hs),xi(Qs)}function Ks(e){Xs(Qs.current);var t=Xs(Ws.current),n=le(t,e.type);t!==n&&(Di(Hs,e),Di(Ws,n))}function Zs(e){Hs.current===e&&(xi(Ws),xi(Hs))}var Js=Ei(0);function $s(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var eo=[];function to(){for(var e=0;e<eo.length;e++)eo[e]._workInProgressVersionPrimary=null;eo.length=0}var no=_.ReactCurrentDispatcher,ro=_.ReactCurrentBatchConfig,io=0,so=null,oo=null,ao=null,lo=!1,uo=!1,co=0,Ao=0;function ho(){throw Error(s(321))}function fo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function po(e,t,n,r,i,o){if(io=o,so=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,no.current=null===e||null===e.memoizedState?Jo:$o,e=n(r,i),uo){o=0;do{if(uo=!1,co=0,25<=o)throw Error(s(301));o+=1,ao=oo=null,t.updateQueue=null,no.current=ea,e=n(r,i)}while(uo)}if(no.current=Zo,t=null!==oo&&null!==oo.next,io=0,ao=oo=so=null,lo=!1,t)throw Error(s(300));return e}function go(){var e=0!==co;return co=0,e}function mo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ao?so.memoizedState=ao=e:ao=ao.next=e,ao}function yo(){if(null===oo){var e=so.alternate;e=null!==e?e.memoizedState:null}else e=oo.next;var t=null===ao?so.memoizedState:ao.next;if(null!==t)ao=t,oo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oo=e).memoizedState,baseState:oo.baseState,baseQueue:oo.baseQueue,queue:oo.queue,next:null},null===ao?so.memoizedState=ao=e:ao=ao.next=e}return ao}function vo(e,t){return"function"===typeof t?t(e):t}function _o(e){var t=yo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=oo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,u=null,c=o;do{var A=c.lane;if((io&A)===A)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:A,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=h,a=r):u=u.next=h,so.lanes|=A,Bl|=A}c=c.next}while(null!==c&&c!==o);null===u?a=r:u.next=l,or(r,t.memoizedState)||(ya=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,so.lanes|=o,Bl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function bo(e){var t=yo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);or(o,t.memoizedState)||(ya=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function wo(){}function Eo(e,t){var n=so,r=yo(),i=t(),o=!or(r.memoizedState,i);if(o&&(r.memoizedState=i,ya=!0),r=r.queue,Bo(Co.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==ao&&1&ao.memoizedState.tag){if(n.flags|=2048,Fo(9,Do.bind(null,n,r,i,t),void 0,null),null===Tl)throw Error(s(349));0!==(30&io)||xo(n,t,i)}return i}function xo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=so.updateQueue)?(t={lastEffect:null,stores:null},so.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Do(e,t,n,r){t.value=n,t.getSnapshot=r,So(t)&&To(e)}function Co(e,t,n){return n(function(){So(t)&&To(e)})}function So(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(QA){return!0}}function To(e){var t=Ps(e,1);null!==t&&tu(t,e,1,-1)}function Io(e){var t=mo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:e},t.queue=e,e=e.dispatch=Xo.bind(null,so,e),[t.memoizedState,e]}function Fo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=so.updateQueue)?(t={lastEffect:null,stores:null},so.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ro(){return yo().memoizedState}function ko(e,t,n,r){var i=mo();so.flags|=e,i.memoizedState=Fo(1|t,n,void 0,void 0===r?null:r)}function Po(e,t,n,r){var i=yo();r=void 0===r?null:r;var s=void 0;if(null!==oo){var o=oo.memoizedState;if(s=o.destroy,null!==r&&fo(r,o.deps))return void(i.memoizedState=Fo(t,n,s,r))}so.flags|=e,i.memoizedState=Fo(1|t,n,s,r)}function Mo(e,t){return ko(8390656,8,e,t)}function Bo(e,t){return Po(2048,8,e,t)}function Lo(e,t){return Po(4,2,e,t)}function Oo(e,t){return Po(4,4,e,t)}function No(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Uo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Po(4,4,No.bind(null,t,e),n)}function zo(){}function jo(e,t){var n=yo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Vo(e,t){var n=yo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Go(e,t,n){return 0===(21&io)?(e.baseState&&(e.baseState=!1,ya=!0),e.memoizedState=n):(or(n,t)||(n=ft(),so.lanes|=n,Bl|=n,e.baseState=!0),t)}function Wo(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=ro.transition;ro.transition={};try{e(!1),t()}finally{yt=n,ro.transition=r}}function Ho(){return yo().memoizedState}function Qo(e,t,n){var r=eu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Yo(e))qo(t,n);else if(null!==(n=ks(e,t,n,r))){tu(n,e,r,$l()),Ko(n,t,r)}}function Xo(e,t,n){var r=eu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yo(e))qo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,or(a,o)){var l=t.interleaved;return null===l?(i.next=i,Rs(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(jA){}null!==(n=ks(e,t,i,r))&&(tu(n,e,r,i=$l()),Ko(n,t,r))}}function Yo(e){var t=e.alternate;return e===so||null!==t&&t===so}function qo(e,t){uo=lo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ko(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,mt(e,n)}}var Zo={readContext:Is,useCallback:ho,useContext:ho,useEffect:ho,useImperativeHandle:ho,useInsertionEffect:ho,useLayoutEffect:ho,useMemo:ho,useReducer:ho,useRef:ho,useState:ho,useDebugValue:ho,useDeferredValue:ho,useTransition:ho,useMutableSource:ho,useSyncExternalStore:ho,useId:ho,unstable_isNewReconciler:!1},Jo={readContext:Is,useCallback:function(e,t){return mo().memoizedState=[e,void 0===t?null:t],e},useContext:Is,useEffect:Mo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,ko(4194308,4,No.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ko(4194308,4,e,t)},useInsertionEffect:function(e,t){return ko(4,2,e,t)},useMemo:function(e,t){var n=mo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=mo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Qo.bind(null,so,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},mo().memoizedState=e},useState:Io,useDebugValue:zo,useDeferredValue:function(e){return mo().memoizedState=e},useTransition:function(){var e=Io(!1),t=e[0];return e=Wo.bind(null,e[1]),mo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=so,i=mo();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Tl)throw Error(s(349));0!==(30&io)||xo(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Mo(Co.bind(null,r,o,e),[e]),r.flags|=2048,Fo(9,Do.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=mo(),t=Tl.identifierPrefix;if(rs){var n=Ki;t=":"+t+"R"+(n=(qi&~(1<<32-st(qi)-1)).toString(32)+n),0<(n=co++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Ao++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$o={readContext:Is,useCallback:jo,useContext:Is,useEffect:Bo,useImperativeHandle:Uo,useInsertionEffect:Lo,useLayoutEffect:Oo,useMemo:Vo,useReducer:_o,useRef:Ro,useState:function(){return _o(vo)},useDebugValue:zo,useDeferredValue:function(e){return Go(yo(),oo.memoizedState,e)},useTransition:function(){return[_o(vo)[0],yo().memoizedState]},useMutableSource:wo,useSyncExternalStore:Eo,useId:Ho,unstable_isNewReconciler:!1},ea={readContext:Is,useCallback:jo,useContext:Is,useEffect:Bo,useImperativeHandle:Uo,useInsertionEffect:Lo,useLayoutEffect:Oo,useMemo:Vo,useReducer:bo,useRef:Ro,useState:function(){return bo(vo)},useDebugValue:zo,useDeferredValue:function(e){var t=yo();return null===oo?t.memoizedState=e:Go(t,oo.memoizedState,e)},useTransition:function(){return[bo(vo)[0],yo().memoizedState]},useMutableSource:wo,useSyncExternalStore:Eo,useId:Ho,unstable_isNewReconciler:!1};function ta(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function na(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ra={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=$l(),i=eu(e),s=Os(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ns(e,s,i))&&(tu(t,e,i,r),Us(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=$l(),i=eu(e),s=Os(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ns(e,s,i))&&(tu(t,e,i,r),Us(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$l(),r=eu(e),i=Os(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Ns(e,i,r))&&(tu(t,e,r,n),Us(t,e,r))}};function ia(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!ar(n,r)||!ar(i,s))}function sa(e,t,n){var r=!1,i=Ci,s=t.contextType;return"object"===typeof s&&null!==s?s=Is(s):(i=Ri(t)?Ii:Si.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Fi(e,i):Ci),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ra,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function oa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ra.enqueueReplaceState(t,t.state,null)}function aa(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Bs(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Is(s):(s=Ri(t)?Ii:Si.current,i.context=Fi(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(na(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ra.enqueueReplaceState(i,i.state,null),js(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function la(e,t){try{var n="",r=t;do{n+=j(r),r=r.return}while(r);var i=n}catch(WA){i="\nError generating stack: "+WA.message+"\n"+WA.stack}return{value:e,source:t,stack:i,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ca(e,t){try{console.error(t.value)}catch(zA){setTimeout(function(){throw zA})}}var Aa="function"===typeof WeakMap?WeakMap:Map;function ha(e,t,n){(n=Os(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gl||(Gl=!0,Wl=r),ca(0,t)},n}function da(e,t,n){(n=Os(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ca(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ca(0,t),"function"!==typeof r&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fa(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Aa;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=xu.bind(null,e,t,n),t.then(e,e))}function pa(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ga(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Os(-1,1)).tag=2,Ns(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ma=_.ReactCurrentOwner,ya=!1;function va(e,t,n,r){t.child=null===e?_s(t,null,n,r):vs(t,e.child,n,r)}function _a(e,t,n,r,i){n=n.render;var s=t.ref;return Ts(t,i),r=po(e,t,n,r,s,i),n=go(),null===e||ya?(rs&&n&&$i(t),t.flags|=1,va(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ga(e,t,i))}function ba(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Ru(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pu(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,wa(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:ar)(o,r)&&e.ref===t.ref)return Ga(e,t,i)}return t.flags|=1,(e=ku(s,r)).ref=t.ref,e.return=t,t.child=e}function wa(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(ar(s,r)&&e.ref===t.ref){if(ya=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Ga(e,t,i);0!==(131072&e.flags)&&(ya=!0)}}return Da(e,t,n,r,i)}function Ea(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Di(kl,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Di(kl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Di(kl,Rl),Rl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Di(kl,Rl),Rl|=r;return va(e,t,i,n),t.child}function xa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Da(e,t,n,r,i){var s=Ri(n)?Ii:Si.current;return s=Fi(t,s),Ts(t,i),n=po(e,t,n,r,s,i),r=go(),null===e||ya?(rs&&r&&$i(t),t.flags|=1,va(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ga(e,t,i))}function Ca(e,t,n,r,i){if(Ri(n)){var s=!0;Bi(t)}else s=!1;if(Ts(t,i),null===t.stateNode)Va(e,t),sa(t,n,r),aa(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=n.contextType;"object"===typeof u&&null!==u?u=Is(u):u=Fi(t,u=Ri(n)?Ii:Si.current);var c=n.getDerivedStateFromProps,A="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;A||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==u)&&oa(t,o,r,u),Ms=!1;var h=t.memoizedState;o.state=h,js(t,r,o,i),l=t.memoizedState,a!==r||h!==l||Ti.current||Ms?("function"===typeof c&&(na(t,n,c,r),l=t.memoizedState),(a=Ms||ia(t,n,a,r,h,l,u))?(A||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ls(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:ta(t.type,a),o.props=u,A=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Is(l):l=Fi(t,l=Ri(n)?Ii:Si.current);var d=n.getDerivedStateFromProps;(c="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==A||h!==l)&&oa(t,o,r,l),Ms=!1,h=t.memoizedState,o.state=h,js(t,r,o,i);var f=t.memoizedState;a!==A||h!==f||Ti.current||Ms?("function"===typeof d&&(na(t,n,d,r),f=t.memoizedState),(u=Ms||ia(t,n,u,r,h,f,l)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Sa(e,t,n,r,s,i)}function Sa(e,t,n,r,i,s){xa(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Li(t,n,!1),Ga(e,t,s);r=t.stateNode,ma.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=vs(t,e.child,null,s),t.child=vs(t,null,a,s)):va(e,t,a,s),t.memoizedState=r.state,i&&Li(t,n,!0),t.child}function Ta(e){var t=e.stateNode;t.pendingContext?Pi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pi(0,t.context,!1),Ys(e,t.containerInfo)}function Ia(e,t,n,r,i){return hs(),ds(i),t.flags|=256,va(e,t,n,r),t.child}var Fa,Ra,ka,Pa,Ma={dehydrated:null,treeContext:null,retryLane:0};function Ba(e){return{baseLanes:e,cachePool:null,transitions:null}}function La(e,t,n){var r,i=t.pendingProps,o=Js.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Di(Js,1&o),null===e)return ls(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Bu(l,i,0,null),e=Mu(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ba(n),t.memoizedState=Ma,e):Oa(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,Na(e,t,a,r=ua(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Bu({mode:"visible",children:r.children},i,0,null),(o=Mu(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&vs(t,e.child,null,a),t.child.memoizedState=Ba(a),t.memoizedState=Ma,o);if(0===(1&t.mode))return Na(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Na(e,t,a,r=ua(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),ya||l){if(null!==(r=Tl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ps(e,i),tu(r,e,i,-1))}return fu(),Na(e,t,a,r=ua(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cu.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ns=li(i.nextSibling),ts=t,rs=!0,is=null,null!==e&&(Qi[Xi++]=qi,Qi[Xi++]=Ki,Qi[Xi++]=Yi,qi=e.id,Ki=e.overflow,Yi=t),t=Oa(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null):(i=ku(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=ku(r,a):(a=Mu(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?Ba(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Ma,i}return e=(a=e.child).sibling,i=ku(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Oa(e,t){return(t=Bu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Na(e,t,n,r){return null!==r&&ds(r),vs(t,e.child,null,n),(e=Oa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ss(e.return,t,n)}function za(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ja(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(va(e,t,r.children,n),0!==(2&(r=Js.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,n,t);else if(19===e.tag)Ua(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Di(Js,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===$s(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),za(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===$s(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}za(t,!0,n,null,s);break;case"together":za(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Va(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ga(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Bl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=ku(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ku(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wa(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ha(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qa(e,t,n){var r=t.pendingProps;switch(es(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ha(t),null;case 1:case 17:return Ri(t.type)&&ki(),Ha(t),null;case 3:return r=t.stateNode,qs(),xi(Ti),xi(Si),to(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(cs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==is&&(su(is),is=null))),Ra(e,t),Ha(t),null;case 5:Zs(t);var i=Xs(Qs.current);if(n=t.type,null!==e&&null!=t.stateNode)ka(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ha(t),null}if(e=Xs(Ws.current),cs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Ai]=t,r[hi]=o,e=0!==(1&t.mode),n){case"dialog":Nr("cancel",r),Nr("close",r);break;case"iframe":case"object":case"embed":Nr("load",r);break;case"video":case"audio":for(i=0;i<Mr.length;i++)Nr(Mr[i],r);break;case"source":Nr("error",r);break;case"img":case"image":case"link":Nr("error",r),Nr("load",r);break;case"details":Nr("toggle",r);break;case"input":K(r,o),Nr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Nr("invalid",r);break;case"textarea":ie(r,o),Nr("invalid",r)}for(var l in me(n,o),i=null,o)if(o.hasOwnProperty(l)){var u=o[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,u,e),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,u,e),i=["children",""+u]):a.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Nr("scroll",r)}switch(n){case"input":Q(r),$(r,o,!0);break;case"textarea":Q(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Jr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Ai]=t,e[hi]=r,Fa(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(n,r),n){case"dialog":Nr("cancel",e),Nr("close",e),i=r;break;case"iframe":case"object":case"embed":Nr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Mr.length;i++)Nr(Mr[i],e);i=r;break;case"source":Nr("error",e),i=r;break;case"img":case"image":case"link":Nr("error",e),Nr("load",e),i=r;break;case"details":Nr("toggle",e),i=r;break;case"input":K(e,r),i=q(e,r),Nr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=O({},r,{value:void 0}),Nr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Nr("invalid",e)}for(o in me(n,i),u=i)if(u.hasOwnProperty(o)){var c=u[o];"style"===o?pe(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&ce(e,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&Ae(e,c):"number"===typeof c&&Ae(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Nr("scroll",e):null!=c&&v(e,o,c,l))}switch(n){case"input":Q(e),$(e,r,!1);break;case"textarea":Q(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ha(t),null;case 6:if(e&&null!=t.stateNode)Pa(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Xs(Qs.current),Xs(Ws.current),cs(t)){if(r=t.stateNode,n=t.memoizedProps,r[Ai]=t,(o=r.nodeValue!==n)&&null!==(e=ts))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Ai]=t,t.stateNode=r}return Ha(t),null;case 13:if(xi(Js),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==ns&&0!==(1&t.mode)&&0===(128&t.flags))As(),hs(),t.flags|=98560,o=!1;else if(o=cs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[Ai]=t}else hs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ha(t),o=!1}else null!==is&&(su(is),is=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Js.current)?0===Pl&&(Pl=3):fu())),null!==t.updateQueue&&(t.flags|=4),Ha(t),null);case 4:return qs(),Ra(e,t),null===e&&jr(t.stateNode.containerInfo),Ha(t),null;case 10:return Cs(t.type._context),Ha(t),null;case 19:if(xi(Js),null===(o=t.memoizedState))return Ha(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Wa(o,!1);else{if(0!==Pl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=$s(e))){for(t.flags|=128,Wa(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Di(Js,1&Js.current|2),t.child}e=e.sibling}null!==o.tail&&Ke()>jl&&(t.flags|=128,r=!0,Wa(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=$s(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!rs)return Ha(t),null}else 2*Ke()-o.renderingStartTime>jl&&1073741824!==n&&(t.flags|=128,r=!0,Wa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ke(),t.sibling=null,n=Js.current,Di(Js,r?1&n|2:1&n),t):(Ha(t),null);case 22:case 23:return cu(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(Ha(t),6&t.subtreeFlags&&(t.flags|=8192)):Ha(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Xa(e,t){switch(es(t),t.tag){case 1:return Ri(t.type)&&ki(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return qs(),xi(Ti),xi(Si),to(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zs(t),null;case 13:if(xi(Js),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));hs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(Js),null;case 4:return qs(),null;case 10:return Cs(t.type._context),null;case 22:case 23:return cu(),null;default:return null}}Fa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(){},ka=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Xs(Ws.current);var s,o=null;switch(n){case"input":i=q(e,i),r=q(e,r),o=[];break;case"select":i=O({},i,{value:void 0}),r=O({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(c in me(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(a.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(o||(o=[]),o.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(o=o||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(a.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Nr("scroll",e),o||l===u||(o=[])):(o=o||[]).push(c,u))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},Pa=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ya=!1,qa=!1,Ka="function"===typeof WeakSet?WeakSet:Set,Za=null;function Ja(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(QA){Eu(e,t,QA)}else n.current=null}function $a(e,t,n){try{n()}catch(QA){Eu(e,t,QA)}}var el=!1;function tl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&$a(t,n,s)}i=i.next}while(i!==r)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[Ai],delete t[hi],delete t[fi],delete t[pi],delete t[gi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function al(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(al(e,t,n),e=e.sibling;null!==e;)al(e,t,n),e=e.sibling}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var ul=null,cl=!1;function Al(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(rt,n)}catch(GA){}switch(n.tag){case 5:qa||Ja(n,t);case 6:var r=ul,i=cl;ul=null,Al(e,t,n),cl=i,null!==(ul=r)&&(cl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(cl?(e=ul,n=n.stateNode,8===e.nodeType?ai(e.parentNode,n):1===e.nodeType&&ai(e,n),jt(e)):ai(ul,n.stateNode));break;case 4:r=ul,i=cl,ul=n.stateNode.containerInfo,cl=!0,Al(e,t,n),ul=r,cl=i;break;case 0:case 11:case 14:case 15:if(!qa&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&$a(n,t,o),i=i.next}while(i!==r)}Al(e,t,n);break;case 1:if(!qa&&(Ja(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(GA){Eu(n,t,GA)}Al(e,t,n);break;case 21:Al(e,t,n);break;case 22:1&n.mode?(qa=(r=qa)||null!==n.memoizedState,Al(e,t,n),qa=r):Al(e,t,n);break;default:Al(e,t,n)}}function dl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ka),t.forEach(function(t){var r=Su.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function fl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,cl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,cl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));hl(o,a,i),ul=null,cl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(jA){Eu(i,t,jA)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)pl(t,e),t=t.sibling}function pl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),gl(e),4&r){try{tl(3,e,e.return),nl(3,e)}catch(PA){Eu(e,e.return,PA)}try{tl(5,e,e.return)}catch(PA){Eu(e,e.return,PA)}}break;case 1:fl(t,e),gl(e),512&r&&null!==n&&Ja(n,n.return);break;case 5:if(fl(t,e),gl(e),512&r&&null!==n&&Ja(n,n.return),32&e.flags){var i=e.stateNode;try{Ae(i,"")}catch(PA){Eu(e,e.return,PA)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===o.type&&null!=o.name&&Z(i,o),ye(l,a);var c=ye(l,o);for(a=0;a<u.length;a+=2){var A=u[a],h=u[a+1];"style"===A?pe(i,h):"dangerouslySetInnerHTML"===A?ce(i,h):"children"===A?Ae(i,h):v(i,A,h,c)}switch(l){case"input":J(i,o);break;case"textarea":se(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(i,!!o.multiple,f,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[hi]=o}catch(PA){Eu(e,e.return,PA)}}break;case 6:if(fl(t,e),gl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(PA){Eu(e,e.return,PA)}}break;case 3:if(fl(t,e),gl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(PA){Eu(e,e.return,PA)}break;case 4:default:fl(t,e),gl(e);break;case 13:fl(t,e),gl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(zl=Ke())),4&r&&dl(e);break;case 22:if(A=null!==n&&null!==n.memoizedState,1&e.mode?(qa=(c=qa)||A,fl(t,e),qa=c):fl(t,e),gl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!A&&0!==(1&e.mode))for(Za=e,A=e.child;null!==A;){for(h=Za=A;null!==Za;){switch(f=(d=Za).child,d.tag){case 0:case 11:case 14:case 15:tl(4,d,d.return);break;case 1:Ja(d,d.return);var p=d.stateNode;if("function"===typeof p.componentWillUnmount){r=d,n=d.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(PA){Eu(r,n,PA)}}break;case 5:Ja(d,d.return);break;case 22:if(null!==d.memoizedState){_l(h);continue}}null!==f?(f.return=d,Za=f):_l(h)}A=A.sibling}e:for(A=null,h=e;;){if(5===h.tag){if(null===A){A=h;try{i=h.stateNode,c?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,a=void 0!==(u=h.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=fe("display",a))}catch(PA){Eu(e,e.return,PA)}}}else if(6===h.tag){if(null===A)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(PA){Eu(e,e.return,PA)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;A===h&&(A=null),h=h.return}A===h&&(A=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),gl(e),4&r&&dl(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(Ae(i,""),r.flags&=-33),ll(e,ol(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;al(e,ol(e),o);break;default:throw Error(s(161))}}catch(a){Eu(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ml(e,t,n){Za=e,yl(e,t,n)}function yl(e,t,n){for(var r=0!==(1&e.mode);null!==Za;){var i=Za,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Ya;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||qa;a=Ya;var u=qa;if(Ya=o,(qa=l)&&!u)for(Za=i;null!==Za;)l=(o=Za).child,22===o.tag&&null!==o.memoizedState?bl(i):null!==l?(l.return=o,Za=l):bl(i);for(;null!==s;)Za=s,yl(s,t,n),s=s.sibling;Za=i,Ya=a,qa=u}vl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Za=s):vl(e)}}function vl(e){for(;null!==Za;){var t=Za;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:qa||nl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!qa)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ta(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Vs(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var A=c.memoizedState;if(null!==A){var h=A.dehydrated;null!==h&&jt(h)}}}break;default:throw Error(s(163))}qa||512&t.flags&&rl(t)}catch(LA){Eu(t,t.return,LA)}}if(t===e){Za=null;break}if(null!==(n=t.sibling)){n.return=t.return,Za=n;break}Za=t.return}}function _l(e){for(;null!==Za;){var t=Za;if(t===e){Za=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Za=n;break}Za=t.return}}function bl(e){for(;null!==Za;){var t=Za;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(l){Eu(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Eu(t,i,l)}}var s=t.return;try{rl(t)}catch(l){Eu(t,s,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){Eu(t,o,l)}}}catch(l){Eu(t,t.return,l)}if(t===e){Za=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Za=a;break}Za=t.return}}var wl,El=Math.ceil,xl=_.ReactCurrentDispatcher,Dl=_.ReactCurrentOwner,Cl=_.ReactCurrentBatchConfig,Sl=0,Tl=null,Il=null,Fl=0,Rl=0,kl=Ei(0),Pl=0,Ml=null,Bl=0,Ll=0,Ol=0,Nl=null,Ul=null,zl=0,jl=1/0,Vl=null,Gl=!1,Wl=null,Hl=null,Ql=!1,Xl=null,Yl=0,ql=0,Kl=null,Zl=-1,Jl=0;function $l(){return 0!==(6&Sl)?Ke():-1!==Zl?Zl:Zl=Ke()}function eu(e){return 0===(1&e.mode)?1:0!==(2&Sl)&&0!==Fl?Fl&-Fl:null!==fs.transition?(0===Jl&&(Jl=ft()),Jl):0!==(e=yt)?e:e=void 0===(e=window.event)?16:qt(e.type)}function tu(e,t,n,r){if(50<ql)throw ql=0,Kl=null,Error(s(185));gt(e,n,r),0!==(2&Sl)&&e===Tl||(e===Tl&&(0===(2&Sl)&&(Ll|=n),4===Pl&&ou(e,Fl)),nu(e,r),1===n&&0===Sl&&0===(1&t.mode)&&(jl=Ke()+500,Ni&&ji()))}function nu(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-st(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ht(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=At(e,e===Tl?Fl:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Ni=!0,zi(e)}(au.bind(null,e)):zi(au.bind(null,e)),si(function(){0===(6&Sl)&&ji()}),n=null;else{switch(vt(r)){case 1:n=Je;break;case 4:n=$e;break;case 16:default:n=et;break;case 536870912:n=nt}n=Tu(n,ru.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ru(e,t){if(Zl=-1,Jl=0,0!==(6&Sl))throw Error(s(327));var n=e.callbackNode;if(bu()&&e.callbackNode!==n)return null;var r=At(e,e===Tl?Fl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=pu(e,r);else{t=r;var i=Sl;Sl|=2;var o=du();for(Tl===e&&Fl===t||(Vl=null,jl=Ke()+500,Au(e,t));;)try{mu();break}catch(GA){hu(e,GA)}Ds(),xl.current=o,Sl=i,null!==Il?t=0:(Tl=null,Fl=0,t=Pl)}if(0!==t){if(2===t&&(0!==(i=dt(e))&&(r=i,t=iu(e,i))),1===t)throw n=Ml,Au(e,0),ou(e,r),nu(e,Ke()),n;if(6===t)ou(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!or(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=pu(e,r))&&(0!==(o=dt(e))&&(r=o,t=iu(e,o))),1===t))throw n=Ml,Au(e,0),ou(e,r),nu(e,Ke()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:_u(e,Ul,Vl);break;case 3:if(ou(e,r),(130023424&r)===r&&10<(t=zl+500-Ke())){if(0!==At(e,0))break;if(((i=e.suspendedLanes)&r)!==r){$l(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(_u.bind(null,e,Ul,Vl),t);break}_u(e,Ul,Vl);break;case 4:if(ou(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-st(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Ke()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ni(_u.bind(null,e,Ul,Vl),r);break}_u(e,Ul,Vl);break;default:throw Error(s(329))}}}return nu(e,Ke()),e.callbackNode===n?ru.bind(null,e):null}function iu(e,t){var n=Nl;return e.current.memoizedState.isDehydrated&&(Au(e,t).flags|=256),2!==(e=pu(e,t))&&(t=Ul,Ul=n,null!==t&&su(t)),e}function su(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function ou(e,t){for(t&=~Ol,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function au(e){if(0!==(6&Sl))throw Error(s(327));bu();var t=At(e,0);if(0===(1&t))return nu(e,Ke()),null;var n=pu(e,t);if(0!==e.tag&&2===n){var r=dt(e);0!==r&&(t=r,n=iu(e,r))}if(1===n)throw n=Ml,Au(e,0),ou(e,t),nu(e,Ke()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_u(e,Ul,Vl),nu(e,Ke()),null}function lu(e,t){var n=Sl;Sl|=1;try{return e(t)}finally{0===(Sl=n)&&(jl=Ke()+500,Ni&&ji())}}function uu(e){null!==Xl&&0===Xl.tag&&0===(6&Sl)&&bu();var t=Sl;Sl|=1;var n=Cl.transition,r=yt;try{if(Cl.transition=null,yt=1,e)return e()}finally{yt=r,Cl.transition=n,0===(6&(Sl=t))&&ji()}}function cu(){Rl=kl.current,xi(kl)}function Au(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ri(n)),null!==Il)for(n=Il.return;null!==n;){var r=n;switch(es(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&ki();break;case 3:qs(),xi(Ti),xi(Si),to();break;case 5:Zs(r);break;case 4:qs();break;case 13:case 19:xi(Js);break;case 10:Cs(r.type._context);break;case 22:case 23:cu()}n=n.return}if(Tl=e,Il=e=ku(e.current,null),Fl=Rl=t,Pl=0,Ml=null,Ol=Ll=Bl=0,Ul=Nl=null,null!==Fs){for(t=0;t<Fs.length;t++)if(null!==(r=(n=Fs[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Fs=null}return e}function hu(e,t){for(;;){var n=Il;try{if(Ds(),no.current=Zo,lo){for(var r=so.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}lo=!1}if(io=0,ao=oo=so=null,uo=!1,co=0,Dl.current=null,null===n||null===n.return){Pl=1,Ml=t,Il=null;break}e:{var o=e,a=n.return,l=n,u=t;if(t=Fl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,A=l,h=A.tag;if(0===(1&A.mode)&&(0===h||11===h||15===h)){var d=A.alternate;d?(A.updateQueue=d.updateQueue,A.memoizedState=d.memoizedState,A.lanes=d.lanes):(A.updateQueue=null,A.memoizedState=null)}var f=pa(a);if(null!==f){f.flags&=-257,ga(f,a,l,0,t),1&f.mode&&fa(o,c,t),u=c;var p=(t=f).updateQueue;if(null===p){var g=new Set;g.add(u),t.updateQueue=g}else p.add(u);break e}if(0===(1&t)){fa(o,c,t),fu();break e}u=Error(s(426))}else if(rs&&1&l.mode){var m=pa(a);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),ga(m,a,l,0,t),ds(la(u,l));break e}}o=u=la(u,l),4!==Pl&&(Pl=2),null===Nl?Nl=[o]:Nl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,zs(o,ha(0,u,t));break e;case 1:l=u;var y=o.type,v=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===Hl||!Hl.has(v)))){o.flags|=65536,t&=-t,o.lanes|=t,zs(o,da(o,l,t));break e}}o=o.return}while(null!==o)}vu(n)}catch(_){t=_,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function du(){var e=xl.current;return xl.current=Zo,null===e?Zo:e}function fu(){0!==Pl&&3!==Pl&&2!==Pl||(Pl=4),null===Tl||0===(268435455&Bl)&&0===(268435455&Ll)||ou(Tl,Fl)}function pu(e,t){var n=Sl;Sl|=2;var r=du();for(Tl===e&&Fl===t||(Vl=null,Au(e,t));;)try{gu();break}catch(kA){hu(e,kA)}if(Ds(),Sl=n,xl.current=r,null!==Il)throw Error(s(261));return Tl=null,Fl=0,Pl}function gu(){for(;null!==Il;)yu(Il)}function mu(){for(;null!==Il&&!Ye();)yu(Il)}function yu(e){var t=wl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?vu(e):Il=t,Dl.current=null}function vu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Qa(n,t,Rl)))return void(Il=n)}else{if(null!==(n=Xa(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Pl=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Pl&&(Pl=5)}function _u(e,t,n){var r=yt,i=Cl.transition;try{Cl.transition=null,yt=1,function(e,t,n,r){do{bu()}while(null!==Xl);if(0!==(6&Sl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Tl&&(Il=Tl=null,Fl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ql||(Ql=!0,Tu(et,function(){return bu(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var a=yt;yt=1;var l=Sl;Sl|=4,Dl.current=null,function(e,t){if($r=Gt,hr(e=Ar())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(fh){n=null;break e}var a=0,l=-1,u=-1,c=0,A=0,h=e,d=null;t:for(;;){for(var f;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==o||0!==r&&3!==h.nodeType||(u=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)d=h,h=f;for(;;){if(h===e)break t;if(d===n&&++c===i&&(l=a),d===o&&++A===r&&(u=a),null!==(f=h.nextSibling))break;d=(h=d).parentNode}h=f}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ei={focusedElem:e,selectionRange:n},Gt=!1,Za=t;null!==Za;)if(e=(t=Za).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Za=e;else for(;null!==Za;){t=Za;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,m=p.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ta(t.type,g),m);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(s(163))}}catch(fh){Eu(t,t.return,fh)}if(null!==(e=t.sibling)){e.return=t.return,Za=e;break}Za=t.return}p=el,el=!1}(e,n),pl(n,e),dr(ei),Gt=!!$r,ei=$r=null,e.current=n,ml(n,e,i),qe(),Sl=l,yt=a,Cl.transition=o}else e.current=n;if(Ql&&(Ql=!1,Xl=e,Yl=i),o=e.pendingLanes,0===o&&(Hl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nu(e,Ke()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Gl)throw Gl=!1,e=Wl,Wl=null,e;0!==(1&Yl)&&0!==e.tag&&bu(),o=e.pendingLanes,0!==(1&o)?e===Kl?ql++:(ql=0,Kl=e):ql=0,ji()}(e,t,n,r)}finally{Cl.transition=i,yt=r}return null}function bu(){if(null!==Xl){var e=vt(Yl),t=Cl.transition,n=yt;try{if(Cl.transition=null,yt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,Yl=0,0!==(6&Sl))throw Error(s(331));var i=Sl;for(Sl|=4,Za=e.current;null!==Za;){var o=Za,a=o.child;if(0!==(16&Za.flags)){var l=o.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Za=c;null!==Za;){var A=Za;switch(A.tag){case 0:case 11:case 15:tl(8,A,o)}var h=A.child;if(null!==h)h.return=A,Za=h;else for(;null!==Za;){var d=(A=Za).sibling,f=A.return;if(il(A),A===c){Za=null;break}if(null!==d){d.return=f,Za=d;break}Za=f}}}var p=o.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}Za=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Za=a;else e:for(;null!==Za;){if(0!==(2048&(o=Za).flags))switch(o.tag){case 0:case 11:case 15:tl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Za=y;break e}Za=o.return}}var v=e.current;for(Za=v;null!==Za;){var _=(a=Za).child;if(0!==(2064&a.subtreeFlags)&&null!==_)_.return=a,Za=_;else e:for(a=v;null!==Za;){if(0!==(2048&(l=Za).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(w){Eu(l,l.return,w)}if(l===a){Za=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Za=b;break e}Za=l.return}}if(Sl=i,ji(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(rt,e)}catch(w){}r=!0}return r}finally{yt=n,Cl.transition=t}}return!1}function wu(e,t,n){e=Ns(e,t=ha(0,t=la(n,t),1),1),t=$l(),null!==e&&(gt(e,1,t),nu(e,t))}function Eu(e,t,n){if(3===e.tag)wu(e,e,n);else for(;null!==t;){if(3===t.tag){wu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hl||!Hl.has(r))){t=Ns(t,e=da(t,e=la(n,e),1),1),e=$l(),null!==t&&(gt(t,1,e),nu(t,e));break}}t=t.return}}function xu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=$l(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Fl&n)===n&&(4===Pl||3===Pl&&(130023424&Fl)===Fl&&500>Ke()-zl?Au(e,0):Ol|=n),nu(e,t)}function Du(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=$l();null!==(e=Ps(e,t))&&(gt(e,t,n),nu(e,n))}function Cu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Du(e,n)}function Su(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Du(e,n)}function Tu(e,t){return Qe(e,t)}function Iu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fu(e,t,n,r){return new Iu(e,t,n,r)}function Ru(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ku(e,t){var n=e.alternate;return null===n?((n=Fu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pu(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Ru(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case E:return Mu(n.children,i,o,t);case x:a=8,i|=8;break;case D:return(e=Fu(12,n,t,2|i)).elementType=D,e.lanes=o,e;case I:return(e=Fu(13,n,t,i)).elementType=I,e.lanes=o,e;case F:return(e=Fu(19,n,t,i)).elementType=F,e.lanes=o,e;case P:return Bu(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:a=10;break e;case S:a=9;break e;case T:a=11;break e;case R:a=14;break e;case k:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Fu(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Mu(e,t,n,r){return(e=Fu(7,e,r,t)).lanes=n,e}function Bu(e,t,n,r){return(e=Fu(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Lu(e,t,n){return(e=Fu(6,e,null,t)).lanes=n,e}function Ou(e,t,n){return(t=Fu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nu(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pt(0),this.expirationTimes=pt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uu(e,t,n,r,i,s,o,a,l){return e=new Nu(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Fu(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bs(s),e}function zu(e){if(!e)return Ci;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ri(n))return Mi(e,n,t)}return t}function ju(e,t,n,r,i,s,o,a,l){return(e=Uu(n,r,!0,e,0,s,0,a,l)).context=zu(null),n=e.current,(s=Os(r=$l(),i=eu(n))).callback=void 0!==t&&null!==t?t:null,Ns(n,s,i),e.current.lanes=i,gt(e,i,r),nu(e,r),e}function Vu(e,t,n,r){var i=t.current,s=$l(),o=eu(i);return n=zu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Os(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ns(i,t,o))&&(tu(e,i,o,s),Us(e,i,o)),o}function Gu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hu(e,t){Wu(e,t),(e=e.alternate)&&Wu(e,t)}wl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ti.current)ya=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ya=!1,function(e,t,n){switch(t.tag){case 3:Ta(t),hs();break;case 5:Ks(t);break;case 1:Ri(t.type)&&Bi(t);break;case 4:Ys(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Di(bs,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Di(Js,1&Js.current),t.flags|=128,null):0!==(n&t.child.childLanes)?La(e,t,n):(Di(Js,1&Js.current),null!==(e=Ga(e,t,n))?e.sibling:null);Di(Js,1&Js.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return ja(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Di(Js,Js.current),r)break;return null;case 22:case 23:return t.lanes=0,Ea(e,t,n)}return Ga(e,t,n)}(e,t,n);ya=0!==(131072&e.flags)}else ya=!1,rs&&0!==(1048576&t.flags)&&Ji(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Va(e,t),e=t.pendingProps;var i=Fi(t,Si.current);Ts(t,n),i=po(null,t,r,e,i,n);var o=go();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(r)?(o=!0,Bi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Bs(t),i.updater=ra,t.stateNode=i,i._reactInternals=t,aa(t,r,e,n),t=Sa(null,t,r,!0,o,n)):(t.tag=0,rs&&o&&$i(t),va(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Va(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Ru(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===R)return 14}return 2}(r),e=ta(r,e),i){case 0:t=Da(null,t,r,e,n);break e;case 1:t=Ca(null,t,r,e,n);break e;case 11:t=_a(null,t,r,e,n);break e;case 14:t=ba(null,t,r,ta(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Da(e,t,r,i=t.elementType===r?i:ta(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ca(e,t,r,i=t.elementType===r?i:ta(r,i),n);case 3:e:{if(Ta(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Ls(e,t),js(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ia(e,t,r,n,i=la(Error(s(423)),t));break e}if(r!==i){t=Ia(e,t,r,n,i=la(Error(s(424)),t));break e}for(ns=li(t.stateNode.containerInfo.firstChild),ts=t,rs=!0,is=null,n=_s(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hs(),r===i){t=Ga(e,t,n);break e}va(e,t,r,n)}t=t.child}return t;case 5:return Ks(t),null===e&&ls(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ti(r,i)?a=null:null!==o&&ti(r,o)&&(t.flags|=32),xa(e,t),va(e,t,a,n),t.child;case 6:return null===e&&ls(t),null;case 13:return La(e,t,n);case 4:return Ys(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=vs(t,null,r,n):va(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,_a(e,t,r,i=t.elementType===r?i:ta(r,i),n);case 7:return va(e,t,t.pendingProps,n),t.child;case 8:case 12:return va(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Di(bs,r._currentValue),r._currentValue=a,null!==o)if(or(o.value,a)){if(o.children===i.children&&!Ti.current){t=Ga(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===o.tag){(u=Os(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var A=(c=c.shared).pending;null===A?u.next=u:(u.next=A.next,A.next=u),c.pending=u}}o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),Ss(o.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ss(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}va(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ts(t,n),r=r(i=Is(i)),t.flags|=1,va(e,t,r,n),t.child;case 14:return i=ta(r=t.type,t.pendingProps),ba(e,t,r,i=ta(r.type,i),n);case 15:return wa(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ta(r,i),Va(e,t),t.tag=1,Ri(r)?(e=!0,Bi(t)):e=!1,Ts(t,n),sa(t,r,i),aa(t,r,i,n),Sa(null,t,r,!0,e,n);case 19:return ja(e,t,n);case 22:return Ea(e,t,n)}throw Error(s(156,t.tag))};var Qu="function"===typeof reportError?reportError:function(e){console.error(e)};function Xu(e){this._internalRoot=e}function Yu(e){this._internalRoot=e}function qu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ku(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zu(){}function Ju(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=Gu(o);a.call(e)}}Vu(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Gu(o);s.call(e)}}var o=ju(t,r,e,0,null,!1,0,"",Zu);return e._reactRootContainer=o,e[di]=o.current,jr(8===e.nodeType?e.parentNode:e),uu(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Gu(l);a.call(e)}}var l=Uu(e,0,!1,null,0,!1,0,"",Zu);return e._reactRootContainer=l,e[di]=l.current,jr(8===e.nodeType?e.parentNode:e),uu(function(){Vu(t,l,n,r)}),l}(n,t,e,i,r);return Gu(o)}Yu.prototype.render=Xu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Vu(e,t,null,null)},Yu.prototype.unmount=Xu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uu(function(){Vu(null,e,null,null)}),t[di]=null}},Yu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<kt.length&&0!==t&&t<kt[n].priority;n++);kt.splice(n,0,e),0===n&&Lt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ct(t.pendingLanes);0!==n&&(mt(t,1|n),nu(t,Ke()),0===(6&Sl)&&(jl=Ke()+500,ji()))}break;case 13:uu(function(){var t=Ps(e,1);if(null!==t){var n=$l();tu(t,e,1,n)}}),Hu(e,1)}},bt=function(e){if(13===e.tag){var t=Ps(e,134217728);if(null!==t)tu(t,e,134217728,$l());Hu(e,134217728)}},wt=function(e){if(13===e.tag){var t=eu(e),n=Ps(e,t);if(null!==n)tu(n,e,t,$l());Hu(e,t)}},Et=function(){return yt},xt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},be=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_i(r);if(!i)throw Error(s(90));X(r),J(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Se=lu,Te=uu;var $u={usingClientEntryPoint:!1,Events:[yi,vi,_i,De,Ce,lu]},ec={findFiberByHostInstance:mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tc={bundleType:ec.bundleType,version:ec.version,rendererPackageName:ec.rendererPackageName,rendererConfig:ec.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:ec.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nc.isDisabled&&nc.supportsFiber)try{rt=nc.inject(tc),it=nc}catch(OA){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$u,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!qu(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!qu(e))throw Error(s(299));var n=!1,r="",i=Qu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uu(e,1,!1,null,0,n,0,r,i),e[di]=t.current,jr(8===e.nodeType?e.parentNode:e),new Xu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uu(e)},t.hydrate=function(e,t,n){if(!Ku(t))throw Error(s(200));return Ju(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!qu(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Qu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=ju(t,null,e,1,null!=n?n:null,i,0,o,a),e[di]=t.current,jr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yu(t)},t.render=function(e,t,n){if(!Ku(t))throw Error(s(200));return Ju(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Ku(e))throw Error(s(40));return!!e._reactRootContainer&&(uu(function(){Ju(null,null,e,!1,function(){e._reactRootContainer=null,e[di]=null})}),!0)},t.unstable_batchedUpdates=lu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ku(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Ju(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},973:e=>{function t(e,t,r){r=r||2;var s,o,a,l,A,h,f,p=t&&t.length,g=p?t[0]*r:e.length,m=n(e,0,g,r,!0),y=[];if(!m||m.next===m.prev)return y;if(p&&(m=function(e,t,r,i){var s,o,a,l=[];for(s=0,o=t.length;s<o;s++)(a=n(e,t[s]*i,s<o-1?t[s+1]*i:e.length,i,!1))===a.next&&(a.steiner=!0),l.push(d(a));for(l.sort(u),s=0;s<l.length;s++)r=c(l[s],r);return r}(e,t,m,r)),e.length>80*r){s=a=e[0],o=l=e[1];for(var v=r;v<g;v+=r)(A=e[v])<s&&(s=A),(h=e[v+1])<o&&(o=h),A>a&&(a=A),h>l&&(l=h);f=0!==(f=Math.max(a-s,l-o))?32767/f:0}return i(m,y,r,s,o,f,0),y}function n(e,t,n,r,i){var s,o;if(i===C(e,t,n,r)>0)for(s=t;s<n;s+=r)o=E(s,e[s],e[s+1],o);else for(s=n-r;s>=t;s-=r)o=E(s,e[s],e[s+1],o);return o&&m(o,o.next)&&(x(o),o=o.next),o}function r(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(x(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function i(e,t,n,u,c,A,d){if(e){!d&&A&&function(e,t,n,r){var i=e;do{0===i.z&&(i.z=h(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,s,o,a,l,u=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,r=n,a=0,t=0;t<u&&(a++,r=r.nextZ);t++);for(l=u;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;n=r}s.nextZ=null,u*=2}while(o>1)}(i)}(e,u,c,A);for(var f,p,g=e;e.prev!==e.next;)if(f=e.prev,p=e.next,A?o(e,u,c,A):s(e))t.push(f.i/n|0),t.push(e.i/n|0),t.push(p.i/n|0),x(e),e=p.next,g=p.next;else if((e=p)===g){d?1===d?i(e=a(r(e),t,n),t,n,u,c,A,2):2===d&&l(e,t,n,u,c,A):i(r(e),t,n,u,c,A,1);break}}}function s(e){var t=e.prev,n=e,r=e.next;if(g(t,n,r)>=0)return!1;for(var i=t.x,s=n.x,o=r.x,a=t.y,l=n.y,u=r.y,c=i<s?i<o?i:o:s<o?s:o,A=a<l?a<u?a:u:l<u?l:u,h=i>s?i>o?i:o:s>o?s:o,d=a>l?a>u?a:u:l>u?l:u,p=r.next;p!==t;){if(p.x>=c&&p.x<=h&&p.y>=A&&p.y<=d&&f(i,a,s,l,o,u,p.x,p.y)&&g(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(e,t,n,r){var i=e.prev,s=e,o=e.next;if(g(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,u=o.x,c=i.y,A=s.y,d=o.y,p=a<l?a<u?a:u:l<u?l:u,m=c<A?c<d?c:d:A<d?A:d,y=a>l?a>u?a:u:l>u?l:u,v=c>A?c>d?c:d:A>d?A:d,_=h(p,m,t,n,r),b=h(y,v,t,n,r),w=e.prevZ,E=e.nextZ;w&&w.z>=_&&E&&E.z<=b;){if(w.x>=p&&w.x<=y&&w.y>=m&&w.y<=v&&w!==i&&w!==o&&f(a,c,l,A,u,d,w.x,w.y)&&g(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,E.x>=p&&E.x<=y&&E.y>=m&&E.y<=v&&E!==i&&E!==o&&f(a,c,l,A,u,d,E.x,E.y)&&g(E.prev,E,E.next)>=0)return!1;E=E.nextZ}for(;w&&w.z>=_;){if(w.x>=p&&w.x<=y&&w.y>=m&&w.y<=v&&w!==i&&w!==o&&f(a,c,l,A,u,d,w.x,w.y)&&g(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;E&&E.z<=b;){if(E.x>=p&&E.x<=y&&E.y>=m&&E.y<=v&&E!==i&&E!==o&&f(a,c,l,A,u,d,E.x,E.y)&&g(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function a(e,t,n){var i=e;do{var s=i.prev,o=i.next.next;!m(s,o)&&y(s,i,i.next,o)&&b(s,o)&&b(o,s)&&(t.push(s.i/n|0),t.push(i.i/n|0),t.push(o.i/n|0),x(i),x(i.next),i=e=o),i=i.next}while(i!==e);return r(i)}function l(e,t,n,s,o,a){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&p(l,u)){var c=w(l,u);return l=r(l,l.next),c=r(c,c.next),i(l,t,n,s,o,a,0),void i(c,t,n,s,o,a,0)}u=u.next}l=l.next}while(l!==e)}function u(e,t){return e.x-t.x}function c(e,t){var n=function(e,t){var n,r=t,i=e.x,s=e.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>o&&(o=a,n=r.x<r.next.x?r:r.next,a===i))return n}r=r.next}while(r!==t);if(!n)return null;var l,u=n,c=n.x,h=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&f(s<h?i:o,s,c,h,s<h?o:i,s,r.x,r.y)&&(l=Math.abs(s-r.y)/(i-r.x),b(r,e)&&(l<d||l===d&&(r.x>n.x||r.x===n.x&&A(n,r)))&&(n=r,d=l)),r=r.next}while(r!==u);return n}(e,t);if(!n)return t;var i=w(n,e);return r(i,i.next),r(n,n.next)}function A(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function h(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function f(e,t,n,r,i,s,o,a){return(i-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(r-a)>=(n-o)*(t-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function p(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&y(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(b(e,t)&&b(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||m(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function m(e,t){return e.x===t.x&&e.y===t.y}function y(e,t,n,r){var i=_(g(e,t,n)),s=_(g(e,t,r)),o=_(g(n,r,e)),a=_(g(n,r,t));return i!==s&&o!==a||(!(0!==i||!v(e,n,t))||(!(0!==s||!v(e,r,t))||(!(0!==o||!v(n,e,r))||!(0!==a||!v(n,t,r)))))}function v(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function _(e){return e>0?1:e<0?-1:0}function b(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function w(e,t){var n=new D(e.i,e.x,e.y),r=new D(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function E(e,t,n,r){var i=new D(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function x(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function D(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(e,t,n,r){for(var i=0,s=t,o=n-r;s<n;s+=r)i+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return i}e.exports=t,e.exports.default=t,t.deviation=function(e,t,n,r){var i=t&&t.length,s=i?t[0]*n:e.length,o=Math.abs(C(e,0,s,n));if(i)for(var a=0,l=t.length;a<l;a++){var u=t[a]*n,c=a<l-1?t[a+1]*n:e.length;o-=Math.abs(C(e,u,c,n))}var A=0;for(a=0;a<r.length;a+=3){var h=r[a]*n,d=r[a+1]*n,f=r[a+2]*n;A+=Math.abs((e[h]-e[f])*(e[d+1]-e[h+1])-(e[h]-e[d])*(e[f+1]-e[h+1]))}return 0===o&&0===A?0:Math.abs((A-o)/o)},t.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)for(var o=0;o<t;o++)n.vertices.push(e[i][s][o]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}var r=n(43),i=n(391);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function o(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}function a(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let c=1,A=1;class h{constructor(){a(this,"time",0),a(this,"channels",new Map),a(this,"animations",new Map),a(this,"playing",!1),a(this,"lastEngineTime",-1)}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:i=1}=e,s=c++,o={time:0,delay:t,duration:n,rate:r,repeat:i};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:e,channel:t}=r;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=A++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}const d={number:{type:"number",validate:(e,t)=>Number.isFinite(e)&&"object"===typeof t&&(void 0===t.max||e<=t.max)&&(void 0===t.min||e>=t.min)},array:{type:"array",validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function f(e){let t=p(e);if("object"!==t)return u(u({value:e},d[t]),{},{type:t});if("object"===typeof e)return e?void 0!==e.type?u(u(u({},e),d[e.type]),{},{type:e.type}):void 0===e.value?{type:"object",value:e}:(t=p(e.value),u(u(u({},e),d[t]),{},{type:t})):{type:"object",value:null};throw new Error("props")}function p(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}const g={vertex:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fragment:"#ifdef MODULE_MATERIAL\n  fragColor = material_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  fragColor = lighting_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_FOG\n  fragColor = fog_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  fragColor = picking_filterHighlightColor(fragColor);\n  fragColor = picking_filterPickingColor(fragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},m=/void\s+main\s*\([^)]*\)\s*\{\n?/,y=/}\n?[^{}]*$/,v=[],_="__LUMA_INJECT_DECLARATIONS__";function b(e){const t={vertex:{},fragment:{}};for(const n in e){let r=e[n];"string"===typeof r&&(r={order:0,injection:r}),t[w(n)][n]=r}return t}function w(e){const t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function E(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i="vertex"===t;for(const s in n){const t=n[s];t.sort((e,t)=>e.order-t.order),v.length=t.length;for(let e=0,n=t.length;e<n;++e)v[e]=t[e].injection;const r="".concat(v.join("\n"),"\n");switch(s){case"vs:#decl":i&&(e=e.replace(_,r));break;case"vs:#main-start":i&&(e=e.replace(m,e=>e+r));break;case"vs:#main-end":i&&(e=e.replace(y,e=>r+e));break;case"fs:#decl":i||(e=e.replace(_,r));break;case"fs:#main-start":i||(e=e.replace(m,e=>e+r));break;case"fs:#main-end":i||(e=e.replace(y,e=>r+e));break;default:e=e.replace(s,e=>e+r)}}return e=e.replace(_,""),r&&(e=e.replace(/\}\s*$/,e=>e+g[t])),e}function x(e){e.map(e=>D(e))}function D(e){if(e.instance)return;x(e.dependencies||[]);const{propTypes:t={},deprecations:n=[],inject:r={}}=e,i={normalizedInjections:b(r),parsedDeprecations:S(n)};t&&(i.propValidators=function(e){const t={};for(const[n,r]of Object.entries(e))t[n]=f(r);return t}(t)),e.instance=i;let s={};t&&(s=Object.entries(t).reduce((e,t)=>{let[n,r]=t;const i=null===r||void 0===r?void 0:r.value;return i&&(e[n]=i),e},{})),e.defaultUniforms=u(u({},e.defaultUniforms),s)}function C(e,t,n){var r;null===(r=e.deprecations)||void 0===r||r.forEach(e=>{var r;null!==(r=e.regex)&&void 0!==r&&r.test(t)&&(e.deprecated?n.deprecated(e.old,e.new)():n.removed(e.old,e.new)())})}function S(e){return e.forEach(e=>{if("function"===e.type)e.regex=new RegExp("\\b".concat(e.old,"\\("));else e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))}),e}function T(e){x(e);const t={},n={};I({modules:e,level:0,moduleMap:t,moduleDepth:n});const r=Object.keys(n).sort((e,t)=>n[t]-n[e]).map(e=>t[e]);return x(r),r}function I(e){const{modules:t,level:n,moduleMap:r,moduleDepth:i}=e;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of t)r[s.name]=s,(void 0===i[s.name]||i[s.name]<n)&&(i[s.name]=n);for(const s of t)s.dependencies&&I({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}const F=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],R=[...F,[M("attribute"),"in $1"],[M("varying"),"out $1"]],k=[...F,[M("varying"),"in $1"]];function P(e,t){for(const[n,r]of t)e=e.replace(n,r);return e}function M(e){return new RegExp("\\b".concat(e,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}function B(e,t){let n="";for(const r in e){const i=e[r];if(n+="void ".concat(i.signature," {\n"),i.header&&(n+="  ".concat(i.header)),t[r]){const e=t[r];e.sort((e,t)=>e.order-t.order);for(const t of e)n+="  ".concat(t.injection,"\n")}i.footer&&(n+="  ".concat(i.footer)),n+="}\n"}return n}function L(e){const t={vertex:{},fragment:{}};for(const n of e){let e,r;"string"!==typeof n?(e=n,r=e.hook):(e={},r=n),r=r.trim();const[i,s]=r.split(":"),o=r.replace(/\(.+/,""),a=Object.assign(e,{signature:s});switch(i){case"vs":t.vertex[o]=a;break;case"fs":t.fragment[o]=a;break;default:throw new Error(i)}}return t}function O(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}function N(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return n?n[1]:t}function U(e){let t=100;const n=e.match(/[^\s]+/g);if(n&&n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}if(100!==t&&300!==t)throw new Error("Invalid GLSL version ".concat(t));return t}const z="\n\n".concat(_,"\n");function j(e,t){const{source:n,stage:r,modules:i,hookFunctions:s=[],inject:o={},log:a}=t;O("string"===typeof n,"shader source must be a string");const l=n;let u="";const c=L(s),A={},h={},d={};for(const g in o){const e="string"===typeof o[g]?{injection:o[g],order:0}:o[g],t=/^(v|f)s:(#)?([\w-]+)$/.exec(g);if(t){const n=t[2],r=t[3];n?"decl"===r?h[g]=[e]:d[g]=[e]:A[g]=[e]}else d[g]=[e]}const f=i;for(const g of f){var p;a&&C(g,l,a);u+=W(g,"wgsl");const e=(null===(p=g.injections)||void 0===p?void 0:p[r])||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?h:d;r[t]=r[t]||[],r[t].push(e[t])}else A[t]=A[t]||[],A[t].push(e[t])}}return u+=z,u=E(u,r,h),u+=B(c[r],A),u+=l,u=E(u,r,d),u}function V(e,t){const{id:n,source:r,stage:i,language:s="glsl",modules:o,defines:a={},hookFunctions:l=[],inject:u={},prologue:c=!0,log:A}=t;O("string"===typeof r,"shader source must be a string");const h="glsl"===s?function(e,t){return{name:N(e,t),language:"glsl",version:U(e)}}(r).version:-1,d=e.shaderLanguageVersion,f=100===h?"#version 100":"#version 300 es",p=r.split("\n").slice(1).join("\n"),g={};o.forEach(e=>{Object.assign(g,e.defines)}),Object.assign(g,a);let m="";switch(s){case"wgsl":break;case"glsl":m=c?"".concat(f,"\n\n// ----- PROLOGUE -------------------------\n").concat(function(e){const{id:t,source:n,stage:r}=e,i=t&&-1===n.indexOf("SHADER_NAME");return i?"\n#define SHADER_NAME ".concat(t,"_").concat(r):""}({id:n,source:r,stage:i}),"\n","#define SHADER_TYPE_".concat(i.toUpperCase()),"\n\n").concat(function(e){switch(null===e||void 0===e?void 0:e.gpu.toLowerCase()){case"apple":return"#define APPLE_GPU\n// Apple optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Headless Chrome's software shader 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// If the GPU doesn't have full 32 bits precision, will causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e),"\n").concat("fragment"===i?"precision highp float;\n":"","\n\n// ----- APPLICATION DEFINES -------------------------\n\n").concat(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";for(const n in e){const r=e[n];(r||Number.isFinite(r))&&(t+="#define ".concat(n.toUpperCase()," ").concat(e[n],"\n"))}return t}(g),"\n\n"):"".concat(f,"\n")}const y=L(l),v={},_={},b={};for(const E in u){const e="string"===typeof u[E]?{injection:u[E],order:0}:u[E],t=/^(v|f)s:(#)?([\w-]+)$/.exec(E);if(t){const n=t[2],r=t[3];n?"decl"===r?_[E]=[e]:b[E]=[e]:v[E]=[e]}else b[E]=[e]}for(const E of o){var w;A&&C(E,p,A);m+=W(E,i);const e=(null===(w=E.instance)||void 0===w?void 0:w.normalizedInjections[i])||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?_:b;r[t]=r[t]||[],r[t].push(e[t])}else v[t]=v[t]||[],v[t].push(e[t])}}return m+="// ----- MAIN SHADER SOURCE -------------------------",m+=z,m=E(m,i,_),m+=B(y[i],v),m+=p,m=E(m,i,b),"glsl"===s&&h!==d&&(m=function(e,t){var n;if(300!==Number((null===(n=e.match(/^#version[ \t]+(\d+)/m))||void 0===n?void 0:n[1])||100))throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return P(e,R);case"fragment":return P(e,k);default:throw new Error(t)}}(m,i)),m.trim()}function G(e){return function(t){const n={};for(const i of e){var r;const e=null===(r=i.getUniforms)||void 0===r?void 0:r.call(i,t,n);Object.assign(n,e)}return n}}function W(e,t){let n;switch(t){case"vertex":n=e.vs||"";break;case"fragment":n=e.fs||"";break;case"wgsl":n=e.source||"";break;default:O(!1)}if(!e.name)throw new Error("Shader module must have a name");const r=e.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i="// ----- MODULE ".concat(e.name," ---------------\n\n");return"wgsl"!==t&&(i+="#define MODULE_".concat(r,"\n")),i+="".concat(n,"\n"),i}const H=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,Q=/^\s*\#\s*endif\s*$/;class X{constructor(){a(this,"_hookFunctions",[]),a(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return X.defaultShaderAssembler=X.defaultShaderAssembler||new X,X.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===("string"===typeof e?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t="string"===typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(e=>e.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,{source:r,getUniforms:i}=function(e){const t=T(e.modules||[]);return{source:j(e.platformInfo,u(u({},e),{},{source:e.source,stage:"vertex",modules:t})),getUniforms:G(t)}}(u(u({},e),{},{source:e.source,modules:t,hookFunctions:n})),s="wgsl"===e.platformInfo.shaderLanguage?function(e,t){const n=e.split("\n"),r=[];let i=!0,s=null;for(const a of n){const e=a.match(H),n=a.match(Q);var o;e?(s=e[1],i=Boolean(null===t||void 0===t||null===(o=t.defines)||void 0===o?void 0:o[s])):n?i=!0:i&&r.push(a)}return r.join("\n")}(r):r;return{source:s,getUniforms:i,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,r=function(e){const{vs:t,fs:n}=e,r=T(e.modules||[]);return{vs:V(e.platformInfo,u(u({},e),{},{source:t,stage:"vertex",modules:r})),fs:V(e.platformInfo,u(u({},e),{},{source:n,stage:"fragment",modules:r})),getUniforms:G(r)}}(u(u({},e),{},{vs:e.vs,fs:e.fs,modules:t,hookFunctions:n}));return u(u({},r),{},{modules:t})}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),n={};let r=0;for(let i=0,s=this._defaultModules.length;i<s;++i){const e=this._defaultModules[i],s=e.name;t[r++]=e,n[s]=!0}for(let i=0,s=e.length;i<s;++i){const s=e[i],o=s.name;n[o]||(t[r++]=s,n[o]=!0)}return t.length=r,x(t),t}}a(X,"defaultShaderAssembler",void 0);const Y="#define SMOOTH_EDGE_RADIUS 0.5",q={name:"geometry",source:"const SMOOTH_EDGE_RADIUS: f32 = 0.5;\n\nstruct VertexGeometry {\n  position: vec4<f32>,\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  normal: vec3<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\nvar<private> geometry_: VertexGeometry = VertexGeometry(\n  vec4<f32>(0.0, 0.0, 1.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec2<f32>(0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0)\n);\n\nstruct FragmentGeometry {\n  uv: vec2<f32>,\n};\n\nvar<private> fragmentGeometry: FragmentGeometry;\n\nfn smoothedge(edge: f32, x: f32) -> f32 {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n",vs:"".concat(Y,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"".concat(Y,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},K=[q],Z=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],J=[];function $(e){const t=X.getDefaultShaderAssembler();for(const r of K)t.addDefaultModule(r);const n="glsl"===e?Z:J;for(const r of n)t.addShaderHook(r);return t}const ee="uniform layerUniforms {\n  uniform float opacity;\n} layer;\n",te={name:"layer",vs:ee,fs:ee,getUniforms:e=>({opacity:Math.pow(e.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},ne="Awaiting state",re="Matched. State transferred from previous layer",ie="Initialized",se="Discarded. Awaiting garbage collection",oe="No longer matched. Awaiting garbage collection",ae="Finalized! Awaiting garbage collection",le=Symbol.for("component"),ue=Symbol.for("propTypes"),ce=Symbol.for("deprecatedProps"),Ae=Symbol.for("asyncPropDefaults"),he=Symbol.for("asyncPropOriginal"),de=Symbol.for("asyncPropResolved");function fe(e){var t,n;if("undefined"!==typeof window&&"renderer"===(null===(t=window.process)||void 0===t?void 0:t.type))return!0;if("undefined"!==typeof process&&Boolean(null===(n=process.versions)||void 0===n?void 0:n.electron))return!0;const r="undefined"!==typeof navigator&&navigator.userAgent,i=e||r;return Boolean(i&&i.indexOf("Electron")>=0)}function pe(){var e;return!("object"===typeof process&&"[object process]"===String(process)&&!(null!==(e=process)&&void 0!==e&&e.browser))||fe()}const ge="4.1.0";class me{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(kA){return null}}(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}var ye;!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(ye||(ye={}));function ve(e){return"string"!==typeof e?e:(e=e.toUpperCase(),ye[e]||ye.WHITE)}function _e(e,t){if(!e)throw new Error(t||"Assertion failed")}const be=globalThis,we=(globalThis.document,globalThis.process||{}),Ee=(globalThis.console,globalThis.navigator||{});function xe(){let e;var t,n;if(pe()&&be.performance)e=null===be||void 0===be||null===(t=be.performance)||void 0===t||null===(n=t.now)||void 0===n?void 0:n.call(t);else if("hrtime"in we){var r;const t=null===we||void 0===we||null===(r=we.hrtime)||void 0===r?void 0:r.call(we);e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}const De={debug:pe()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Ce={enabled:!0,level:0};function Se(){}const Te={},Ie={once:!0};class Fe{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};this.VERSION=ge,this._startTs=xe(),this._deltaTs=xe(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new me("__probe-".concat(this.id,"__"),Ce),this.timeStamp("".concat(this.id," started")),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n),i=e;for(const s of r){const n=i[s];"function"===typeof n&&(t.find(e=>s===e)||(i[s]=n.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((xe()-this._startTs).toPrecision(10))}getDelta(){return Number((xe()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,De.warn,arguments,Ie)}error(e){return this._getLogFunction(0,e,De.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,De.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,De.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,De.debug||De.info,arguments,Ie)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||Se,n&&[n],{tag:Pe(t)}):Se}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Se)}group(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const r=ke({logLevel:e,message:t,opts:n}),{collapsed:i}=n;return r.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Se)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Re(e)}_getLogFunction(e,t,n,r,i){if(this._shouldLog(e)){i=ke({logLevel:e,message:t,args:r,opts:i}),_e(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=xe();const s=i.tag||i.message;if(i.once&&s){if(Te[s])return Se;Te[s]=xe()}return t=function(e,t,n){if("string"===typeof t){const r=n.time?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}(function(e){let t;return t=e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s"),t}(n.total)):"";t=function(e,t,n){if(!pe&&"string"===typeof e){if(t){const n=ve(t);e="\x1b[".concat(n,"m").concat(e,"\x1b[39m")}if(n){const t=ve(n);e="\x1b[".concat(t+10,"m").concat(e,"\x1b[49m")}}return e}(t=n.time?"".concat(e,": ").concat(r,"  ").concat(t):"".concat(e,": ").concat(t),n.color,n.background)}return t}(this.id,i.message,i),n.bind(console,t,...i.args)}return Se}}function Re(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return _e(Number.isFinite(t)&&t>=0),t}function ke(e){const{logLevel:t,message:n}=e;e.logLevel=Re(t);const r=e.args?Array.from(e.args):[];for(;r.length&&r.shift()!==n;);switch(typeof t){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"===typeof e.message&&(e.message=e.message());const i=typeof e.message;return _e("string"===i||"object"===i),Object.assign(e,{args:r},e.opts)}function Pe(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}Fe.VERSION=ge;const Me=new Fe({id:"deck"});let Be={};function Le(e){Be=e}function Oe(e,t,n,r){Me.level>0&&Be[e]&&Be[e].call(null,t,n,r)}function Ne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return Array.isArray(e)?Ue(e,t,[]):t(e)?[e]:[]}function Ue(e,t,n){let r=-1;for(;++r<e.length;){const i=e[r];Array.isArray(i)?Ue(i,t,n):t(i)&&n.push(i)}return n}function ze(e){let{target:t,source:n,start:r=0,count:i=1}=e;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)t[l++]=n[a];for(;a<o;)a<o-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+o-a),a=o);return t}function je(){let e;if("undefined"!==typeof window&&window.performance)e=window.performance.now();else if("undefined"!==typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class Ve{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=je(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(je()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Ge{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(e=>this._getOrCreate(e))}_getOrCreate(e){const{name:t,type:n}=e;let r=this.stats[t];return r||(r=e instanceof Ve?e:new Ve(t,n),this.stats[t]=r),r}}const We=e=>"boolean"===typeof e,He=e=>"function"===typeof e,Qe=e=>null!==e&&"object"===typeof e,Xe=e=>Qe(e)&&e.constructor==={}.constructor,Ye=e=>"undefined"!==typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,qe=e=>"undefined"!==typeof Blob&&e instanceof Blob,Ke=e=>(e=>"undefined"!==typeof ReadableStream&&e instanceof ReadableStream||Qe(e)&&He(e.tee)&&He(e.cancel)&&He(e.getReader))(e)||(e=>Qe(e)&&He(e.read)&&He(e.pipe)&&We(e.readable))(e);function Ze(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function Je(e){var t;if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions)}function $e(e){var t,n;let r;return Ze(e,"null loader"),Ze(Je(e),"invalid loader"),Array.isArray(e)&&(r=e[1],e=u(u({},e=e[0]),{},{options:u(u({},e.options),r)})),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(n=e)&&void 0!==n&&n.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}let et="";const tt={};class nt extends Error{constructor(e,t){super(e),a(this,"reason",void 0),a(this,"url",void 0),a(this,"response",void 0),this.reason=t.reason,this.url=t.url,this.response=t.response}}const rt=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,it=/^([-\w.]+\/[-\w.+]+)/;function st(e,t){return e.toLowerCase()===t.toLowerCase()}function ot(e){const t=rt.exec(e);return t?t[1]:""}const at=/\?.*/;function lt(e){return e.replace(at,"")}function ut(e){if(Ye(e)){return e.url}if(qe(e)){return e.name||""}return"string"===typeof e?e:""}function ct(e){if(Ye(e)){const t=e,n=t.headers.get("content-type")||"",r=lt(t.url);return function(e){const t=it.exec(e);return t?t[1]:e}(n)||ot(r)}if(qe(e)){return e.type||""}return"string"===typeof e?ot(e):""}async function At(e){if(Ye(e))return e;const t={},n=function(e){if(Ye(e))return e.headers["content-length"]||-1;if(qe(e))return e.size;return"string"===typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);n>=0&&(t["content-length"]=String(n));const r=ut(e),i=ct(e);i&&(t["content-type"]=i);const s=await async function(e){const t=5;if("string"===typeof e)return"data:,".concat(e.slice(0,t));if(e instanceof Blob){const t=e.slice(0,5);return await new Promise(e=>{const n=new FileReader;n.onload=t=>{var n;return e(null===t||void 0===t||null===(n=t.target)||void 0===n?void 0:n.result)},n.readAsDataURL(t)})}if(e instanceof ArrayBuffer){const n=function(e){let t="";const n=new Uint8Array(e);for(let r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}(e.slice(0,t));return"data:base64,".concat(n)}return null}(e);s&&(t["x-first-bytes"]=s),"string"===typeof e&&(e=(new TextEncoder).encode(e));const o=new Response(e,{headers:t});return Object.defineProperty(o,"url",{value:r}),o}async function ht(e){if(!e.ok){const t=await async function(e){const n=function(e){if(e.length<50)return e;const t=e.slice(e.length-15),n=e.substr(0,32);return"".concat(n,"...").concat(t)}(e.url);let r="Failed to fetch resource (".concat(e.status,") ").concat(e.statusText,": ").concat(n);r=r.length>100?"".concat(r.slice(0,100),"..."):r;const i={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");i.reason=!e.bodyUsed&&null!==t&&void 0!==t&&t.includes("application/json")?await e.json():await e.text()}catch(t){}return new nt(r,i)}(e);throw t}}async function dt(e,t){if("string"===typeof e){const i=function(e){for(const t in tt)if(e.startsWith(t)){const n=tt[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e="".concat(et).concat(e)),e}(e);var n,r;if(function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(i))if(null!==(n=globalThis.loaders)&&void 0!==n&&n.fetchNode)return null===(r=globalThis.loaders)||void 0===r?void 0:r.fetchNode(i,t);return await fetch(i,t)}return await At(e)}const ft=new Fe({id:"loaders.gl"});class pt{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof global&&global,"undefined"!==typeof document&&document;const gt=Boolean("object"!==typeof process||"[object process]"!==String(process)||process.browser),mt="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version),yt=(mt&&parseFloat(mt[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){a(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.error.bind(this.console,...t)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:gt,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),vt={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function _t(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function bt(){const e=_t();return e.globalOptions=e.globalOptions||u({},yt),e.globalOptions}function wt(e,t,n,r){return n=n||[],function(e,t){Et(e,null,yt,vt,t);for(const n of t){const r=e&&e[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Et(r,n.id,i,s,t)}}(e,n=Array.isArray(n)?n:[n]),Dt(t,e,r)}function Et(e,t,n,r,i){const s=t||"Top level",o=t?"".concat(t,"."):"";for(const a in e){const l=!t&&Qe(e[a]);if(!(a in n)&&!("baseUri"===a&&!t)&&!("workerUrl"===a&&t))if(a in r)ft.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const e=xt(a,i);ft.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(e))()}}}function xt(e,t){const n=e.toLowerCase();let r="";for(const i of t)for(const t in i.options){if(e===t)return"Did you mean '".concat(i.id,".").concat(t,"'?");const s=t.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(t,"'?"))}return r}function Dt(e,t,n){const r=u({},e.options||{});return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(r,n),null===r.log&&(r.log=new pt),Ct(r,bt()),Ct(r,t),r}function Ct(e,t){for(const n in t)if(n in t){const r=t[n];Xe(r)&&Xe(e[n])?e[n]=u(u({},e[n]),t[n]):e[n]=t[n]}}function St(e,t){const n=bt(),r=e||n;return"function"===typeof r.fetch?r.fetch:Qe(r.fetch)?e=>dt(e,r.fetch):null!==t&&void 0!==t&&t.fetch?null===t||void 0===t?void 0:t.fetch:dt}function Tt(e,t){return It(e||{},t)}function It(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n>3)return t;const r=u({},e);for(const[i,s]of Object.entries(t))s&&"object"===typeof s&&!Array.isArray(s)?r[i]=It(r[i]||{},t[i],n+1):r[i]=t[i];return r}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof global&&global,"undefined"!==typeof document&&document;const Ft="object"!==typeof process||"[object process]"!==String(process)||process.browser,Rt="undefined"!==typeof window&&"undefined"!==typeof window.orientation,kt="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version);kt&&parseFloat(kt[1]);class Pt{terminate(){}}function Mt(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const Bt=new Map;function Lt(e){Mt(e.source&&!e.url||!e.source&&e.url);let t=Bt.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return Ot((t=e,"try {\n  importScripts('".concat(t,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var t}(e.url),Bt.set(e.url,t)),e.source&&(t=Ot(e.source),Bt.set(e.source,t))),Mt(t),t}function Ot(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function Nt(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(e){if(Ut(e))r.add(e);else if(Ut(e.buffer))r.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"===typeof e)for(const i in e)Nt(e[i],t,r)}else;return void 0===n?Array.from(r):[]}function Ut(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&e instanceof MessagePort||("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}const zt=()=>{};class jt{static isSupported(){return"undefined"!==typeof Worker&&Ft||"undefined"!==typeof Pt&&!Ft}constructor(e){a(this,"name",void 0),a(this,"source",void 0),a(this,"url",void 0),a(this,"terminated",!1),a(this,"worker",void 0),a(this,"onMessage",void 0),a(this,"onError",void 0),a(this,"_loadableURL","");const{name:t,source:n,url:r}=e;Mt(n||r),this.name=t,this.source=n,this.url=r,this.onMessage=zt,this.onError=e=>console.log(e),this.worker=Ft?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=zt,this.onError=zt,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||Nt(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=Lt({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Pt(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new Pt(this.source,{eval:!0})}return e.on("message",e=>{this.onMessage(e)}),e.on("error",e=>{this.onError(e)}),e.on("exit",e=>{}),e}}class Vt{constructor(e,t){a(this,"name",void 0),a(this,"workerThread",void 0),a(this,"isRunning",!0),a(this,"result",void 0),a(this,"_resolve",()=>{}),a(this,"_reject",()=>{}),this.name=e,this.workerThread=t,this.result=new Promise((e,t)=>{this._resolve=e,this._reject=t})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Mt(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Mt(this.isRunning),this.isRunning=!1,this._reject(e)}}class Gt{static isSupported(){return jt.isSupported()}constructor(e){a(this,"name","unnamed"),a(this,"source",void 0),a(this,"url",void 0),a(this,"maxConcurrency",1),a(this,"maxMobileConcurrency",1),a(this,"onDebug",()=>{}),a(this,"reuseWorkers",!0),a(this,"props",{}),a(this,"jobQueue",[]),a(this,"idleQueue",[]),a(this,"count",0),a(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=u(u({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,n)=>e.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const r=new Promise(r=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:r}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new Vt(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}catch(n){console.error("Worker exception: ".concat(n))}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Ft||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new jt({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Rt?this.maxMobileConcurrency:this.maxConcurrency}}const Wt={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Ht{static isSupported(){return jt.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ht._workerFarm=Ht._workerFarm||new Ht({}),Ht._workerFarm.setProps(e),Ht._workerFarm}constructor(e){a(this,"props",void 0),a(this,"workerPools",new Map),this.props=u({},Wt),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props=u(u({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:r}=e;let i=this.workerPools.get(t);return i||(i=new Gt({name:t,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}a(Ht,"_workerFarm",void 0);const Qt=function(){var e;return null!==(e=globalThis._loadersgl_)&&void 0!==e&&e.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}();async function Xt(e,t,n,r,i){const s=e.id,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t[e.id]||{},r="".concat(e.id,Ft?"-worker.js":"-worker-node.js");let i=n.workerUrl;if(i||"compression"!==e.id||(i=t.workerUrl),"test"===t._workerType&&(i=Ft?"modules/".concat(e.module,"/dist/").concat(r):"modules/".concat(e.module,"/src/workers/").concat(e.id,"-worker-node.ts")),!i){let t=e.version;"latest"===t&&(t="latest");const n=t?"@".concat(t):"";i="https://unpkg.com/@loaders.gl/".concat(e.module).concat(n,"/dist/").concat(r)}return Mt(i),i}(e,n),a=Ht.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const l=await a.startJob("process-on-worker",Yt.bind(null,i));l.postMessage("process",{input:t,options:n,context:r});const u=await l.result;return await u.result}async function Yt(e,t,n,r){switch(n){case"done":t.done(r);break;case"error":t.error(new Error(r.error));break;case"process":const{id:s,input:o,options:a}=r;try{const n=await e(o,a);t.postMessage("done",{id:s,result:n})}catch(i){const e=i instanceof Error?i.message:"unknown error";t.postMessage("error",{id:s,error:e})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function qt(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new Kt(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function Kt(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Kt=function(e){this.s=e,this.n=e.next},Kt.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new Kt(e)}function Zt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){const t=e.map(e=>e instanceof ArrayBuffer?new Uint8Array(e):e),n=t.reduce((e,t)=>e+t.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of t)r.set(s,i),i+=s.byteLength;return r.buffer}(t)}const Jt=262144;function $t(e,t){this.v=e,this.k=t}function en(e){return new $t(e,0)}function tn(e){return function(){return new nn(e.apply(this,arguments))}}function nn(e){var t,n;function r(t,n){try{var s=e[t](n),o=s.value,a=o instanceof $t;Promise.resolve(a?o.v:o).then(function(n){if(a){var l="return"===t?"return":"next";if(!o.k||n.done)return r(l,n);n=e[l](n).value}i(s.done?"return":"normal",n)},function(e){r("throw",e)})}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise(function(s,o){var a={key:e,arg:i,resolve:s,reject:o,next:null};n?n=n.next=a:(t=n=a,r(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}nn.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},nn.prototype.next=function(e){return this._invoke("next",e)},nn.prototype.throw=function(e){return this._invoke("throw",e)},nn.prototype.return=function(e){return this._invoke("return",e)};function rn(){return rn=tn(function*(e,t){const n=(null===t||void 0===t?void 0:t.chunkSize)||1048576;let r=0;for(;r<e.size;){const t=r+n,i=yield en(e.slice(r,t).arrayBuffer());r=t,yield i}}),rn.apply(this,arguments)}function sn(e){if(function(e){return e&&"object"===typeof e&&e.isBuffer}(e))return e;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"===typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"===typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function on(e,t){return gt?function(e,t){return an.apply(this,arguments)}(e,t):function(e,t){return ln.apply(this,arguments)}(e,t)}function an(){return an=tn(function*(e,t){const n=e.getReader();let r;try{for(;;){const e=r||n.read();null!==t&&void 0!==t&&t._streamReadAhead&&(r=n.read());const{done:i,value:s}=yield en(e);if(i)return;yield sn(s)}}catch(i){n.releaseLock()}}),an.apply(this,arguments)}function ln(){return(ln=tn(function*(e,t){var n,r=!1,i=!1;try{for(var s,o=qt(e);r=!(s=yield en(o.next())).done;r=!1){const e=s.value;yield sn(e)}}catch(a){i=!0,n=a}finally{try{r&&null!=o.return&&(yield en(o.return()))}finally{if(i)throw n}}})).apply(this,arguments)}function un(e,t){if("string"===typeof e)return function*(e,t){const n=(null===t||void 0===t?void 0:t.chunkSize)||262144;let r=0;const i=new TextEncoder;for(;r<e.length;){const t=Math.min(e.length-r,n),s=e.slice(r,r+t);r+=t,yield i.encode(s)}}(e,t);if(e instanceof ArrayBuffer)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:n=Jt}=t;let r=0;for(;r<e.byteLength;){const t=Math.min(e.byteLength-r,n),i=new ArrayBuffer(t),s=new Uint8Array(e,r,t);new Uint8Array(i).set(s),r+=t,yield i}}()}(e,t);if(qe(e))return function(e,t){return rn.apply(this,arguments)}(e,t);if(Ke(e))return on(e,t);if(Ye(e)){return on(e.body,t)}throw new Error("makeIterator")}const cn="Cannot convert supplied data type";async function An(e,t,n){const r=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"===typeof e||r)return function(e,t){if(t.text&&"string"===typeof e)return e;if((e=>e&&"object"===typeof e&&e.isBuffer)(e)&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const r=e.byteLength||e.length;return 0===e.byteOffset&&r===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+r)),n}throw new Error(cn)}(e,t);if(qe(e)&&(e=await At(e)),Ye(e)){const n=e;return await ht(n),t.binary?await n.arrayBuffer():await n.text()}if(Ke(e)&&(e=un(e,n)),(e=>Boolean(e)&&"function"===typeof e[Symbol.iterator])(e)||(e=>e&&"function"===typeof e[Symbol.asyncIterator])(e))return async function(e){const t=[];var n,r=!1,i=!1;try{for(var s,o=qt(e);r=!(s=await o.next()).done;r=!1){const e=s.value;t.push(e)}}catch(a){i=!0,n=a}finally{try{r&&null!=o.return&&await o.return()}finally{if(i)throw n}}return Zt(...t)}(e);throw new Error(cn)}function hn(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function dn(e,t,n){if(n)return n;const r=u({fetch:St(t,e)},e);if(r.url){const e=lt(r.url);r.baseUrl=e,r.queryString=function(e){const t=e.match(at);return t&&t[0]}(r.url),r.filename=hn(e),r.baseUrl=function(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}(e)}return Array.isArray(r.loaders)||(r.loaders=null),r}const fn="4.3.3",pn=fn[0]>="0"&&fn[0]<="9"?"v".concat(fn):"";const gn=function(){const e=new Fe({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=e,globalThis.loaders.version=pn,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=e,e}(),mn=()=>{const e=_t();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};const yn=/\.([^.]+)$/;function vn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!_n(e))return null;if(t&&!Array.isArray(t))return $e(t);let i=[];t&&(i=i.concat(t)),null!==n&&void 0!==n&&n.ignoreRegisteredLoaders||i.push(...mn()),function(e){for(const t of e)$e(t)}(i);const s=function(e,t,n,r){const i=ut(e),s=ct(e),o=lt(i)||(null===r||void 0===r?void 0:r.url);let a=null,l="";null!==n&&void 0!==n&&n.mimeType&&(a=wn(t,null===n||void 0===n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null===n||void 0===n?void 0:n.mimeType));a=a||function(e,t){const n=t&&yn.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,r):null}(t,o),l=l||(a?"matched url ".concat(o):""),a=a||wn(t,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||function(e,t){if(!t)return null;for(const n of e)if("string"===typeof t){if(En(t,n))return n}else if(ArrayBuffer.isView(t)){if(xn(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer){if(xn(t,0,n))return n}return null}(t,e),l=l||(a?"matched initial data ".concat(Dn(e)):""),null!==n&&void 0!==n&&n.fallbackMimeType&&(a=a||wn(t,null===n||void 0===n?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""));var u;l&&gn.log(1,"selectLoader selected ".concat(null===(u=a)||void 0===u?void 0:u.name,": ").concat(l,"."));return a}(e,i,n,r);if(!s&&(null===n||void 0===n||!n.nothrow))throw new Error(bn(e));return s}function _n(e){return!(e instanceof Response&&204===e.status)}function bn(e){const t=ut(e),n=ct(e);let r="No valid loader found (";r+=t?"".concat(hn(t),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=e?Dn(e):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function wn(e,t){for(const r of e){var n;if(null!==(n=r.mimeTypes)&&void 0!==n&&n.some(e=>st(t,e)))return r;if(st(t,"application/x.".concat(r.id)))return r}return null}function En(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some(t=>e.startsWith(t))}function xn(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(n=>function(e,t,n,r){if(r instanceof ArrayBuffer)return function(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(r,e,r.byteLength);switch(typeof r){case"function":return r(e);case"string":return r===Cn(e,t,r.length);default:return!1}}(e,t,0,n))}function Dn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"===typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return Cn(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return Cn(e,0,t)}return""}function Cn(e,t,n){if(e.byteLength<t+n)return"";const r=new DataView(e);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(t+s));return i}async function Sn(e,t,n,r){!t||Array.isArray(t)||Je(t)||(r=void 0,n=t,t=void 0),n=n||{};const i=ut(e=await e),s=function(e,t){if(e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:void 0}(t,r),o=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!_n(e))return null;let i=vn(e,t,u(u({},n),{},{nothrow:!0}),r);if(i)return i;if(qe(e)&&(i=vn(e=await e.slice(0,10).arrayBuffer(),t,n,r)),!i&&(null===n||void 0===n||!n.nothrow))throw new Error(bn(e));return i}(e,s,n);return o?(r=dn({url:i,_parse:Sn,loaders:s},n=wt(n,o,s,i),r||null),await async function(e,t,n,r){if(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qt;Mt(e,"no worker provided");const n=e.version}(e),n=Tt(e.options,n),Ye(t)){const e=t,{ok:n,redirected:i,status:s,statusText:o,type:a,url:l}=e,u=Object.fromEntries(e.headers.entries());r.response={headers:u,ok:n,redirected:i,status:s,statusText:o,type:a,url:l}}t=await An(t,e,n);const i=e;if(i.parseTextSync&&"string"===typeof t)return i.parseTextSync(t,n,r);if(function(e,t){return!!Ht.isSupported()&&!!(Ft||null!==t&&void 0!==t&&t._nodeWorkers)&&e.worker&&(null===t||void 0===t?void 0:t.worker)}(e,n))return await Xt(e,t,n,r,Sn);if(i.parseText&&"string"===typeof t)return await i.parseText(t,n,r);if(i.parse)return await i.parse(t,n,r);throw Mt(!i.parseSync),new Error("".concat(e.id," loader - no parser found and worker is disabled"))}(o,e,n,r)):null}async function Tn(e,t,n,r){let i,s;Array.isArray(t)||Je(t)?(i=t,s=n):(i=[],s=t);const o=St(s);let a=e;return"string"===typeof e&&(a=await o(e)),qe(e)&&(a=await o(e)),Array.isArray(i),await Sn(a,i,s)}class In{constructor(e,t,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let r=e;"string"===typeof e&&(r=Tn(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=e)}).catch(e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=e||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const i of this._subscribers)i.onChange(this.getData())}}class Fn{constructor(e){var t;this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:null===(t=e.device)||void 0===t?void 0:t.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add(e){let{resourceId:t,data:n,forceUpdate:r=!1,persistent:i=!0}=e,s=this._resources[t];s?s.setData(n,r):(s=new In(t,n,this._context),this._resources[t]=s),s.persistent=i}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe(e){let{consumerId:t}=e;const n=this._consumers[t];if(n){for(const e in n){const t=n[e],r=this._resources[t.resourceId];r&&r.unsubscribe(t)}delete this._consumers[t],this.prune()}}subscribe(e){let{resourceId:t,onChange:n,consumerId:r,requestId:i="default"}=e;const{_resources:s,protocol:o}=this;t.startsWith(o)&&(t=t.replace(o,""),s[t]||this.add({resourceId:t,data:null,persistent:!1}));const a=s[t];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,r){const i=this._consumers,s=i[e]=i[e]||{};let o=s[t];const a=o&&o.resourceId&&this._resources[o.resourceId];a&&(a.unsubscribe(o),this.prune()),n&&(o?(o.onChange=r,o.resourceId=n.id):o={onChange:r,resourceId:n.id},s[t]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];t.persistent||t.inUse()||(t.delete(),delete this._resources[e])}}}const Rn=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,n){let{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}=n;const u=i||e&&e.constructor||Float32Array,c=t*r+s;if(ArrayBuffer.isView(e)){if(c<=e.length)return e;if(c*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new u(e.buffer,0,c)}let A=1/0;l&&(A=l*r+s);const h=this._allocate(u,c,a,A);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,t,n,r){let i=Math.max(Math.ceil(t*this.opts.overAlloc),1);i>r&&(i=r);const s=this._pool,o=e.BYTES_PER_ELEMENT*i,a=s.findIndex(e=>e.byteLength>=o);if(a>=0){const t=new e(s.splice(a,1)[0],0,i);return n&&t.fill(0),t}return new e(i)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:r}=n,i=t.findIndex(e=>e.byteLength>=r);i<0?t.push(n):(i>0||t.length<this.opts.poolSize)&&t.splice(i,0,n),t.length>this.opts.poolSize&&t.shift()}};Math.PI,Math.PI;globalThis.mathgl=globalThis.mathgl||{config:u({},{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1})};const kn=globalThis.mathgl.config;function Pn(e){let{precision:t=kn.precision}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=function(e){return Math.round(e/kn.EPSILON)*kn.EPSILON}(e),"".concat(parseFloat(e.toPrecision(t)))}function Mn(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Bn(e,t,n){return Nn(e,e=>Math.max(t,Math.min(n,e)))}function Ln(e,t,n){return Mn(e)?e.map((e,r)=>Ln(e,t[r],n)):n*t+(1-n)*e}function On(e,t,n){const r=kn.EPSILON;n&&(kn.EPSILON=n);try{if(e===t)return!0;if(Mn(e)&&Mn(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!On(e[n],t[n]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"===typeof e&&"number"===typeof t&&Math.abs(e-t)<=kn.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{kn.EPSILON=r}}function Nn(e,t,n){if(Mn(e)){const r=e;n=n||function(e){return e.clone?e.clone():new Array(e.length)}(r);for(let i=0;i<n.length&&i<r.length;++i){const r="number"===typeof e?e:e[i];n[i]=t(r,i,n)}return n}return t(e)}class Un extends Array{clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Mn(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(kn)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+Pn(this[n],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!On(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(void 0===n)return this.lerp(this,e,t);for(let r=0;r<this.ELEMENTS;++r){const i=e[r],s="number"===typeof t?t:t[r];this[r]=i+n*(s-i)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]+=r[e];return this.check()}subtract(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]-=r[e];return this.check()}scale(e){if("number"===typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(kn.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}function zn(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(JSON.stringify(e)));return e}function jn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(kn.debug&&!function(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e,t))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return e}function Vn(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}class Gn extends Un{get x(){return this[0]}set x(e){this[0]=zn(e)}get y(){return this[1]}set y(e){this[1]=zn(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-e[n];t+=r*r}return zn(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return zn(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=r[e];return this.check()}divide(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=r[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Vn(e>=0&&e<this.ELEMENTS,"index is out of range"),zn(this[e])}setComponent(e,t){return Vn(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const Wn=1e-6;let Hn="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function Qn(){const e=new Hn(3);return Hn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Xn(e,t,n){const r=new Hn(3);return r[0]=e,r[1]=t,r[2]=n,r}function Yn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function qn(e,t,n){const r=t[0],i=t[1],s=t[2],o=n[0],a=n[1],l=n[2];return e[0]=i*l-s*a,e[1]=s*o-r*l,e[2]=r*a-i*o,e}function Kn(e,t,n){const r=t[0],i=t[1],s=t[2];let o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,e[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,e}function Zn(e,t,n){const r=t[0],i=t[1],s=t[2];return e[0]=r*n[0]+i*n[3]+s*n[6],e[1]=r*n[1]+i*n[4]+s*n[7],e[2]=r*n[2]+i*n[5]+s*n[8],e}function Jn(e,t,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=t[0],l=t[1],u=t[2];let c=i*u-s*l,A=s*a-r*u,h=r*l-i*a,d=i*h-s*A,f=s*c-r*h,p=r*A-i*c;const g=2*o;return c*=g,A*=g,h*=g,d*=2,f*=2,p*=2,e[0]=a+c+d,e[1]=l+A+f,e[2]=u+h+p,e}const $n=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},er=function(e){const t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},tr=function(e){const t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r};!function(){const e=Qn()}();function nr(e,t,n){const r=t[0],i=t[1],s=t[2],o=n[3]*r+n[7]*i+n[11]*s||1;return e[0]=(n[0]*r+n[4]*i+n[8]*s)/o,e[1]=(n[1]*r+n[5]*i+n[9]*s)/o,e[2]=(n[2]*r+n[6]*i+n[10]*s)/o,e}function rr(e,t,n){const r=t[0],i=t[1],s=t[2];return e[0]=n[0]*r+n[3]*i+n[6]*s,e[1]=n[1]*r+n[4]*i+n[7]*s,e[2]=n[2]*r+n[5]*i+n[8]*s,e[3]=t[3],e}const ir=[0,0,0];let sr;class or extends Gn{static get ZERO(){return sr||(sr=new or(0,0,0),Object.freeze(sr)),sr}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(-0,-0,-0),1===arguments.length&&Mn(e)?this.copy(e):(kn.debug&&(zn(e),zn(t),zn(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return kn.debug&&(zn(e.x),zn(e.y),zn(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=zn(e)}angle(e){return function(e,t){const n=e[0],r=e[1],i=e[2],s=t[0],o=t[1],a=t[2],l=Math.sqrt((n*n+r*r+i*i)*(s*s+o*o+a*a)),u=l&&Yn(e,t)/l;return Math.acos(Math.min(Math.max(u,-1),1))}(this,e)}cross(e){return qn(this,this,e),this.check()}rotateX(e){let{radians:t,origin:n=ir}=e;return function(e,t,n,r){const i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}rotateY(e){let{radians:t,origin:n=ir}=e;return function(e,t,n,r){const i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}rotateZ(e){let{radians:t,origin:n=ir}=e;return function(e,t,n,r){const i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Kn(this,this,e),this.check()}transformAsVector(e){return nr(this,this,e),this.check()}transformByMatrix3(e){return Zn(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return Jn(this,this,e),this.check()}}const ar=new or;function lr(e,t,n,r){ar.set(e,t,n);const i=ar.len();return{distance:r/i,normal:new or(-e/i,-t/i,-n/i)}}function ur(e){return e-Math.fround(e)}let cr;function Ar(e,t){const{size:n=1,startIndex:r=0}=t,i=void 0!==t.endIndex?t.endIndex:e.length,s=(i-r)/n;cr=Rn.allocate(cr,s,{type:Float32Array,size:2*n});let o=r,a=0;for(;o<i;){for(let t=0;t<n;t++){const r=e[o++];cr[a+t]=r,cr[a+t+n]=ur(r)}a+=2*n}return cr.subarray(0,s*n*2)}function hr(e){let t=null,n=!1;for(const r of e)r&&(t?(n||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],n=!0),t[0][0]=Math.min(t[0][0],r[0][0]),t[0][1]=Math.min(t[0][1],r[0][1]),t[1][0]=Math.max(t[1][0],r[1][0]),t[1][1]=Math.max(t[1][1],r[1][1])):t=r);return t}class dr extends Un{toString(){let e="[";if(kn.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=" ".concat(this[n*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=zn(n),this}getColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0);const n=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[n+r];return t}setColumn(e,t){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=t[r];return this}}function fr(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],A=t[9],h=t[10],d=t[11],f=t[12],p=t[13],g=t[14],m=t[15],y=n*a-r*o,v=n*l-i*o,_=n*u-s*o,b=r*l-i*a,w=r*u-s*a,E=i*u-s*l,x=c*p-A*f,D=c*g-h*f,C=c*m-d*f,S=A*g-h*p,T=A*m-d*p,I=h*m-d*g;let F=y*I-v*T+_*S+b*C-w*D+E*x;return F?(F=1/F,e[0]=(a*I-l*T+u*S)*F,e[1]=(i*T-r*I-s*S)*F,e[2]=(p*E-g*w+m*b)*F,e[3]=(h*w-A*E-d*b)*F,e[4]=(l*C-o*I-u*D)*F,e[5]=(n*I-i*C+s*D)*F,e[6]=(g*_-f*E-m*v)*F,e[7]=(c*E-h*_+d*v)*F,e[8]=(o*T-a*C+u*x)*F,e[9]=(r*C-n*T-s*x)*F,e[10]=(f*w-p*_+m*y)*F,e[11]=(A*_-c*w-d*y)*F,e[12]=(a*D-o*S-l*x)*F,e[13]=(n*S-r*D+i*x)*F,e[14]=(p*v-f*b-g*y)*F,e[15]=(c*b-A*v+h*y)*F,e):null}function pr(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],u=t[6],c=t[7],A=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],y=t[15];let v=n[0],_=n[1],b=n[2],w=n[3];return e[0]=v*r+_*a+b*A+w*p,e[1]=v*i+_*l+b*h+w*g,e[2]=v*s+_*u+b*d+w*m,e[3]=v*o+_*c+b*f+w*y,v=n[4],_=n[5],b=n[6],w=n[7],e[4]=v*r+_*a+b*A+w*p,e[5]=v*i+_*l+b*h+w*g,e[6]=v*s+_*u+b*d+w*m,e[7]=v*o+_*c+b*f+w*y,v=n[8],_=n[9],b=n[10],w=n[11],e[8]=v*r+_*a+b*A+w*p,e[9]=v*i+_*l+b*h+w*g,e[10]=v*s+_*u+b*d+w*m,e[11]=v*o+_*c+b*f+w*y,v=n[12],_=n[13],b=n[14],w=n[15],e[12]=v*r+_*a+b*A+w*p,e[13]=v*i+_*l+b*h+w*g,e[14]=v*s+_*u+b*d+w*m,e[15]=v*o+_*c+b*f+w*y,e}function gr(e,t,n){const r=n[0],i=n[1],s=n[2];let o,a,l,u,c,A,h,d,f,p,g,m;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*s+t[12],e[13]=t[1]*r+t[5]*i+t[9]*s+t[13],e[14]=t[2]*r+t[6]*i+t[10]*s+t[14],e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(o=t[0],a=t[1],l=t[2],u=t[3],c=t[4],A=t[5],h=t[6],d=t[7],f=t[8],p=t[9],g=t[10],m=t[11],e[0]=o,e[1]=a,e[2]=l,e[3]=u,e[4]=c,e[5]=A,e[6]=h,e[7]=d,e[8]=f,e[9]=p,e[10]=g,e[11]=m,e[12]=o*r+c*i+f*s+t[12],e[13]=a*r+A*i+p*s+t[13],e[14]=l*r+h*i+g*s+t[14],e[15]=u*r+d*i+m*s+t[15]),e}function mr(e,t,n){const r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function yr(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],A=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+u*r,e[5]=o*i+c*r,e[6]=a*i+A*r,e[7]=l*i+h*r,e[8]=u*i-s*r,e[9]=c*i-o*r,e[10]=A*i-a*r,e[11]=h*i-l*r,e}function vr(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],l=t[3],u=t[4],c=t[5],A=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+u*r,e[1]=o*i+c*r,e[2]=a*i+A*r,e[3]=l*i+h*r,e[4]=u*i-s*r,e[5]=c*i-o*r,e[6]=A*i-a*r,e[7]=h*i-l*r,e}function _r(e,t){const n=t[0],r=t[1],i=t[2],s=t[4],o=t[5],a=t[6],l=t[8],u=t[9],c=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(s*s+o*o+a*a),e[2]=Math.sqrt(l*l+u*u+c*c),e}const br=function(e,t,n,r,i){const s=1/Math.tan(t/2);if(e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0){const t=1/(r-i);e[10]=(i+r)*t,e[14]=2*i*r*t}else e[10]=-1,e[14]=-2*r;return e};const wr=function(e,t,n,r,i,s,o){const a=1/(t-n),l=1/(r-i),u=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*a,e[13]=(i+r)*l,e[14]=(o+s)*u,e[15]=1,e};function Er(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function xr(e,t,n,r){const i=t[0],s=t[1];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e}!function(){const e=function(){const e=new Hn(2);return Hn!=Float32Array&&(e[0]=0,e[1]=0),e}()}();function Dr(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function Cr(e){const t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)}function Sr(e){const t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function Tr(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,e}!function(){const e=function(){const e=new Hn(4);return Hn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();var Ir;!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"}(Ir||(Ir={}));const Fr=45*Math.PI/180,Rr=1,kr=.1,Pr=500,Mr=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Br extends dr{static get IDENTITY(){return function(){Or||(Or=new Br,Object.freeze(Or));return Or}()}static get ZERO(){return function(){Lr||(Lr=new Br([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Lr));return Lr}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Ir}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,r,i,s,o,a,l,u,c,A,h,d,f,p){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=l,this[9]=u,this[10]=c,this[11]=A,this[12]=h,this[13]=d,this[14]=f,this[15]=p,this.check()}setRowMajor(e,t,n,r,i,s,o,a,l,u,c,A,h,d,f,p){return this[0]=e,this[1]=i,this[2]=l,this[3]=h,this[4]=t,this[5]=s,this[6]=u,this[7]=d,this[8]=n,this[9]=o,this[10]=c,this[11]=f,this[12]=r,this[13]=a,this[14]=A,this[15]=p,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Mr)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,a=r+r,l=i+i,u=n*o,c=r*o,A=r*a,h=i*o,d=i*a,f=i*l,p=s*o,g=s*a,m=s*l;e[0]=1-A-f,e[1]=c+m,e[2]=h-g,e[3]=0,e[4]=c-m,e[5]=1-u-f,e[6]=d+p,e[7]=0,e[8]=h+g,e[9]=d-p,e[10]=1-u-A,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:r,top:i,near:s=kr,far:o=Pr}=e;return o===1/0?function(e,t,n,r,i,s){const o=2*s/(n-t),a=2*s/(i-r),l=(n+t)/(n-t),u=(i+r)/(i-r),c=-1,A=-1,h=-2*s;e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=l,e[9]=u,e[10]=c,e[11]=A,e[12]=0,e[13]=0,e[14]=h,e[15]=0}(this,t,n,r,i,s):function(e,t,n,r,i,s,o){const a=1/(n-t),l=1/(i-r),u=1/(s-o);e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*l,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(i+r)*l,e[10]=(o+s)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*u,e[15]=0}(this,t,n,r,i,s,o),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:r=[0,1,0]}=e;return function(e,t,n,r){let i,s,o,a,l,u,c,A,h,d;const f=t[0],p=t[1],g=t[2],m=r[0],y=r[1],v=r[2],_=n[0],b=n[1],w=n[2];Math.abs(f-_)<Wn&&Math.abs(p-b)<Wn&&Math.abs(g-w)<Wn?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(A=f-_,h=p-b,d=g-w,i=1/Math.sqrt(A*A+h*h+d*d),A*=i,h*=i,d*=i,s=y*d-v*h,o=v*A-m*d,a=m*h-y*A,i=Math.sqrt(s*s+o*o+a*a),i?(i=1/i,s*=i,o*=i,a*=i):(s=0,o=0,a=0),l=h*a-d*o,u=d*s-A*a,c=A*o-h*s,i=Math.sqrt(l*l+u*u+c*c),i?(i=1/i,l*=i,u*=i,c*=i):(l=0,u=0,c=0),e[0]=s,e[1]=l,e[2]=A,e[3]=0,e[4]=o,e[5]=u,e[6]=h,e[7]=0,e[8]=a,e[9]=c,e[10]=d,e[11]=0,e[12]=-(s*f+o*p+a*g),e[13]=-(l*f+u*p+c*g),e[14]=-(A*f+h*p+d*g),e[15]=1)}(this,t,n,r),this.check()}ortho(e){const{left:t,right:n,bottom:r,top:i,near:s=kr,far:o=Pr}=e;return wr(this,t,n,r,i,s,o),this.check()}orthographic(e){const{fovy:t=Fr,aspect:n=Rr,focalDistance:r=1,near:i=kr,far:s=Pr}=e;Nr(t);const o=t/2,a=r*Math.tan(o),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:i,far:s})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}=e;return Nr(t),br(this,t,n,r,i),this.check()}determinant(){return function(e){const t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],A=e[10],h=e[11],d=e[12],f=e[13],p=e[14],g=t*o-n*s,m=t*a-r*s,y=n*a-r*o,v=u*f-c*d,_=u*p-A*d,b=c*p-A*f;return l*(t*b-n*_+r*v)-i*(s*b-o*_+a*v)+e[15]*(u*y-c*m+A*g)-h*(d*y-f*m+p*g)}(this)}getScale(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],i=1/n[1],s=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*i,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*i,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],i=1/n[1],s=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=this[4]*r,e[4]=this[5]*i,e[5]=this[6]*s,e[6]=this[8]*r,e[7]=this[9]*i,e[8]=this[10]*s,e}transpose(){return function(e,t){if(e===t){const n=t[1],r=t[2],i=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}invert(){return fr(this,this),this.check()}multiplyLeft(e){return pr(this,e,this),this.check()}multiplyRight(e){return pr(this,this,e),this.check()}rotateX(e){return yr(this,this,e),this.check()}rotateY(e){return function(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],l=t[3],u=t[8],c=t[9],A=t[10],h=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-u*r,e[1]=o*i-c*r,e[2]=a*i-A*r,e[3]=l*i-h*r,e[8]=s*r+u*i,e[9]=o*r+c*i,e[10]=a*r+A*i,e[11]=l*r+h*i}(this,this,e),this.check()}rotateZ(e){return vr(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function(e,t,n,r){let i,s,o,a,l,u,c,A,h,d,f,p,g,m,y,v,_,b,w,E,x,D,C,S,T=r[0],I=r[1],F=r[2],R=Math.sqrt(T*T+I*I+F*F);R<Wn||(R=1/R,T*=R,I*=R,F*=R,s=Math.sin(n),i=Math.cos(n),o=1-i,a=t[0],l=t[1],u=t[2],c=t[3],A=t[4],h=t[5],d=t[6],f=t[7],p=t[8],g=t[9],m=t[10],y=t[11],v=T*T*o+i,_=I*T*o+F*s,b=F*T*o-I*s,w=T*I*o-F*s,E=I*I*o+i,x=F*I*o+T*s,D=T*F*o+I*s,C=I*F*o-T*s,S=F*F*o+i,e[0]=a*v+A*_+p*b,e[1]=l*v+h*_+g*b,e[2]=u*v+d*_+m*b,e[3]=c*v+f*_+y*b,e[4]=a*w+A*E+p*x,e[5]=l*w+h*E+g*x,e[6]=u*w+d*E+m*x,e[7]=c*w+f*E+y*x,e[8]=a*D+A*C+p*S,e[9]=l*D+h*C+g*S,e[10]=u*D+d*C+m*S,e[11]=c*D+f*C+y*S,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}scale(e){return mr(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return gr(this,this,e),this.check()}transform(e,t){return 4===e.length?(jn(t=Tr(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let r;switch(n){case 2:r=function(e,t,n){const r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}(t||[-0,-0],e,this);break;case 3:r=Kn(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return jn(r,e.length),r}transformAsVector(e,t){let n;switch(e.length){case 2:n=function(e,t,n){const r=t[0],i=t[1],s=n[3]*r+n[7]*i||1;return e[0]=(n[0]*r+n[4]*i)/s,e[1]=(n[1]*r+n[5]*i)/s,e}(t||[-0,-0],e,this);break;case 3:n=nr(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return jn(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let Lr,Or;function Nr(e){if(e>2*Math.PI)throw Error("expected radians")}function Ur(e,t){const n=Tr([],t,e);return Dr(n,n,1/n[3]),n}function zr(e,t){const n=e%t;return n<0?t+n:n}function jr(e,t,n){return e<t?t:e>n?n:e}const Vr=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function Gr(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Wr=Math.PI,Hr=Wr/4,Qr=Wr/180,Xr=180/Wr,Yr=512,qr=4003e4,Kr=85.051129,Zr=1.5;function Jr(e){const[t,n]=e;Gr(Number.isFinite(t)),Gr(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=n*Qr;return[Yr*(t*Qr+Wr)/(2*Wr),Yr*(Wr+Math.log(Math.tan(Hr+.5*r)))/(2*Wr)]}function $r(e){const[t,n]=e,r=t/Yr*(2*Wr)-Wr,i=2*(Math.atan(Math.exp(n/Yr*(2*Wr)-Wr))-Hr);return[r*Xr,i*Xr]}function ei(e){const{latitude:t}=e;Gr(Number.isFinite(t));const n=Math.cos(t*Qr);return function(e){return Vr(e)}(qr*n)-9}function ti(e){return 12790407194604047e-21/Math.cos(e*Qr)}function ni(e){const{latitude:t,longitude:n,highPrecision:r=!1}=e;Gr(Number.isFinite(t)&&Number.isFinite(n));const i=Yr,s=Math.cos(t*Qr),o=i/360,a=o/s,l=12790407194604047e-21/s,u={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[.703125,1/a,1/l]};if(r){const e=Qr*Math.tan(t*Qr)/s,n=o*e/2,r=12790407194604047e-21*e,i=r/a*l;u.unitsPerDegree2=[0,n,r],u.unitsPerMeter2=[i,0,i]}return u}function ri(e,t){const[n,r,i]=e,[s,o,a]=t,{unitsPerMeter:l,unitsPerMeter2:u}=ni({longitude:n,latitude:r,highPrecision:!0}),c=Jr(e);c[0]+=s*(l[0]+u[0]*o),c[1]+=o*(l[1]+u[1]*o);const A=$r(c),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[A[0],A[1],h]:A}function ii(e){const{width:t,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:u=1}=e;let{fovy:c=si(Zr)}=e;void 0!==r&&(c=si(r));const A=c*Qr,h=i*Qr,d=oi(c);let f=d;o&&(f+=o[2]*a/Math.cos(h)/n);const p=A*(.5+(s?s[1]:0)/n),g=Math.sin(p)*f/Math.sin(jr(Math.PI/2-h-p,.01,Math.PI-.01)),m=Math.sin(h)*g+f,y=10*f;return{fov:A,aspect:t/n,focalDistance:d,near:l,far:Math.min(m*u,y)}}function si(e){return 2*Math.atan(.5/e)*Xr}function oi(e){return.5/Math.tan(.5*e*Qr)}function ai(e,t){const[n,r,i=0]=e;return Gr(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Ur(t,[n,r,i,1])}function li(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[r,i,s]=e;if(Gr(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s)){return Ur(t,[r,i,s,1])}const o=Ur(t,[r,i,0,1]),a=Ur(t,[r,i,1,1]),l=o[2],u=a[2];return xr([],o,a,l===u?0:((n||0)-l)/(u-l))}function ui(e){const{width:t,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=e,[[a,l],[u,c]]=r,A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"===typeof e)return{top:e,bottom:e,left:e,right:e};return Gr(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),h=Jr([a,jr(c,-85.051129,Kr)]),d=Jr([u,jr(l,-85.051129,Kr)]),f=[Math.max(Math.abs(d[0]-h[0]),i),Math.max(Math.abs(d[1]-h[1]),i)],p=[t-A.left-A.right-2*Math.abs(o[0]),n-A.top-A.bottom-2*Math.abs(o[1])];Gr(p[0]>0&&p[1]>0);const g=p[0]/f[0],m=p[1]/f[1],y=(A.right-A.left)/2/g,v=(A.top-A.bottom)/2/m,_=$r([(d[0]+h[0])/2+y,(d[1]+h[1])/2+v]),b=Math.min(s,Vr(Math.abs(Math.min(g,m))));return Gr(Number.isFinite(b)),{longitude:_[0],latitude:_[1],zoom:b}}const ci=Math.PI/180;function Ai(e,t,n){const{pixelUnprojectionMatrix:r}=e,i=Ur(r,[t,0,1,1]),s=Ur(r,[t,e.height,1,1]),o=$r(xr([],i,s,(n*e.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2])));return o.push(n),o}var hi,di,fi;!function(e){e[e.Start=1]="Start",e[e.Move=2]="Move",e[e.End=4]="End",e[e.Cancel=8]="Cancel"}(hi||(hi={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Up=4]="Up",e[e.Down=8]="Down",e[e.Horizontal=3]="Horizontal",e[e.Vertical=12]="Vertical",e[e.All=15]="All"}(di||(di={})),function(e){e[e.Possible=1]="Possible",e[e.Began=2]="Began",e[e.Changed=4]="Changed",e[e.Ended=8]="Ended",e[e.Recognized=8]="Recognized",e[e.Cancelled=16]="Cancelled",e[e.Failed=32]="Failed"}(fi||(fi={}));const pi="auto",gi="manipulation",mi="none",yi="pan-x",vi="pan-y";class _i{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){"compute"===e&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return function(e){if(e.includes(mi))return mi;const t=e.includes(yi),n=e.includes(vi);return t&&n?mi:t||n?t?yi:vi:e.includes(gi)?gi:pi}(e.join(" "))}}function bi(e){return e.trim().split(/\s+/g)}function wi(e,t,n){if(e)for(const r of bi(t))e.addEventListener(r,n,!1)}function Ei(e,t,n){if(e)for(const r of bi(t))e.removeEventListener(r,n,!1)}function xi(e){return(e.ownerDocument||e).defaultView}function Di(e){const t=e.length;if(1===t)return{x:Math.round(e[0].clientX),y:Math.round(e[0].clientY)};let n=0,r=0,i=0;for(;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:Math.round(n/t),y:Math.round(r/t)}}function Ci(e){const t=[];let n=0;for(;n<e.pointers.length;)t[n]={clientX:Math.round(e.pointers[n].clientX),clientY:Math.round(e.pointers[n].clientY)},n++;return{timeStamp:Date.now(),pointers:t,center:Di(t),deltaX:e.deltaX,deltaY:e.deltaY}}function Si(e,t){const n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function Ti(e,t){const n=t.clientX-e.clientX,r=t.clientY-e.clientY;return Math.sqrt(n*n+r*r)}function Ii(e,t){const n=t.clientX-e.clientX,r=t.clientY-e.clientY;return 180*Math.atan2(r,n)/Math.PI}function Fi(e,t){return e===t?di.None:Math.abs(e)>=Math.abs(t)?e<0?di.Left:di.Right:t<0?di.Up:di.Down}function Ri(e,t,n){return{x:t/e||0,y:n/e||0}}function ki(e,t){const{session:n}=e,{pointers:r}=t,{length:i}=r;n.firstInput||(n.firstInput=Ci(t)),i>1&&!n.firstMultiple?n.firstMultiple=Ci(t):1===i&&(n.firstMultiple=!1);const{firstInput:s,firstMultiple:o}=n,a=o?o.center:s.center,l=t.center=Di(r);t.timeStamp=Date.now(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=function(e,t){const n=t.x-e.x,r=t.y-e.y;return 180*Math.atan2(r,n)/Math.PI}(a,l),t.distance=Si(a,l);const{deltaX:u,deltaY:c}=function(e,t){const n=t.center;let r=e.offsetDelta,i=e.prevDelta;const s=e.prevInput;return t.eventType!==hi.Start&&(null===s||void 0===s?void 0:s.eventType)!==hi.End||(i=e.prevDelta={x:(null===s||void 0===s?void 0:s.deltaX)||0,y:(null===s||void 0===s?void 0:s.deltaY)||0},r=e.offsetDelta={x:n.x,y:n.y}),{deltaX:i.x+(n.x-r.x),deltaY:i.y+(n.y-r.y)}}(n,t);t.deltaX=u,t.deltaY=c,t.offsetDirection=Fi(t.deltaX,t.deltaY);const A=Ri(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=A.x,t.overallVelocityY=A.y,t.overallVelocity=Math.abs(A.x)>Math.abs(A.y)?A.x:A.y,t.scale=o?function(e,t){return Ti(t[0],t[1])/Ti(e[0],e[1])}(o.pointers,r):1,t.rotation=o?function(e,t){return Ii(t[1],t[0])-Ii(e[1],e[0])}(o.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length;let h=e.element;return function(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parentNode}return!1}(t.srcEvent.target,h)&&(h=t.srcEvent.target),t.target=h,function(e,t){const n=e.lastInterval||t,r=t.timeStamp-n.timeStamp;let i,s,o,a;if(t.eventType!==hi.Cancel&&(r>25||void 0===n.velocity)){const l=t.deltaX-n.deltaX,u=t.deltaY-n.deltaY,c=Ri(r,l,u);s=c.x,o=c.y,i=Math.abs(c.x)>Math.abs(c.y)?c.x:c.y,a=Fi(l,u),e.lastInterval=t}else i=n.velocity,s=n.velocityX,o=n.velocityY,a=n.direction;t.velocity=i,t.velocityX=s,t.velocityY=o,t.direction=a}(n,t),t}class Pi{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=e=>{this.manager.options.enable&&this.handler(e)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){!function(e,t,n){const r=n.pointers.length,i=n.changedPointers.length,s=t&hi.Start&&r-i===0,o=t&(hi.End|hi.Cancel)&&r-i===0;n.isFirst=Boolean(s),n.isFinal=Boolean(o),s&&(e.session={}),n.eventType=t;const a=ki(e,n);e.emit("hammer.input",a),e.recognize(a),e.session.prevInput=a}(this.manager,e,t)}init(){wi(this.element,this.evEl,this.domHandler),wi(this.target,this.evTarget,this.domHandler),wi(xi(this.element),this.evWin,this.domHandler)}destroy(){Ei(this.element,this.evEl,this.domHandler),Ei(this.target,this.evTarget,this.domHandler),Ei(xi(this.element),this.evWin,this.domHandler)}}const Mi={pointerdown:hi.Start,pointermove:hi.Move,pointerup:hi.End,pointercancel:hi.Cancel,pointerout:hi.Cancel};class Bi extends Pi{constructor(e){super(e),this.evEl="pointerdown",this.evWin="pointermove pointerup pointercancel",this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let n=!1;const r=Mi[e.type],i=e.pointerType,s="touch"===i;let o=t.findIndex(t=>t.pointerId===e.pointerId);r&hi.Start&&(e.buttons||s)?o<0&&(t.push(e),o=t.length-1):r&(hi.End|hi.Cancel)&&(n=!0),o<0||(t[o]=e,this.callback(r,{pointers:t,changedPointers:[e],eventType:r,pointerType:i,srcEvent:e}),n&&t.splice(o,1))}}const Li=["","webkit","Moz","MS","ms","o"];function Oi(e,t){const n=t[0].toUpperCase()+t.slice(1);for(const r of Li){const i=r?r+n:t;if(i in e)return i}}const Ni={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class Ui{constructor(e,t){this.options=u(u(u({},Ni),t),{},{cssProps:u(u({},Ni.cssProps),t.cssProps),inputTarget:t.inputTarget||e}),this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new Bi(this),this.touchAction=new _i(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?2:1}recognize(e){const{session:t}=this;if(t.stopped)return;let n;this.session.prevented&&e.srcEvent.preventDefault();const{recognizers:r}=this;let{curRecognizer:i}=t;(!i||i&&i.state&fi.Recognized)&&(i=t.curRecognizer=null);let s=0;for(;s<r.length;)n=r[s],2===t.stopped||i&&n!==i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&n.state&(fi.Began|fi.Changed|fi.Ended)&&(i=t.curRecognizer=n),s++}get(e){const{recognizers:t}=this;for(let n=0;n<t.length;n++)if(t[n].options.event===e)return t[n];return null}add(e){if(Array.isArray(e)){for(const t of e)this.add(t);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const t of e)this.remove(t);return this}const t="string"===typeof e?this.get(e):e;if(t){const{recognizers:e}=this,n=e.indexOf(t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:n}=this;for(const r of bi(e))n[r]=n[r]||[],n[r].push(t)}off(e,t){if(!e)return;const{handlers:n}=this;for(const r of bi(e))t?n[r]&&n[r].splice(n[r].indexOf(t),1):delete n[r]}emit(e,t){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const r=t;r.type=e,r.preventDefault=function(){t.srcEvent.preventDefault()};let i=0;for(;i<n.length;)n[i](r),i++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[n,r]of Object.entries(this.options.cssProps)){const i=Oi(t.style,n);e?(this.oldCssProps[i]=t.style[i],t.style[i]=r):t.style[i]=this.oldCssProps[i]||""}e||(this.oldCssProps={})}}}let zi=1;function ji(e){return e&fi.Cancelled?"cancel":e&fi.Ended?"end":e&fi.Changed?"move":e&fi.Began?"start":""}class Vi{constructor(e){this.options=e,this.id=zi++,this.state=fi.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const t of e)this.recognizeWith(t);return this}let t;if("string"===typeof e){if(t=this.manager.get(e),!t)throw new Error("Cannot find recognizer ".concat(e))}else t=e;const{simultaneous:n}=this;return n[t.id]||(n[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const t of e)this.dropRecognizeWith(t);return this}let t;return t="string"===typeof e?this.manager.get(e):e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const t of e)this.requireFailure(t);return this}let t;if("string"===typeof e){if(t=this.manager.get(e),!t)throw new Error("Cannot find recognizer ".concat(e))}else t=e;const{requireFail:n}=this;return-1===n.indexOf(t)&&(n.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const t of e)this.dropRequireFailure(t);return this}let t;if(t="string"===typeof e?this.manager.get(e):e,t){const e=this.requireFail.indexOf(t);e>-1&&this.requireFail.splice(e,1)}return this}hasRequireFailures(){return Boolean(this.requireFail.find(e=>e.options.enable))}canRecognizeWith(e){return Boolean(this.simultaneous[e.id])}emit(e){if(!e)return;const{state:t}=this;t<fi.Ended&&this.manager.emit(this.options.event+ji(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=fi.Ended&&this.manager.emit(this.options.event+ji(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=fi.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(fi.Failed|fi.Possible)))return!1;e++}return!0}recognize(e){const t=u({},e);if(!this.options.enable)return this.reset(),void(this.state=fi.Failed);this.state&(fi.Recognized|fi.Cancelled|fi.Failed)&&(this.state=fi.Possible),this.state=this.process(t),this.state&(fi.Began|fi.Changed|fi.Ended|fi.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}class Gi extends Vi{attrTest(e){const t=this.options.pointers;return 0===t||e.pointers.length===t}process(e){const{state:t}=this,{eventType:n}=e,r=t&(fi.Began|fi.Changed),i=this.attrTest(e);return r&&(n&hi.Cancel||!i)?t|fi.Cancelled:r||i?n&hi.End?t|fi.Ended:t&fi.Began?t|fi.Changed:fi.Began:fi.Failed}}class Wi extends Vi{constructor(){super(u({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[gi]}process(e){const{options:t}=this,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),e.eventType&hi.Start&&0===this.count)return this.failTimeout();if(r&&i&&n){if(e.eventType!==hi.End)return this.failTimeout();const n=!this.pTime||e.timeStamp-this.pTime<t.interval,r=!this.pCenter||Si(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,r&&n?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=fi.Recognized,this.tryEmit(this._input)},t.interval),fi.Began):fi.Recognized}return fi.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=fi.Failed},this.options.interval),fi.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===fi.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const Hi=["","start","move","end","cancel","up","down","left","right"];class Qi extends Gi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(u({enable:!0,pointers:1,event:"pan",threshold:10,direction:di.All},e)),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&di.Horizontal&&t.push(vi),e&di.Vertical&&t.push(yi),t}getEventNames(){return Hi.map(e=>this.options.event+e)}directionTest(e){const{options:t}=this;let n=!0,{distance:r}=e,{direction:i}=e;const s=e.deltaX,o=e.deltaY;return i&t.direction||(t.direction&di.Horizontal?(i=0===s?di.None:s<0?di.Left:di.Right,n=s!==this.pX,r=Math.abs(e.deltaX)):(i=0===o?di.None:o<0?di.Up:di.Down,n=o!==this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&Boolean(i&t.direction)}attrTest(e){return super.attrTest(e)&&(Boolean(this.state&fi.Began)||!(this.state&fi.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=di[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}const Xi=["","start","move","end","cancel","in","out"];class Yi{constructor(e,t,n){this.element=e,this.callback=t,this.options=n}}const qi="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Ki=("undefined"!==typeof window?window:global,"undefined"!==typeof global?global:window,"undefined"!==typeof document&&document,-1!==qi.indexOf("firefox")),Zi=4.000244140625;class Ji extends Yi{constructor(e,t,n){super(e,t,u({enable:!0},n)),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;globalThis.WheelEvent&&(Ki&&e.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(t/=globalThis.devicePixelRatio),e.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%Zi===0&&(t=Math.floor(t/Zi)),e.shiftKey&&t&&(t*=.25),this.callback({type:"wheel",center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}}const $i=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class es extends Yi{constructor(e,t,n){super(e,t,u({enable:!0},n)),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,$i.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){$i.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t}}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const ts=["keydown","keyup"];class ns extends Yi{constructor(e,t,n){super(e,t,u({enable:!0,tabIndex:0},n)),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:"keydown",srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",ts.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){ts.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"keydown"===e&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}}class rs extends Yi{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){"contextmenu"===e&&(this.options.enable=t)}}const is={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};const ss={srcElement:"root",priority:0};class os{constructor(e,t){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{handlers:s,handlersByElement:o}=this,a=u(u({},ss),n);let l=o.get(a.srcElement);l||(l=[],o.set(a.srcElement,l));const c={type:e,handler:t,srcElement:a.srcElement,priority:a.priority};r&&(c.once=!0),i&&(c.passive=!0),s.push(c),this._active=this._active||!c.passive;let A=l.length-1;for(;A>=0&&!(l[A].priority>=c.priority);)A--;l.splice(A+1,0,c)}remove(e,t){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const s=n[i];if(s.type===e&&s.handler===t){n.splice(i,1);const e=r.get(s.srcElement);e.splice(e.indexOf(s),1),0===e.length&&r.delete(s.srcElement)}}this._active=n.some(e=>!e.passive)}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const r=()=>{e.handled=!0},i=()=>{e.handled=!0,t=!0},s=[];for(let o=0;o<n.length;o++){const{type:a,handler:l,once:c}=n[o];if(l(u(u({},e),{},{type:a,stopPropagation:r,stopImmediatePropagation:i})),c&&s.push(n[o]),t)break}for(let e=0;e<s.length;e++){const{type:t,handler:n}=s[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return u(u(u(u({},e),function(e){const t=is[e.srcEvent.type];if(!t)return null;const{buttons:n,button:r}=e.srcEvent;let i=!1,s=!1,o=!1;return 2===t?(i=Boolean(1&n),s=Boolean(4&n),o=Boolean(2&n)):(i=0===r,s=1===r,o=2===r),{leftButton:i,middleButton:s,rightButton:o}}(e)),function(e,t){const n=e.center;if(!n)return null;const r=t.getBoundingClientRect(),i=r.width/t.offsetWidth||1,s=r.height/t.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-r.left-t.clientLeft)/i,y:(n.y-r.top-t.clientTop)/s}}}(e,t)),{},{preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t})}}function as(e){if("recognizer"in e)return e;let t;const n=Array.isArray(e)?[...e]:[e];if("function"===typeof n[0]){t=new(n.shift())(n.shift()||{})}else t=n.shift();return{recognizer:t,recognizeWith:"string"===typeof n[0]?[n[0]]:n[0],requireFailure:"string"===typeof n[1]?[n[1]]:n[1]}}class ls{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._onBasicInput=e=>{this.manager.emit(e.srcEvent.type,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options=u({recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{}},t),this.events=new Map,this.element=e,e){this.manager=new Ui(e,this.options);for(const e of this.options.recognizers){const{recognizer:t,recognizeWith:n,requireFailure:r}=as(e);this.manager.add(t),n&&t.recognizeWith(n),r&&t.requireFailure(r)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new Ji(e,this._onOtherEvent,{enable:!1}),this.moveInput=new es(e,this._onOtherEvent,{enable:!1}),this.keyInput=new ns(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new rs(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){var n,r,i,s;const{manager:o}=this;if(!o)return;const a=o.get(e);a&&(a.set({enable:t}),o.touchAction.update()),null===(n=this.wheelInput)||void 0===n||n.enableEventType(e,t),null===(r=this.moveInput)||void 0===r||r.enableEventType(e,t),null===(i=this.keyInput)||void 0===i||i.enableEventType(e,t),null===(s=this.contextmenuInput)||void 0===s||s.enableEventType(e,t)}_addEventHandler(e,t,n,r,i){if("string"!==typeof e){n=t;for(const[t,s]of Object.entries(e))this._addEventHandler(t,s,n,r,i);return}const{manager:s,events:o}=this;if(!s)return;let a=o.get(e);if(!a){const t=this._getRecognizerName(e)||e;a=new os(this,t),o.set(e,a),s&&s.on(e,a.handleEvent)}a.add(e,t,n,r,i),a.isEmpty()||this._toggleRecognizer(a.recognizerName,!0)}_removeEventHandler(e,t){if("string"!==typeof e){for(const[t,n]of Object.entries(e))this._removeEventHandler(t,n);return}const{events:n}=this,r=n.get(e);if(r&&(r.remove(e,t),r.isEmpty())){const{recognizerName:e}=r;let t=!1;for(const r of n.values())if(r.recognizerName===e&&!r.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}_getRecognizerName(e){var t;return null===(t=this.manager.recognizers.find(t=>t.getEventNames().includes(e)))||void 0===t?void 0:t.options.event}}const us={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(us,"IDENTITY",{get:()=>(Me.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const cs={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},As={common:0,meters:1,pixels:2},hs={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},ds={multipan:[Qi,{threshold:10,direction:di.Vertical,pointers:2}],pinch:[class extends Gi{constructor(){super(u({enable:!0,event:"pinch",threshold:0,pointers:2},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}))}getTouchAction(){return[mi]}getEventNames(){return Xi.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||Boolean(this.state&fi.Began))}emit(e){if(1!==e.scale){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}},{},null,["multipan"]],pan:[Qi,{threshold:1},["pinch"],["multipan"]],dblclick:[Wi,{event:"dblclick",taps:2}],click:[Wi,{event:"click"},null,["dblclick"]]},fs=Math.PI/180,ps=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],gs=[0,0,0],ms={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class ys{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||ms,this.focalDistance=e.focalDistance||1,this.position=e.position||gs,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?cs.WEB_MERCATOR:cs.WEB_MERCATOR_AUTO_OFFSET:cs.IDENTITY}equals(e){return e instanceof ys&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&On(e.projectionMatrix,this.projectionMatrix)&&On(e.viewMatrix,this.viewMatrix))}project(e){let{topLeft:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=ai(this.projectPosition(e),this.pixelProjectionMatrix),[r,i]=n,s=t?i:this.height-i;return 2===e.length?[r,s]:[r,s,n[2]]}unproject(e){let{topLeft:t=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[r,i,s]=e,o=t?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],l=li([r,o,s],this.pixelUnprojectionMatrix,a),[u,c,A]=this.unprojectPosition(l);return Number.isFinite(s)?[u,c,A]:Number.isFinite(n)?[u,c,n]:[u,c]}projectPosition(e){const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=Jr(e);return t[1]=Bn(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?$r(e):e}getBounds(){const e={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},t=this.unproject([0,0],e),n=this.unproject([this.width,0],e),r=this.unproject([0,this.height],e),i=this.unproject([this.width,this.height],e);return[Math.min(t[0],n[0],r[0],i[0]),Math.min(t[1],n[1],r[1],i[1]),Math.max(t[0],n[0],r[0],i[0]),Math.max(t[1],n[1],r[1],i[1])]}getDistanceScales(e){return e&&this.isGeospatial?ni({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel(e){let{x:t,y:n,width:r=1,height:i=1}=e;return t<this.x+this.width&&this.x<t+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:lr((e=this.viewProjectionMatrix)[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:lr(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:lr(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:lr(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:lr(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:lr(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}),this._frustumPlanes;var e}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=ei({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||ni({latitude:n,longitude:t}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:i,modelMatrix:s}=e;let o=gs;if(i&&(o=s?new Br(s).transformAsVector(i,[]):i),this.isGeospatial){const e=this.projectPosition([t,n,0]);this.center=new or(o).scale(this.distanceScales.unitsPerMeter).add(e)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:t=ps,projectionMatrix:n=null,orthographic:r=!1,fovyRadians:i,fovy:s=75,near:o=.1,far:a=1e3,padding:l=null,focalDistance:u=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new Br).multiplyRight(t).translate(new or(this.center).negate()),this.projectionMatrix=n||function(e){let{width:t,height:n,orthographic:r,fovyRadians:i,focalDistance:s,padding:o,near:a,far:l}=e;const u=t/n,c=r?(new Br).orthographic({fovy:i,aspect:u,focalDistance:s,near:a,far:l}):(new Br).perspective({fovy:i,aspect:u,near:a,far:l});if(o){const{left:e=0,right:r=0,top:i=0,bottom:s=0}=o,a=Bn((e+t-r)/2,0,t)-t/2,l=Bn((i+n-s)/2,0,n)-n/2;c[8]-=2*a/t,c[9]+=2*l/n}return c}({width:this.width,height:this.height,orthographic:r,fovyRadians:i||s*fs,focalDistance:u,padding:l,near:o,far:a});const c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var A;pr(c,c,this.projectionMatrix),pr(c,c,this.viewMatrix),this.viewProjectionMatrix=c,this.viewMatrixInverse=fr([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(A=this.viewMatrixInverse)[12],A[13],A[14]];const h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];mr(h,h,[this.width/2,-this.height/2,1]),gr(h,h,[1,-1,0]),pr(d,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=d,this.pixelUnprojectionMatrix=fr([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Me.warn("Pixel project matrix not invertible")()}}ys.displayName="Viewport";const vs=ys;class _s{constructor(e,t){var n;this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=e=>{Oe("layerManager.activateViewport",this,e),e&&(this.context.viewport=e)};const{deck:r,stats:i,viewport:s,timeline:o}=t||{};this.layers=[],this.resourceManager=new Fn({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:null===e||void 0===e?void 0:e.gl,deck:r,shaderAssembler:$((null===e||void 0===e||null===(n=e.info)||void 0===n?void 0:n.shadingLanguage)||"glsl"),defaultShaderModules:[te],renderPass:void 0,stats:i||new Ge({id:"deck.gl"}),viewport:s||new vs({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new h,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers(){let{layerIds:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?this.layers.filter(t=>e.find(e=>0===t.id.indexOf(e))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Oe("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const n=Ne(e,Boolean);for(const r of n)r.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find(t=>t.name===e.name)||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,n=t.findIndex(t=>t.name===e.name);n>=0&&(t.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,n){n.raiseError(t,"".concat(e," of ").concat(n))}_updateLayers(e,t){const n={};for(const s of e)n[s.id]?Me.warn("Multiple old layers with same id ".concat(s.id))():n[s.id]=s;if(this._defaultShaderModulesChanged){for(const t of e)t.setNeedsUpdate(),t.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const r=[];this._updateSublayersRecursively(t,n,r),this._finalizeOldLayers(n);let i=!1;for(const s of r)if(s.hasUniformTransition()){i="Uniform transition in ".concat(s);break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(e,t,n){for(const i of e){i.context=this.context;const e=t[i.id];null===e&&Me.warn("Multiple new layers with same id ".concat(i.id))(),t[i.id]=null;let s=null;try{this._debug&&e!==i&&i.validateProps(),e?(this._transferLayerState(e,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(r){this._handleError("matching",r,i)}s&&this._updateSublayersRecursively(s,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=ie}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=re,t!==e&&(e.lifecycle=se)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=oe;try{e._finalize(),e.lifecycle=ae}catch(t){this._handleError("finalization",t,e)}}}function bs(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!bs(e[r],t[r],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const s of r){if(!t.hasOwnProperty(s))return!1;if(!bs(e[s],t[s],n-1))return!1}return!0}return!1}class ws{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t="string"===typeof e?this.getView(e):e,n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),r={x:e[0],y:e[1]};for(let i=n.length-1;i>=0;--i){const s=n[i];if(s.containsPixel(r)){const n=e.slice();return n[0]-=s.x,n[1]-=s.y,s.unproject(n,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Ne(e,Boolean);this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){if(e){!bs(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e}else Me.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:t=>{var n;return null===(n=this.getView(e.id))||void 0===n?void 0:n.makeViewport({viewState:t,width:this.width,height:this.height})}})}_updateController(e,t,n,r){const i=e.controller;if(i&&n){const s=u(u(u({},t),i),{},{id:e.id,x:n.x,y:n.y,width:n.width,height:n.height});return r&&r.constructor===i.type||(r=this._createController(e,s)),r&&r.setProps(s),r}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let r=e.length;r--;){const i=e[r],s=this.getViewState(i),o=i.makeViewport({viewState:s,width:this.width,height:this.height});let a=t[i.id];const l=Boolean(i.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[i.id]=this._updateController(i,s,o,a),o&&this._viewports.unshift(o)}for(const r in t){const e=t[r];e&&!this.controllers[r]&&e.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((n,r)=>!e[r].equals(t[r]))}}const Es=/([0-9]+\.?[0-9]*)(%|px)/;function xs(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=Es.exec(e);if(t&&t.length>=3){const e="%"===t[2],n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error("Could not parse position string ".concat(e))}}function Ds(e,t){return e.relative?Math.round(e.position*t):e.position}class Cs{constructor(e){const{id:t,x:n=0,y:r=0,width:i="100%",height:s="100%",padding:o=null}=e;this.id=t||this.constructor.displayName||"view",this.props=u(u({},e),{},{id:this.id}),this._x=xs(n),this._y=xs(r),this._width=xs(i),this._height=xs(s),this._padding=o&&{left:xs(o.left||0),right:xs(o.right||0),top:xs(o.top||0),bottom:xs(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||this.constructor===e.constructor&&bs(this.props,e.props,2)}makeViewport(e){let{width:t,height:n,viewState:r}=e;r=this.filterViewState(r);const i=this.getDimensions({width:t,height:n});if(!i.height||!i.width)return null;return new(this.getViewportType(r))(u(u(u({},r),this.props),i))}getViewStateId(){const{viewState:e}=this.props;return"string"===typeof e?e:(null===e||void 0===e?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=u({},e);for(const e in this.props.viewState)"id"!==e&&(t[e]=this.props.viewState[e]);return t}return e}getDimensions(e){let{width:t,height:n}=e;const r={x:Ds(this._x,t),y:Ds(this._y,n),width:Ds(this._width,t),height:Ds(this._height,n)};return this._padding&&(r.padding={left:Ds(this._padding.left,t),top:Ds(this._padding.top,n),right:Ds(this._padding.right,t),bottom:Ds(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"===typeof e?{type:e}:u({type:this.ControllerType},e):null}}class Ss extends vs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:t=0,longitude:n=0,zoom:r=0,pitch:i=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:a=1.01,nearZ:l,farZ:c,orthographic:A=!1,projectionMatrix:h,repeat:d=!1,worldOffset:f=0,position:p,padding:g,legacyMeterSizes:m=!1}=e;let{width:y,height:v,altitude:_=1.5}=e;const b=Math.pow(2,r);let w;y=y||1,v=v||1;let E=null;if(h)_=h[5]/2,w=si(_);else{let n;if(e.fovy?(w=e.fovy,_=oi(w)):w=si(_),g){const{top:e=0,bottom:t=0}=g;n=[0,Bn((e+v-t)/2,0,v)-v/2]}E=ii({width:y,height:v,scale:b,center:p&&[0,0,p[2]*ti(t)],offset:n,pitch:i,fovy:w,nearZMultiplier:o,farZMultiplier:a}),Number.isFinite(l)&&(E.near=l),Number.isFinite(c)&&(E.far=c)}let x=function(e){const{height:t,pitch:n,bearing:r,altitude:i,scale:s,center:o}=e,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];gr(a,a,[0,0,-i]),yr(a,a,-n*Qr),vr(a,a,r*Qr);const l=s/t;return mr(a,a,[l,l,l]),o&&gr(a,a,function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}([],o)),a}({height:v,pitch:i,bearing:s,scale:b,altitude:_});if(f){x=(new Br).translate([512*f,0,0]).multiplyLeft(x)}super(u(u(u({},e),{},{width:y,height:v,viewMatrix:x,longitude:n,latitude:t,zoom:r},E),{},{fovy:w,focalDistance:_})),this.latitude=t,this.longitude=n,this.zoom=r,this.pitch=i,this.bearing=s,this.altitude=_,this.fovy=w,this.orthographic=A,this._subViewports=d?[]:null,this._pseudoMeters=m,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let r=t;r<=n;r++){const e=r?new Ss(u(u({},this),{},{worldOffset:r})):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*ti(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)/ti(n)]}addMetersToLngLat(e,t){return ri(e,t)}panByPosition(e,t){const n=li(t,this.pixelUnprojectionMatrix),r=Er([],this.projectFlat(e),function(e,t){return e[0]=-t[0],e[1]=-t[1],e}([],n)),i=Er([],this.center,r),[s,o]=this.unprojectFlat(i);return{longitude:s,latitude:o}}getBounds(){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:n,height:r,unproject:i}=e,s={targetZ:t},o=i([0,r],s),a=i([n,r],s);let l,u;return(e.fovy?.5*e.fovy*ci:Math.atan(.5/e.altitude))>(90-e.pitch)*ci-.01?(l=Ai(e,0,t),u=Ai(e,n,t)):(l=i([0,0],s),u=i([n,0],s)),[o,a,u,l]}(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:n,height:r}=this,{longitude:i,latitude:s,zoom:o}=ui(u({width:n,height:r,bounds:e},t));return new Ss({width:n,height:r,longitude:i,latitude:s,zoom:o})}}Ss.displayName="WebMercatorViewport";const Ts=Ss;class Is{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){var t,n;this.cancel(),this.settings=e,this._inProgress=!0,null===(t=(n=this.settings).onStart)||void 0===t||t.call(n,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(e=(t=this.settings).onEnd)||void 0===e||e.call(t,this))}cancel(){var e,t;this._inProgress&&(null===(e=(t=this.settings).onInterrupt)||void 0===e||e.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(e=(t=this.settings).onUpdate)||void 0===e||e.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Fs=()=>{},Rs=2,ks=3,Ps=e=>e,Ms=1;class Bs{constructor(e){this._onTransitionUpdate=e=>{const{time:t,settings:{interpolator:n,startProps:r,endProps:i,duration:s,easing:o}}=e,a=o(t/s),l=n.interpolateProps(r,i,a);this.propsInTransition=this.getControllerState(u(u({},this.props),l)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Is(e.timeline),this.onViewStateChange=e.onViewStateChange||Fs,this.onStateChange=e.onStateChange||Fs}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let r=n;if(this.transition.inProgress){const{interruption:e,endProps:t}=this.transition.settings;r=u(u({},n),e===Rs?t:this.propsInTransition||n)}this._triggerTransition(r,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||"auto"===t)&&Boolean(n)}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){if(this.transition.inProgress){return this.transition.settings.interruption===ks||this._isUpdateDueToCurrentTransition(t)}return!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const n=this.getControllerState(e),r=this.getControllerState(t).shortestPathFrom(n),i=t.transitionInterpolator,s=i.getDuration?i.getDuration(e,t):t.transitionDuration;if(0===s)return;const o=i.initializeProps(e,r);this.propsInTransition={};const a={duration:s,easing:t.transitionEasing||Ps,interpolator:i,interruption:t.transitionInterruption||Ms,startProps:o.start,endProps:o.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null===e||void 0===e||e(t)}}}function Ls(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}class Os{constructor(e){const{compare:t,extract:n,required:r}=e;this._propsToCompare=t,this._propsToExtract=n||t,this._requiredProps=r}arePropsEqual(e,t){for(const n of this._propsToCompare)if(!(n in e)||!(n in t)||!On(e[n],t[n]))return!1;return!0}initializeProps(e,t){const n={},r={};for(const i of this._propsToExtract)(i in e||i in t)&&(n[i]=e[i],r[i]=t[i]);return this._checkRequiredProps(n),this._checkRequiredProps(r),{start:n,end:r}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const n=e[t];Ls(Number.isFinite(n)||Array.isArray(n),"".concat(t," is required for transition"))})}}const Ns=["longitude","latitude","zoom","bearing","pitch"],Us=["longitude","latitude","zoom"];class zs extends Os{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:Ns,required:Us},super(n.transitionProps),this.opts=n}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:r,around:i}=this.opts;if(r&&i){const s=r(e),o=r(t),a=s.unproject(i);n.start.around=i,Object.assign(n.end,{around:o.project(a),aroundPosition:a,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const r={};for(const i of this._propsToExtract)r[i]=Ln(e[i]||0,t[i]||0,n);if(t.aroundPosition&&this.opts.makeViewport){const i=this.opts.makeViewport(u(u({},t),r));Object.assign(r,i.panByPosition(t.aroundPosition,Ln(e.around,t.around,n)))}return r}}const js={transitionDuration:0},Vs=e=>1-(1-e)*(1-e),Gs=["wheel"],Ws=["panstart","panmove","panend"],Hs=["pinchstart","pinchmove","pinchend"],Qs=["multipanstart","multipanmove","multipanend"],Xs=["dblclick"],Ys=["keydown"],qs={};class Ks{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new Bs(u(u({},e),{},{getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)})),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events){var e;if(this._events[t])null===(e=this.eventManager)||void 0===e||e.off(t,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return!t&&this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState(u(u({makeViewport:this.makeViewport},this.props),this.state)),this._controllerState}getCenter(e){const{x:t,y:n}=this.props,{offsetCenter:r}=e;return[r.x-t,r.y-n]}isPointInBounds(e,t){const{width:n,height:r}=this.props;if(t&&t.handled)return!1;const i=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=r;return i&&t&&t.stopPropagation(),i}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:a=!1,keyboard:l=!0}=e,u=Boolean(this.onViewStateChange);this.toggleEvents(Gs,u&&n),this.toggleEvents(Ws,u),this.toggleEvents(Hs,u&&(o||a)),this.toggleEvents(Qs,u&&a),this.toggleEvents(Xs,u&&s),this.toggleEvents(Ys,u&&l),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(e=>{this._events[e]!==t&&(this._events[e]=t,t?this.eventManager.on(e,this.handleEvent):this.eventManager.off(e,this.handleEvent))})}updateViewport(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=u(u({},e.getViewportProps()),t),i=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),i){const e=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:e,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange(u(u({},e),{},{interactionState:this._interactionState,viewId:this.props.id}))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(r,js,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,js,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,u(u({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:Vs}),{isDragging:!1,isPanning:!0})}else{const e=this.controllerState.panEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,js,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,u(u({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:Vs}),{isDragging:!1,isRotating:!0})}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:i}=e;let s=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==s&&(s=1/s);const o=this.controllerState.zoom({pos:t,scale:s});return this.updateViewport(o,u(u({},this._getTransitionProps({around:t})),{},{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,js,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,js,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),r=[n[0],n[1]+=e.velocityY*t/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,u(u({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:Vs}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return qs._startPinchRotation=e.rotation,qs._lastPinchEvent=e,this.updateViewport(n,js,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:qs._startPinchRotation-n})}return this.updateViewport(t,js,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),qs._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:n}=qs;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const r=this.getCenter(e);let i=this.controllerState.rotateEnd();const s=Math.log2(e.scale),o=(s-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),a=Math.pow(2,s+o*t/2);i=i.zoom({pos:r,scale:a}).zoomEnd(),this.updateViewport(i,u(u({},this._getTransitionProps({around:r})),{},{transitionDuration:t,transitionEasing:Vs}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const e=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return qs._startPinchRotation=null,qs._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:s}=!0===this.keyboard?{}:this.keyboard,{controllerState:o}=this;let a;const l={};switch(e.srcEvent.code){case"Minus":a=t?o.zoomOut(n).zoomOut(n):o.zoomOut(n),l.isZooming=!0;break;case"Equal":a=t?o.zoomIn(n).zoomIn(n):o.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":t?(a=o.rotateLeft(i),l.isRotating=!0):(a=o.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":t?(a=o.rotateRight(i),l.isRotating=!0):(a=o.moveRight(r),l.isPanning=!0);break;case"ArrowUp":t?(a=o.rotateUp(s),l.isRotating=!0):(a=o.moveUp(r),l.isPanning=!0);break;case"ArrowDown":t?(a=o.rotateDown(s),l.isRotating=!0):(a=o.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?u(u({},t),{},{transitionInterpolator:new zs(u(u(u({},e),t.transitionInterpolator.opts),{},{makeViewport:this.controllerState.makeViewport}))}):t:js}}class Zs{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class Js extends Zs{constructor(e){const{width:t,height:n,latitude:r,longitude:i,zoom:s,bearing:o=0,pitch:a=0,altitude:l=1.5,position:u=[0,0,0],maxZoom:c=20,minZoom:A=0,maxPitch:h=60,minPitch:d=0,startPanLngLat:f,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v,normalize:_=!0}=e;Ls(Number.isFinite(i)),Ls(Number.isFinite(r)),Ls(Number.isFinite(s)),super({width:t,height:n,latitude:r,longitude:i,zoom:s,bearing:o,pitch:a,altitude:l,maxZoom:c,minZoom:A,maxPitch:h,minPitch:d,normalize:_,position:u},{startPanLngLat:f,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v}),this.makeViewport=e.makeViewport}panStart(e){let{pos:t}=e;return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan(e){let{pos:t,startPos:n}=e;const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(r,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(e){let{pos:t}=e;return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(e){let{pos:t,deltaAngleX:n=0,deltaAngleY:r=0}=e;const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||void 0===s||void 0===o)return this;let a;return a=t?this._getNewRotation(t,i,o,s):{bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(e){let{pos:t}=e;return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom(e){let{pos:t,startPos:n,scale:r}=e,{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(t)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=Bn(l,a,o);const c=this.makeViewport(u(u({},this.getViewportProps()),{},{zoom:l}));return this._getUpdatedState(u({zoom:l},c.panByPosition(s,t)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(e)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/e)}moveLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([e,0])}moveRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-e,0])}moveUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,e])}moveDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-e])}rotateLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n=u({},this.getViewportProps()),{bearing:r,longitude:i}=n;return Math.abs(r-t.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-t.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:r}=e;e.zoom=Bn(r,n,t);const{maxPitch:i,minPitch:s,pitch:o}=e;e.pitch=Bn(o,s,i);const{normalize:a=!0}=e;return a&&Object.assign(e,function(e){const{width:t,height:n,pitch:r=0}=e;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=e;(i<-180||i>180)&&(i=zr(i+180,360)-180),(a<-180||a>180)&&(a=zr(a+180,360)-180);const l=Vr(n/512);if(o<=l)o=l,s=0;else{const e=n/2/Math.pow(2,o),t=$r([0,e])[1];if(s<t)s=t;else{const t=$r([0,512-e])[1];s>t&&(s=t)}}return{width:t,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor(u(u(u({makeViewport:this.makeViewport},this.getViewportProps()),this.getState()),e))}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,n,r){const i=e[0]-t[0],s=e[1]-t[1],o=e[1],a=t[1],{width:l,height:u}=this.getViewportProps(),c=i/l;let A=0;s>0?Math.abs(u-a)>5&&(A=s/(a-u)*1.2):s<0&&a>5&&(A=1-o/a),A=Bn(A,-1,1);const{minPitch:h,maxPitch:d}=this.getViewportProps();let f=n;return A>0?f=n+A*(d-n):A<0&&(f=n-A*(h-n)),{pitch:f,bearing:r+180*c}}}class $s extends Ks{constructor(){super(...arguments),this.ControllerState=Js,this.transition={transitionDuration:300,transitionInterpolator:new zs({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e);(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(u(u({makeViewport:this.makeViewport},e),this.state)))}}class eo extends Cs{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getViewportType(){return Ts}get ControllerType(){return $s}}eo.displayName="MapView";const to=eo,no=[255,255,255],ro=1;let io=0;class so{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="ambient";const{color:t=no}=e,{intensity:n=ro}=e;this.id=e.id||"ambient-".concat(io++),this.color=t,this.intensity=n}}const oo=[255,255,255],ao=1,lo=[0,0,-1];let uo=0;class co{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="directional";const{color:t=oo}=e,{intensity:n=ao}=e,{direction:r=lo}=e,{_shadow:i=!1}=e;this.id=e.id||"directional-".concat(uo++),this.color=t,this.intensity=n,this.type="directional",this.direction=new or(r).normalize().toArray(),this.shadow=i}getProjectedLight(e){return this}}class Ao{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"pass"};const{id:n}=t;this.id=n,this.device=e,this.props=u({},t)}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class ho extends Ao{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){var t,n,r;const[i,s]=this.device.canvasContext.getDrawingBufferSize(),o=null===(t=e.clearCanvas)||void 0===t||t,a=null!==(n=e.clearColor)&&void 0!==n?n:!!o&&[0,0,0,0],l=!!o&&1,u=!!o&&0,c=null!==(r=e.colorMask)&&void 0!==r?r:15,A={viewport:[0,0,i,s]};e.colorMask&&(A.colorMask=c),e.scissorRect&&(A.scissorRect=e.scissorRect);const h=this.device.beginRenderPass({framebuffer:e.target,parameters:A,clearColor:a,clearDepth:l,clearStencil:u});try{return this._drawLayers(h,e)}finally{h.end(),this.device.submit()}}_drawLayers(e,t){const{target:n,shaderModuleProps:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0}=t;t.pass=t.pass||"unknown",a&&(this._lastRenderIndex=-1);const l=[];for(const u of i){const i=s&&s[u.id];null===o||void 0===o||o(u);const a=this._getDrawLayerParams(u,t),c=u.subViewports||[u];for(const s of c){const o=this._drawLayersInViewport(e,{target:n,shaderModuleProps:r,viewport:s,view:i,pass:t.pass,layers:t.layers},a);l.push(o)}}return l}_getDrawLayerParams(e,t){let{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,shaderModuleProps:l}=t,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const A=[],h=fo(this._lastRenderIndex+1),d={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},f={};for(let g=0;g<n.length;g++){const t=n[g],i=this._shouldDrawLayer(t,d,s,f),o={shouldDrawLayer:i};var p;if(i&&!c)o.shouldDrawLayer=!0,o.layerRenderIndex=h(t,i),o.shaderModuleProps=this._getShaderModuleProps(t,a,r,l),o.layerParameters=u(u({},null===(p=t.context.deck)||void 0===p?void 0:p.props.parameters),this.getLayerParameters(t,g,e));A[g]=o}return A}_drawLayersInViewport(e,t,n){let{layers:r,shaderModuleProps:i,pass:s,target:o,viewport:a,view:l}=t;const u=function(e,t){var n,r;let{shaderModuleProps:i,target:s,viewport:o}=t;const a=null!==(n=null===i||void 0===i||null===(r=i.project)||void 0===r?void 0:r.devicePixelRatio)&&void 0!==n?n:e.canvasContext.cssToDeviceRatio(),[,l]=e.canvasContext.getDrawingBufferSize(),u=s?s.height:l,c=o;return[c.x*a,u-(c.y+c.height)*a,c.width*a,c.height*a]}(this.device,{shaderModuleProps:i,target:o,viewport:a});if(l&&l.props.clear){const e=!0===l.props.clear?{color:!0,depth:!0}:l.props.clear;this.device.beginRenderPass({framebuffer:o,parameters:{viewport:u,scissorRect:u},clearColor:!!e.color&&[0,0,0,0],clearDepth:!!e.depth&&1}).end()}const c={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:u});for(let h=0;h<r.length;h++){const t=r[h],i=n[h],{shouldDrawLayer:o}=i;if(o&&t.props.pickable&&c.pickableCount++,t.isComposite&&c.compositeCount++,t.isDrawable&&i.shouldDrawLayer){const{layerRenderIndex:n,shaderModuleProps:r,layerParameters:o}=i;c.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,n),r.project&&(r.project.viewport=a),t.context.renderPass=e;try{t._drawLayer({renderPass:e,shaderModuleProps:r,uniforms:{layerIndex:n},parameters:o})}catch(A){t.raiseError(A,"drawing ".concat(t," to ").concat(s))}}}return c}shouldDrawLayer(e){return!0}getShaderModuleProps(e,t,n){return null}getLayerParameters(e,t,n){return e.props.parameters}_shouldDrawLayer(e,t,n,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let i=e.parent;for(;i;){if(!i.props.visible||!i.filterSubLayer(t))return!1;t.layer=i,i=i.parent}if(n){const e=t.layer.id;if(e in r||(r[e]=n(t)),!r[e])return!1}return e.activateViewport(t.viewport),!0}_getShaderModuleProps(e,t,n,r){var i;const s=this.device.canvasContext.cssToDeviceRatio(),o=(null===(i=e.internalState)||void 0===i?void 0:i.propsInTransition)||e.props,a={layer:o,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:s,modelMatrix:o.modelMatrix,coordinateSystem:o.coordinateSystem,coordinateOrigin:o.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(t)for(const u of t){var l;po(a,null===(l=u.getShaderModuleProps)||void 0===l?void 0:l.call(u,e,a))}return po(a,this.getShaderModuleProps(e,t,a),r)}}function fo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let u;if(l&&!(l in t)&&r(i.parent,!1),l in n){const e=n[l]=n[l]||fo(t[l],t);u=e(i,s),n[a]=e}else Number.isFinite(o)?(u=o+(t[l]||0),n[a]=null):u=e;return s&&u>=e&&(e=u+1),t[a]=u,u};return r}function po(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)if(i)for(const t in i)e[t]?Object.assign(e[t],i[t]):e[t]=i[t];return e}class go extends ho{constructor(e,t){super(e,t);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),r=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:r})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const t=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),r=e.viewports[0],i=r.width*n,s=r.height*n;i===t.width&&s===t.height||t.resize({width:i,height:s}),super.render(u(u({},e),{},{clearColor:[1,1,1,1],target:t,pass:"shadow"}))}getLayerParameters(e,t,n){return u(u({},e.props.parameters),{},{blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getShaderModuleProps(e,t,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}const mo={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n\n// All these functions are for substituting tan() function from Intel GPU only\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n\n    // 2pi range reduction\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n"};function yo(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}function vo(e){let t,n={};return r=>{for(const i in r)if(!yo(r[i],n[i])){t=e(r),n=r;break}return t}}const _o=[0,0,0,0],bo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],wo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Eo=[0,0,0],xo=[0,0,0],Do=vo(function(e){let{viewport:t,devicePixelRatio:n,coordinateSystem:r,coordinateOrigin:i}=e;const{projectionCenter:s,viewProjectionMatrix:o,originCommon:a,cameraPosCommon:l,shaderCoordinateOrigin:u,geospatialOrigin:c}=function(e,t,n){const{viewMatrixUncentered:r,projectionMatrix:i}=e;let{viewMatrix:s,viewProjectionMatrix:o}=e,a=_o,l=_o,u=e.cameraPosition;const{geospatialOrigin:c,shaderCoordinateOrigin:A,offsetMode:h}=Co(e,t,n);h&&(l=e.projectPosition(c||A),u=[u[0]-l[0],u[1]-l[1],u[2]-l[2]],l[3]=1,a=Tr([],l,o),s=r||s,o=pr([],i,s),o=pr([],o,bo));return{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:u,shaderCoordinateOrigin:A,geospatialOrigin:c}}(t,r,i),A=t.getDistanceScales(),h=[t.width*n,t.height*n],d=Tr([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,f={coordinateSystem:r,projectionMode:t.projectionMode,coordinateOrigin:u,commonOrigin:a.slice(0,3),center:s,pseudoMeters:Boolean(t._pseudoMeters),viewportSize:h,devicePixelRatio:n,focalDistance:d,commonUnitsPerMeter:A.unitsPerMeter,commonUnitsPerWorldUnit:A.unitsPerMeter,commonUnitsPerWorldUnit2:Eo,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:o,modelMatrix:wo,cameraPosition:l};if(c){const e=t.getDistanceScales(c);switch(r){case us.METER_OFFSETS:f.commonUnitsPerWorldUnit=e.unitsPerMeter,f.commonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case us.LNGLAT:case us.LNGLAT_OFFSETS:t._pseudoMeters||(f.commonUnitsPerMeter=e.unitsPerMeter),f.commonUnitsPerWorldUnit=e.unitsPerDegree,f.commonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case us.CARTESIAN:f.commonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],f.commonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return f});function Co(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xo;n.length<3&&(n=[n[0],n[1],0]);let r,i=n,s=!0;switch(r=t===us.LNGLAT_OFFSETS||t===us.METER_OFFSETS?n:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case cs.WEB_MERCATOR:t!==us.LNGLAT&&t!==us.CARTESIAN||(r=[0,0,0],s=!1);break;case cs.WEB_MERCATOR_AUTO_OFFSET:t===us.LNGLAT?i=r:t===us.CARTESIAN&&(i=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],r=e.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case cs.IDENTITY:i=e.position.map(Math.fround),i[2]=i[2]||0;break;case cs.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}const So=Object.keys(us).map(e=>"const COORDINATE_SYSTEM_".concat(e,": i32 = ").concat(us[e],";")).join(""),To=Object.keys(cs).map(e=>"const PROJECTION_MODE_".concat(e,": i32 = ").concat(cs[e],";")).join(""),Io=Object.keys(As).map(e=>"const UNIT_".concat(e.toUpperCase(),": i32 = ").concat(As[e],";")).join(""),Fo="".concat(So,"\n").concat(To,"\n").concat(Io,'\n\nconst TILE_SIZE: f32 = 512.0;\nconst PI: f32 = 3.1415926536;\nconst WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);\nconst ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);\nconst EARTH_RADIUS: f32 = 6370972.0; // meters\nconst GLOBE_RADIUS: f32 = 256.0;\n\n// -----------------------------------------------------------------------------\n// Uniform block (converted from GLSL uniform block)\n// -----------------------------------------------------------------------------\nstruct ProjectUniforms {\n  wrapLongitude: i32,\n  coordinateSystem: i32,\n  commonUnitsPerMeter: vec3<f32>,\n  projectionMode: i32,\n  scale: f32,\n  commonUnitsPerWorldUnit: vec3<f32>,\n  commonUnitsPerWorldUnit2: vec3<f32>,\n  center: vec4<f32>,\n  modelMatrix: mat4x4<f32>,\n  viewProjectionMatrix: mat4x4<f32>,\n  viewportSize: vec2<f32>,\n  devicePixelRatio: f32,\n  focalDistance: f32,\n  cameraPosition: vec3<f32>,\n  coordinateOrigin: vec3<f32>,\n  commonOrigin: vec3<f32>,\n  pseudoMeters: i32,\n};\n\n@group(0) @binding(0)\nvar<uniform> project: ProjectUniforms;\n\n// -----------------------------------------------------------------------------\n// Geometry data\n// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,\n// you might supply this via vertex attributes or a uniform. Here we define a\n// uniform struct for demonstration.)\n// -----------------------------------------------------------------------------\n\n// Structure to carry additional geometry data used by deck.gl filters.\nstruct Geometry {\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  position: vec4<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\n// @group(0) @binding(1)\nvar<private> geometry: Geometry;\n'),Ro="".concat(Fo,'\n\n// -----------------------------------------------------------------------------\n// Functions\n// -----------------------------------------------------------------------------\n\n// Returns an adjustment factor for commonUnitsPerMeter\nfn _project_size_at_latitude(lat: f32) -> f32 {\n  let y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\n// Overloaded version: scales a value in meters at a given latitude.\nfn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);\n}\n\n// Computes a non-linear scale factor based on geometry.\n// (Note: This function relies on "geometry" being provided.)\nfn project_size() -> f32 {\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n      project.pseudoMeters == 0) {\n    if (geometry.position.w == 0.0) {\n      return _project_size_at_latitude(geometry.worldPosition.y);\n    }\n    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    let y2 = y * y;\n    let y4 = y2 * y2;\n    let y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\n// Overloads to scale offsets (meters to world units)\nfn project_size_float(meters: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * project_size();\n}\n\nfn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {\n  return meters * project.commonUnitsPerMeter.xy * project_size();\n}\n\nfn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {\n  return meters * project.commonUnitsPerMeter * project_size();\n}\n\nfn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {\n  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\n\n// Returns a rotation matrix aligning the z\u2011axis with the given up vector.\nfn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {\n  let uz = normalize(up);\n  let ux = select(\n    vec3<f32>(1.0, 0.0, 0.0),\n    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),\n    abs(uz.z) == 1.0\n  );\n  let uy = cross(uz, ux);\n  return mat3x3<f32>(ux, uy, uz);\n}\n\n// Since WGSL does not support "out" parameters, we return a struct.\nstruct RotationResult {\n  needsRotation: bool,\n  transform: mat3x3<f32>,\n};\n\nfn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    return RotationResult(true, project_get_orientation_matrix(commonPosition));\n  } else {\n    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed\n  };\n}\n\n// Projects a normal vector from the current coordinate system to world space.\nfn project_normal(vector: vec3<f32>) -> vec3<f32> {\n  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);\n  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\n  let rotResult = project_needs_rotation(geometry.position.xyz);\n  if (rotResult.needsRotation) {\n    n = rotResult.transform * n;\n  }\n  return n;\n}\n\n// Applies a scale offset based on y-offset (dy)\nfn project_offset_(offset: vec4<f32>) -> vec4<f32> {\n  let dy: f32 = offset.y;\n  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\n  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n// Projects lng/lat coordinates to a unit tile [0,1]\nfn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {\n  var x = lnglat.x;\n  if (project.wrapLongitude != 0) {\n    x = ((x + 180.0) % 360.0) - 180.0;\n  }\n  let y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2<f32>(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// Projects lng/lat/z coordinates for a globe projection.\nfn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {\n  let lambda = radians(lnglatz.x);\n  let phi = radians(lnglatz.y);\n  let cosPhi = cos(phi);\n  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n  return vec3<f32>(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n// Projects positions (with an optional 64-bit low part) from the input\n// coordinate system to the common space.\nfn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {\n  var position_world = project.modelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug:\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_mercator_(position_world.xy),\n        _project_size_at_latitude_m(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\n        return vec4<f32>(\n          project_mercator_(position_world.xy) - project.commonOrigin.xy,\n          project_size_float(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);\n  }\n\n  return project_offset_(position_world) +\n         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));\n}\n\n// Overloaded versions for different input types.\nfn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {\n  return project_position_vec4_f64(position, ZERO_64_LOW);\n}\n\nfn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nfn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nfn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\n// Transforms a common space position to clip space.\nfn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {\n  return viewProjectionMatrix * position + center;\n}\n\n// Uses the project viewProjectionMatrix and center.\nfn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {\n  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);\n}\n\n// Returns a clip space offset corresponding to a given number of screen pixels.\nfn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {\n  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\n  return offset * project.focalDistance;\n}\n\nfn project_meter_size_to_pixel(meters: f32) -> f32 {\n  return project_size_float(meters) * project.scale;\n}\n\nfn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {\n  if (unit == UNIT_METERS) {\n    return project_meter_size_to_pixel(size);\n  } else if (unit == UNIT_COMMON) {\n    return size * project.scale;\n  }\n  // UNIT_PIXELS: no scaling applied.\n  return size;\n}\n\nfn project_pixel_size_float(pixels: f32) -> f32 {\n  return pixels / project.scale;\n}\n\nfn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {\n  return pixels / project.scale;\n}\n'),ko=Object.keys(us).map(e=>"const int COORDINATE_SYSTEM_".concat(e," = ").concat(us[e],";")).join(""),Po=Object.keys(cs).map(e=>"const int PROJECTION_MODE_".concat(e," = ").concat(cs[e],";")).join(""),Mo=Object.keys(As).map(e=>"const int UNIT_".concat(e.toUpperCase()," = ").concat(As[e],";")).join(""),Bo="".concat(ko,"\n").concat(Po,"\n").concat(Mo,"\nuniform projectUniforms {\nbool wrapLongitude;\nint coordinateSystem;\nvec3 commonUnitsPerMeter;\nint projectionMode;\nfloat scale;\nvec3 commonUnitsPerWorldUnit;\nvec3 commonUnitsPerWorldUnit2;\nvec4 center;\nmat4 modelMatrix;\nmat4 viewProjectionMatrix;\nvec2 viewportSize;\nfloat devicePixelRatio;\nfloat focalDistance;\nvec3 cameraPosition;\nvec3 coordinateOrigin;\nvec3 commonOrigin;\nbool pseudoMeters;\n} project;\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\nfloat y = clamp(lat, -89.9, 89.9);\nreturn 1.0 / cos(radians(y));\n}\nfloat project_size() {\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\nproject.pseudoMeters == false) {\nif (geometry.position.w == 0.0) {\nreturn project_size_at_latitude(geometry.worldPosition.y);\n}\nfloat y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\nfloat y2 = y * y;\nfloat y4 = y2 * y2;\nfloat y6 = y4 * y2;\nreturn 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n}\nreturn 1.0;\n}\nfloat project_size_at_latitude(float meters, float lat) {\nreturn meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\nreturn meters * project.commonUnitsPerMeter.z * project_size();\n}\nvec2 project_size(vec2 meters) {\nreturn meters * project.commonUnitsPerMeter.xy * project_size();\n}\nvec3 project_size(vec3 meters) {\nreturn meters * project.commonUnitsPerMeter * project_size();\n}\nvec4 project_size(vec4 meters) {\nreturn vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\nvec3 uz = normalize(up);\nvec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\nvec3 uy = cross(uz, ux);\nreturn mat3(ux, uy, uz);\n}\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\ntransform = project_get_orientation_matrix(commonPosition);\nreturn true;\n}\nreturn false;\n}\nvec3 project_normal(vec3 vector) {\nvec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);\nvec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\nmat3 rotation;\nif (project_needs_rotation(geometry.position.xyz, rotation)) {\nn = rotation * n;\n}\nreturn n;\n}\nvec4 project_offset_(vec4 offset) {\nfloat dy = offset.y;\nvec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\nreturn vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\nfloat x = lnglat.x;\nif (project.wrapLongitude) {\nx = mod(x + 180., 360.0) - 180.;\n}\nfloat y = clamp(lnglat.y, -89.9, 89.9);\nreturn vec2(\nradians(x) + PI,\nPI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n) * WORLD_SCALE;\n}\nvec3 project_globe_(vec3 lnglatz) {\nfloat lambda = radians(lnglatz.x);\nfloat phi = radians(lnglatz.y);\nfloat cosPhi = cos(phi);\nfloat D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\nreturn vec3(\nsin(lambda) * cosPhi,\n-cos(lambda) * cosPhi,\nsin(phi)\n) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\nvec4 position_world = project.modelMatrix * position;\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_mercator_(position_world.xy),\nproject_size_at_latitude(position_world.z, position_world.y),\nposition_world.w\n);\n}\nif (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\nposition_world.xyz += project.coordinateOrigin;\n}\n}\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_globe_(position_world.xyz),\nposition_world.w\n);\n}\n}\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nif (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\nreturn vec4(\nproject_mercator_(position_world.xy) - project.commonOrigin.xy,\nproject_size(position_world.z),\nposition_world.w\n);\n}\n}\n}\nif (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\nposition_world.xyz -= project.coordinateOrigin;\n}\nreturn project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));\n}\nvec4 project_position(vec4 position) {\nreturn project_position(position, ZERO_64_LOW);\n}\nvec3 project_position(vec3 position, vec3 position64Low) {\nvec4 projected_position = project_position(vec4(position, 1.0), position64Low);\nreturn projected_position.xyz;\n}\nvec3 project_position(vec3 position) {\nvec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\nreturn projected_position.xyz;\n}\nvec2 project_position(vec2 position) {\nvec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\nreturn projected_position.xy;\n}\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\nreturn viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\nreturn project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\nvec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\nreturn offset * project.focalDistance;\n}\nfloat project_size_to_pixel(float meters) {\nreturn project_size(meters) * project.scale;\n}\nfloat project_size_to_pixel(float size, int unit) {\nif (unit == UNIT_METERS) return project_size_to_pixel(size);\nif (unit == UNIT_COMMON) return size * project.scale;\nreturn size;\n}\nfloat project_pixel_size(float pixels) {\nreturn pixels / project.scale;\n}\nvec2 project_pixel_size(vec2 pixels) {\nreturn pixels / project.scale;\n}\n"),Lo={};const Oo={name:"project",dependencies:[mo,q],source:Ro,vs:Bo,getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lo;return"viewport"in e?function(e){let{viewport:t,devicePixelRatio:n=1,modelMatrix:r=null,coordinateSystem:i=us.DEFAULT,coordinateOrigin:s=xo,autoWrapLongitude:o=!1}=e;i===us.DEFAULT&&(i=t.isGeospatial?us.LNGLAT:us.CARTESIAN);const a=Do({viewport:t,devicePixelRatio:n,coordinateSystem:i,coordinateOrigin:s});return a.wrapLongitude=o,a.modelMatrix=r||wo,a}(e):{}},uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},No="\nuniform shadowUniforms {\n  bool drawShadowMap;\n  bool useShadowMap;\n  vec4 color;\n  highp int lightId;\n  float lightCount;\n  mat4 viewProjectionMatrix0;\n  mat4 viewProjectionMatrix1;\n  vec4 projectCenter0;\n  vec4 projectCenter1;\n} shadow;\n",Uo="\n".concat(No,"\n").concat("\nconst int max_lights = 2;\n\nout vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  mat4 viewProjectionMatrices[max_lights];\n  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;\n  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;\n  vec4 projectCenters[max_lights];\n  projectCenters[0] = shadow.projectCenter0;\n  projectCenters[1] = shadow.projectCenter1;\n\n  if (shadow.drawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);\n  }\n  if (shadow.useShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow.lightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n","\n"),zo="\n".concat(No,"\n").concat("\nconst int max_lights = 2;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\n\nin vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow.drawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow.useShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow.lightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow.color.a / shadow.lightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n","\n"),jo=vo(function(e){let{viewport:t,center:n}=e;return new Br(t.viewProjectionMatrix).invert().transform(n)}),Vo=vo(function(e){let{viewport:t,shadowMatrices:n}=e;const r=[],i=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,o=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(e=>function(e,t){const[n,r,i]=e,s=li([n,r,i],t);if(Number.isFinite(i))return s;return[s[0],s[1],0]}(e,i));for(const a of n){const e=a.clone().translate(new or(t.center).negate()),n=o.map(t=>e.transform(t)),i=(new Br).ortho({left:Math.min(...n.map(e=>e[0])),right:Math.max(...n.map(e=>e[0])),bottom:Math.min(...n.map(e=>e[1])),top:Math.max(...n.map(e=>e[1])),near:Math.min(...n.map(e=>-e[2])),far:Math.max(...n.map(e=>-e[2]))});r.push(i.multiplyRight(a))}return r}),Go=[0,0,0,1],Wo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const Ho={name:"shadow",dependencies:[Oo],vs:Uo,fs:zo,inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(e){const{shadowEnabled:t=!0,project:n}=e;if(!t||!n||!e.shadowMatrices||!e.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};const r=Oo.getUniforms(n),i=jo({viewport:n.viewport,center:r.center}),s=[],o=Vo({shadowMatrices:e.shadowMatrices,viewport:n.viewport}).slice();for(let l=0;l<e.shadowMatrices.length;l++){const e=o[l],t=e.clone().translate(new or(n.viewport.center).negate());r.coordinateSystem===us.LNGLAT&&r.projectionMode===cs.WEB_MERCATOR?(o[l]=t,s[l]=i):(o[l]=e.clone().multiplyRight(Wo),s[l]=t.transform(i))}const a={drawShadowMap:Boolean(e.drawToShadowMap),useShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,color:e.shadowColor||Go,lightId:e.shadowLightId||0,lightCount:e.shadowMatrices.length,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};for(let l=0;l<o.length;l++)a["viewProjectionMatrix".concat(l)]=o[l],a["projectCenter".concat(l)]=s[l];for(let l=0;l<2;l++)a["shadow_uShadowMap".concat(l)]=e.shadowMaps&&e.shadowMaps[l]||e.dummyShadowMap;return a},uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},Qo={color:[255,255,255],intensity:1},Xo=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Yo=[0,0,0,200/255];class qo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id="lighting-effect",this.shadowColor=Yo,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),n._addDefaultShaderModule(Ho),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(e=>e.shadow),this.context&&this.setup(this.context),this.props=e}preRender(e){let{layers:t,layerFilter:n,viewports:r,onViewportActive:i,views:s}=e;if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let e=0;e<this.shadowPasses.length;e++){this.shadowPasses[e].render({layers:t,layerFilter:n,viewports:r,onViewportActive:i,views:s,shaderModuleProps:{shadow:{shadowLightId:e,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}}getShaderModuleProps(e,t){const n=this.shadow?{project:t.project,shadowMaps:this.shadowPasses.map(e=>e.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},r={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(t=>t.getProjectedLight({layer:e})),pointLights:this.pointLights.map(t=>t.getProjectedLight({layer:e}))},i=e.props.material;return{shadow:n,lighting:r,phongMaterial:i,gouraudMaterial:i}}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(Ho))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const n=(new Br).lookAt({eye:new or(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new go(e);this.shadowPasses[t]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;e||0!==t.length||0!==n.length||(this.ambientLight=new so(Qo),this.directionalLights.push(new co(Xo[0]),new co(Xo[1])))}}const Ko=new qo;class Zo{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(t=>t.id===e.id)){const n=t.findIndex(t=>function(e,t){var n,r;return(null!==(n=e.order)&&void 0!==n?n:1/0)-(null!==(r=t.order)&&void 0!==r?r:1/0)}(t,e)>0);n<0?t.push(e):t.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(bs(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const r of this.effects)t[r.id]=r;const n=[];for(const r of e){const e=t[r.id];let i=r;e&&e!==r?e.setProps?(e.setProps(r.props),i=e):e.cleanup(this._context):e||r.setup(this._context),n.push(i),delete t[r.id]}for(const r in t)t[r].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(e=>e instanceof qo)||this._resolvedEffects.push(Ko),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class Jo extends ho{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const $o={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class ea extends ho{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer(e){let{layers:t,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:u,height:c},cullRect:A,effects:h,pass:d="picking",pickZ:f,shaderModuleProps:p}=e;this.pickZ=f;const g=this._resetColorEncoder(f),m=[a,l,u,c],y=super.render({target:o,layers:t,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:A,effects:null===h||void 0===h?void 0:h.filter(e=>e.useInPicking),pass:d,isPicking:!0,shaderModuleProps:p,clearColor:[0,0,0,0],colorMask:15,scissorRect:m});this._colorEncoderState=null;return{decodePickingColor:g&&ta.bind(null,g),stats:y}}shouldDrawLayer(e){const{pickable:t,operation:n}=e.props;return t&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,t,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,t,n){const r=u({},e.props.parameters),{pickable:i,operation:s}=e.props;return!this._colorEncoderState||s.includes("terrain")?r.blend=!1:i&&s.includes("draw")&&(Object.assign(r,$o),r.blend=!0,r.blendColor=function(e,t,n){const{byLayer:r,byAlpha:i}=e;let s,o=r.get(t);o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:t,viewports:[n]},r.set(t,o),i[s]=o):(Me.warn("Too many pickable layers, only picking the first 255")(),s=0));return[0,0,0,s/255]}(this._colorEncoderState,e,n)),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function ta(e,t){const n=e.byAlpha[t[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(t)}}class na{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new Jo(e),this.pickLayersPass=new ea(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n=u({layerFilter:this.layerFilter,isPicking:this.drawPickingColors},e);n.effects&&this._preRender(n.effects,n);const r=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const i=t.render(u(u({},n),{},{target:r}));n.effects&&this._postRender(n.effects,n),this.renderCount++,Oe("deckRenderer.renderLayers",this,i,e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const n of e)t.preRenderStats[n.id]=n.preRender(t),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize();0===e.length&&[0,1].map(t=>{const n=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:"deck-renderbuffer-".concat(t),colorAttachments:[n]}))});for(const n of e)n.resize(t)}_postRender(e,t){const{renderBuffers:n}=this,r=u(u({},t),{},{inputBuffer:n[0],swapBuffer:n[1]});for(const i of e)if(i.postRender){r.target=i.id===this.lastPostProcessEffect?t.target:void 0;const e=i.postRender(r);r.inputBuffer=e,r.swapBuffer=e===n[0]?n[1]:n[0]}}}const ra={pickedColor:null,pickedObjectIndex:-1};function ia(e){let{pickedColors:t,decodePickingColor:n,deviceX:r,deviceY:i,deviceRadius:s,deviceRect:o}=e;const{x:a,y:l,width:c,height:A}=o;let h=s*s,d=-1,f=0;for(let u=0;u<A;u++){const e=u+l-i,n=e*e;if(n>h)f+=4*c;else for(let i=0;i<c;i++){if(t[f+3]-1>=0){const e=i+a-r,t=e*e+n;t<=h&&(h=t,d=f)}f+=4}}if(d>=0){const e=t.slice(d,d+4),r=n(e);if(r){const t=Math.floor(d/4/c),n=d/4-t*c;return u(u({},r),{},{pickedColor:e,pickedX:a+n,pickedY:l+t})}Me.error("Picked non-existent layer. Is picking buffer corrupt?")()}return ra}function sa(e){let t,{pickInfo:n,viewports:r,pixelRatio:i,x:s,y:o,z:a}=e,l=r[0];if(r.length>1&&(l=function(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.containsPixel(t))return r}return e[0]}((null===n||void 0===n?void 0:n.pickedViewports)||r,{x:s,y:o})),l){const e=[s-l.x,o-l.y];void 0!==a&&(e[2]=a),t=l.unproject(e)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:t,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:i}}function oa(e){const{pickInfo:t,lastPickedInfo:n,mode:r,layers:i}=e,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=t,l=o?[o]:[];if("hover"===r){const e=n.index,t=n.layerId,r=o?o.props.id:null;if(r!==t||a!==e){if(r!==t){const e=i.find(e=>e.props.id===t);e&&l.unshift(e)}n.layerId=r,n.index=a,n.info=null}}const c=sa(e),A=new Map;return A.set(null,c),l.forEach(e=>{let t=u({},c);e===o&&(t.color=s,t.index=a,t.picked=!0),t=aa({layer:e,info:t,mode:r});const i=t.layer;e===o&&"hover"===r&&(n.info=t),A.set(i.id,t),"hover"===r&&i.updateAutoHighlight(t)}),A}function aa(e){let{layer:t,info:n,mode:r}=e;for(;t&&n;){const e=n.layer||null;n.sourceLayer=e,n.layer=t,n=t.getPickingInfo({info:n,mode:r,sourceLayer:e}),t=t.parent}return n}class la{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new ea(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject(e){let{x:t,y:n,layers:r,viewports:i}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info;const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(e=>e.id===o):null,c=a&&i.find(e=>e.id===a)||i[0],A=c&&c.unproject([t-c.x,n-c.y]),h={x:t,y:n,viewport:c,coordinate:A,layer:l};return u(u({},s),h)}_resizeBuffer(){var e,t;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const e=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=e}const{canvas:n}=this.device.getDefaultCanvasContext();null===(e=this.pickingFBO)||void 0===e||e.resize({width:n.width,height:n.height}),null===(t=this.depthFBO)||void 0===t||t.resize({width:n.width,height:n.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(e=>this.pickLayersPass.shouldDrawLayer(e)&&!e.isComposite);return t.length?t:null}_pickClosestObject(e){let{layers:t,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:A,effects:h}=e;const d=this.device.canvasContext.cssToDeviceRatio(),f=this._getPickable(t);if(!f||0===r.length)return{result:[],emptyInfo:sa({viewports:r,x:i,y:s,pixelRatio:d})};this._resizeBuffer();const p=this.device.canvasContext.cssToDevicePixels([i,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*d),{width:y,height:v}=this.pickingFBO,_=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:y,deviceHeight:v}),b={x:i-o,y:s-o,width:2*o+1,height:2*o+1};let w;const E=[],x=new Set;for(let D=0;D<a;D++){let e,t;if(_){e=ia(u(u({},this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:A,deviceRect:_,cullRect:b,effects:h,pass:"picking:".concat(l)})),{},{deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:_}))}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&c&&this.depthFBO){const{pickedColors:i}=this._drawAndSample({layers:[e.pickedLayer],views:n,viewports:r,onViewportActive:A,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:b,effects:h,pass:"picking:".concat(l,":z")},!0);i[3]&&(t=i[0])}e.pickedLayer&&D+1<a&&(x.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),w=oa({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:l,layers:f,viewports:r,x:i,y:s,z:t,pixelRatio:d});for(const n of w.values())n.layer&&E.push(n);if(!e.pickedColor)break}for(const u of x)u.restorePickingColors();return{result:E,emptyInfo:w.get(null)}}_pickVisibleObjects(e){let{layers:t,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:A,effects:h}=e;const d=this._getPickable(t);if(!d||0===r.length)return[];this._resizeBuffer();const f=this.device.canvasContext.cssToDeviceRatio(),p=this.device.canvasContext.cssToDevicePixels([i,s],!0),g=p.x,m=p.y+p.height,y=this.device.canvasContext.cssToDevicePixels([i+o,s+a],!0),v=y.x+y.width,_=y.y,b={x:g,y:_,width:v-g,height:m-_},w=function(e){let{pickedColors:t,decodePickingColor:n}=e;const r=new Map;if(t)for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const e=t.slice(i,i+4),s=e.join(",");if(!r.has(s)){const t=n(e);t?r.set(s,u(u({},t),{},{color:e})):Me.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(r.values())}(this._drawAndSample({layers:d,views:n,viewports:r,onViewportActive:A,deviceRect:b,cullRect:{x:i,y:s,width:o,height:a},effects:h,pass:"picking:".concat(l)})),E=new Map,x=[],D=Number.isFinite(c);for(let u=0;u<w.length;u++){var C;if(D&&x.length>=c)break;const e=w[u];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:f};t=aa({layer:e.pickedLayer,info:t,mode:l});const n=t.layer.id;E.has(n)||E.set(n,new Set);const r=E.get(n),o=null!==(C=t.object)&&void 0!==C?C:t.index;r.has(o)||(r.add(o),x.push(t))}return x}_drawAndSample(e){let{layers:t,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l}=e,u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const c=u?this.depthFBO:this.pickingFBO,A={layers:t,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:c,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:u,preRenderStats:{},isPicking:!0};for(const y of a)y.useInPicking&&(A.preRenderStats[y.id]=y.preRender(A));const{decodePickingColor:h}=this.pickLayersPass.render(A),{x:d,y:f,width:p,height:g}=s,m=new(u?Float32Array:Uint8Array)(p*g*4);return this.device.readPixelsToArrayWebGL(c,{sourceX:d,sourceY:f,sourceWidth:p,sourceHeight:g,target:m}),{pickedColors:m,decodePickingColor:h}}_getPickingRect(e){let{deviceX:t,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}=e;const o=Math.max(0,t-r),a=Math.max(0,n-r),l=Math.min(i,t+r+1)-o,u=Math.min(s,n+r+1)-a;return l<=0||u<=0?null:{x:o,y:a,width:l,height:u}}}const ua={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},ca="top-left",Aa="__root";class ha{constructor(e){let{deck:t,parentElement:n}=e;this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=t,this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!bs(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(t=>t.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const t={};for(const n of this.resolvedWidgets)t[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)t[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const e=t[n.id];e?e.viewId!==n.viewId||e.placement!==n.placement?(this._remove(e),this._add(n)):n!==e&&(e.setProps(n.props),n=e):this._add(n),t[n.id]=null,this.resolvedWidgets.push(n)}for(const n in t){const e=t[n];e&&this._remove(e)}this.widgets=e}_add(e){const{viewId:t=null,placement:n=ca}=e,r=e.onAdd({deck:this.deck,viewId:t});r&&this._getContainer(t,n).append(r),e._element=r}_remove(e){var t;null===(t=e.onRemove)||void 0===t||t.call(e),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,t){const n=e||Aa;let r=this.containers[n];var i;r||(r=document.createElement("div"),r.style.pointerEvents="none",r.style.position="absolute",r.style.overflow="hidden",null===(i=this.parentElement)||void 0===i||i.append(r),this.containers[n]=r);let s=r.querySelector(".".concat(t));return s||(s=document.createElement("div"),s.className=t,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,ua[t]),r.append(s)),s}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const n in this.containers){const r=this.lastViewports[n]||null,i=n===Aa||r,s=this.containers[n];i?(s.style.display="block",s.style.left="".concat(r?r.x:0,"px"),s.style.top="".concat(r?r.y:0,"px"),s.style.width="".concat(r?r.width:e,"px"),s.style.height="".concat(r?r.height:t,"px")):s.style.display="none"}}onRedraw(e){let{viewports:t,layers:n}=e;const r=t.reduce((e,t)=>(e[t.id]=t,e),{});for(const o of this.getWidgets()){const{viewId:e}=o;if(e){const t=r[e];var i;if(t)o.onViewportChange&&o.onViewportChange(t),null===(i=o.onRedraw)||void 0===i||i.call(o,{viewports:[t],layers:n})}else{var s;if(o.onViewportChange)for(const e of t)o.onViewportChange(e);null===(s=o.onRedraw)||void 0===s||s.call(o,{viewports:t,layers:n})}}this.lastViewports=r,this._updateContainers()}onHover(e,t){for(const i of this.getWidgets()){var n;const{viewId:s}=i;var r;if(!s||s===(null===(n=e.viewport)||void 0===n?void 0:n.id))null===(r=i.onHover)||void 0===r||r.call(i,e,t)}}onEvent(e,t){const n=hs[t.type];if(n)for(const s of this.getWidgets()){var r;const{viewId:o}=s;var i;if(!o||o===(null===(r=e.viewport)||void 0===r?void 0:r.id))null===(i=s[n])||void 0===i||i.call(s,e,t)}}}const da={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class fa{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd(e){let{deck:t}=e;const n=document.createElement("div");return n.className="deck-tooltip",Object.assign(n.style,da),this.deck=t,this.element=n,n}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){var t;this.isVisible&&e.id===(null===(t=this.lastViewport)||void 0===t?void 0:t.id)&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:t}=this,n=t&&t.props.getTooltip;if(!n)return;const r=n(e);this.lastViewport=e.viewport,this.setTooltip(r,e.x,e.y)}setTooltip(e,t,n){const r=this.element;if(r){if("string"===typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(n,"px)"),e&&"object"===typeof e&&"style"in e&&Object.assign(r.style,e.style)}}}var pa;const ga=null===(pa=globalThis.loaders)||void 0===pa?void 0:pa.parseImageNode,ma="undefined"!==typeof Image,ya="undefined"!==typeof ImageBitmap,va=Boolean(ga),_a=!!gt||va;function ba(e){const t=Ea(e);if(!t)throw new Error("Not an image");return t}function wa(e){switch(ba(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function Ea(e){return"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&e instanceof Image?"image":e&&"object"===typeof e&&e.data&&e.width&&e.height?"data":null}const xa=/^data:image\/svg\+xml/,Da=/\.svg((\?|#).*)?$/;function Ca(e){return e&&(xa.test(e)||Da.test(e))}function Sa(e,t){if(Ca(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function Ta(e,t,n){const r=function(e,t){if(Ca(t)){let t=(new TextDecoder).decode(e);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(n){throw new Error(n.message)}return"data:image/svg+xml;base64,".concat(btoa(t))}return Sa(e,t)}(e,n),i=self.URL||self.webkitURL,s="string"!==typeof r&&i.createObjectURL(r);try{return await async function(e,t){const n=new Image;if(n.src=e,t.image&&t.image.decode&&n.decode)return await n.decode(),n;return await new Promise((e,t)=>{try{n.onload=()=>e(n),n.onerror=e=>{const n=e instanceof Error?e.message:"error";t(new Error(n))}}catch(r){t(r)}})}(s||r,t)}finally{s&&i.revokeObjectURL(s)}}const Ia={};let Fa=!0;async function Ra(e,t,n){let r;if(Ca(n)){r=await Ta(e,t,n)}else r=Sa(e,n);const i=t&&t.imagebitmap;return await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e){for(const t in e||Ia)return!1;return!0}(t)&&Fa||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(n){console.warn(n),Fa=!1}return await createImageBitmap(e)}(r,i)}function ka(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=function(e){return[...e].map(e=>e.charCodeAt(0))}(t);for(let i=0;i<r.length;++i)if(r[i]!==e[i+n])return!1;return!0}(e,"ftyp",4)?0===(96&e[8])?null:function(e){switch(function(e,t,n){return String.fromCharCode(...e.slice(t,n))}(e,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}(e):null}const Pa=!1,Ma=!0;function Ba(e){const t=La(e);return function(e){const t=La(e),n=t.byteLength>=24&&2303741511===t.getUint32(0,Pa);if(!n)return null;return{mimeType:"image/png",width:t.getUint32(16,Pa),height:t.getUint32(20,Pa)}}(t)||function(e){const t=La(e),n=t.byteLength>=3&&65496===t.getUint16(0,Pa)&&255===t.getUint8(2);if(!n)return null;const{tableMarkers:r,sofMarkers:i}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let s=2;for(;s+9<t.byteLength;){const e=t.getUint16(s,Pa);if(i.has(e))return{mimeType:"image/jpeg",height:t.getUint16(s+5,Pa),width:t.getUint16(s+7,Pa)};if(!r.has(e))return null;s+=2,s+=t.getUint16(s,Pa)}return null}(t)||function(e){const t=La(e),n=t.byteLength>=10&&1195984440===t.getUint32(0,Pa);if(!n)return null;return{mimeType:"image/gif",width:t.getUint16(6,Ma),height:t.getUint16(8,Ma)}}(t)||function(e){const t=La(e),n=t.byteLength>=14&&16973===t.getUint16(0,Pa)&&t.getUint32(2,Ma)===t.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:t.getUint32(18,Ma),height:t.getUint32(22,Ma)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),n=ka(t);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(t)}function La(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}const Oa={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:"4.3.3",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(e,t,n){const r=((t=t||{}).image||{}).type||"auto",{url:i}=n||{},s=function(e){switch(e){case"auto":case"data":return function(){if(ya)return"imagebitmap";if(ma)return"image";if(_a)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return ya||ma||_a;case"imagebitmap":return ya;case"image":return ma;case"data":return _a;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}(e),e}}(r);let o;switch(s){case"imagebitmap":o=await Ra(e,t,i);break;case"image":o=await Ta(e,t,i);break;case"data":o=await async function(e){var t;const{mimeType:n}=Ba(e)||{},r=null===(t=globalThis.loaders)||void 0===t?void 0:t.parseImageNode;return Ze(r),await r(e,n)}(e);break;default:Ze(!1)}return"data"===r&&(o=wa(o)),o},tests:[e=>Boolean(Ba(new DataView(e)))],options:{image:{type:"auto",decode:!0}}};const Na={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){const t=e[0],n=e[e.length-1];return"{"===t&&"}"===n||"["===t&&"]"===n},parseTextSync:JSON.parse};const Ua=function(){const e="9.1.14",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat(e));return t||(Me.log(1,"deck.gl ".concat(e))(),globalThis.deck=u(u({},globalThis.deck),{},{VERSION:e,version:e,log:Me,_registerLoggers:Le}),function(e){const t=mn();e=Array.isArray(e)?e:[e];for(const n of e){const e=$e(n);t.find(t=>e===t)||t.unshift(e)}}([Na,[Oa,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}();const za=new class{constructor(){a(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new Ge({id:e})),this.stats.get(e)}},ja=new Fe({id:"luma.gl"}),Va={};function Ga(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";Va[e]=Va[e]||1;const t=Va[e]++;return"".concat(e,"-").concat(t)}class Wa{toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,':"').concat(this.id,'"')}constructor(e,t,n){if(a(this,"id",void 0),a(this,"props",void 0),a(this,"userData",{}),a(this,"_device",void 0),a(this,"destroyed",!1),a(this,"allocatedBytes",0),a(this,"_attachedResources",new Set),!e)throw new Error("no device");this._device=e,this.props=function(e,t){const n=u({},t);for(const r in e)void 0!==e[r]&&(n[r]=e[r]);return n}(t,n);const r="undefined"!==this.props.id?this.props.id:Ga(this[Symbol.toStringTag]);this.props.id=r,this.id=r,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("".concat(t,"s Active")).decrementCount()}trackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get("".concat(t," Memory")).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get("".concat(e," Memory")).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}}a(Wa,"defaultProps",{id:"undefined",handle:void 0,userData:void 0});class Ha extends Wa{get[Symbol.toStringTag](){return"Buffer"}constructor(e,t){const n=u({},t);(t.usage||0)&Ha.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?n.indexType="uint32":t.data instanceof Uint16Array&&(n.indexType="uint16")),delete n.data,super(e,n,Ha.defaultProps),a(this,"usage",void 0),a(this,"indexType",void 0),a(this,"updateTimestamp",void 0),a(this,"debugData",new ArrayBuffer(0)),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer(u(u({},this.props),e))}readSyncWebGL(e,t){throw new Error("not implemented")}_setDebugData(e,t,n){const r=ArrayBuffer.isView(e)?e.buffer:e,i=Math.min(e?e.byteLength:n,Ha.DEBUG_DATA_MAX_LENGTH);null===r?this.debugData=new ArrayBuffer(i):0===t&&n===r.byteLength?this.debugData=r.slice(0,i):this.debugData=r.slice(t,t+i)}}function Qa(e){const t=function(e){const t=Ya[e];return t}(Xa[e]),n=e.includes("norm"),r=!n&&!e.startsWith("float"),i=e.startsWith("s");return{dataType:Xa[e],byteLength:t,integer:r,signed:i,normalized:n}}a(Ha,"defaultProps",u(u({},Wa.defaultProps),{},{usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1})),a(Ha,"MAP_READ",1),a(Ha,"MAP_WRITE",2),a(Ha,"COPY_SRC",4),a(Ha,"COPY_DST",8),a(Ha,"INDEX",16),a(Ha,"VERTEX",32),a(Ha,"UNIFORM",64),a(Ha,"STORAGE",128),a(Ha,"INDIRECT",256),a(Ha,"QUERY_RESOLVE",512),a(Ha,"DEBUG_DATA_MAX_LENGTH",32);const Xa={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},Ya={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},qa="texture-compression-bc",Ka="texture-compression-astc",Za="texture-compression-etc2",Ja="texture-compression-pvrtc-webgl",$a="texture-compression-atc-webgl",el="float32-renderable-webgl",tl="float16-renderable-webgl",nl="snorm8-renderable-webgl",rl="norm16-renderable-webgl",il="snorm16-renderable-webgl",sl="float32-filterable",ol="float16-filterable-webgl";function al(e){const t=ll[e];if(!t)throw new Error("Unsupported texture format ".concat(e));return t}const ll={r8unorm:{},r8snorm:{render:nl},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:nl},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:tl,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:rl},"r16snorm-webgl":{f:il},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:nl},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:tl,filter:ol},"rg16unorm-webgl":{render:rl},"rg16snorm-webgl":{render:il},r32uint:{},r32sint:{},r32float:{render:el,filter:sl},rgb9e5ufloat:{channels:"rgb",packed:!0,render:"rgb9e5ufloat-renderable-webgl"},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:el},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:rl},"rgb16snorm-webgl":{f:rl},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:sl},rgba16uint:{},rgba16sint:{},rgba16float:{render:tl,filter:ol},"rgba16unorm-webgl":{render:rl},"rgba16snorm-webgl":{render:il},"rgb32float-webgl":{render:el,filter:sl},rgba32uint:{},rgba32sint:{},rgba32float:{render:el,filter:sl},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:qa},"bc1-rgb-unorm-srgb-webgl":{f:qa},"bc1-rgba-unorm":{f:qa},"bc1-rgba-unorm-srgb":{f:qa},"bc2-rgba-unorm":{f:qa},"bc2-rgba-unorm-srgb":{f:qa},"bc3-rgba-unorm":{f:qa},"bc3-rgba-unorm-srgb":{f:qa},"bc4-r-unorm":{f:qa},"bc4-r-snorm":{f:qa},"bc5-rg-unorm":{f:qa},"bc5-rg-snorm":{f:qa},"bc6h-rgb-ufloat":{f:qa},"bc6h-rgb-float":{f:qa},"bc7-rgba-unorm":{f:qa},"bc7-rgba-unorm-srgb":{f:qa},"etc2-rgb8unorm":{f:Za},"etc2-rgb8unorm-srgb":{f:Za},"etc2-rgb8a1unorm":{f:Za},"etc2-rgb8a1unorm-srgb":{f:Za},"etc2-rgba8unorm":{f:Za},"etc2-rgba8unorm-srgb":{f:Za},"eac-r11unorm":{f:Za},"eac-r11snorm":{f:Za},"eac-rg11unorm":{f:Za},"eac-rg11snorm":{f:Za},"astc-4x4-unorm":{f:Ka},"astc-4x4-unorm-srgb":{f:Ka},"astc-5x4-unorm":{f:Ka},"astc-5x4-unorm-srgb":{f:Ka},"astc-5x5-unorm":{f:Ka},"astc-5x5-unorm-srgb":{f:Ka},"astc-6x5-unorm":{f:Ka},"astc-6x5-unorm-srgb":{f:Ka},"astc-6x6-unorm":{f:Ka},"astc-6x6-unorm-srgb":{f:Ka},"astc-8x5-unorm":{f:Ka},"astc-8x5-unorm-srgb":{f:Ka},"astc-8x6-unorm":{f:Ka},"astc-8x6-unorm-srgb":{f:Ka},"astc-8x8-unorm":{f:Ka},"astc-8x8-unorm-srgb":{f:Ka},"astc-10x5-unorm":{f:Ka},"astc-10x5-unorm-srgb":{f:Ka},"astc-10x6-unorm":{f:Ka},"astc-10x6-unorm-srgb":{f:Ka},"astc-10x8-unorm":{f:Ka},"astc-10x8-unorm-srgb":{f:Ka},"astc-10x10-unorm":{f:Ka},"astc-10x10-unorm-srgb":{f:Ka},"astc-12x10-unorm":{f:Ka},"astc-12x10-unorm-srgb":{f:Ka},"astc-12x12-unorm":{f:Ka},"astc-12x12-unorm-srgb":{f:Ka},"pvrtc-rgb4unorm-webgl":{f:Ja},"pvrtc-rgba4unorm-webgl":{f:Ja},"pvrtc-rbg2unorm-webgl":{f:Ja},"pvrtc-rgba2unorm-webgl":{f:Ja},"etc1-rbg-unorm-webgl":{f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{f:$a},"atc-rgba-unorm-webgl":{f:$a},"atc-rgbai-unorm-webgl":{f:$a}},ul=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],cl=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function Al(e){return ul.some(t=>e.startsWith(t))}function hl(e){let t=function(e){var t,n,r,i,s,o,a,l;const c=al(e),A=c.bytesPerPixel||1,h=c.bitsPerChannel||[8,8,8,8];delete c.bitsPerChannel,delete c.bytesPerPixel,delete c.f,delete c.render,delete c.filter,delete c.blend,delete c.store;const d=u(u({},c),{},{format:e,attachment:c.attachment||"color",channels:c.channels||"r",components:c.components||(null===(t=c.channels)||void 0===t?void 0:t.length)||1,bytesPerPixel:A,bitsPerChannel:h,dataType:c.dataType||"uint8",srgb:null!==(n=c.srgb)&&void 0!==n&&n,packed:null!==(r=c.packed)&&void 0!==r&&r,webgl:null!==(i=c.webgl)&&void 0!==i&&i,integer:null!==(s=c.integer)&&void 0!==s&&s,signed:null!==(o=c.signed)&&void 0!==o&&o,normalized:null!==(a=c.normalized)&&void 0!==a&&a,compressed:null!==(l=c.compressed)&&void 0!==l&&l});return d}(e);if(Al(e)){t.channels="rgb",t.components=3,t.bytesPerPixel=1,t.srgb=!1,t.compressed=!0;const n=function(e){const t=/.*-(\d+)x(\d+)-.*/.exec(e);if(t){const[,e,n]=t;return{blockWidth:Number(e),blockHeight:Number(n)}}return null}(e);n&&(t.blockWidth=n.blockWidth,t.blockHeight=n.blockHeight)}const n=cl.exec(e);if(n){const[,r,i,s,o,a]=n,l=Qa("".concat(s).concat(i)),u=8*l.byteLength,c=r.length,A=[u,c>=2?u:0,c>=3?u:0,c>=4?u:0];t={format:e,attachment:t.attachment,dataType:l.dataType,components:c,channels:r,integer:l.integer,signed:l.signed,normalized:l.normalized,bitsPerChannel:A,bytesPerPixel:l.byteLength*r.length,packed:t.packed,srgb:t.srgb},"-webgl"===a&&(t.webgl=!0),"-srgb"===o&&(t.srgb=!0)}return e.endsWith("-webgl")&&(t.webgl=!0),e.endsWith("-srgb")&&(t.srgb=!0),t}class dl{}class fl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;a(this,"features",void 0),a(this,"disabledFeatures",void 0),this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){var t;return!(null!==(t=this.disabledFeatures)&&void 0!==t&&t[e])&&this.features.has(e)}}class pl{get[Symbol.toStringTag](){return"Device"}constructor(e){a(this,"id",void 0),a(this,"props",void 0),a(this,"userData",{}),a(this,"statsManager",za),a(this,"timestamp",0),a(this,"_reused",!1),a(this,"_lumaData",{}),this.props=u(u({},pl.defaultProps),e),this.id=this.props.id||Ga(this[Symbol.toStringTag].toLowerCase())}getTextureFormatCapabilities(e){const t=function(e){var t,n,r,i,s;const o=al(e),a={format:e,create:null===(t=o.f)||void 0===t||t,render:null===(n=o.render)||void 0===n||n,filter:null===(r=o.filter)||void 0===r||r,blend:null===(i=o.blend)||void 0===i||i,store:null===(s=o.store)||void 0===s||s},l=hl(e),u=e.startsWith("depth")||e.startsWith("stencil"),c=null===l||void 0===l?void 0:l.signed,A=null===l||void 0===l?void 0:l.integer,h=null===l||void 0===l?void 0:l.webgl;return a.render&&(a.render=!c),a.filter&&(a.filter=!u&&!c&&!A&&!h),a}(e),n=e=>{var t;return null===(t="string"===typeof e?this.features.has(e):e)||void 0===t||t},r=n(t.create),i={format:e,create:r,render:r&&n(t.render),filter:r&&n(t.filter),blend:r&&n(t.blend),store:r&&n(t.store)};return this._getDeviceSpecificTextureFormatCapabilities(i)}isTextureFormatSupported(e,t){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return Al(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return!0===e.createCanvasContext?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t=u({},e);return(e.usage||0)&Ha.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array?t.indexType="uint16":ja.warn("indices buffer content must be of integer type")()),t}}a(pl,"defaultProps",{id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>ja.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:ja.get("debug")||void 0,debugShaders:ja.get("debug-shaders")||void 0,debugFramebuffers:Boolean(ja.get("debug-framebuffers")),debugWebGL:Boolean(ja.get("debug-webgl")),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0});const gl=pe()&&"undefined"!==typeof document,ml="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class yl{constructor(){if(a(this,"stats",za),a(this,"log",ja),a(this,"VERSION","9.1.9"),a(this,"spector",void 0),a(this,"preregisteredAdapters",new Map),globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw ja.error("Found luma.gl ".concat(globalThis.luma.VERSION," while initialzing ").concat(this.VERSION))(),ja.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");ja.error("This version of luma.gl has already been initialized")()}ja.log(1,"".concat(this.VERSION," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=this}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this.getAdapterMap(e);return Array.from(t).map(e=>{let[,t]=e;return t}).filter(e=>{var t;return null===(t=e.isSupported)||void 0===t?void 0:t.call(e)}).map(e=>e.type)}getBestAvailableAdapter(){var e,t,n,r;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const s=this.getAdapterMap(i);return null!==(e=s.get("webgpu"))&&void 0!==e&&null!==(t=e.isSupported)&&void 0!==t&&t.call(e)?"webgpu":null!==(n=s.get("webgl"))&&void 0!==n&&null!==(r=n.isSupported)&&void 0!==r&&r.call(n)?"webgl":null}setDefaultDeviceProps(e){Object.assign(yl.defaultProps,e)}async createDevice(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=u(u({},yl.defaultProps),t),t.waitForPageLoad&&await yl.pageLoaded;const n=this.getAdapterMap(t.adapters);let r=t.type||"";"best-available"===r&&(r=this.getBestAvailableAdapter(t.adapters)||r);const i=(this.getAdapterMap(t.adapters)||n).get(r),s=await(null===i||void 0===i||null===(e=i.create)||void 0===e?void 0:e.call(i,t));if(s)return s;throw new Error(ml)}async attachDevice(e){var t;const n=this.getAdapterMap(e.adapters);let r="";e.handle instanceof WebGL2RenderingContext&&(r="webgl"),e.createCanvasContext&&await yl.pageLoaded,null===e.handle&&(r="unknown");const i=n.get(r),s=await(null===i||void 0===i||null===(t=i.attach)||void 0===t?void 0:t.call(i,null));if(s)return s;throw new Error(ml)}enforceWebGL2(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=this.getAdapterMap(n).get("webgl");r||ja.warn("enforceWebGL2: webgl adapter not found")(),null===r||void 0===r||null===(e=r.enforceWebGL2)||void 0===e||e.call(r,t)}getAdapterMap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Map(this.preregisteredAdapters);for(const n of e)t.set(n.type,n);return t}registerDevices(e){ja.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const t of e){const e=t.adapter;e&&this.preregisteredAdapters.set(e.type,e)}}}a(yl,"defaultProps",u(u({},pl.defaultProps),{},{type:"best-available",adapters:void 0,waitForPageLoad:!0})),a(yl,"pageLoaded",function(){if(gl&&"complete"===document.readyState||"undefined"===typeof window)return Promise.resolve();return new Promise(e=>{window.addEventListener("load",()=>e())})}().then(()=>{ja.probe(2,"DOM is loaded")()}));const vl=new yl;class _l{}const bl={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},wl=(e,t,n)=>t?e.enable(n):e.disable(n),El=(e,t,n)=>e.hint(n,t),xl=(e,t,n)=>e.pixelStorei(n,t),Dl=(e,t,n)=>{const r=36006===n?36009:36008;return e.bindFramebuffer(r,t)},Cl=(e,t,n)=>{const r={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];e.bindBuffer(r,t)};function Sl(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}const Tl={3042:wl,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:wl,2885:(e,t)=>e.cullFace(t),2929:wl,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:wl,35723:El,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>{var n;return null===(n=e.bindTransformFeedback)||void 0===n?void 0:n.call(e,36386,t)},34229:(e,t)=>e.bindVertexArray(t),36006:Dl,36010:Dl,34964:Cl,36662:Cl,36663:Cl,35053:Cl,35055:Cl,2886:(e,t)=>e.frontFace(t),33170:El,2849:(e,t)=>e.lineWidth(t),32823:wl,32824:"polygonOffset",10752:"polygonOffset",35977:wl,32926:wl,32928:wl,32938:"sampleCoverage",32939:"sampleCoverage",3089:wl,3088:(e,t)=>e.scissor(...t),2960:wl,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:wl,10754:wl,12288:wl,12289:wl,12290:wl,12291:wl,12292:wl,12293:wl,12294:wl,12295:wl,3333:xl,3317:xl,37440:xl,37441:xl,37443:xl,3330:xl,3332:xl,3331:xl,3314:xl,32878:xl,3316:xl,3315:xl,32877:xl,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{const n="number"===typeof t?[t,t]:t;e.blendEquationSeparate(...n)},blendFunc:(e,t)=>{const n=2===(null===t||void 0===t?void 0:t.length)?[...t,...t]:t;e.blendFuncSeparate(...n)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(t[0],t[1]||!1),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=Sl(t)?t:[t,t];const[n,r]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,r)},stencilFunc:(e,t)=>{t=Sl(t)&&3===t.length?[...t,...t]:t;const[n,r,i,s,o,a]=t;e.stencilFuncSeparate(1028,n,r,i),e.stencilFuncSeparate(1029,s,o,a)},stencilOp:(e,t)=>{t=Sl(t)&&3===t.length?[...t,...t]:t;const[n,r,i,s,o,a]=t;e.stencilOpSeparate(1028,n,r,i),e.stencilOpSeparate(1029,s,o,a)},viewport:(e,t)=>e.viewport(...t)};function Il(e,t,n){return void 0!==t[e]?t[e]:n[e]}const Fl={blendEquation:(e,t,n)=>e.blendEquationSeparate(Il(32777,t,n),Il(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(Il(32969,t,n),Il(32968,t,n),Il(32971,t,n),Il(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(Il(32824,t,n),Il(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(Il(32938,t,n),Il(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,Il(2962,t,n),Il(2967,t,n),Il(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,Il(34816,t,n),Il(36003,t,n),Il(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,Il(2964,t,n),Il(2965,t,n),Il(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,Il(34817,t,n),Il(34818,t,n),Il(34819,t,n))},Rl={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,n)=>e({36007:n}),bindTransformFeedback:(e,t,n)=>e({36389:n}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},bindBuffer:(e,t,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return r?e({[r]:n}):{valueChanged:!0}},blendColor:(e,t,n,r,i)=>e({32773:new Float32Array([t,n,r,i])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,r,i)=>e({32969:t,32968:n,32971:r,32970:i}),clearColor:(e,t,n,r,i)=>e({3106:new Float32Array([t,n,r,i])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,r,i)=>e({3107:[t,n,r,i]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,r,i)=>e({3088:new Int32Array([t,n,r,i])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,r)=>e({2962:t,2967:n,2963:r,34816:t,36003:n,36004:r}),stencilFuncSeparate:(e,t,n,r,i)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:r,[1028===t?2963:36004]:i}),stencilOp:(e,t,n,r)=>e({2964:t,2965:n,2966:r,34817:t,34818:n,34819:r}),stencilOpSeparate:(e,t,n,r,i)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:r,[1028===t?2966:34819]:i}),viewport:(e,t,n,r,i)=>e({2978:[t,n,r,i]})},kl=(e,t)=>e.isEnabled(t),Pl={3042:kl,2884:kl,2929:kl,3024:kl,32823:kl,32926:kl,32928:kl,3089:kl,2960:kl,35977:kl},Ml=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function Bl(e,t){if(function(e){for(const t in e)return!1;return!0}(t))return;const n={};for(const i in t){const r=Number(i),s=Tl[i];s&&("string"===typeof s?n[s]=!0:s(e,t[i],r))}const r=e.state&&e.state.cache;if(r)for(const i in n){(0,Fl[i])(e,t,r)}}function Ll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bl;if("number"===typeof t){const n=t,r=Pl[n];return r?r(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),r={};for(const i of n){const t=Pl[i];r[i]=t?t(e,Number(i)):e.getParameter(Number(i))}return r}function Ol(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}class Nl{static get(e){return e.state}constructor(e,t){a(this,"gl",void 0),a(this,"program",null),a(this,"stateStack",[]),a(this,"enable",!0),a(this,"cache",null),a(this,"log",void 0),a(this,"initialized",!1),this.gl=e,this.log=(null===t||void 0===t?void 0:t.log)||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];Bl(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t.copyState?Ll(e):Object.assign({},bl),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,function(e){const t=e.useProgram.bind(e);e.useProgram=function(n){const r=Nl.get(e);r.program!==n&&(t(n),r.program=n)}}(e);for(const n in Rl){zl(e,n,Rl[n])}Ul(e,"getParameter"),Ul(e,"isEnabled")}_updateCache(e){let t,n=!1;const r=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const i in e){const s=e[i],o=this.cache[i];Ol(s,o)||(n=!0,t=o,r&&!(i in r)&&(r[i]=o),this.cache[i]=s)}return{valueChanged:n,oldValue:t}}}function Ul(e,t){const n=e[t].bind(e);e[t]=function(t){if(void 0===t||Ml.has(t))return n(t);const r=Nl.get(e);return t in r.cache||(r.cache[t]=n(t)),r.enable?r.cache[t]:n(t)},Object.defineProperty(e[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function zl(e,t,n){if(!e[t])return;const r=e[t].bind(e);e[t]=function(){const t=Nl.get(e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];const{valueChanged:a,oldValue:l}=n(t._updateCache,...s);return a&&r(...s),l},Object.defineProperty(e[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}function jl(e,t,n){return void 0===n[t]&&(n[t]=e.getExtension(t)||null),n[t]}function Vl(e,t){const n=e.getParameter(7936),r=e.getParameter(7937);jl(e,"WEBGL_debug_renderer_info",t);const i=t.WEBGL_debug_renderer_info,s=e.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936)||n,o=e.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937)||r,a=e.getParameter(7938),l=Gl(s,o),u=function(e,t){if(/Metal/i.exec(e)||/Metal/i.exec(t))return"metal";if(/ANGLE/i.exec(e)||/ANGLE/i.exec(t))return"opengl";return"unknown"}(s,o),c=function(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(Gl(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(s,o);return{type:"webgl",gpu:l,gpuType:c,gpuBackend:u,vendor:s,renderer:o,version:a,shadingLanguage:"glsl",shadingLanguageVersion:300}}function Gl(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}function Wl(e){switch(e){case"uint8":case"unorm8":return 5121;case"sint8":case"snorm8":return 5120;case"uint16":case"unorm16":return 5123;case"sint16":case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}const Hl="WEBGL_compressed_texture_s3tc",Ql="WEBGL_compressed_texture_s3tc_srgb",Xl="EXT_texture_compression_rgtc",Yl="EXT_texture_compression_bptc",ql="EXT_texture_norm16",Kl="EXT_render_snorm",Zl={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[Kl],"norm16-renderable-webgl":[ql],"snorm16-renderable-webgl":[ql,Kl],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Hl,Ql,Xl,Yl],"texture-compression-bc5-webgl":[Xl],"texture-compression-bc7-webgl":[Yl],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};const Jl={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:"EXT_color_buffer_float",dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Hl},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:Ql},"bc1-rgba-unorm":{gl:33777,x:Hl},"bc1-rgba-unorm-srgb":{gl:35916,x:Ql},"bc2-rgba-unorm":{gl:33778,x:Hl},"bc2-rgba-unorm-srgb":{gl:35918,x:Ql},"bc3-rgba-unorm":{gl:33779,x:Hl},"bc3-rgba-unorm-srgb":{gl:35919,x:Ql},"bc4-r-unorm":{gl:36283,x:Xl},"bc4-r-snorm":{gl:36284,x:Xl},"bc5-rg-unorm":{gl:36285,x:Xl},"bc5-rg-snorm":{gl:36286,x:Xl},"bc6h-rgb-ufloat":{gl:36495,x:Yl},"bc6h-rgb-float":{gl:36494,x:Yl},"bc7-rgba-unorm":{gl:36492,x:Yl},"bc7-rgba-unorm-srgb":{gl:36493,x:Yl},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function $l(e){var t;const n=Jl[e],r=function(e){const t=Jl[e],n=null===t||void 0===t?void 0:t.gl;if(void 0===n)throw new Error("Unsupported texture format ".concat(e));return n}(e),i=hl(e);return{internalFormat:r,format:(null===n||void 0===n?void 0:n.dataFormat)||eu(i.channels,i.integer,i.normalized,r),type:i.dataType?Wl(i.dataType):(null===n||void 0===n||null===(t=n.types)||void 0===t?void 0:t[0])||5121,compressed:i.compressed||!1}}function eu(e,t,n,r){if(6408===r||6407===r)return r;switch(e){case"r":return t&&!n?36244:6403;case"rg":return t&&!n?33320:33319;case"rgb":return t&&!n?36248:6407;case"rgba":return t&&!n?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}const tu={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class nu extends fl{constructor(e,t,n){super([],n),a(this,"gl",void 0),a(this,"extensions",void 0),a(this,"testedFeatures",new Set),this.gl=e,this.extensions=t,jl(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){var t;return(null===(t=this.disabledFeatures)||void 0===t||!t[e])&&(this.testedFeatures.has(e)||(this.testedFeatures.add(e),function(e){return e in Zl}(e)&&function(e,t,n){return(Zl[t]||[]).every(t=>jl(e,t,n))}(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(e=>"polygon-mode-webgl"!==e);for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(tu),...Object.keys(Zl)]}getWebGLFeature(e){const t=tu[e];return"string"===typeof t?Boolean(jl(this.gl,t,this.extensions)):Boolean(t)}}class ru extends dl{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}constructor(e){super(),a(this,"gl",void 0),a(this,"limits",{}),this.gl=e}getParameter(e){return void 0===this.limits[e]&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class iu{toString(){return"".concat(this[Symbol.toStringTag],"(").concat(this.id,")")}constructor(e){if(a(this,"id",void 0),a(this,"props",void 0),a(this,"canvas",void 0),a(this,"htmlCanvas",void 0),a(this,"offscreenCanvas",void 0),a(this,"type",void 0),a(this,"width",1),a(this,"height",1),a(this,"resizeObserver",void 0),a(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1}),this.props=u(u({},iu.defaultProps),e),e=this.props,!pe())return this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,void(this.canvas=null);if(e.canvas)"string"===typeof e.canvas?this.canvas=function(e){const t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}(e.canvas):this.canvas=e.canvas;else{var t,n;const r=function(e){const{width:t,height:n}=e,r=document.createElement("canvas");return r.id=Ga("lumagl-auto-created-canvas"),r.width=t||1,r.height=n||1,r.style.width=Number.isFinite(t)?"".concat(t,"px"):"100%",r.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",r}(e),i=function(e){if("string"===typeof e){const t=document.getElementById(e);if(!t)throw new Error("".concat(e," is not an HTML element"));return t}if(e)return e;return document.body}((null===(t=e)||void 0===t?void 0:t.container)||null);i.insertBefore(r,i.firstChild),this.canvas=r,null!==(n=e)&&void 0!==n&&n.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(e=>{for(const t of e)t.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){if("undefined"!==typeof OffscreenCanvas&&this.canvas instanceof OffscreenCanvas)return 1;if(!(e=void 0===e?this.props.useDevicePixels:e)||e<=0)return 1;if(!0===e){return"undefined"!==typeof window&&window.devicePixelRatio||1}return e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),t=this.canvas;return t.parentElement?[t.clientWidth*e,t.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,t]=this.getPixelSize();return e/t}cssToDeviceRatio(){try{var e;const[t]=this.getDrawingBufferSize(),n=this._canvasSizeInfo.clientWidth||(null===(e=this.htmlCanvas)||void 0===e?void 0:e.clientWidth);return n?t/n:1}catch(t){return 1}}cssToDevicePixels(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.cssToDeviceRatio(),[r,i]=this.getDrawingBufferSize();return function(e,t,n,r,i){const s=e,o=su(s[0],t,n);let a=ou(s[1],t,r,i),l=su(s[0]+1,t,n);const u=l===n-1?l:l-1;let c;l=ou(s[1]+1,t,r,i),i?(l=0===l?l:l+1,c=a,a=l):c=l===r-1?l:l-1;return{x:o,y:a,width:Math.max(u-o+1,1),height:Math.max(c-a+1,1)}}(e,n,r,i,t)}setDevicePixelRatio(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.htmlCanvas)return;let n="width"in t?t.width:this.htmlCanvas.clientWidth,r="height"in t?t.height:this.htmlCanvas.clientHeight;n&&r||(ja.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,n=this.htmlCanvas.width||1,r=this.htmlCanvas.height||1);const i=this._canvasSizeInfo;if(i.clientWidth!==n||i.clientHeight!==r||i.devicePixelRatio!==e){let t=e;const i=Math.floor(n*t),s=Math.floor(r*t);this.htmlCanvas.width=i,this.htmlCanvas.height=s;if(this.device.gl){const[o,a]=this.getDrawingBufferSize();o===i&&a===s||(t=Math.min(o/n,a/r),this.htmlCanvas.width=Math.floor(n*t),this.htmlCanvas.height=Math.floor(r*t),ja.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=n,this._canvasSizeInfo.clientHeight=r,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;return e?[e.drawingBufferWidth,e.drawingBufferHeight]:this.getPixelSize()}_setAutoCreatedCanvasId(e){var t;"lumagl-auto-created-canvas"===(null===(t=this.htmlCanvas)||void 0===t?void 0:t.id)&&(this.htmlCanvas.id=e)}}function su(e,t,n){return Math.min(Math.round(e*t),n-1)}function ou(e,t,n,r){return r?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}a(iu,"defaultProps",{canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"});class au extends Wa{get[Symbol.toStringTag](){return"Texture"}toString(){return"Texture(".concat(this.id,",").concat(this.format,",").concat(this.width,"x").concat(this.height,")")}constructor(e,t){if(super(e,t=au.normalizeProps(e,t),au.defaultProps),a(this,"dimension",void 0),a(this,"format",void 0),a(this,"width",void 0),a(this,"height",void 0),a(this,"depth",void 0),a(this,"mipLevels",void 0),a(this,"updateTimestamp",void 0),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,void 0===this.props.width||void 0===this.props.height){const e=au.getTextureDataSize(this.props.data);this.width=(null===e||void 0===e?void 0:e.width)||1,this.height=(null===e||void 0===e?void 0:e.height)||1}this.props.mipmaps&&void 0===this.props.mipLevels&&(this.props.mipLevels="pyramid"),this.mipLevels="pyramid"===this.props.mipLevels?au.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createTexture(u(u({},this.props),e))}static isExternalImage(e){return"undefined"!==typeof ImageData&&e instanceof ImageData||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas}static getExternalImageSize(e){if("undefined"!==typeof ImageData&&e instanceof ImageData||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if("undefined"!==typeof VideoFrame&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(e){const t=null===e||void 0===e?void 0:e.data;return ArrayBuffer.isView(t)}static getTextureDataSize(e){if(!e)return null;if(ArrayBuffer.isView(e))return null;if(Array.isArray(e))return au.getTextureDataSize(e[0]);if(au.isExternalImage(e))return au.getExternalImageSize(e);if(e&&"object"===typeof e&&e.constructor===Object){const t=Object.values(e)[0];return{width:t.width,height:t.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(e,t){let n;return n=ArrayBuffer.isView(e)?[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?e:[e],n}static getMipLevelCount(e,t){return Math.floor(Math.log2(Math.max(e,t)))+1}static getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}static normalizeProps(e,t){var n;const r=u({},t),i=(null===e||void 0===e||null===(n=e.props)||void 0===n||null===(n=n._resourceDefaults)||void 0===n?void 0:n.texture)||{};Object.assign(r,i);const{width:s,height:o}=r;return"number"===typeof s&&(r.width=Math.max(1,Math.ceil(s))),"number"===typeof o&&(r.height=Math.max(1,Math.ceil(o))),r}}a(au,"COPY_SRC",1),a(au,"COPY_DST",2),a(au,"TEXTURE",4),a(au,"STORAGE",8),a(au,"RENDER_ATTACHMENT",16),a(au,"CubeFaces",["+X","-X","+Y","-Y","+Z","-Z"]),a(au,"defaultProps",u(u({},Wa.defaultProps),{},{data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0})),a(au,"defaultCopyExternalImageOptions",{image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1});class lu extends Wa{get[Symbol.toStringTag](){return"Framebuffer"}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},lu.defaultProps),a(this,"width",void 0),a(this,"height",void 0),this.width=this.props.width,this.height=this.props.height}clone(e){const t=this.colorAttachments.map(t=>t.texture.clone(e)),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer(u(u({},this.props),{},{colorAttachments:t,depthStencilAttachment:n}))}resize(e){let t=!e;if(e){const[n,r]=Array.isArray(e)?e:[e.width,e.height];t=t||r!==this.height||n!==this.width,this.width=n,this.height=r}t&&(ja.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(this.width,"x").concat(this.height))(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((e,t)=>{if("string"===typeof e){const n=this.createColorTexture(e,t);return this.attachResource(n),n.view}return e instanceof au?e.view:e});const e=this.props.depthStencilAttachment;if(e)if("string"===typeof e){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else this.depthStencilAttachment=e instanceof au?e.view:e}createColorTexture(e,t){return this.device.createTexture({id:"".concat(this.id,"-color-attachment-").concat(t),usage:au.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:"".concat(this.id,"-depth-stencil-attachment"),usage:au.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,t){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const r=this.colorAttachments[n].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=r.view,this.attachResource(r.view)}if(this.depthStencilAttachment){const n=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}}a(lu,"defaultProps",u(u({},Wa.defaultProps),{},{width:1,height:1,colorAttachments:[],depthStencilAttachment:null}));class uu extends lu{constructor(e,t){super(e,t),a(this,"device",void 0),a(this,"gl",void 0),a(this,"handle",void 0),a(this,"colorAttachments",[]),a(this,"depthStencilAttachment",null);const n=null===t.handle;this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const e=this.colorAttachments[t];if(e){const n=36064+t;this._attachTextureView(n,e)}}if(this.depthStencilAttachment){const e=function(e){switch(hl(e).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error("Not a depth stencil format: ".concat(e))}}(this.depthStencilAttachment.props.format);this._attachTextureView(e,this.depthStencilAttachment)}if(this.device.props.debug){const e=this.gl.checkFramebufferStatus(36160);if(36053!==e)throw new Error("Framebuffer ".concat(function(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return"".concat(e)}}(e)))}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,t){const{gl:n}=this.device,{texture:r}=t,i=t.props.baseMipLevel,s=t.props.baseArrayLayer;switch(n.bindTexture(r.glTarget,r.handle),r.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,e,r.handle,i,s);break;case 34067:const t=function(e){return e<34069?e+34069:e}(s);n.framebufferTexture2D(36160,e,t,r.handle,i);break;case 3553:n.framebufferTexture2D(36160,e,3553,r.handle,i);break;default:throw new Error("Illegal texture type")}n.bindTexture(r.glTarget,null)}}class cu extends iu{get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,t){super(t),a(this,"device",void 0),a(this,"format","rgba8unorm"),a(this,"depthStencilFormat","depth24plus"),a(this,"presentationSize",void 0),a(this,"_framebuffer",null),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId("".concat(this.device.id,"-canvas")),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new uu(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl&&this.canvas){const t=this.getDevicePixelRatio(null===e||void 0===e?void 0:e.useDevicePixels);return void this.setDevicePixelRatio(t,e)}}commit(){}}async function Au(e,t){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",e),t&&(r.id=t),new Promise((t,i)=>{r.onload=t,r.onerror=t=>i(new Error("Unable to load script '".concat(e,"': ").concat(t))),n.appendChild(r)})}let hu=null,du=!1;const fu={debugSpectorJS:ja.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};var pu;!function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"}(pu||(pu={}));function gu(e){return e.luma=e.luma||{},e.luma}function mu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.debugWebGL||t.traceWebGL?function(e,t){if(!globalThis.WebGLDebugUtils)return ja.warn("webgl-debug not loaded")(),e;const n=gu(e);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init(u(u({},pu),e));const r=globalThis.WebGLDebugUtils.makeDebugContext(e,vu.bind(null,t),_u.bind(null,t));for(const o in pu)o in r||"number"!==typeof pu[o]||(r[o]=pu[o]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.setPrototypeOf(i,r);const s=Object.create(i);return n.realContext=e,n.debugContext=s,s.debug=!0,s}(e,t):function(e){const t=gu(e);return t.realContext?t.realContext:e}(e)}function yu(e,t){t=Array.from(t).map(e=>void 0===e?"undefined":e);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return n="".concat(n.slice(0,100)).concat(n.length>100?"...":""),"gl.".concat(e,"(").concat(n,")")}function vu(e,t,n,r){r=Array.from(r).map(e=>void 0===e?"undefined":e);const i=globalThis.WebGLDebugUtils.glEnumToString(t),s=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r),o="".concat(i," in gl.").concat(n,"(").concat(s,")");ja.error(o)()}function _u(e,t,n){let r="";ja.level>=1&&(r=yu(t,n),e.traceWebGL&&ja.log(1,r)());for(const i of n)void 0===i&&(r=r||yu(t,n))}const bu={};function wu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";bu[e]=bu[e]||1;const t=bu[e]++;return"".concat(e,"-").concat(t)}class Eu extends Ha{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),a(this,"device",void 0),a(this,"gl",void 0),a(this,"handle",void 0),a(this,"glTarget",void 0),a(this,"glUsage",void 0),a(this,"glIndexType",5123),a(this,"byteLength",void 0),a(this,"bytesUsed",void 0),this.device=e,this.gl=this.device.gl;const n="object"===typeof t?t.handle:void 0;this.handle=n||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,u(u({},this.props),{},{data:typeof this.props.data})),this.glTarget=function(e){if(e&Ha.INDEX)return 34963;if(e&Ha.VERTEX)return 34962;if(e&Ha.UNIFORM)return 35345;return 34962}(this.props.usage),this.glUsage=function(e){if(e&Ha.INDEX)return 35044;if(e&Ha.VERTEX)return 35044;if(e&Ha.UNIFORM)return 35048;return 35044}(this.props.usage),this.glIndexType="uint32"===this.props.indexType?5125:5123,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}_initWithData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+t;const r=this.glTarget;this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.glUsage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,t,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){let t=e;0===e&&(t=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,t,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=36663;this.gl.bindBuffer(n,this.handle),this.gl.bufferSubData(n,t,e),this.gl.bindBuffer(n,null),this._setDebugData(e,t,e.byteLength)}async readAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return this.readSyncWebGL(e,t)}readSyncWebGL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;t=null!==t&&void 0!==t?t:this.byteLength-e;const n=new Uint8Array(t);return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,0,t),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,t),n}}function xu(e,t,n,r){if(null!==r&&void 0!==r&&r.inlineSource){const r=function(e,t,n){let r="";for(let i=t-2;i<=t;i++){const s=e[i-1];void 0!==s&&(r+=Du(s,t,n))}return r}(t,n),i=e.linePos>0?"".concat(" ".repeat(e.linePos+5),"^^^\n"):"";return"\n".concat(r).concat(i).concat(e.type.toUpperCase(),": ").concat(e.message,"\n\n")}const i="error"===e.type?"red":"#8B4000";return null!==r&&void 0!==r&&r.html?"<div class='luma-compiler-log-error' style=\"color:".concat(i,';"><b> ').concat(e.type.toUpperCase(),": ").concat(e.message,"</b></div>"):"".concat(e.type.toUpperCase(),": ").concat(e.message)}function Du(e,t,n){const r=null!==n&&void 0!==n&&n.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return"".concat(function(e,t){let n="";for(let r=e.length;r<t;++r)n+=" ";return n+e}(String(t),4),": ").concat(r).concat(null!==n&&void 0!==n&&n.html?"<br/>":"\n")}class Cu extends Wa{get[Symbol.toStringTag](){return"Shader"}constructor(e,t){t=u(u({},t),{},{debugShaders:t.debugShaders||e.props.debugShaders||"errors"}),super(e,u({id:Su(t)},t),Cu.defaultProps),a(this,"stage",void 0),a(this,"source",void 0),a(this,"compilationStatus","pending"),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if("success"===this.compilationStatus)return}const t=await this.getCompilationInfo();"warnings"===e&&0===(null===t||void 0===t?void 0:t.length)||this._displayShaderLog(t)}_displayShaderLog(e){var t,n;if("undefined"===typeof document||null===(t=document)||void 0===t||!t.createElement)return;const r=Tu(this.source),i="".concat(this.stage," ").concat(r);let s=function(e,t,n){let r="";const i=t.split(/\r?\n/),s=e.slice().sort((e,t)=>e.lineNum-t.lineNum);switch((null===n||void 0===n?void 0:n.showSourceCode)||"no"){case"all":let t=0;for(let e=1;e<=i.length;e++)for(r+=Du(i[e-1],e,n);s.length>t&&s[t].lineNum===e;){const e=s[t++];r+=xu(e,i,e.lineNum,u(u({},n),{},{inlineSource:!1}))}return r;case"issues":case"no":for(const s of e)r+=xu(s,i,s.lineNum,{inlineSource:"no"!==(null===n||void 0===n?void 0:n.showSourceCode)});return r}}(e,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(s+='<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>'.concat(o,"</pre></code>"));const a=document.createElement("Button");a.innerHTML="\n<h1>Shader Compilation Error in ".concat(i,'</h1><br /><br />\n<code style="user-select:text;"><pre>\n').concat(s,"\n</pre></code>"),a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a);null===(n=document.getElementsByClassName("luma-compiler-log-error")[0])||void 0===n||n.scrollIntoView(),a.onclick=()=>{const e="data:text/plain,".concat(encodeURIComponent(this.source));navigator.clipboard.writeText(e)}}}function Su(e){return Tu(e.source)||e.id||Ga("unnamed ".concat(e.stage,"-shader"))}function Tu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return n?n[1]:t}function Iu(e){const t=e.toLowerCase();return["warning","error","info"].includes(t)?t:"info"}a(Cu,"defaultProps",u(u({},Wa.defaultProps),{},{language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}));class Fu extends Cu{constructor(e,t){switch(super(e,t),a(this,"device",void 0),a(this,"handle",void 0),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?function(e){const t=e.split(/\r?\n/),n=[];for(const r of t){if(r.length<=1)continue;const e=r.split(":");if(2===e.length){const[t,r]=e;n.push({message:r.trim(),type:Iu(t),lineNum:0,linePos:0});continue}const[t,i,s,...o]=e;let a=parseInt(s,10);isNaN(a)&&(a=0);let l=parseInt(i,10);isNaN(l)&&(l=0),n.push({message:o.join(":").trim(),type:Iu(t),lineNum:a,linePos:l})}return n}(e):[]}getTranslatedSource(){const e=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return(null===e||void 0===e?void 0:e.getTranslatedShaderSource(this.handle))||null}async _compile(e){e=e.startsWith("#version ")?e:"#version 300 es\n".concat(e);const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),this.device.props.debug){if(this.device.features.has("compilation-status-async-webgl"))ja.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),ja.info(2,"Shader ".concat(this.id," - async compilation complete: ").concat(this.compilationStatus))(),this._getCompilationStatus(),this.debugShader();else if(this._getCompilationStatus(),this.debugShader(),"error"===this.compilationStatus)throw new Error("GLSL compilation errors in ".concat(this.props.stage," shader ").concat(this.props.id))}else this.compilationStatus="pending"}async _waitForCompilationComplete(){const e=async e=>await new Promise(t=>setTimeout(t,e));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}class Ru extends Wa{get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){super(e,t=Ru.normalizeProps(e,t),Ru.defaultProps)}static normalizeProps(e,t){var n;const r=(null===e||void 0===e||null===(n=e.props)||void 0===n||null===(n=n._resourceDefaults)||void 0===n?void 0:n.sampler)||{};return u(u({},t),r)}}function ku(e,t){const n=e,{gl:r}=n;if(t.cullMode)switch(t.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029)}if(t.frontFace&&r.frontFace(Ou("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&r.enable(34383),void 0!==t.depthBias&&(r.enable(32823),r.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){const e=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,r=Ou("provokingVertex",t.provokingVertex,{first:36429,last:36430});null===e||void 0===e||e.provokingVertexWEBGL(r)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){const e=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,r=Ou("polygonMode",t.polygonMode,{fill:6914,line:6913});null===e||void 0===e||e.polygonModeWEBGL(1028,r),null===e||void 0===e||e.polygonModeWEBGL(1029,r)}t.polygonOffsetLine&&r.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&r.enable(12288),t.clipDistance1&&r.enable(12289),t.clipDistance2&&r.enable(12290),t.clipDistance3&&r.enable(12291),t.clipDistance4&&r.enable(12292),t.clipDistance5&&r.enable(12293),t.clipDistance6&&r.enable(12294),t.clipDistance7&&r.enable(12295)),void 0!==t.depthWriteEnabled&&r.depthMask(function(e,t){return t}(0,t.depthWriteEnabled)),t.depthCompare&&("always"!==t.depthCompare?r.enable(2929):r.disable(2929),r.depthFunc(Pu("depthCompare",t.depthCompare))),t.stencilWriteMask){const e=t.stencilWriteMask;r.stencilMaskSeparate(1028,e),r.stencilMaskSeparate(1029,e)}if(t.stencilReadMask&&ja.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){const e=t.stencilReadMask||4294967295,n=Pu("depthCompare",t.stencilCompare);"always"!==t.stencilCompare?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,n,0,e),r.stencilFuncSeparate(1029,n,0,e)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){const e=Mu("stencilPassOperation",t.stencilPassOperation),n=Mu("stencilFailOperation",t.stencilFailOperation),i=Mu("stencilDepthFailOperation",t.stencilDepthFailOperation);r.stencilOpSeparate(1028,n,i,e),r.stencilOpSeparate(1029,n,i,e)}switch(t.blend){case!0:r.enable(3042);break;case!1:r.disable(3042)}if(t.blendColorOperation||t.blendAlphaOperation){const e=Bu("blendColorOperation",t.blendColorOperation||"add"),n=Bu("blendAlphaOperation",t.blendAlphaOperation||"add");r.blendEquationSeparate(e,n);const i=Lu("blendColorSrcFactor",t.blendColorSrcFactor||"one"),s=Lu("blendColorDstFactor",t.blendColorDstFactor||"zero"),o=Lu("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),a=Lu("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");r.blendFuncSeparate(i,s,o,a)}}function Pu(e,t){return Ou(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function Mu(e,t){return Ou(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function Bu(e,t){return Ou(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function Lu(e,t){return Ou(e,t,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function Ou(e,t,n){if(!(t in n))throw new Error(function(e,t){return"Illegal parameter ".concat(t," for ").concat(e)}(e,t));return n[t]}function Nu(e){let t=!0;for(const n in e){t=!1;break}return t}function Uu(e){const t={};return e.addressModeU&&(t[10242]=zu(e.addressModeU)),e.addressModeV&&(t[10243]=zu(e.addressModeV)),e.addressModeW&&(t[32882]=zu(e.addressModeW)),e.magFilter&&(t[10240]=ju(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";if(!t)return ju(e);switch(t){case"none":return ju(e);case"nearest":return"nearest"===e?9984:9986;case"linear":return"nearest"===e?9985:9987}}(e.minFilter||"linear",e.mipmapFilter)),void 0!==e.lodMinClamp&&(t[33082]=e.lodMinClamp),void 0!==e.lodMaxClamp&&(t[33083]=e.lodMaxClamp),"comparison-sampler"===e.type&&(t[34892]=34894),e.compare&&(t[34893]=Pu("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function zu(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function ju(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}a(Ru,"defaultProps",u(u({},Wa.defaultProps),{},{type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1}));class Vu extends Ru{constructor(e,t){super(e,t),a(this,"device",void 0),a(this,"handle",void 0),a(this,"parameters",void 0),this.device=e,this.parameters=Uu(t),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return"Sampler(".concat(this.id,",").concat(JSON.stringify(this.props),")")}_setSamplerParameters(e){for(const[t,n]of Object.entries(e)){const e=Number(t);switch(e){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,e,n);break;default:this.device.gl.samplerParameteri(this.handle,e,n)}}}}class Gu extends Wa{get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,Gu.defaultProps)}}a(Gu,"defaultProps",u(u({},Wa.defaultProps),{},{format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}));class Wu extends Gu{constructor(e,t){super(e,u(u({},au.defaultProps),t)),a(this,"device",void 0),a(this,"gl",void 0),a(this,"handle",void 0),a(this,"texture",void 0),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}function Hu(e){switch(e){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function Qu(e,t,n){if(function(e){for(const t in e)return!1;return!0}(t))return n(e);const{nocatch:r=!0}=t,i=Nl.get(e);let s;if(i.push(),Bl(e,t),r)s=n(e),i.pop();else try{s=n(e)}finally{i.pop()}return s}function Xu(e,t,n,r){const{width:i,height:s}=r,{dimension:o,depth:a=0,mipLevel:l=0}=r,{x:u=0,y:c=0,z:A=0}=r,{glFormat:h,glType:d}=r,f=qu(r.glTarget,o,a),p=r.flipY?{37440:!0}:{};Qu(e,p,()=>{switch(o){case"2d-array":case"3d":e.bindTexture(f,t),e.texSubImage3D(f,l,u,c,A,i,s,a,h,d,n),e.bindTexture(f,null);break;case"2d":case"cube":e.bindTexture(f,t),e.texSubImage2D(f,l,u,c,i,s,h,d,n),e.bindTexture(f,null);break;default:throw new Error(o)}})}function Yu(e,t,n){const{dimension:r,width:i,height:s,depth:o=0,mipLevel:a=0,byteOffset:l=0}=n,{x:u=0,y:c=0,z:A=0}=n,{glFormat:h,glType:d,compressed:f}=n,p=qu(n.glTarget,r,o);switch(r){case"2d-array":case"3d":f?e.compressedTexSubImage3D(p,a,u,c,A,i,s,o,h,t,l):e.texSubImage3D(p,a,u,c,A,i,s,o,h,d,t,l);break;case"2d":case"cube":f?e.compressedTexSubImage2D(p,a,u,c,i,s,h,t,l):e.texSubImage2D(p,a,u,c,i,s,h,d,t,l);break;default:throw new Error(r)}}function qu(e,t,n){return"cube"===t?34069+n:e}function Ku(e,t){var n;const{sourceX:r=0,sourceY:i=0,sourceAttachment:s=0}=t||{};let{target:o=null,sourceWidth:a,sourceHeight:l,sourceDepth:u,sourceFormat:c,sourceType:A}=t||{};const{framebuffer:h,deleteFramebuffer:d}=Zu(e),{gl:f,handle:p}=h;a||(a=h.width),l||(l=h.height);const g=null===(n=h.colorAttachments[s])||void 0===n?void 0:n.texture;if(!g)throw new Error("Invalid framebuffer attachment ".concat(s));u=(null===g||void 0===g?void 0:g.depth)||1,c||(c=(null===g||void 0===g?void 0:g.glFormat)||6408),A||(A=(null===g||void 0===g?void 0:g.glType)||5121),o=function(e,t,n,r,i){if(e)return e;t||(t=5121);const s=function(e,t){const{clamped:n=!0}=t||{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}(t,{clamped:!1}),o=Hu(n);return new s(r*i*o)}(o,A,c,a,l),A=A||function(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}(o);const m=f.bindFramebuffer(36160,p);return f.readBuffer(36064+s),f.readPixels(r,i,a,l,c,A,o),f.readBuffer(36064),f.bindFramebuffer(36160,m||null),d&&h.destroy(),o}function Zu(e){return e instanceof lu?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:Ju(e),deleteFramebuffer:!0}}function Ju(e,t){const{device:n,width:r,height:i,id:s}=e;return n.createFramebuffer(u(u({},t),{},{id:"framebuffer-for-".concat(s),width:r,height:i,colorAttachments:[e]}))}class $u extends au{constructor(e,t){super(e,t),a(this,"device",void 0),a(this,"gl",void 0),a(this,"handle",void 0),a(this,"sampler",void 0),a(this,"view",void 0),a(this,"mipmaps",void 0),a(this,"compressed",void 0),a(this,"glTarget",void 0),a(this,"glFormat",void 0),a(this,"glType",void 0),a(this,"glInternalFormat",void 0),a(this,"textureUnit",0);const n=u({},this.props);n.data=t.data,this.device=e,this.gl=this.device.gl,this.glTarget=function(e){switch(e){case"1d":case"cube-array":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(e)}(this.props.dimension);const r=$l(this.props.format);this.glInternalFormat=r.internalFormat,this.glFormat=r.format,this.glType=r.type,this.compressed=r.compressed,this.mipmaps=Boolean(this.props.mipmaps),this._initialize(n),Object.seal(this)}_initialize(e){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,u(u({},this.props),{},{data:e.data}));let{width:t,height:n}=e;if(!t||!n){const r=au.getTextureDataSize(e.data);t=(null===r||void 0===r?void 0:r.width)||1,n=(null===r||void 0===r?void 0:r.height)||1}if(this.width=t,this.height=n,this.depth=e.depth,this.setSampler(e.sampler),this.view=new Wu(this.device,u(u({},this.props),{},{texture:this})),this.bind(),function(e,t,n){const{dimension:r,width:i,height:s,depth:o=0}=n,{glInternalFormat:a}=n,l=n.glTarget;switch(r){case"2d-array":case"3d":e.texStorage3D(l,t,a,i,s,o);break;default:e.texStorage2D(l,t,a,i,s)}}(this.gl,this.mipLevels,this),e.data)switch(e.dimension){case"1d":this.setTexture1DData(e.data);break;case"2d":this.setTexture2DData(e.data);break;case"3d":this.setTexture3DData(e.data);break;case"cube":this.setTextureCubeData(e.data);break;case"2d-array":this.setTextureArrayData(e.data);break;case"cube-array":this.setTextureCubeArrayData(e.data);break;default:throw new Error(e.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new Wu(this.device,u(u({},e),{},{texture:this}))}setSampler(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t instanceof Vu?(this.sampler=t,e=t.props):(this.sampler=new Vu(this.device,t),e=t);const n=Uu(e);this._setSamplerParameters(n)}generateMipmap(e){if(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format)||(ja.warn("".concat(this," is not renderable or filterable, may not be able to generate mipmaps"))(),null!==e&&void 0!==e&&e.force))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(t){ja.warn("Error generating mipmap for ".concat(this,": ").concat(t.message))()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(e){const t=au.getExternalImageSize(e.image),n=u(u(u({},au.defaultCopyExternalImageOptions),t),e),{image:r,depth:i,mipLevel:s,x:o,y:a,z:l,flipY:c}=n;let{width:A,height:h}=n;const{dimension:d,glTarget:f,glFormat:p,glInternalFormat:g,glType:m}=this;if(A=Math.min(A,this.width-o),h=Math.min(h,this.height-a),e.sourceX||e.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return Xu(this.device.gl,this.handle,r,{dimension:d,mipLevel:s,x:o,y:a,z:l,width:A,height:h,depth:i,glFormat:p,glInternalFormat:g,glType:m,glTarget:f,flipY:c}),{width:n.width,height:n.height}}setTexture1DData(e){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.bind();const n=au.normalizeTextureData(e,this);n.length>1&&!1!==this.props.mipmaps&&ja.warn("Texture ".concat(this.id," mipmap and multiple LODs."))();for(let r=0;r<n.length;r++){const e=n[r];this._setMipLevel(t,r,e)}this.unbind()}setTexture3DData(e){if("3d"!==this.props.dimension)throw new Error(this.id);ArrayBuffer.isView(e)&&(this.bind(),Yu(this.device.gl,e,this),this.unbind())}setTextureCubeData(e){if("cube"!==this.props.dimension)throw new Error(this.id);for(const t of au.CubeFaces)this.setTextureCubeFaceData(e[t],t)}setTextureArrayData(e){if("2d-array"!==this.props.dimension)throw new Error(this.id);throw new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(e){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(e,t){Array.isArray(e)&&e.length>1&&!1!==this.props.mipmaps&&ja.warn("".concat(this.id," has mipmap and multiple LODs."))();const n=au.CubeFaces.indexOf(t);this.setTexture2DData(e,n)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(e){const{face:t,width:n,height:r,pixels:i,data:s,format:o=6408,type:a=5121}=e,{gl:l}=this,u=i||s;this.bind(),u instanceof Promise?u.then(n=>this.setImageDataForFace(Object.assign({},e,{face:t,data:n,pixels:n}))):this.width||this.height?l.texImage2D(t,0,o,n,r,0,o,a,u):l.texImage2D(t,0,o,o,a,u)}_getImageDataMap(e){for(let t=0;t<au.CubeFaces.length;++t){const n=au.CubeFaces[t];e[n]&&(e[34069+t]=e[n],delete e[n])}return e}_setSamplerParameters(e){ja.log(1,"".concat(this.id," sampler parameters"),this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[t,n]of Object.entries(e)){const e=Number(t),r=n;switch(e){case 33082:case 33083:this.gl.texParameterf(this.glTarget,e,r);break;case 10241:case 10242:case 10243:default:this.gl.texParameteri(this.glTarget,e,r);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,e,r)}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.glTarget;if(au.isExternalImage(n))Xu(this.device.gl,this.handle,n,u(u({},this),{},{depth:e,mipLevel:t,glTarget:r,flipY:this.props.flipY}));else{if(!au.isTextureLevelData(n))throw new Error("Texture: invalid image data");Yu(this.device.gl,n.data,u(u({},this),{},{depth:e,mipLevel:t,glTarget:r}))}}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,this.handle),e}unbind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,null),e}}var ec;class tc extends Wa{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){super(e,t=tc.normalizeProps(e,t),tc.defaultProps)}static normalizeProps(e,t){var n;return u(u({},null===(n=e.props._resourceDefaults)||void 0===n?void 0:n.renderPass),t)}}ec=tc,a(tc,"defaultClearColor",[0,0,0,1]),a(tc,"defaultClearDepth",1),a(tc,"defaultClearStencil",0),a(tc,"defaultProps",u(u({},Wa.defaultProps),{},{framebuffer:null,parameters:void 0,clearColor:ec.defaultClearColor,clearColors:void 0,clearDepth:ec.defaultClearDepth,clearStencil:ec.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}));const nc=[1,2,4,8];class rc extends tc{constructor(e,t){var n;let r;if(super(e,t),a(this,"device",void 0),a(this,"glParameters",void 0),this.device=e,null===t||void 0===t||null===(n=t.parameters)||void 0===n||!n.viewport)if(null!==t&&void 0!==t&&t.framebuffer){const{width:e,height:n}=t.framebuffer;r=[0,0,e,n]}else{const[t,n]=e.getCanvasContext().getDrawingBufferSize();r=[0,0,t,n]}this.device.pushState(),this.setParameters(u({viewport:r},this.props.parameters));const i=this.props.framebuffer;if(null!==i&&void 0!==i&&i.handle)if(this.props.framebuffer){const e=this.props.framebuffer.colorAttachments.map((e,t)=>36064+t);this.device.gl.drawBuffers(e)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=u({},this.glParameters);t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),e[2967]=e.stencilReference),e.colorMask&&(t.colorMask=nc.map(t=>Boolean(t&e.colorMask))),this.glParameters=t,Bl(this.device.gl,t)}beginOcclusionQuery(e){const t=this.props.occlusionQuerySet;null===t||void 0===t||t.beginOcclusionQuery()}endOcclusionQuery(){const e=this.props.occlusionQuerySet;null===e||void 0===e||e.endOcclusionQuery()}clear(){const e=u({},this.glParameters);let t=0;this.props.clearColors&&this.props.clearColors.forEach((e,t)=>{e&&this.clearColorBuffer(t,e)}),!1!==this.props.clearColor&&void 0===this.props.clearColors&&(t|=16384,e.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(t|=256,e.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(t|=1024,e.clearStencil=this.props.clearStencil),0!==t&&Qu(this.device.gl,e,()=>{this.device.gl.clear(t)})}clearColorBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0];Qu(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,t);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}class ic extends Wa{get[Symbol.toStringTag](){return"RenderPipeline"}constructor(e,t){super(e,t,ic.defaultProps),a(this,"shaderLayout",void 0),a(this,"bufferLayout",void 0),a(this,"linkStatus","pending"),a(this,"hash",""),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}function sc(e){return oc.includes(e)}a(ic,"defaultProps",u(u({},Wa.defaultProps),{},{vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}}));const oc=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],ac={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function lc(e){const t=ac[e];if(!t)throw new Error("uniform");const[n,r,,i]=t;return{format:i,components:r,glType:n}}function uc(e){const t=ac[e];if(!t)throw new Error("attribute");const[,n,,r,i]=t;return{attributeType:r,vertexFormat:i,components:n}}function cc(e,t){const n={attributes:[],bindings:[]};n.attributes=function(e,t){const n=[],r=e.getProgramParameter(t,35721);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i);if(!r)throw new Error("activeInfo");const{name:s,type:o}=r,a=e.getAttribLocation(t,s);if(a>=0){const{attributeType:e}=uc(o),t=/instance/i.test(s)?"instance":"vertex";n.push({name:s,location:a,stepMode:t,type:e})}}return n.sort((e,t)=>e.location-t.location),n}(e,t);const r=function(e,t){const n=(n,r)=>e.getActiveUniformBlockParameter(t,n,r),r=[],i=e.getProgramParameter(t,35382);for(let s=0;s<i;s++){const i={name:e.getActiveUniformBlockName(t,s)||"",location:n(s,35391),byteLength:n(s,35392),vertex:n(s,35396),fragment:n(s,35398),uniformCount:n(s,35394),uniforms:[]},o=n(s,35395)||[],a=e.getActiveUniforms(t,o,35383),l=e.getActiveUniforms(t,o,35384),u=e.getActiveUniforms(t,o,35387),c=e.getActiveUniforms(t,o,35388);for(let n=0;n<i.uniformCount;++n){const r=e.getActiveUniform(t,o[n]);if(!r)throw new Error("activeInfo");i.uniforms.push({name:r.name,format:lc(a[n]).format,type:a[n],arrayLength:l[n],byteOffset:u[n],byteStride:c[n]})}r.push(i)}return r.sort((e,t)=>e.location-t.location),r}(e,t);for(const a of r){const e=a.uniforms.map(e=>({name:e.name,format:e.format,byteOffset:e.byteOffset,byteStride:e.byteStride,arrayLength:e.arrayLength}));n.bindings.push({type:"uniform",name:a.name,group:0,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:e})}const i=function(e,t){const n=[],r=e.getProgramParameter(t,35718);for(let i=0;i<r;i++){const r=e.getActiveUniform(t,i);if(!r)throw new Error("activeInfo");const{name:s,size:o,type:a}=r,{name:l,isArray:c}=dc(s);let A=e.getUniformLocation(t,l);const h={location:A,name:l,size:o,type:a,isArray:c};if(n.push(h),h.size>1)for(let i=0;i<h.size;i++){const r="".concat(l,"[").concat(i,"]");A=e.getUniformLocation(t,r);const s=u(u({},h),{},{name:r,location:A});n.push(s)}}return n}(e,t);let s=0;for(const a of i)if(sc(a.type)){const{viewDimension:e,sampleType:t}=hc(a.type);n.bindings.push({type:"texture",name:a.name,group:0,location:s,viewDimension:e,sampleType:t}),a.textureUnit=s,s+=1}i.length&&(n.uniforms=i);const o=function(e,t){const n=[],r=e.getProgramParameter(t,35971);for(let i=0;i<r;i++){const r=e.getTransformFeedbackVarying(t,i);if(!r)throw new Error("activeInfo");const{name:s,type:o,size:a}=r,{glType:l,components:u}=lc(o),c={location:i,name:s,type:l,size:a*u};n.push(c)}return n.sort((e,t)=>e.location-t.location),n}(e,t);return null!==o&&void 0!==o&&o.length&&(n.varyings=o),n}const Ac={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function hc(e){const t=Ac[e];if(!t)throw new Error("sampler");const[n,r]=t;return{viewDimension:n,sampleType:r}}function dc(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:t[2]?1:0,isArray:Boolean(t[2])}}function fc(e,t,n,r){const i=e;let s=r;!0===s&&(s=1),!1===s&&(s=0);const o="number"===typeof s?[s]:s;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if("number"!==typeof r)throw new Error("samplers must be set to integers");return e.uniform1i(t,r);case 5126:return e.uniform1fv(t,o);case 35664:return e.uniform2fv(t,o);case 35665:return e.uniform3fv(t,o);case 35666:return e.uniform4fv(t,o);case 5124:case 35670:return e.uniform1iv(t,o);case 35667:case 35671:return e.uniform2iv(t,o);case 35668:case 35672:return e.uniform3iv(t,o);case 35669:case 35673:return e.uniform4iv(t,o);case 5125:return i.uniform1uiv(t,o,1);case 36294:return i.uniform2uiv(t,o,2);case 36295:return i.uniform3uiv(t,o,3);case 36296:return i.uniform4uiv(t,o,4);case 35674:return e.uniformMatrix2fv(t,!1,o);case 35675:return e.uniformMatrix3fv(t,!1,o);case 35676:return e.uniformMatrix4fv(t,!1,o);case 35685:return i.uniformMatrix2x3fv(t,!1,o);case 35686:return i.uniformMatrix2x4fv(t,!1,o);case 35687:return i.uniformMatrix3x2fv(t,!1,o);case 35688:return i.uniformMatrix3x4fv(t,!1,o);case 35689:return i.uniformMatrix4x2fv(t,!1,o);case 35690:return i.uniformMatrix4x3fv(t,!1,o)}throw new Error("Illegal uniform")}function pc(e){return function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)||function(e){return!!Array.isArray(e)&&(0===e.length||"number"===typeof e[0])}(e)}function gc(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach(n=>{const r=e[n];!function(e){return null!==pc(e)||"number"===typeof e||"boolean"===typeof e}(r)?t.bindings[n]=r:t.uniforms[n]=r}),t}class mc extends ic{constructor(e,t){super(e,t),a(this,"device",void 0),a(this,"handle",void 0),a(this,"vs",void 0),a(this,"fs",void 0),a(this,"introspectedLayout",void 0),a(this,"uniforms",{}),a(this,"bindings",{}),a(this,"varyings",null),a(this,"_uniformCount",0),a(this,"_uniformSetters",{}),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=t.vs,this.fs=t.fs;const{varyings:n,bufferMode:r=35981}=t;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,r)),this._linkShaders(),ja.time(1,"RenderPipeline ".concat(this.id," - shaderLayout introspection"))(),this.introspectedLayout=cc(this.device.gl,this.handle),ja.timeEnd(1,"RenderPipeline ".concat(this.id," - shaderLayout introspection"))(),this.shaderLayout=function(e,t){const n=u(u({},e),{},{attributes:e.attributes.map(e=>u({},e))});for(const r of(null===t||void 0===t?void 0:t.attributes)||[]){const e=n.attributes.find(e=>e.name===r.name);e?(e.type=r.type||e.type,e.stepMode=r.stepMode||e.stepMode):ja.warn("shader layout attribute ".concat(r.name," not present in shader"))}return n}(this.introspectedLayout,t.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,t){for(const[n,r]of Object.entries(e)){const e=this.shaderLayout.bindings.find(e=>e.name===n)||this.shaderLayout.bindings.find(e=>e.name==="".concat(n,"Uniforms"));if(!e){const e=this.shaderLayout.bindings.map(e=>'"'.concat(e.name,'"')).join(", ");null!==t&&void 0!==t&&t.disableWarnings||ja.warn('No binding "'.concat(n,'" in render pipeline "').concat(this.id,'", expected one of ').concat(e),r)();continue}switch(r||ja.warn('Unsetting binding "'.concat(n,'" in render pipeline "').concat(this.id,'"'))(),e.type){case"uniform":if(!(r instanceof Eu)&&!(r.buffer instanceof Eu))throw new Error("buffer value");break;case"texture":if(!(r instanceof Wu||r instanceof $u||r instanceof uu))throw new Error("texture value");break;case"sampler":ja.warn("Ignoring sampler ".concat(n))();break;default:throw new Error(e.type)}this.bindings[n]=r}}draw(e){var t;const{renderPass:n,parameters:r=this.props.parameters,topology:i=this.props.topology,vertexArray:s,vertexCount:o,instanceCount:a,isInstanced:l=!1,firstVertex:u=0,transformFeedback:c}=e,A=function(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(e)}}(i),h=Boolean(s.indexBuffer),d=null===(t=s.indexBuffer)||void 0===t?void 0:t.glIndexType;if("success"!==this.linkStatus)return ja.info(2,"RenderPipeline:".concat(this.id,".draw() aborted - waiting for shader linking"))(),!1;if(!this._areTexturesRenderable())return ja.info(2,"RenderPipeline:".concat(this.id,".draw() aborted - textures not yet loaded"))(),!1;this.device.gl.useProgram(this.handle),s.bindBeforeRender(n),c&&c.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const f=n;return function(e,t,n,r){if(Nu(t))return r(e);const i=e;i.pushState();try{return ku(e,t),Bl(i.gl,n),r(e)}finally{i.popState()}}(this.device,r,f.glParameters,()=>{h&&l?this.device.gl.drawElementsInstanced(A,o||0,d,u,a||0):h?this.device.gl.drawElements(A,o||0,d,u):l?this.device.gl.drawArraysInstanced(A,u,o||0,a||0):this.device.gl.drawArrays(A,u,o||0),c&&c.end()}),s.unbindAfterRender(n),!0}setUniformsWebGL(e){const{bindings:t}=gc(e);Object.keys(t).forEach(e=>{ja.warn('Unsupported value "'.concat(JSON.stringify(t[e]),'" used in setUniforms() for key ').concat(e,". Use setBindings() instead?"))()}),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),ja.time(4,"linkProgram for ".concat(this.id))(),e.linkProgram(this.handle),ja.timeEnd(4,"linkProgram for ".concat(this.id))(),ja.level,!this.device.features.has("compilation-status-async-webgl")){const e=this._getLinkStatus();return void this._reportLinkStatus(e)}ja.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),ja.info(2,"RenderPipeline ".concat(this.id," - async linking complete: ").concat(this.linkStatus))();const t=this._getLinkStatus();this._reportLinkStatus(t)}async _reportLinkStatus(e){var t;if("success"!==e){switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error("Error during compilation of shader ".concat(this.vs.id));case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader())}switch(null===(t=this.fs)||void 0===t?void 0:t.compilationStatus){case"error":throw this.fs.debugShader(),new Error("Error during compilation of shader ".concat(this.fs.id));case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader())}const n=this.device.gl.getProgramInfoLog(this.handle);throw new Error("Error during ".concat(e,": ").concat(n))}}_getLinkStatus(){const{gl:e}=this.device;if(!e.getProgramParameter(this.handle,35714))return this.linkStatus="error","linking";e.validateProgram(this.handle);return e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")}async _waitForLinkComplete(){const e=async e=>await new Promise(t=>setTimeout(t,e));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const t of this.shaderLayout.bindings)this.bindings[t.name]||this.bindings[t.name.replace(/Uniforms$/,"")]||(ja.warn("Binding ".concat(t.name," not found in ").concat(this.id))(),e=!1);return e}_applyBindings(){if("success"!==this.linkStatus)return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,n=0;for(const r of this.shaderLayout.bindings){const i=this.bindings[r.name]||this.bindings[r.name.replace(/Uniforms$/,"")];if(!i)throw new Error("No value for binding ".concat(r.name," in ").concat(this.id));switch(r.type){case"uniform":const{name:s}=r,o=e.getUniformBlockIndex(this.handle,s);if(4294967295===o)throw new Error("Invalid uniform block name ".concat(s));e.uniformBlockBinding(this.handle,n,o),i instanceof Eu?e.bindBufferBase(35345,n,i.handle):e.bindBufferRange(35345,n,i.buffer.handle,i.offset||0,i.size||i.buffer.byteLength-i.offset),n+=1;break;case"texture":if(!(i instanceof Wu||i instanceof $u||i instanceof uu))throw new Error("texture");let a;if(i instanceof Wu)a=i.texture;else if(i instanceof $u)a=i;else{if(!(i instanceof uu&&i.colorAttachments[0]instanceof Wu))throw new Error("No texture");ja.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),a=i.colorAttachments[0].texture}e.activeTexture(33984+t),e.bindTexture(a.glTarget,a.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error("binding type '".concat(r.type,"' not supported in WebGL"))}}}_applyUniforms(){for(const t of this.shaderLayout.uniforms||[]){var e;const{name:n,location:r,type:i,textureUnit:s}=t,o=null!==(e=this.uniforms[n])&&void 0!==e?e:s;void 0!==o&&fc(this.device.gl,r,i,o)}}}class yc extends Wa{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,yc.defaultProps)}}a(yc,"defaultProps",u(u({},Wa.defaultProps),{},{measureExecutionTime:void 0}));class vc extends Wa{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,vc.defaultProps)}}a(vc,"defaultProps",u({},Wa.defaultProps));class _c extends vc{constructor(e){super(e,{}),a(this,"device",void 0),a(this,"commands",[]),this.device=e}submitCommands(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.commands;for(const t of e)switch(t.name){case"copy-buffer-to-buffer":bc(this.device,t.options);break;case"copy-buffer-to-texture":wc(this.device,t.options);break;case"copy-texture-to-buffer":Ec(this.device,t.options);break;case"copy-texture-to-texture":xc(this.device,t.options);break;default:throw new Error(t.name)}}}function bc(e,t){var n,r;const i=t.sourceBuffer,s=t.destinationBuffer;e.gl.bindBuffer(36662,i.handle),e.gl.bindBuffer(36663,s.handle),e.gl.copyBufferSubData(36662,36663,null!==(n=t.sourceOffset)&&void 0!==n?n:0,null!==(r=t.destinationOffset)&&void 0!==r?r:0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function wc(e,t){throw new Error("Not implemented")}function Ec(e,t){const{sourceTexture:n,mipLevel:r=0,aspect:i="all",width:s=t.sourceTexture.width,height:o=t.sourceTexture.height,depthOrArrayLayers:a=0,origin:l=[0,0],destinationBuffer:u,byteOffset:c=0,bytesPerRow:A,rowsPerImage:h}=t;if("all"!==i)throw new Error("aspect not supported in WebGL");if(0!==r||0!==a||A||h)throw new Error("not implemented");const{framebuffer:d,destroyFramebuffer:f}=Dc(n);let p;try{const t=u,n=s||d.width,r=o||d.height,i=$l(d.colorAttachments[0].texture.props.format),a=i.format,A=i.type;e.gl.bindBuffer(35051,t.handle),p=e.gl.bindFramebuffer(36160,d.handle),e.gl.readPixels(l[0],l[1],n,r,a,A,c)}finally{e.gl.bindBuffer(35051,null),void 0!==p&&e.gl.bindFramebuffer(36160,p),f&&d.destroy()}}function xc(e,t){const{sourceTexture:n,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:s=[0,0],destinationTexture:o}=t;let{width:a=t.destinationTexture.width,height:l=t.destinationTexture.height}=t;const{framebuffer:u,destroyFramebuffer:c}=Dc(n),[A,h]=i,[d,f,p]=s,g=e.gl.bindFramebuffer(36160,u.handle);let m,y=null;if(!(o instanceof $u))throw new Error("invalid destination");switch(y=o,a=Number.isFinite(a)?a:y.width,l=Number.isFinite(l)?l:y.height,y.bind(0),m=y.glTarget,m){case 3553:case 34067:e.gl.copyTexSubImage2D(m,r,d,f,A,h,a,l);break;case 35866:case 32879:e.gl.copyTexSubImage3D(m,r,d,f,p,A,h,a,l)}y&&y.unbind(),e.gl.bindFramebuffer(36160,g),c&&u.destroy()}function Dc(e){if(e instanceof au){const{width:t,height:n,id:r}=e;return{framebuffer:e.device.createFramebuffer({id:"framebuffer-for-".concat(r),width:t,height:n,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}class Cc extends yc{constructor(e,t){super(e,t),a(this,"device",void 0),a(this,"commandBuffer",void 0),this.device=e,this.commandBuffer=new _c(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,n){}}const Sc={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},Tc={f32:4,f16:2,i32:4,u32:4};function Ic(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[n,r]=e.split("x"),i=n,s=r?parseInt(r):1,o=Qa(i),a={type:i,components:s,byteLength:o.byteLength*s,integer:o.integer,signed:o.signed,normalized:o.normalized};return t&&(a.webglOnly=!0),a}function Fc(e,t){const n={};for(const r of e.attributes){const i=Rc(e,t,r.name);i&&(n[r.name]=i)}return n}function Rc(e,t,n){const r=function(e,t){const n=e.attributes.find(e=>e.name===t);n||ja.warn('shader layout attribute "'.concat(t,'" not present in shader'));return n||null}(e,n),i=function(e,t){kc(e);let n=function(e,t){for(const n of e)if(n.format&&n.name===t)return{attributeName:n.name,bufferName:t,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}(e,t);if(n)return n;if(n=function(e,t){for(const r of e){var n;let e=r.byteStride;if("number"!==typeof r.byteStride)for(const t of r.attributes||[]){e+=Ic(t.format).byteLength}const i=null===(n=r.attributes)||void 0===n?void 0:n.find(e=>e.attribute===t);if(i)return{attributeName:i.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:e}}return null}(e,t),n)return n;return ja.warn('layout for attribute "'.concat(t,'" not present in buffer layout')),null}(t,n);if(!r)return null;const s=function(e){const[t,n]=Sc[e],r="i32"===t||"u32"===t,i="u32"!==t,s=Tc[t]*n,o=function(e,t){let n;switch(e){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return 1===t?n:"".concat(n,"x").concat(t)}(t,n);return{dataType:t,components:n,defaultVertexFormat:o,byteLength:s,integer:r,signed:i}}(r.type),o=(null===i||void 0===i?void 0:i.vertexFormat)||s.defaultVertexFormat,a=Ic(o);return{attributeName:(null===i||void 0===i?void 0:i.attributeName)||r.name,bufferName:(null===i||void 0===i?void 0:i.bufferName)||r.name,location:r.location,shaderType:r.type,shaderDataType:s.dataType,shaderComponents:s.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:s.integer,stepMode:(null===i||void 0===i?void 0:i.stepMode)||r.stepMode||"vertex",byteOffset:(null===i||void 0===i?void 0:i.byteOffset)||0,byteStride:(null===i||void 0===i?void 0:i.byteStride)||0}}function kc(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&ja.warn("BufferLayout ".concat(name," must have either 'attributes' or 'format' field"))}class Pc extends Wa{get[Symbol.toStringTag](){return"VertexArray"}constructor(e,t){super(e,t,Pc.defaultProps),a(this,"maxVertexAttributes",void 0),a(this,"attributeInfos",void 0),a(this,"indexBuffer",null),a(this,"attributes",void 0),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:n,bufferLayout:r}=t.renderPipeline||{};if(!n||!r)throw new Error("VertexArray");this.attributeInfos=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;const r=Fc(e,t),i=new Array(n).fill(null);for(const s of Object.values(r))i[s.location]=s;return i}(n,r,this.maxVertexAttributes)}setConstantWebGL(e,t){this.device.reportError(new Error("constant attributes not supported"))}}let Mc;function Bc(e){return(!Mc||Mc.byteLength<e)&&(Mc=new ArrayBuffer(e)),Mc}a(Pc,"defaultProps",u(u({},Wa.defaultProps),{},{renderPipeline:null}));class Lc extends Pc{get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(e){return"Chrome"===(t||pe()?fe(t)?"Electron":(t||Ee.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node");var t}constructor(e,t){super(e,t),a(this,"device",void 0),a(this,"handle",void 0),a(this,"buffer",null),a(this,"bufferValue",null),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){var e;(super.destroy(),this.buffer)&&(null===(e=this.buffer)||void 0===e||e.destroy());this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&34963!==t.glTarget)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const n=t;if(34963===n.glTarget)throw new Error("Use .setIndexBuffer()");const{size:r,type:i,stride:s,offset:o,normalized:a,integer:l,divisor:u}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),l?this.device.gl.vertexAttribIPointer(e,r,i,s,o):this.device.gl.vertexAttribPointer(e,r,i,a,s,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,u||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error("Unknown attribute location ".concat(e));const n=Wl(t.bufferDataType);return{size:t.bufferComponents,type:n,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:"instance"===t.stepMode?1:0}}_enable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Lc.isConstantAttributeZeroSupported(this.device);(t||(n||0!==e))&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const n=function(e){if(Array.isArray(e))return new Float32Array(e);return e}(t),r=n.byteLength*e,i=n.length*e;if(this.buffer&&r!==this.buffer.byteLength)throw new Error("Buffer size is immutable, byte length ".concat(r," !== ").concat(this.buffer.byteLength,"."));let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:r}),s=s||!function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(n,this.bufferValue),s){const e=function(e,t){return new e(Bc(e.BYTES_PER_ELEMENT*t),0,t)}(t.constructor,i);!function(e){const{target:t,source:n,start:r=0,count:i=1}=e,s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)t[l++]=n[a];for(;a<o;)a<o-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+o-a),a=o);e.target}({target:e,source:n,start:0,count:i}),this.buffer.write(e),this.bufferValue=t}return this.buffer}}class Oc extends Wa{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,Oc.defaultProps)}}a(Oc,"defaultProps",u(u({},Wa.defaultProps),{},{layout:void 0,buffers:{}}));class Nc extends Oc{constructor(e,t){super(e,t),a(this,"device",void 0),a(this,"gl",void 0),a(this,"handle",void 0),a(this,"layout",void 0),a(this,"buffers",{}),a(this,"unusedBuffers",{}),a(this,"bindOnUse",!0),a(this,"_bound",!1),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"point-list";this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(function(e){switch(e){case"point-list":return 0;case"line-list":case"line-strip":return 1;case"triangle-list":case"triangle-strip":return 4;default:throw new Error(e)}}(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])})}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:r,byteLength:i,byteOffset:s}=this._getBufferRange(t);if(n<0)return this.unusedBuffers[e]=r,void ja.warn("".concat(this.id," unusedBuffers varying buffer ").concat(e))();this.buffers[n]={buffer:r,byteLength:i,byteOffset:s},this.bindOnUse||this._bindBuffer(n,r,s,i)}getBuffer(e){if(Uc(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!==typeof t?(this.gl.bindTransformFeedback(36386,t),this):(this._bound?e=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,e=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),e)}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof Eu)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:n=0,byteLength:r=e.buffer.byteLength}=e;return{buffer:t,byteOffset:n,byteLength:r}}_getVaryingIndex(e){if(Uc(e))return Number(e);for(const t of this.layout.varyings)if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:n,byteOffset:r}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,r,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const i=t&&t.handle;i&&void 0!==r?this.gl.bindBufferRange(35982,e,i,n,r):this.gl.bindBufferBase(35982,e,i)}}function Uc(e){return"number"===typeof e?Number.isInteger(e):/^\d+$/.test(e)}class zc extends Wa{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,zc.defaultProps)}}a(zc,"defaultProps",u(u({},Wa.defaultProps),{},{type:void 0,count:void 0}));class jc extends zc{get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),a(this,"device",void 0),a(this,"handle",void 0),a(this,"target",null),a(this,"_queryPending",!1),a(this,"_pollingPromise",null),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(null!==e&&void 0!==e&&e.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)}),this._pollingPromise}}class Vc extends pl{constructor(e){var t;super(u(u({},e),{},{id:e.id||wu("webgl-device")})),a(this,"type","webgl"),a(this,"handle",void 0),a(this,"features",void 0),a(this,"limits",void 0),a(this,"info",void 0),a(this,"canvasContext",void 0),a(this,"lost",void 0),a(this,"_resolveContextLost",void 0),a(this,"gl",void 0),a(this,"debug",!1),a(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1}),a(this,"_extensions",{}),a(this,"_polyfilled",!1),a(this,"spectorJS",void 0),a(this,"renderPass",null),a(this,"_constants",void 0);const n=pl._getCanvasContextProps(e);if(!n)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let r=null===(t=n.canvas)||void 0===t||null===(t=t.gl)||void 0===t?void 0:t.device;if(r)throw new Error("WebGL context already attached to device ".concat(r.id));this.canvasContext=new cu(this,n),this.lost=new Promise(e=>{this._resolveContextLost=e});const i=u({},e.webgl);"premultiplied"===n.alphaMode&&(i.premultipliedAlpha=!0),void 0!==e.powerPreference&&(i.powerPreference=e.powerPreference);const s=this.props._handle||function(e,t,n){var r;let i="";const s=u({preserveDrawingBuffer:!0},n);let o=null;var a;if(o||(o=e.getContext("webgl2",s)),s.failIfMajorPerformanceCaveat&&(i||(i="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow.")),o||n.failIfMajorPerformanceCaveat||(s.failIfMajorPerformanceCaveat=!1,o=e.getContext("webgl2",s),(a=o).luma||(a.luma={}),o.luma.softwareRenderer=!0),o||(o=e.getContext("webgl",{}),o&&(o=null,i||(i="Your browser only supports WebGL1"))),!o)throw i||(i="Your browser does not support WebGL"),new Error("Failed to create WebGL context: ".concat(i));const{onContextLost:l,onContextRestored:c}=t;return e.addEventListener("webglcontextlost",e=>l(e),!1),e.addEventListener("webglcontextrestored",e=>c(e),!1),(r=o).luma||(r.luma={}),o}(this.canvasContext.canvas,{onContextLost:e=>{var t;return null===(t=this._resolveContextLost)||void 0===t?void 0:t.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})},onContextRestored:e=>console.log("WebGL context restored")},i);if(!s)throw new Error("WebGL context creation failed");if(r=s.device,r){if(e._reuseDevices)return ja.log(1,"Not creating a new Device, instead returning a reference to Device ".concat(r.id," already attached to WebGL context"),r)(),r._reused=!0,r;throw new Error("WebGL context already attached to device ".concat(r.id))}this.handle=s,this.gl=s,this.spectorJS=function(e){var t,n,r;if(!(e=u(u({},fu),e)).debugSpectorJS)return null;if(!hu&&globalThis.SPECTOR&&(null===(t=globalThis.luma)||void 0===t||!t.spector)){ja.probe(1,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;hu=new e,globalThis.luma&&(globalThis.luma.spector=hu)}if(!hu)return null;if(du||(du=!0,hu.spyCanvases(),null===(n=hu)||void 0===n||n.onCaptureStarted.add(e=>ja.info("Spector capture started:",e)()),null===(r=hu)||void 0===r||r.onCapture.add(e=>{var t,n,r;ja.info("Spector capture complete:",e)(),null===(t=hu)||void 0===t||t.getResultUI(),null===(n=hu)||void 0===n||n.resultView.display(),null===(r=hu)||void 0===r||r.resultView.addCapture(e)})),e.gl){var i;const t=e.gl,n=t.device;null===(i=hu)||void 0===i||i.startCapture(e.gl,500),t.device=n,new Promise(e=>setTimeout(e,2e3)).then(e=>{var t;ja.info("Spector capture stopped after 2 seconds")(),null===(t=hu)||void 0===t||t.stopCapture()})}return hu}(u(u({},this.props),{},{gl:this.handle})),this.gl.device=this,this.gl._version=2,this.info=Vl(this.gl,this._extensions),this.limits=new ru(this.gl),this.features=new nu(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),!1!==n.autoResize&&this.canvasContext.resize();const o=new Nl(this.gl,{log:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ja.log(1,...t)()}});o.trackState(this.gl,{copyState:!1});const l=e.debugWebGL||e.debug,c=e.debugWebGL;l&&(this.gl=mu(this.gl,{debugWebGL:l,traceWebGL:c}),ja.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(ja.level=Math.max(ja.level,1)))}destroy(){this.props._reuseDevices||this._reused||delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._normalizeBufferProps(e);return new Eu(this,t)}createTexture(e){return new $u(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new Vu(this,e)}createShader(e){return new Fu(this,e)}createFramebuffer(e){return new uu(this,e)}createVertexArray(e){return new Lc(this,e)}createTransformFeedback(e){return new Nc(this,e)}createQuerySet(e){return new jc(this,e)}createRenderPipeline(e){return new mc(this,e)}beginRenderPass(e){return new rc(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}createCommandEncoder(){return new Cc(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}submit(){var e;null===(e=this.renderPass)||void 0===e||e.end(),this.renderPass=null}readPixelsToArrayWebGL(e,t){return Ku(e,t)}readPixelsToBufferWebGL(e,t){return function(e,t){const{target:n,sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,targetByteOffset:o=0}=t||{};let{sourceWidth:a,sourceHeight:l,sourceType:u}=t||{};const{framebuffer:c,deleteFramebuffer:A}=Zu(e);a=a||c.width,l=l||c.height;const h=c;u=u||5121;let d=n;if(!d){const e=Hu(s),t=function(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}(u),n=o+a*l*e*t;d=h.device.createBuffer({byteLength:n})}const f=e.device.createCommandEncoder();return f.copyTextureToBuffer({sourceTexture:e,width:a,height:l,origin:[r,i],destinationBuffer:d,byteOffset:o}),f.destroy(),A&&c.destroy(),d}(e,t)}setParametersWebGL(e){Bl(this.gl,e)}getParametersWebGL(e){return Ll(this.gl,e)}withParametersWebGL(e,t){return Qu(this.gl,e,t)}resetWebGL(){ja.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),Bl(this.gl,bl)}_getDeviceSpecificTextureFormatCapabilities(e){return function(e,t,n){let r=t.create;const i=Jl[t.format];return void 0===(null===i||void 0===i?void 0:i.gl)&&(r=!1),null!==i&&void 0!==i&&i.x&&(r=r&&Boolean(jl(e,i.x,n))),{format:t.format,create:r&&t.create,render:r&&t.render,filter:r&&t.filter,blend:r&&t.blend,store:r&&t.store}}(this.gl,e,this._extensions)}loseDevice(){var e;let t=!1;const n=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return n&&(t=!0,n.loseContext()),null===(e=this._resolveContextLost)||void 0===e||e.call(this,{reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){Nl.get(this.gl).push()}popState(){Nl.get(this.gl).pop()}setSpectorMetadata(e,t){e.__SPECTOR_Metadata=t}getGLKey(e,t){const n=Number(e);for(const r in this.gl)if(this.gl[r]===n)return"GL.".concat(r);return null!==t&&void 0!==t&&t.emptyIfUnknown?"":String(e)}getGLKeys(e){const t={emptyIfUnknown:!0};return Object.entries(e).reduce((e,n)=>{let[r,i]=n;return e["".concat(r,":").concat(this.getGLKey(r,t))]="".concat(i,":").concat(this.getGLKey(i,t)),e},{})}setConstantAttributeWebGL(e,t){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const r=this._constants[e];switch(r&&function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(r,t)&&ja.info(1,"setConstantAttributeWebGL(".concat(e,") could have been skipped, value unchanged"))(),this._constants[e]=t,t.constructor){case Float32Array:!function(e,t,n){switch(n.length){case 1:e.gl.vertexAttrib1fv(t,n);break;case 2:e.gl.vertexAttrib2fv(t,n);break;case 3:e.gl.vertexAttrib3fv(t,n);break;case 4:e.gl.vertexAttrib4fv(t,n)}}(this,e,t);break;case Int32Array:!function(e,t,n){e.gl.vertexAttribI4iv(t,n)}(this,e,t);break;case Uint32Array:!function(e,t,n){e.gl.vertexAttribI4uiv(t,n)}(this,e,t);break;default:throw new Error("constant")}}getExtension(e){return jl(this.gl,e,this._extensions),this._extensions}}const Gc={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},Wc=e=>({drawBuffersWEBGL:t=>e.drawBuffers(t),COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),Hc=e=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES:()=>e.createVertexArray(),deleteVertexArrayOES:t=>e.deleteVertexArray(t),isVertexArrayOES:t=>e.isVertexArray(t),bindVertexArrayOES:t=>e.bindVertexArray(t)}),Qc=e=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(){return e.drawArraysInstanced(...arguments)},drawElementsInstancedANGLE(){return e.drawElementsInstanced(...arguments)},vertexAttribDivisorANGLE(){return e.vertexAttribDivisor(...arguments)}});function Xc(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext)return t.getContext=t.originalGetContext,void(t.originalGetContext=void 0);t.originalGetContext=t.getContext,t.getContext=function(e,t){if("webgl"===e||"experimental-webgl"===e){const e=this.originalGetContext("webgl2",t);return e instanceof HTMLElement&&function(e){e.getExtension("EXT_color_buffer_float");const t=u(u({},Gc),{},{WEBGL_disjoint_timer_query:e.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:Wc(e),OES_vertex_array_object:Hc(e),ANGLE_instanced_arrays:Qc(e)}),n=e.getExtension;e.getExtension=function(r){const i=n.call(e,r);return i||(r in t?t[r]:null)};const r=e.getSupportedExtensions;e.getSupportedExtensions=function(){const n=r.apply(e)||[];return null===n||void 0===n?void 0:n.concat(Object.keys(t))}}(e),e}return this.originalGetContext(e,t)}}const Yc=new class extends _l{constructor(){super(),a(this,"type","webgl"),pl.defaultProps=u(u({},pl.defaultProps),fu),Vc.adapter=this}isSupported(){return"undefined"!==typeof WebGL2RenderingContext}enforceWebGL2(e){Xc(e)}async attach(e){if(e instanceof Vc)return e;if((null===e||void 0===e?void 0:e.device)instanceof pl)return e.device;if(!function(e){if("undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return!0;return Boolean(e&&Number.isFinite(e._version))}(e))throw new Error("Invalid WebGL2RenderingContext");return new Vc({_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1}})}async create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ja.groupCollapsed(1,"WebGLDevice created")();const t=[];(e.debugWebGL||e.debug)&&t.push(async function(){pe()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Au("https://unpkg.com/webgl-debug@2.0.1/index.js"))}()),e.debugSpectorJS&&t.push(async function(e){if(!globalThis.SPECTOR)try{await Au(e.debugSpectorJSUrl||fu.debugSpectorJSUrl)}catch(t){ja.warn(String(t))}}(e));const n=await Promise.allSettled(t);for(const s of n)"rejected"===s.status&&ja.error("Failed to initialize debug libraries ".concat(s.reason))();const r=new Vc(e),i="".concat(r._reused?"Reusing":"Created"," device with WebGL2 ").concat(r.debug?"debug ":"","context: ").concat(r.info.vendor,", ").concat(r.info.renderer," for canvas: ").concat(r.canvasContext.id);return ja.probe(1,i)(),ja.table(1,r.info)(),ja.groupEnd(1)(),r}};let qc=0;const Kc={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:vl.stats.get("animation-loop-".concat(qc++)),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class Zc{constructor(e){if(a(this,"device",null),a(this,"canvas",null),a(this,"props",void 0),a(this,"animationProps",null),a(this,"timeline",null),a(this,"stats",void 0),a(this,"cpuTime",void 0),a(this,"gpuTime",void 0),a(this,"frameRate",void 0),a(this,"display",void 0),a(this,"needsRedraw","initialized"),a(this,"_initialized",!1),a(this,"_running",!1),a(this,"_animationFrameId",null),a(this,"_nextFramePromise",null),a(this,"_resolveNextFrame",null),a(this,"_cpuStartTime",0),a(this,"_error",null),this.props=u(u({},Kc),e),!(e=this.props).device)throw new Error("No device provided");const{useDevicePixels:t=!0}=this.props;this.stats=e.stats||new Ge({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:t}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){var t;this.props.onError(e),this._error=Error();if((null===(t=this.device)||void 0===t||null===(t=t.canvasContext)||void 0===t?void 0:t.canvas)instanceof HTMLCanvasElement){const t=document.createElement("h1");t.innerHTML=e.message,t.style.position="absolute",t.style.top="20%",t.style.left="10px",t.style.color="black",t.style.backgroundColor="red",document.body.appendChild(t)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(!1!==e&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var e;return null!==(e=this.device)&&void 0!==e&&e.isLost||this._error||(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers()),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){var e;this._running&&(this._animationFrameId=(e=this._animationFrame.bind(this),"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)))}_cancelAnimationFrame(){var e;null!==this._animationFrameId&&(e=this._animationFrameId,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){var t;this.display?this.display._renderFrame(e):(this.props.onRender(this._getAnimationProps()),null===(t=this.device)||void 0===t||t.submit())}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){var e;const t=null===(e=this.device)||void 0===e||null===(e=e.canvasContext)||void 0===e?void 0:e.canvas;if(!this.device||!t)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:t,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){var e;if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=(null===(e=this.device.canvasContext)||void 0===e?void 0:e.canvas)||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){var e,t;if(!this.device)return{width:1,height:1,aspect:1};const[n,r]=(null===(e=this.device)||void 0===e||null===(e=e.canvasContext)||void 0===e?void 0:e.getPixelSize())||[1,1];let i=1;const s=null===(t=this.device)||void 0===t||null===(t=t.canvasContext)||void 0===t?void 0:t.canvas;return s&&s.clientHeight?i=s.clientWidth/s.clientHeight:n>0&&r>0&&(i=n/r),{width:n,height:r,aspect:i}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){var e;this.props.autoResizeDrawingBuffer&&(null===(e=this.device)||void 0===e||null===(e=e.canvasContext)||void 0===e||e.resize({useDevicePixels:this.props.useDevicePixels}))}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}function Jc(){}const $c={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Jc,onWebGLInitialized:Jc,onResize:Jc,onViewStateChange:Jc,onInteractionStateChange:Jc,onBeforeRender:Jc,onAfterRender:Jc,onLoad:Jc,onError:e=>Me.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:e=>{let{isDragging:t}=e;return t?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class eA{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Ge({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=e=>{const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const n=e.offsetCenter;if(!n)return;t.x=n.x,t.y=n.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e},this._onEvent=e=>{const t=hs[e.type],n=e.offsetCenter;if(!t||!n||!this.layerManager)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:s}=i,o=s&&(s[t]||s.props[t]),a=this.props[t];let l=!1;o&&(l=o.call(s,i,e)),l||(null===a||void 0===a||a(i,e),this.widgetManager.onEvent(i,e))},this._onPointerDown=e=>{var t;if("webgpu"===(null===(t=this.device)||void 0===t?void 0:t.type))return;const n=e.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:n.x,y:n.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo},this.props=u(u({},$c),e),(e=this.props).viewState&&e.initialViewState&&Me.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let t=this.device;!t&&e.gl&&(e.gl instanceof WebGLRenderingContext&&Me.error("WebGL1 context not supported.")(),t=Yc.attach(e.gl)),t||(t=vl.createDevice(u(u({type:"best-available",_reuseDevices:!0,adapters:[Yc]},e.deviceProps),{},{createCanvasContext:{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!1}}))),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&Rn.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,n,r,i,s,o,a,l,u;(null===(e=this.animationLoop)||void 0===e||e.stop(),null===(t=this.animationLoop)||void 0===t||t.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(n=this.layerManager)||void 0===n||n.finalize(),this.layerManager=null,null===(r=this.viewManager)||void 0===r||r.finalize(),this.viewManager=null,null===(i=this.effectManager)||void 0===i||i.finalize(),this.effectManager=null,null===(s=this.deckRenderer)||void 0===s||s.finalize(),this.deckRenderer=null,null===(o=this.deckPicker)||void 0===o||o.finalize(),this.deckPicker=null,null===(a=this.eventManager)||void 0===a||a.destroy(),this.eventManager=null,null===(l=this.widgetManager)||void 0===l||l.finalize(),this.widgetManager=null,this.props.canvas||this.props.device||this.props.gl||!this.canvas)||(null===(u=this.canvas.parentElement)||void 0===u||u.removeChild(this.canvas),this.canvas=null)}setProps(e){var t;this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Me.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Me.removed("onLayerClick","onClick")(),e.initialViewState&&!bs(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),null===(t=this.animationLoop)||void 0===t||t.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n),this.widgetManager.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),i=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return t=t||n||r||i||s,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return Ls(this.viewManager),this.viewManager.views}getViewports(e){return Ls(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){var t;null===(t=this.layerManager)||void 0===t||t.removeDefaultShaderModule(e)}_pick(e,t,n){Ls(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const i=this.deckPicker[e](u({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects()},n));return r.get(t).timeEnd(),i}_createCanvas(e){let t=e.canvas;if("string"===typeof t&&(t=document.getElementById(t),Ls(t)),!t){t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay";(e.parent||document.body).appendChild(t)}return Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:n}=e;if(t||0===t){const e=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=e}if(n||0===n){var r;const t=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(r=e.style)||void 0===r?void 0:r.position)||"absolute",this.canvas.style.height=t}}_updateCanvasSize(){var e,t;const{canvas:n}=this;if(!n)return;const r=null!==(e=n.clientWidth)&&void 0!==e?e:n.width,i=null!==(t=n.clientHeight)&&void 0!==t?t:n.height;var s,o;r===this.width&&i===this.height||(this.width=r,this.height=i,null===(s=this.viewManager)||void 0===s||s.setProps({width:r,height:i}),null===(o=this.layerManager)||void 0===o||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:i}))}_createAnimationLoop(e,t){const{gl:n,onError:r,useDevicePixels:i}=t;return new Zc({device:e,useDevicePixels:i,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:e=>this._setDevice(e.device),onRender:this._onRenderFrame.bind(this),onError:r})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new to({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){var e;if("webgpu"===(null===(e=this.device)||void 0===e?void 0:e.type))return;const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:s}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=e.length>0;let o=s,a=!1;for(const r of e){var n;o=r,a=(null===(n=r.layer)||void 0===n?void 0:n.onHover(r,t.event))||a}var r,i;if(!a)null===(r=(i=this.props).onHover)||void 0===r||r.call(i,o,t.event),this.widgetManager.onHover(o,t.event);t.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){var t,n;if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=null===(n=this.device.canvasContext)||void 0===n?void 0:n.canvas);"webgl"===this.device.type&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),"webgl"===this.device.type&&this.props.onWebGLInitialized(this.device.gl);const r=new h;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new ls(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(ds).map(e=>{var t;const[n,r,i,s]=ds[e],o=null===(t=this.props.eventRecognizerOptions)||void 0===t?void 0:t[e];return{recognizer:new n(u(u(u({},r),o),{},{event:e})),recognizeWith:i,requestFailure:s}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const s in hs)this.eventManager.on(s,this._onEvent);this.viewManager=new ws({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new _s(this.device,{deck:this,stats:this.stats,viewport:i,timeline:r}),this.effectManager=new Zo({deck:this,device:this.device}),this.deckRenderer=new na(this.device),this.deckPicker=new la(this.device),this.widgetManager=new ha({deck:this,parentElement:null===(t=this.canvas)||void 0===t?void 0:t.parentElement}),this.widgetManager.addDefault(new fa),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){var n;const{device:r,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:i});const s=u({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects()},t);null===(n=this.deckRenderer)||void 0===n||n.renderLayers(s),"screen"===s.pass&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:r,gl:i})}_onRenderFrame(){var e;this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Me.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),"webgpu"!==(null===(e=this.device)||void 0===e?void 0:e.type)&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=u(u({},this.viewState),{},{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=vl.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}eA.defaultProps=$c,eA.VERSION=Ua;const tA=eA,nA="undefined"!==typeof window?r.useLayoutEffect:r.useEffect;function rA(e,t){for(;e;){if(e===t)return!0;e=Object.getPrototypeOf(e)}return!1}function iA(e){const t=ArrayBuffer.isView(e)?e.constructor:e;switch(t){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(t.constructor.name)}}function sA(e){switch(e){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(e)}}function oA(e,t,n){if(!t||t>4)throw new Error("size ".concat(t));const r=t;let i=iA(e);if("uint8"===i&&n&&1===r)return"unorm8-webgl";if("uint8"===i&&n&&3===r)return"unorm8x3-webgl";if("uint8"===i||"sint8"===i){if(1===r||3===r)throw new Error("size: ".concat(t));return n&&(i=i.replace("int","norm")),"".concat(i,"x").concat(r)}if("uint16"===i||"sint16"===i){if(1===r||3===r)throw new Error("size: ".concat(t));return n&&(i=i.replace("int","norm")),"".concat(i,"x").concat(r)}return 1===r?i:"".concat(i,"x").concat(r)}const aA=iA;function lA(e,t,n){const r="webgpu"===n&&"uint8"===t.type?"unorm8":t.type;return{attribute:e,format:t.size>1?"".concat(r,"x").concat(t.size):t.type,byteOffset:t.offset||0}}function uA(e){return e.stride||e.size*e.bytesPerElement}function cA(e,t){t.offset&&Me.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=uA(e),r=(void 0!==t.vertexOffset?t.vertexOffset:e.vertexOffset||0)*n+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return u(u({},t),{},{offset:r,stride:n})}class AA{constructor(e,t,n){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const r=t.logicalType||t.type,i="float64"===r;let s,{defaultValue:o}=t;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0),s=i?"float32":!r&&t.isIndexed?"uint32":r||"float32";let a=function(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return sA(e)}}(r||s);this.doublePrecision=i,i&&!1===t.fp64&&(a=Float32Array),this.value=null,this.settings=u(u({},t),{},{defaultType:a,defaultValue:o,logicalType:r,type:s,normalized:s.includes("norm"),size:this.size,bytesPerElement:a.BYTES_PER_ELEMENT}),this.state=u(u({},n),{},{externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1})}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*uA(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Rn.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n={};if(this.state.constant){const r=this.value;if(t){const i=cA(this.getAccessor(),t),s=i.offset/r.BYTES_PER_ELEMENT,o=i.size||this.size;n[e]=r.subarray(s,s+o)}else n[e]=r}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n["".concat(e,"64Low")]=n[e]:n["".concat(e,"64Low")]=new Float32Array(this.size)),n}_getBufferLayout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getAccessor(),r=[],i={name:this.id,byteStride:uA(n),attributes:r};if(this.doublePrecision){const i=function(e,t){const n=cA(e,t);return{high:n,low:u(u({},n),{},{offset:n.offset+4*e.size})}}(n,t||{});r.push(lA(e,u(u({},n),i.high),this.device.type),lA("".concat(e,"64Low"),u(u({},n),i.low),this.device.type))}else if(t){const i=cA(n,t);r.push(lA(e,u(u({},n),i),this.device.type))}else r.push(lA(e,n,this.device.type));return i}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:n,size:r}=this,i=n*r;if(t&&i&&t.length>=i){const n=new Array(r).fill(1/0),s=new Array(r).fill(-1/0);for(let e=0;e<i;)for(let i=0;i<r;i++){const r=t[e++];r<n[i]&&(n[i]=r),r>s[i]&&(s[i]=r)}e=[n,s]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let n;n=ArrayBuffer.isView(e)?{value:e}:e instanceof Ha?{buffer:e}:e;const r=u(u({},this.settings),n);if(ArrayBuffer.isView(n.value)){if(!n.type){if(this.doublePrecision&&n.value instanceof Float64Array)r.type="float32";else{const e=aA(n.value);r.type=r.normalized?e.replace("int","norm"):e}}r.bytesPerElement=n.value.BYTES_PER_ELEMENT,r.stride=uA(r)}if(t.bounds=null,n.constant){let e=n.value;e=this._normalizeValue(e,[],0),this.settings.normalized&&(e=this.normalizeConstant(e));if(!(!t.constant||!this._areValuesEqual(e,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(e)?e:new Float32Array(e)}else if(n.buffer){const e=n.buffer;t.externalBuffer=e,t.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let e=n.value;t.externalBuffer=null,t.constant=!1,this.value=e;let{buffer:i}=this;const s=uA(r),o=(r.vertexOffset||0)*s;if(this.doublePrecision&&e instanceof Float64Array&&(e=Ar(e,r)),this.settings.isIndexed){const t=this.settings.defaultType;e.constructor!==t&&(e=new t(e))}const a=e.byteLength+o+2*s;(!i||i.byteLength<a)&&(i=this._createBuffer(a)),i.write(e,o)}return this.setAccessor(r),!0}updateSubBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;const t=this.value,{startOffset:n=0,endOffset:r}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?Ar(t,{size:this.size,startIndex:n,endIndex:r}):t.subarray(n,r),n*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:n}=this,r=n.allocatedValue,i=Rn.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=i;const{byteOffset:s}=this;let{buffer:o}=this;return(!o||o.byteLength<i.byteLength+s)&&(o=this._createBuffer(i.byteLength+s),t&&r&&o.write(r instanceof Float64Array?Ar(r,this):r,s)),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));t instanceof n||!this.settings.normalized||"normalized"in e||Me.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(e=>(e+128)/255*2-1);case"snorm16":return new Float32Array(e).map(e=>(e+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(e=>e/255);case"unorm16":return new Float32Array(e).map(e=>e/65535);default:return e}}_normalizeValue(e,t,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e){let e=i;for(;--e>=0;)t[n+e]=r[e];return t}switch(i){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let s=i;for(;--s>=0;)t[n+s]=Number.isFinite(e[s])?e[s]:r[s]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}_createBuffer(e){var t;this._buffer&&this._buffer.destroy();const{isIndexed:n,type:r}=this.settings;return this._buffer=this.device.createBuffer(u(u({},null===(t=this._buffer)||void 0===t?void 0:t.props),{},{id:this.id,usage:(n?Ha.INDEX:Ha.VERTEX)|Ha.COPY_DST,indexType:n?r:void 0,byteLength:e})),this._buffer}}const hA=[],dA=[];function fA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=hA;const i={index:-1,data:e,target:[]};return e?"function"===typeof e[Symbol.iterator]?r=e:e.length>0&&(dA.length=e.length,r=dA):r=hA,(t>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(t,n),i.index=t-1),{iterable:r,objectInfo:i}}function pA(e){return e&&e[Symbol.asyncIterator]}function gA(e,t){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=t,a=e.BYTES_PER_ELEMENT,l=r?r/a:n,u=i?i/a:0,c=Math.floor((e.length-u)/l);return(t,r)=>{let{index:i,target:a}=r;if(!s){const t=i*l+u;for(let r=0;r<n;r++)a[r]=e[t+r];return a}const A=s[i],h=s[i+1]||c;let d;if(o){d=new Array(h-A);for(let t=A;t<h;t++){const r=t*l+u;a=new Array(n);for(let t=0;t<n;t++)a[t]=e[r+t];d[t-A]=a}}else if(l===n)d=e.subarray(A*n+u,h*n+u);else{d=new e.constructor((h-A)*n);let t=0;for(let r=A;r<h;r++){const i=r*l+u;for(let r=0;r<n;r++)d[t++]=e[i+r]}}return d}}const mA=[],yA=[[0,1/0]];const vA={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function _A(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});const n=e.type||"interpolation";return u(u(u(u({},vA[n]),t),e),{},{type:n})}class bA extends AA{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:yA}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t,n,r;(t=this.state).layoutChanged||(t.layoutChanged=(n=e,r=this.getAccessor(),!(n.type===r.type&&n.size===r.size&&uA(n)===uA(r)&&(n.offset||0)===(r.offset||0)))),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!==typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition,r=Array.isArray(t)?e[t.find(t=>e[t])]:e[t];return _A(r,n)}setNeedsUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:e=0,endRow:n=1/0}=t;this.state.updateRanges=function(e,t){if(e===yA)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;const n=[],r=e.length;let i=0;for(let s=0;s<r;s++){const r=e[s];r[1]<t[0]?(n.push(r),i=s+1):r[0]>t[1]?n.push(r):t=[Math.min(r[0],t[0]),Math.max(r[1],t[1])]}return n.splice(i,0,t),n}(this.state.updateRanges,[e,n])}else this.state.updateRanges=yA}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=mA}setNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(e,t.updateRanges!==yA),!0))}updateBuffer(e){let{numInstances:t,data:n,props:r,context:i}=e;if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[e,a]of s)o.call(i,this,{data:n,startRow:e,endRow:a,props:r,numInstances:t});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of s){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):a||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}else;this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){if("webgpu"===this.device.type||void 0===e||"function"===typeof e)return!1;return this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{state:n,settings:r}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;n.binaryValue=e,this.setNeedsRedraw();if(r.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const i=e;Ls(ArrayBuffer.isView(i.value),"invalid ".concat(r.accessor));const s=Boolean(i.size)&&i.size!==this.size;return n.binaryAccessor=gA(i.value,{size:i.size||this.size,stride:i.stride,offset:i.offset,startIndices:t,nested:s}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const n in e)Object.assign(t,super.getValue(n,e[n]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:r}=this.settings;if(n.stepMode="dynamic"===r?e?e.isInstanced?"instance":"vertex":"instance":null!==r&&void 0!==r?r:"vertex",!t)return n;for(const i in t){const e=super._getBufferLayout(i,t[i]);n.attributes.push(...e.attributes)}return n}_autoUpdater(e,t){let{data:n,startRow:r,endRow:i,props:s,numInstances:o}=t;if(e.constant&&"webgpu"!==this.context.device.type)return;const{settings:a,state:l,value:u,size:c,startIndices:A}=e,{accessor:h,transform:d}=a;let f=l.binaryAccessor||("function"===typeof h?h:s[h]);"function"!==typeof f&&(f=()=>f),Ls("function"===typeof f,'accessor "'.concat(h,'" is not a function'));let p=e.getVertexOffset(r);const{iterable:g,objectInfo:m}=fA(n,r,i);for(const y of g){m.index++;let t=f(y,m);if(d&&(t=d.call(this,t)),A){const n=(m.index<A.length-1?A[m.index+1]:o)-A[m.index];if(t&&Array.isArray(t[0])){let n=p;for(const r of t)e._normalizeValue(r,u,n),n+=c}else t&&t.length>c?u.set(t,p):(e._normalizeValue(t,m.target,0),ze({target:u,source:m.target,start:p,count:n}));p+=n*c}else e._normalizeValue(t,u,p),p+=c}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||"function"===typeof e.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const wA="#version 300 es\n".concat("out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}");function EA(e){const{input:t,inputChannels:n,output:r}=e||{};if(!t)return wA;if(!n)throw new Error("inputChannels");const i=function(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error("invalid channels: ".concat(e))}}(n),s=function(e,t){switch(t){case 1:return"vec4(".concat(e,", 0.0, 0.0, 1.0)");case 2:return"vec4(".concat(e,", 0.0, 1.0)");case 3:return"vec4(".concat(e,", 1.0)");case 4:return e;default:throw new Error("invalid channels: ".concat(t))}}(t,n);return"#version 300 es\nin ".concat(i," ").concat(t,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(s,";\n}")}class xA{constructor(e){a(this,"bufferLayouts",void 0),this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(t=>t.name===e)||null}getAttributeNamesForBuffer(e){var t;return e.attributes?null===(t=e.attributes)||void 0===t?void 0:t.map(e=>e.attribute):[e.name]}mergeBufferLayouts(e,t){const n=[...e];for(const r of t){const e=n.findIndex(e=>e.name===r.name);e<0?n.push(r):n[e]=r}return n}getBufferIndex(e){const t=this.bufferLayouts.findIndex(t=>t.name===e);return-1===t&&ja.warn('BufferLayout: Missing buffer for "'.concat(e,'".'))(),t}}function DA(e){return Array.isArray(e)?0===e.length||"number"===typeof e[0]:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)}class CA{constructor(e){if(a(this,"name",void 0),a(this,"uniforms",{}),a(this,"modifiedUniforms",{}),a(this,"modified",!0),a(this,"bindingLayout",{}),a(this,"needsRedraw","initialized"),this.name=(null===e||void 0===e?void 0:e.name)||"unnamed",null!==e&&void 0!==e&&e.name&&null!==e&&void 0!==e&&e.shaderLayout){var t;const n=null===e||void 0===e||null===(t=e.shaderLayout.bindings)||void 0===t?void 0:t.find(t=>"uniform"===t.type&&t.name===(null===e||void 0===e?void 0:e.name));if(!n)throw new Error(null===e||void 0===e?void 0:e.name);const r=n;for(const e of r.uniforms||[])this.bindingLayout[e.name]=e}}setUniforms(e){for(const[t,n]of Object.entries(e))this._setUniform(t,n),this.needsRedraw||this.setNeedsRedraw("".concat(this.name,".").concat(t,"=").concat(n))}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){(function(e,t){if(e!==t)return!1;const n=e,r=t;if(!DA(n))return!1;if(DA(r)&&n.length===r.length)for(let i=0;i<n.length;++i)if(r[i]!==n[i])return!1;return!0})(this.uniforms[e],t)||(this.uniforms[e]=function(e){return DA(e)?e.slice():e}(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}const SA={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function TA(e){return SA[e]}function IA(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}class FA{constructor(e){a(this,"layout",{}),a(this,"byteLength",void 0);let t=0;for(const[r,i]of Object.entries(e)){const e=TA(i),{type:n,components:s}=e;t=IA(t,s);const o=t;t+=s,this.layout[r]={type:n,size:s,offset:o}}t+=(4-t%4)%4;const n=4*t;this.byteLength=Math.max(n,1024)}getData(e){const t=Bc(Math.max(this.byteLength,1024)),n={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[r,i]of Object.entries(e)){const e=this.layout[r];if(!e){ja.warn("Supplied uniform value ".concat(r," not present in uniform block layout"))();continue}const{type:t,size:s,offset:o}=e,a=n[t];if(1===s){if("number"!==typeof i&&"boolean"!==typeof i){ja.warn("Supplied value for single component uniform ".concat(r," is not a number: ").concat(i))();continue}a[o]=Number(i)}else{if(!DA(i)){ja.warn("Supplied value for multi component / array uniform ".concat(r," is not a numeric array: ").concat(i))();continue}a.set(i,o)}}return new Uint8Array(t)}has(e){return Boolean(this.layout[e])}get(e){return this.layout[e]}}class RA{constructor(e){a(this,"uniformBlocks",new Map),a(this,"uniformBufferLayouts",new Map),a(this,"uniformBuffers",new Map);for(const[t,n]of Object.entries(e)){const e=t,r=new FA(n.uniformTypes||{});this.uniformBufferLayouts.set(e,r);const i=new CA({name:t});i.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(e,i)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[n,r]of Object.entries(e)){var t;null===(t=this.uniformBlocks.get(n))||void 0===t||t.setUniforms(r)}this.updateUniformBuffers()}getUniformBufferByteLength(e){var t;return(null===(t=this.uniformBufferLayouts.get(e))||void 0===t?void 0:t.byteLength)||0}getUniformBufferData(e){var t,n;const r=(null===(t=this.uniformBlocks.get(e))||void 0===t?void 0:t.getAllUniforms())||{};return null===(n=this.uniformBufferLayouts.get(e))||void 0===n?void 0:n.getData(r)}createUniformBuffer(e,t,n){n&&this.setUniforms(n);const r=this.getUniformBufferByteLength(t),i=e.createBuffer({usage:Ha.UNIFORM|Ha.COPY_DST,byteLength:r}),s=this.getUniformBufferData(t);return i.write(s),i}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const n=this.getUniformBufferByteLength(t),r=e.createBuffer({usage:Ha.UNIFORM|Ha.COPY_DST,byteLength:n});this.uniformBuffers.set(t,r)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(t);e||(e=n)}return e&&ja.log(3,"UniformStore.updateUniformBuffers(): ".concat(e))(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),r=!1;if(n&&null!==t&&void 0!==t&&t.needsRedraw){var i,s;r||(r=t.needsRedraw);const o=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),null===(i=n)||void 0===i||i.write(o);const a=null===(s=this.uniformBlocks.get(e))||void 0===s?void 0:s.getAllUniforms();ja.log(4,"Writing to uniform buffer ".concat(String(e)),o,a)()}return r}}class kA{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class PA{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class MA extends kA{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class BA extends kA{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return"array<".concat(this.format.getTypeName(),", ").concat(this.count,">")}}class LA extends kA{constructor(e,t,n){super(e,n),this.format=t}get isPointer(){return!0}getTypeName(){return"&".concat(this.format.getTypeName())}}class OA extends kA{constructor(e,t,n,r){super(e,n),this.format=t,this.access=r}get isTemplate(){return!0}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+="<".concat(this.format.name,">")}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}}var NA;(e=>{e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"})(NA||(NA={}));class UA{constructor(e,t,n,r,i,s,o){this.name=e,this.type=t,this.group=n,this.binding=r,this.attributes=i,this.resourceType=s,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class zA{constructor(e,t){this.name=e,this.type=t}}class jA{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r,this.interpolation=null}}class VA{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r}}class GA{constructor(e,t,n,r){this.name=e,this.type=t,this.attributes=n,this.id=r}}class WA{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n}}class HA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=n}}class QA{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function XA(e){var t=(32768&e)>>15,n=(31744&e)>>10,r=1023&e;return 0==n?(t?-1:1)*Math.pow(2,-14)*(r/Math.pow(2,10)):31==n?r?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,n-15)*(1+r/Math.pow(2,10))}const YA=new Float32Array(1),qA=new Int32Array(YA.buffer),KA=new Uint16Array(1);function ZA(e){YA[0]=e;const t=qA[0],n=t>>31&1;let r=t>>23&255,i=8388607&t;if(255===r)return KA[0]=n<<15|31744|(0!==i?512:0),KA[0];if(0===r){if(0===i)return KA[0]=n<<15,KA[0];i|=8388608;let e=113;for(;!(8388608&i);)i<<=1,e--;return r=127-e,i&=8388607,r>0?(i=(i>>126-r)+(i>>127-r&1),KA[0]=n<<15|r<<10|i>>13,KA[0]):(KA[0]=n<<15,KA[0])}return r=r-127+15,r>=31?(KA[0]=n<<15|31744,KA[0]):r<=0?r<-10?(KA[0]=n<<15,KA[0]):(i=(8388608|i)>>1-r,KA[0]=n<<15|i>>13,KA[0]):(i>>=13,KA[0]=n<<15|r<<10|i,KA[0])}const JA=new Uint32Array(1),$A=new Float32Array(JA.buffer,0,1);function eh(e){const t=112+(e>>6&31)<<23|(63&e)<<17;return JA[0]=t,$A[0]}function th(e,t,n,r){const i=[0,0,0,0];for(let s=0;s<r;++s)switch(n){case"8unorm":i[s]=e[t]/255,t++;break;case"8snorm":i[s]=e[t]/255*2-1,t++;break;case"8uint":i[s]=e[t],t++;break;case"8sint":i[s]=e[t]-127,t++;break;case"16uint":i[s]=e[t]|e[t+1]<<8,t+=2;break;case"16sint":i[s]=(e[t]|e[t+1]<<8)-32768,t+=2;break;case"16float":i[s]=XA(e[t]|e[t+1]<<8),t+=2;break;case"32uint":case"32sint":i[s]=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,t+=4;break;case"32float":i[s]=new Float32Array(e.buffer,t,1)[0],t+=4}return i}function nh(e,t,n,r,i){for(let s=0;s<r;++s)switch(n){case"8unorm":e[t]=255*i[s],t++;break;case"8snorm":e[t]=.5*(i[s]+1)*255,t++;break;case"8uint":e[t]=i[s],t++;break;case"8sint":e[t]=i[s]+127,t++;break;case"16uint":new Uint16Array(e.buffer,t,1)[0]=i[s],t+=2;break;case"16sint":new Int16Array(e.buffer,t,1)[0]=i[s],t+=2;break;case"16float":{const n=ZA(i[s]);new Uint16Array(e.buffer,t,1)[0]=n,t+=2;break}case"32uint":new Uint32Array(e.buffer,t,1)[0]=i[s],t+=4;break;case"32sint":new Int32Array(e.buffer,t,1)[0]=i[s],t+=4;break;case"32float":new Float32Array(e.buffer,t,1)[0]=i[s],t+=4}return i}const rh={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class ih{constructor(){this.id=ih._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(sh.instance);for(const n of e)n instanceof Array?this.searchBlock(n,t):n.search(t);t(oh.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}ih._id=0;class sh extends ih{}sh.instance=new sh;class oh extends ih{}oh.instance=new oh;const ah=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class lh extends ih{constructor(){super()}}class uh extends lh{constructor(e,t,n,r,i,s){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=n,this.body=r,this.startLine=i,this.endLine=s}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}}class ch extends lh{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class Ah extends lh{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class hh extends lh{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class dh extends lh{constructor(e,t,n,r){super(),this.init=e,this.condition=t,this.increment=n,this.body=r}get astNodeType(){return"for"}search(e){var t,n,r;null===(t=this.init)||void 0===t||t.search(e),null===(n=this.condition)||void 0===n||n.search(e),null===(r=this.increment)||void 0===r||r.search(e),this.searchBlock(this.body,e)}}class fh extends lh{constructor(e,t,n,r,i){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"var"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class ph extends lh{constructor(e,t,n){super(),this.attributes=null,this.name=e,this.type=t,this.value=n}get astNodeType(){return"override"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class gh extends lh{constructor(e,t,n,r,i){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"let"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class mh extends lh{constructor(e,t,n,r,i){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}var yh,vh,_h,bh;(e=>{e.increment="++",e.decrement="--"})(yh||(yh={})),(e=>{e.parse=function(t){const n=t;if("parse"==n)throw new Error("Invalid value for IncrementOperator");return e[n]}})(yh||(yh={}));class wh extends lh{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(e=>{e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="})(vh||(vh={})),(e=>{e.parse=function(e){const t=e;if("parse"==t)throw new Error("Invalid value for AssignOperator");return t}})(vh||(vh={}));class Eh extends lh{constructor(e,t,n){super(),this.operator=e,this.variable=t,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class xh extends lh{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return ah.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}}class Dh extends lh{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}search(e){var t;this.searchBlock(this.body,e),null===(t=this.continuing)||void 0===t||t.search(e)}}class Ch extends lh{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}search(e){e(this);for(const t of this.cases)t.search(e)}}class Sh extends lh{constructor(e,t,n,r){super(),this.condition=e,this.body=t,this.elseif=n,this.else=r}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Th extends lh{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class Ih extends lh{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class Fh extends lh{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Rh extends lh{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class kh extends lh{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class Ph extends lh{constructor(){super()}get astNodeType(){return"discard"}}class Mh extends lh{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class Bh extends lh{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class Lh extends lh{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let t=e[0];if("f32"===t.name)return t;for(let n=1;n<e.length;++n){const r=Lh._priority.get(t.name);Lh._priority.get(e[n].name)<r&&(t=e[n])}return"x32"===t.name?Lh.i32:t}getTypeName(){return this.name}}Lh.x32=new Lh("x32"),Lh.f32=new Lh("f32"),Lh.i32=new Lh("i32"),Lh.u32=new Lh("u32"),Lh.f16=new Lh("f16"),Lh.bool=new Lh("bool"),Lh.void=new Lh("void"),Lh._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Oh extends Lh{constructor(e){super(e)}}class Nh extends Lh{constructor(e,t,n,r){super(e),this.members=t,this.startLine=n,this.endLine=r}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}}class Uh extends Lh{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+="<".concat(this.format.name,">")}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}}Uh.vec2f=new Uh("vec2",Lh.f32,null),Uh.vec3f=new Uh("vec3",Lh.f32,null),Uh.vec4f=new Uh("vec4",Lh.f32,null),Uh.vec2i=new Uh("vec2",Lh.i32,null),Uh.vec3i=new Uh("vec3",Lh.i32,null),Uh.vec4i=new Uh("vec4",Lh.i32,null),Uh.vec2u=new Uh("vec2",Lh.u32,null),Uh.vec3u=new Uh("vec3",Lh.u32,null),Uh.vec4u=new Uh("vec4",Lh.u32,null),Uh.vec2h=new Uh("vec2",Lh.f16,null),Uh.vec3h=new Uh("vec3",Lh.f16,null),Uh.vec4h=new Uh("vec4",Lh.f16,null),Uh.vec2b=new Uh("vec2",Lh.bool,null),Uh.vec3b=new Uh("vec3",Lh.bool,null),Uh.vec4b=new Uh("vec4",Lh.bool,null),Uh.mat2x2f=new Uh("mat2x2",Lh.f32,null),Uh.mat2x3f=new Uh("mat2x3",Lh.f32,null),Uh.mat2x4f=new Uh("mat2x4",Lh.f32,null),Uh.mat3x2f=new Uh("mat3x2",Lh.f32,null),Uh.mat3x3f=new Uh("mat3x3",Lh.f32,null),Uh.mat3x4f=new Uh("mat3x4",Lh.f32,null),Uh.mat4x2f=new Uh("mat4x2",Lh.f32,null),Uh.mat4x3f=new Uh("mat4x3",Lh.f32,null),Uh.mat4x4f=new Uh("mat4x4",Lh.f32,null),Uh.mat2x2h=new Uh("mat2x2",Lh.f16,null),Uh.mat2x3h=new Uh("mat2x3",Lh.f16,null),Uh.mat2x4h=new Uh("mat2x4",Lh.f16,null),Uh.mat3x2h=new Uh("mat3x2",Lh.f16,null),Uh.mat3x3h=new Uh("mat3x3",Lh.f16,null),Uh.mat3x4h=new Uh("mat3x4",Lh.f16,null),Uh.mat4x2h=new Uh("mat4x2",Lh.f16,null),Uh.mat4x3h=new Uh("mat4x3",Lh.f16,null),Uh.mat4x4h=new Uh("mat4x4",Lh.f16,null),Uh.mat2x2i=new Uh("mat2x2",Lh.i32,null),Uh.mat2x3i=new Uh("mat2x3",Lh.i32,null),Uh.mat2x4i=new Uh("mat2x4",Lh.i32,null),Uh.mat3x2i=new Uh("mat3x2",Lh.i32,null),Uh.mat3x3i=new Uh("mat3x3",Lh.i32,null),Uh.mat3x4i=new Uh("mat3x4",Lh.i32,null),Uh.mat4x2i=new Uh("mat4x2",Lh.i32,null),Uh.mat4x3i=new Uh("mat4x3",Lh.i32,null),Uh.mat4x4i=new Uh("mat4x4",Lh.i32,null),Uh.mat2x2u=new Uh("mat2x2",Lh.u32,null),Uh.mat2x3u=new Uh("mat2x3",Lh.u32,null),Uh.mat2x4u=new Uh("mat2x4",Lh.u32,null),Uh.mat3x2u=new Uh("mat3x2",Lh.u32,null),Uh.mat3x3u=new Uh("mat3x3",Lh.u32,null),Uh.mat3x4u=new Uh("mat3x4",Lh.u32,null),Uh.mat4x2u=new Uh("mat4x2",Lh.u32,null),Uh.mat4x3u=new Uh("mat4x3",Lh.u32,null),Uh.mat4x4u=new Uh("mat4x4",Lh.u32,null);class zh extends Lh{constructor(e,t,n,r){super(e),this.storage=t,this.type=n,this.access=r}get astNodeType(){return"pointer"}}class jh extends Lh{constructor(e,t,n,r){super(e),this.attributes=t,this.format=n,this.count=r}get astNodeType(){return"array"}get isArray(){return!0}}class Vh extends Lh{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"sampler"}}class Gh extends ih{constructor(){super(),this.postfix=null}}class Wh extends Gh{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class Hh extends Gh{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}}class Qh extends Gh{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return ah.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}}class Xh extends Gh{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}}class Yh extends Gh{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const t=e.evalExpression(this.initializer,e.context);return null!==t&&this.postfix?t.getSubData(e,this.postfix,e.context):t}return null}search(e){this.initializer.search(e)}}class qh extends Gh{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return void 0!==t&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof hd}get isVector(){return this.value instanceof fd||this.value instanceof pd}get scalarValue(){return this.value instanceof hd?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof fd||this.value instanceof pd?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class Kh extends Gh{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class Zh extends Gh{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Jh extends Gh{constructor(){super()}}class $h extends Jh{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class ed extends Jh{constructor(e,t,n){super(),this.operator=e,this.left=t,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:"f32"===e.name||"f32"===t.name?Lh.f32:"u32"===e.name||"u32"===t.name?Lh.u32:Lh.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class td extends ih{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class nd extends Gh{constructor(){super()}get astNodeType(){return"default"}}class rd extends td{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class id extends td{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class sd extends ih{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"argument"}}class od extends ih{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class ad extends ih{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"member"}}class ld extends ih{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}class ud{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=ud._id++}clone(){throw"Clone: Not implemented for ".concat(this.constructor.name)}setDataValue(e,t,n,r){console.error("SetDataValue: Not implemented for ".concat(this.constructor.name))}getSubData(e,t,n){return console.error("GetDataValue: Not implemented for ".concat(this.constructor.name)),null}toString(){return"<".concat(this.typeInfo.getTypeName(),">")}}ud._id=0;class cd extends ud{constructor(){super(new kA("void",null),null)}toString(){return"void"}}cd.void=new cd;class Ad extends ud{constructor(e){super(new LA("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,t,n,r){this.reference.setDataValue(e,t,n,r)}getSubData(e,t,n){return t?this.reference.getSubData(e,t,n):this}toString(){return"&".concat(this.reference.toString())}}class hd extends ud{constructor(e,t){super(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:"x32"===this.typeInfo.name?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):"i32"===this.typeInfo.name||"bool"===this.typeInfo.name?this.data=new Int32Array([e]):"u32"===this.typeInfo.name?this.data=new Uint32Array([e]):"f32"===this.typeInfo.name||"f16"===this.typeInfo.name?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",t)}clone(){if(this.data instanceof Float32Array)return new hd(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new hd(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new hd(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,t,n,r){if(n)return void console.error("SetDataValue: Scalar data does not support postfix",n);if(!(t instanceof hd))return void console.error("SetDataValue: Invalid value",t);let i=t.data[0];"i32"===this.typeInfo.name||"u32"===this.typeInfo.name?i=Math.floor(i):"bool"===this.typeInfo.name&&(i=i?1:0),this.data[0]=i}getSubData(e,t,n){return t?(console.error("getSubData: Scalar data does not support postfix",t),null):this}toString(){return"".concat(this.value)}}function dd(e,t,n){const r=t.length;return 2===r?"f32"===n?new fd(new Float32Array(t),e.getTypeInfo("vec2f")):"i32"===n||"bool"===n?new fd(new Int32Array(t),e.getTypeInfo("vec2i")):"u32"===n?new fd(new Uint32Array(t),e.getTypeInfo("vec2u")):"f16"===n?new fd(new Float32Array(t),e.getTypeInfo("vec2h")):(console.error("getSubData: Unknown format ".concat(n)),null):3===r?"f32"===n?new fd(new Float32Array(t),e.getTypeInfo("vec3f")):"i32"===n||"bool"===n?new fd(new Int32Array(t),e.getTypeInfo("vec3i")):"u32"===n?new fd(new Uint32Array(t),e.getTypeInfo("vec3u")):"f16"===n?new fd(new Float32Array(t),e.getTypeInfo("vec3h")):(console.error("getSubData: Unknown format ".concat(n)),null):4===r?"f32"===n?new fd(new Float32Array(t),e.getTypeInfo("vec4f")):"i32"===n||"bool"===n?new fd(new Int32Array(t),e.getTypeInfo("vec4i")):"u32"===n?new fd(new Uint32Array(t),e.getTypeInfo("vec4u")):"f16"===n?new fd(new Float32Array(t),e.getTypeInfo("vec4h")):(console.error("getSubData: Unknown format ".concat(n)),null):(console.error("getSubData: Invalid vector size ".concat(t.length)),null)}class fd extends ud{constructor(e,t){if(super(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?this.data=new Float32Array(e):"vec2i"===t||"vec3i"===t||"vec4i"===t?this.data=new Int32Array(e):"vec2u"===t||"vec3u"===t||"vec4u"===t?this.data=new Uint32Array(e):"vec2h"===t||"vec3h"===t||"vec4h"===t?this.data=new Float32Array(e):"vec2b"===t||"vec3b"===t||"vec4b"===t?this.data=new Int32Array(e):"vec2"===t||"vec3"===t||"vec4"===t?this.data=new Float32Array(e):console.error("VectorData: Invalid type ".concat(t))}}clone(){if(this.data instanceof Float32Array)return new fd(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new fd(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new fd(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,t,n,r){n instanceof Wh?console.error("TODO: Set vector postfix"):t instanceof fd?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,n){if(null===t)return this;let r=e.getTypeInfo("f32");if(this.typeInfo instanceof OA)r=this.typeInfo.format||r;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?r=e.getTypeInfo("f32"):"vec2i"===t||"vec3i"===t||"vec4i"===t?r=e.getTypeInfo("i32"):"vec2b"===t||"vec3b"===t||"vec4b"===t?r=e.getTypeInfo("bool"):"vec2u"===t||"vec3u"===t||"vec4u"===t?r=e.getTypeInfo("u32"):"vec2h"===t||"vec3h"===t||"vec4h"===t?r=e.getTypeInfo("f16"):console.error("GetSubData: Unknown type ".concat(t))}let i=this;for(;null!==t&&null!==i;){if(t instanceof Zh){const s=t.index;let o=-1;if(s instanceof qh){if(!(s.value instanceof hd))return console.error("GetSubData: Invalid array index ".concat(s.value)),null;o=s.value.value}else{const t=e.evalExpression(s,n);if(!(t instanceof hd))return console.error("GetSubData: Unknown index type",s),null;o=t.value}if(o<0||o>=i.data.length)return console.error("GetSubData: Index out of range",o),null;if(i.data instanceof Float32Array){const e=new Float32Array(i.data.buffer,i.data.byteOffset+4*o,1);return new hd(e,r)}if(i.data instanceof Int32Array){const e=new Int32Array(i.data.buffer,i.data.byteOffset+4*o,1);return new hd(e,r)}if(i.data instanceof Uint32Array){const e=new Uint32Array(i.data.buffer,i.data.byteOffset+4*o,1);return new hd(e,r)}throw"GetSubData: Invalid data type"}if(!(t instanceof Wh))return console.error("GetSubData: Unknown postfix",t),null;{const n=t.value.toLowerCase();if(1===n.length){let e=0;if("x"===n||"r"===n)e=0;else if("y"===n||"g"===n)e=1;else if("z"===n||"b"===n)e=2;else{if("w"!==n&&"a"!==n)return console.error("GetSubData: Unknown member ".concat(n)),null;e=3}if(this.data instanceof Float32Array){let t=new Float32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new hd(t,r,this)}if(this.data instanceof Int32Array){let t=new Int32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new hd(t,r,this)}if(this.data instanceof Uint32Array){let t=new Uint32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new hd(t,r,this)}}const s=[];for(const e of n)"x"===e||"r"===e?s.push(this.data[0]):"y"===e||"g"===e?s.push(this.data[1]):"z"===e||"b"===e?s.push(this.data[2]):"w"===e||"a"===e?s.push(this.data[3]):console.error("GetDataValue: Unknown member ".concat(e));i=dd(e,s,r.name)}t=t.postfix}return i}toString(){let e="".concat(this.data[0]);for(let t=1;t<this.data.length;++t)e+=", ".concat(this.data[t]);return e}}class pd extends ud{constructor(e,t){super(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new pd(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,t,n,r){n instanceof Wh?console.error("TODO: Set matrix postfix"):t instanceof pd?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,n){if(null===t)return this;const r=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof OA)this.typeInfo.format;else if(r.endsWith("f"))e.getTypeInfo("f32");else if(r.endsWith("i"))e.getTypeInfo("i32");else if(r.endsWith("u"))e.getTypeInfo("u32");else{if(!r.endsWith("h"))return console.error("GetDataValue: Unknown type ".concat(r)),null;e.getTypeInfo("f16")}if(t instanceof Zh){const i=t.index;let s=-1;if(i instanceof qh){if(!(i.value instanceof hd))return console.error("GetDataValue: Invalid array index ".concat(i.value)),null;s=i.value.value}else{const t=e.evalExpression(i,n);if(!(t instanceof hd))return console.error("GetDataValue: Unknown index type",i),null;s=t.value}if(s<0||s>=this.data.length)return console.error("GetDataValue: Index out of range",s),null;const o=r.endsWith("h")?"h":"f";let a;if("mat2x2"===r||"mat2x2f"===r||"mat2x2h"===r||"mat3x2"===r||"mat3x2f"===r||"mat3x2h"===r||"mat4x2"===r||"mat4x2f"===r||"mat4x2h"===r)a=new fd(new Float32Array(this.data.buffer,this.data.byteOffset+2*s*4,2),e.getTypeInfo("vec2".concat(o)));else if("mat2x3"===r||"mat2x3f"===r||"mat2x3h"===r||"mat3x3"===r||"mat3x3f"===r||"mat3x3h"===r||"mat4x3"===r||"mat4x3f"===r||"mat4x3h"===r)a=new fd(new Float32Array(this.data.buffer,this.data.byteOffset+3*s*4,3),e.getTypeInfo("vec3".concat(o)));else{if("mat2x4"!==r&&"mat2x4f"!==r&&"mat2x4h"!==r&&"mat3x4"!==r&&"mat3x4f"!==r&&"mat3x4h"!==r&&"mat4x4"!==r&&"mat4x4f"!==r&&"mat4x4h"!==r)return console.error("GetDataValue: Unknown type ".concat(r)),null;a=new fd(new Float32Array(this.data.buffer,this.data.byteOffset+4*s*4,4),e.getTypeInfo("vec4".concat(o)))}return t.postfix?a.getSubData(e,t.postfix,n):a}return console.error("GetDataValue: Invalid postfix",t),null}toString(){let e="".concat(this.data[0]);for(let t=1;t<this.data.length;++t)e+=", ".concat(this.data[t]);return e}}class gd extends ud{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new gd(e.buffer,this.typeInfo,0,null)}setDataValue(e,t,n,r){if(null===t)return void console.log("setDataValue: NULL data.");let i=this.offset,s=this.typeInfo;for(;n;){if(n instanceof Zh)if(s instanceof BA){const t=n.index;if(t instanceof qh){if(!(t.value instanceof hd))return void console.error("SetDataValue: Invalid index type ".concat(t.value));i+=t.value.value*s.stride}else{const n=e.evalExpression(t,r);if(!(n instanceof hd))return void console.error("SetDataValue: Unknown index type",t);i+=n.value*s.stride}s=s.format}else console.error("SetDataValue: Type ".concat(s.getTypeName()," is not an array"));else{if(!(n instanceof Wh))return void console.error("SetDataValue: Unknown postfix type",n);{const e=n.value;if(s instanceof MA){let t=!1;for(const n of s.members)if(n.name===e){i+=n.offset,s=n.type,t=!0;break}if(!t)return void console.error("SetDataValue: Member ".concat(e," not found"))}else if(s instanceof kA){const n=s.getTypeName();let r=0;if("x"===e||"r"===e)r=0;else if("y"===e||"g"===e)r=1;else if("z"===e||"b"===e)r=2;else{if("w"!==e&&"a"!==e)return void console.error("SetDataValue: Unknown member ".concat(e));r=3}if(!(t instanceof hd))return void console.error("SetDataValue: Invalid value",t);const o=t.value;return"vec2f"===n?void(new Float32Array(this.buffer,i,2)[r]=o):"vec3f"===n?void(new Float32Array(this.buffer,i,3)[r]=o):"vec4f"===n?void(new Float32Array(this.buffer,i,4)[r]=o):"vec2i"===n?void(new Int32Array(this.buffer,i,2)[r]=o):"vec3i"===n?void(new Int32Array(this.buffer,i,3)[r]=o):"vec4i"===n?void(new Int32Array(this.buffer,i,4)[r]=o):"vec2u"===n?void(new Uint32Array(this.buffer,i,2)[r]=o):"vec3u"===n?void(new Uint32Array(this.buffer,i,3)[r]=o):"vec4u"===n?void(new Uint32Array(this.buffer,i,4)[r]=o):void console.error("SetDataValue: Type ".concat(n," is not a struct"))}}}n=n.postfix}this.setData(e,t,s,i,r)}setData(e,t,n,r,i){const s=n.getTypeName();if("f32"!==s&&"f16"!==s)if("i32"!==s&&"atomic<i32>"!==s&&"x32"!==s)if("u32"!==s&&"atomic<u32>"!==s)if("bool"!==s){if("vec2f"===s||"vec2h"===s){const e=new Float32Array(this.buffer,r,2);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3f"===s||"vec3h"===s){const e=new Float32Array(this.buffer,r,3);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4f"===s||"vec4h"===s){const e=new Float32Array(this.buffer,r,4);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2i"===s){const e=new Int32Array(this.buffer,r,2);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3i"===s){const e=new Int32Array(this.buffer,r,3);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4i"===s){const e=new Int32Array(this.buffer,r,4);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2u"===s){const e=new Uint32Array(this.buffer,r,2);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3u"===s){const e=new Uint32Array(this.buffer,r,3);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4u"===s){const e=new Uint32Array(this.buffer,r,4);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2b"===s){const e=new Uint32Array(this.buffer,r,2);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3b"===s){const e=new Uint32Array(this.buffer,r,3);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4b"===s){const e=new Uint32Array(this.buffer,r,4);return void(t instanceof fd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("mat2x2f"===s||"mat2x2h"===s){const e=new Float32Array(this.buffer,r,4);return void(t instanceof pd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("mat2x3f"===s||"mat2x3h"===s){const e=new Float32Array(this.buffer,r,6);return void(t instanceof pd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]))}if("mat2x4f"===s||"mat2x4h"===s){const e=new Float32Array(this.buffer,r,8);return void(t instanceof pd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]))}if("mat3x2f"===s||"mat3x2h"===s){const e=new Float32Array(this.buffer,r,6);return void(t instanceof pd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]))}if("mat3x3f"===s||"mat3x3h"===s){const e=new Float32Array(this.buffer,r,9);return void(t instanceof pd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]))}if("mat3x4f"===s||"mat3x4h"===s){const e=new Float32Array(this.buffer,r,12);return void(t instanceof pd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]))}if("mat4x2f"===s||"mat4x2h"===s){const e=new Float32Array(this.buffer,r,8);return void(t instanceof pd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]))}if("mat4x3f"===s||"mat4x3h"===s){const e=new Float32Array(this.buffer,r,12);return void(t instanceof pd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]))}if("mat4x4f"===s||"mat4x4h"===s){const e=new Float32Array(this.buffer,r,16);return void(t instanceof pd?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11],e[12]=t.data[12],e[13]=t.data[13],e[14]=t.data[14],e[15]=t.data[15]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}if(t instanceof gd){if(n===t.typeInfo)return void new Uint8Array(this.buffer,r,t.buffer.byteLength).set(new Uint8Array(t.buffer));console.error("SetDataValue: Type mismatch",s,t.typeInfo.getTypeName())}else console.error("SetData: Unknown type ".concat(s))}else t instanceof hd&&(new Int32Array(this.buffer,r,1)[0]=t.value);else t instanceof hd&&(new Uint32Array(this.buffer,r,1)[0]=t.value);else t instanceof hd&&(new Int32Array(this.buffer,r,1)[0]=t.value);else t instanceof hd&&(new Float32Array(this.buffer,r,1)[0]=t.value)}getSubData(e,t,n){var r,i,s;if(null===t)return this;let o=this.offset,a=this.typeInfo;for(;t;){if(t instanceof Zh){const r=t.index,i=r instanceof Gh?e.evalExpression(r,n):r;let s=0;if(i instanceof hd?s=i.value:"number"==typeof i?s=i:console.error("GetDataValue: Invalid index type",r),a instanceof BA)o+=s*a.stride,a=a.format;else{const t=a.getTypeName();"mat4x4"===t||"mat4x4f"===t||"mat4x4h"===t?(o+=16*s,a=e.getTypeInfo("vec4f")):console.error("getDataValue: Type ".concat(a.getTypeName()," is not an array"))}}else{if(!(t instanceof Wh))return console.error("GetDataValue: Unknown postfix type",t),null;{const n=t.value;if(a instanceof MA){let e=!1;for(const t of a.members)if(t.name===n){o+=t.offset,a=t.type,e=!0;break}if(!e)return console.error("GetDataValue: Member ".concat(n," not found")),null}else if(a instanceof kA){const t=a.getTypeName();if("vec2f"===t||"vec3f"===t||"vec4f"===t||"vec2i"===t||"vec3i"===t||"vec4i"===t||"vec2u"===t||"vec3u"===t||"vec4u"===t||"vec2b"===t||"vec3b"===t||"vec4b"===t||"vec2h"===t||"vec3h"===t||"vec4h"===t||"vec2"===t||"vec3"===t||"vec4"===t){if(n.length>0&&n.length<5){let r="f";const i=[];for(let s=0;s<n.length;++s){const a=n[s].toLowerCase();let l=0;if("x"===a||"r"===a)l=0;else if("y"===a||"g"===a)l=1;else if("z"===a||"b"===a)l=2;else{if("w"!==a&&"a"!==a)return console.error("Unknown member ".concat(n)),null;l=3}if(1===n.length){if(t.endsWith("f"))return this.buffer.byteLength<o+4*l+4?(console.log("Insufficient buffer data"),null):new hd(new Float32Array(this.buffer,o+4*l,1),e.getTypeInfo("f32"),this);if(t.endsWith("h"))return new hd(new Float32Array(this.buffer,o+4*l,1),e.getTypeInfo("f16"),this);if(t.endsWith("i"))return new hd(new Int32Array(this.buffer,o+4*l,1),e.getTypeInfo("i32"),this);if(t.endsWith("b"))return new hd(new Int32Array(this.buffer,o+4*l,1),e.getTypeInfo("bool"),this);if(t.endsWith("u"))return new hd(new Uint32Array(this.buffer,o+4*l,1),e.getTypeInfo("i32"),this)}if("vec2f"===t)i.push(new Float32Array(this.buffer,o,2)[l]);else if("vec3f"===t){if(o+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const e=new Float32Array(this.buffer,o,3);i.push(e[l])}else if("vec4f"===t)i.push(new Float32Array(this.buffer,o,4)[l]);else if("vec2i"===t)r="i",i.push(new Int32Array(this.buffer,o,2)[l]);else if("vec3i"===t)r="i",i.push(new Int32Array(this.buffer,o,3)[l]);else if("vec4i"===t)r="i",i.push(new Int32Array(this.buffer,o,4)[l]);else if("vec2u"===t){r="u";const e=new Uint32Array(this.buffer,o,2);i.push(e[l])}else"vec3u"===t?(r="u",i.push(new Uint32Array(this.buffer,o,3)[l])):"vec4u"===t&&(r="u",i.push(new Uint32Array(this.buffer,o,4)[l]))}return 2===i.length?a=e.getTypeInfo("vec2".concat(r)):3===i.length?a=e.getTypeInfo("vec3".concat(r)):4===i.length?a=e.getTypeInfo("vec4".concat(r)):console.error("GetDataValue: Invalid vector length ".concat(i.length)),new fd(i,a,null)}return console.error("GetDataValue: Unknown member ".concat(n)),null}return console.error("GetDataValue: Type ".concat(t," is not a struct")),null}}}t=t.postfix}const l=a.getTypeName();return"f32"===l?new hd(new Float32Array(this.buffer,o,1),a,this):"i32"===l?new hd(new Int32Array(this.buffer,o,1),a,this):"u32"===l?new hd(new Uint32Array(this.buffer,o,1),a,this):"vec2f"===l?new fd(new Float32Array(this.buffer,o,2),a,this):"vec3f"===l?new fd(new Float32Array(this.buffer,o,3),a,this):"vec4f"===l?new fd(new Float32Array(this.buffer,o,4),a,this):"vec2i"===l?new fd(new Int32Array(this.buffer,o,2),a,this):"vec3i"===l?new fd(new Int32Array(this.buffer,o,3),a,this):"vec4i"===l?new fd(new Int32Array(this.buffer,o,4),a,this):"vec2u"===l?new fd(new Uint32Array(this.buffer,o,2),a,this):"vec3u"===l?new fd(new Uint32Array(this.buffer,o,3),a,this):"vec4u"===l?new fd(new Uint32Array(this.buffer,o,4),a,this):a instanceof OA&&"atomic"===a.name?"u32"===(null===(r=a.format)||void 0===r?void 0:r.name)?new hd(new Uint32Array(this.buffer,o,1)[0],a.format,this):"i32"===(null===(i=a.format)||void 0===i?void 0:i.name)?new hd(new Int32Array(this.buffer,o,1)[0],a.format,this):(console.error("GetDataValue: Invalid atomic format ".concat(null===(s=a.format)||void 0===s?void 0:s.name)),null):new gd(this.buffer,a,o,this)}toString(){let e="";if(this.typeInfo instanceof BA)if("f32"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e="[".concat(t[0]);for(let n=1;n<t.length;++n)e+=", ".concat(t[n])}else if("i32"===this.typeInfo.format.name){const t=new Int32Array(this.buffer,this.offset);e="[".concat(t[0]);for(let n=1;n<t.length;++n)e+=", ".concat(t[n])}else if("u32"===this.typeInfo.format.name){const t=new Uint32Array(this.buffer,this.offset);e="[".concat(t[0]);for(let n=1;n<t.length;++n)e+=", ".concat(t[n])}else if("vec2f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e="[".concat(t[0],", ").concat(t[1],"]");for(let n=1;n<t.length/2;++n)e+=", [".concat(t[2*n],", ").concat(t[2*n+1],"]")}else if("vec3f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e="[".concat(t[0],", ").concat(t[1],", ").concat(t[2],"]");for(let n=4;n<t.length;n+=4)e+=", [".concat(t[n],", ").concat(t[n+1],", ").concat(t[n+2],"]")}else if("vec4f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e="[".concat(t[0],", ").concat(t[1],", ").concat(t[2],", ").concat(t[3],"]");for(let n=4;n<t.length;n+=4)e+=", [".concat(t[n],", ").concat(t[n+1],", ").concat(t[n+2],", ").concat(t[n+3],"]")}else e="[...]";else this.typeInfo instanceof MA?e+="{...}":e="[...]";return e}}class md extends ud{constructor(e,t,n,r){super(t,null),this.data=e,this.descriptor=n,this.view=r}clone(){return new md(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>0?null!==(e=n[0])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.width)&&void 0!==t?t:0}get height(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>1?null!==(e=n[1])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.height)&&void 0!==t?t:0}get depthOrArrayLayers(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>2?null!==(e=n[2])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.depthOrArrayLayers)&&void 0!==t?t:0}get format(){var e;return this.descriptor&&null!==(e=this.descriptor.format)&&void 0!==e?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&null!==(e=this.descriptor.sampleCount)&&void 0!==e?e:1}get mipLevelCount(){var e;return this.descriptor&&null!==(e=this.descriptor.mipLevelCount)&&void 0!==e?e:1}get dimension(){var e;return this.descriptor&&null!==(e=this.descriptor.dimension)&&void 0!==e?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<t.length;++n)t[n]=Math.max(1,t[n]>>e);return t}get texelByteSize(){const e=this.format,t=rh[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=rh[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=rh[e],n=this.width;if(!e||n<=0||!t)return-1;const r=this.height,i=this.depthOrArrayLayers,s=this.dimension;return n/t.blockWidth*("1d"===s?1:r/t.blockHeight)*t.bytesPerBlock*i}getPixel(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=this.texelByteSize,s=this.bytesPerRow,o=this.height,a=this.data[r];return function(e,t,n,r,i,s,o,a,l){const u=r*(o>>=i)*(s>>=i)+n*o+t*a;switch(l){case"r8unorm":return[th(e,u,"8unorm",1)[0]];case"r8snorm":return[th(e,u,"8snorm",1)[0]];case"r8uint":return[th(e,u,"8uint",1)[0]];case"r8sint":return[th(e,u,"8sint",1)[0]];case"rg8unorm":{const t=th(e,u,"8unorm",2);return[t[0],t[1]]}case"rg8snorm":{const t=th(e,u,"8snorm",2);return[t[0],t[1]]}case"rg8uint":{const t=th(e,u,"8uint",2);return[t[0],t[1]]}case"rg8sint":{const t=th(e,u,"8sint",2);return[t[0],t[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const t=th(e,u,"8unorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8snorm":{const t=th(e,u,"8snorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8uint":{const t=th(e,u,"8uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba8sint":{const t=th(e,u,"8sint",4);return[t[0],t[1],t[2],t[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const t=th(e,u,"8unorm",4);return[t[2],t[1],t[0],t[3]]}case"r16uint":return[th(e,u,"16uint",1)[0]];case"r16sint":return[th(e,u,"16sint",1)[0]];case"r16float":return[th(e,u,"16float",1)[0]];case"rg16uint":{const t=th(e,u,"16uint",2);return[t[0],t[1]]}case"rg16sint":{const t=th(e,u,"16sint",2);return[t[0],t[1]]}case"rg16float":{const t=th(e,u,"16float",2);return[t[0],t[1]]}case"rgba16uint":{const t=th(e,u,"16uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16sint":{const t=th(e,u,"16sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16float":{const t=th(e,u,"16float",4);return[t[0],t[1],t[2],t[3]]}case"r32uint":return[th(e,u,"32uint",1)[0]];case"r32sint":return[th(e,u,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[th(e,u,"32float",1)[0]];case"rg32uint":{const t=th(e,u,"32uint",2);return[t[0],t[1]]}case"rg32sint":{const t=th(e,u,"32sint",2);return[t[0],t[1]]}case"rg32float":{const t=th(e,u,"32float",2);return[t[0],t[1]]}case"rgba32uint":{const t=th(e,u,"32uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32sint":{const t=th(e,u,"32sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32float":{const t=th(e,u,"32float",4);return[t[0],t[1],t[2],t[3]]}case"rg11b10ufloat":{const t=new Uint32Array(e.buffer,u,1)[0],n=(4192256&t)>>11,r=(4290772992&t)>>22;return[eh(2047&t),eh(n),function(e){const t=112+(e>>5&31)<<23|(31&e)<<18;return JA[0]=t,$A[0]}(r),1]}}return null}(new Uint8Array(a),e,t,n,r,o,s,i,this.format)}setPixel(e,t,n,r,i){const s=this.texelByteSize,o=this.bytesPerRow,a=this.height,l=this.data[r];!function(e,t,n,r,i,s,o,a,l,u){const c=r*(o>>=i)*(s>>=i)+n*o+t*a;switch(l){case"r8unorm":return void nh(e,c,"8unorm",1,u);case"r8snorm":return void nh(e,c,"8snorm",1,u);case"r8uint":return void nh(e,c,"8uint",1,u);case"r8sint":return void nh(e,c,"8sint",1,u);case"rg8unorm":return void nh(e,c,"8unorm",2,u);case"rg8snorm":return void nh(e,c,"8snorm",2,u);case"rg8uint":return void nh(e,c,"8uint",2,u);case"rg8sint":return void nh(e,c,"8sint",2,u);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void nh(e,c,"8unorm",4,u);case"rgba8snorm":return void nh(e,c,"8snorm",4,u);case"rgba8uint":return void nh(e,c,"8uint",4,u);case"rgba8sint":return void nh(e,c,"8sint",4,u);case"r16uint":return void nh(e,c,"16uint",1,u);case"r16sint":return void nh(e,c,"16sint",1,u);case"r16float":return void nh(e,c,"16float",1,u);case"rg16uint":return void nh(e,c,"16uint",2,u);case"rg16sint":return void nh(e,c,"16sint",2,u);case"rg16float":return void nh(e,c,"16float",2,u);case"rgba16uint":return void nh(e,c,"16uint",4,u);case"rgba16sint":return void nh(e,c,"16sint",4,u);case"rgba16float":return void nh(e,c,"16float",4,u);case"r32uint":return void nh(e,c,"32uint",1,u);case"r32sint":return void nh(e,c,"32sint",1,u);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void nh(e,c,"32float",1,u);case"rg32uint":return void nh(e,c,"32uint",2,u);case"rg32sint":return void nh(e,c,"32sint",2,u);case"rg32float":return void nh(e,c,"32float",2,u);case"rgba32uint":return void nh(e,c,"32uint",4,u);case"rgba32sint":return void nh(e,c,"32sint",4,u);case"rgba32float":return void nh(e,c,"32float",4,u);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}}(new Uint8Array(l),e,t,n,r,a,o,s,this.format,i)}}(e=>{e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"})(bh||(bh={}));class yd{constructor(e,t,n){this.name=e,this.type=t,this.rule=n}toString(){return this.name}}class vd{}_h=vd,vd.none=new yd("",bh.reserved,""),vd.eof=new yd("EOF",bh.token,""),vd.reserved={asm:new yd("asm",bh.reserved,"asm"),bf16:new yd("bf16",bh.reserved,"bf16"),do:new yd("do",bh.reserved,"do"),enum:new yd("enum",bh.reserved,"enum"),f16:new yd("f16",bh.reserved,"f16"),f64:new yd("f64",bh.reserved,"f64"),handle:new yd("handle",bh.reserved,"handle"),i8:new yd("i8",bh.reserved,"i8"),i16:new yd("i16",bh.reserved,"i16"),i64:new yd("i64",bh.reserved,"i64"),mat:new yd("mat",bh.reserved,"mat"),premerge:new yd("premerge",bh.reserved,"premerge"),regardless:new yd("regardless",bh.reserved,"regardless"),typedef:new yd("typedef",bh.reserved,"typedef"),u8:new yd("u8",bh.reserved,"u8"),u16:new yd("u16",bh.reserved,"u16"),u64:new yd("u64",bh.reserved,"u64"),unless:new yd("unless",bh.reserved,"unless"),using:new yd("using",bh.reserved,"using"),vec:new yd("vec",bh.reserved,"vec"),void:new yd("void",bh.reserved,"void")},vd.keywords={array:new yd("array",bh.keyword,"array"),atomic:new yd("atomic",bh.keyword,"atomic"),bool:new yd("bool",bh.keyword,"bool"),f32:new yd("f32",bh.keyword,"f32"),i32:new yd("i32",bh.keyword,"i32"),mat2x2:new yd("mat2x2",bh.keyword,"mat2x2"),mat2x3:new yd("mat2x3",bh.keyword,"mat2x3"),mat2x4:new yd("mat2x4",bh.keyword,"mat2x4"),mat3x2:new yd("mat3x2",bh.keyword,"mat3x2"),mat3x3:new yd("mat3x3",bh.keyword,"mat3x3"),mat3x4:new yd("mat3x4",bh.keyword,"mat3x4"),mat4x2:new yd("mat4x2",bh.keyword,"mat4x2"),mat4x3:new yd("mat4x3",bh.keyword,"mat4x3"),mat4x4:new yd("mat4x4",bh.keyword,"mat4x4"),ptr:new yd("ptr",bh.keyword,"ptr"),sampler:new yd("sampler",bh.keyword,"sampler"),sampler_comparison:new yd("sampler_comparison",bh.keyword,"sampler_comparison"),struct:new yd("struct",bh.keyword,"struct"),texture_1d:new yd("texture_1d",bh.keyword,"texture_1d"),texture_2d:new yd("texture_2d",bh.keyword,"texture_2d"),texture_2d_array:new yd("texture_2d_array",bh.keyword,"texture_2d_array"),texture_3d:new yd("texture_3d",bh.keyword,"texture_3d"),texture_cube:new yd("texture_cube",bh.keyword,"texture_cube"),texture_cube_array:new yd("texture_cube_array",bh.keyword,"texture_cube_array"),texture_multisampled_2d:new yd("texture_multisampled_2d",bh.keyword,"texture_multisampled_2d"),texture_storage_1d:new yd("texture_storage_1d",bh.keyword,"texture_storage_1d"),texture_storage_2d:new yd("texture_storage_2d",bh.keyword,"texture_storage_2d"),texture_storage_2d_array:new yd("texture_storage_2d_array",bh.keyword,"texture_storage_2d_array"),texture_storage_3d:new yd("texture_storage_3d",bh.keyword,"texture_storage_3d"),texture_depth_2d:new yd("texture_depth_2d",bh.keyword,"texture_depth_2d"),texture_depth_2d_array:new yd("texture_depth_2d_array",bh.keyword,"texture_depth_2d_array"),texture_depth_cube:new yd("texture_depth_cube",bh.keyword,"texture_depth_cube"),texture_depth_cube_array:new yd("texture_depth_cube_array",bh.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new yd("texture_depth_multisampled_2d",bh.keyword,"texture_depth_multisampled_2d"),texture_external:new yd("texture_external",bh.keyword,"texture_external"),u32:new yd("u32",bh.keyword,"u32"),vec2:new yd("vec2",bh.keyword,"vec2"),vec3:new yd("vec3",bh.keyword,"vec3"),vec4:new yd("vec4",bh.keyword,"vec4"),bitcast:new yd("bitcast",bh.keyword,"bitcast"),block:new yd("block",bh.keyword,"block"),break:new yd("break",bh.keyword,"break"),case:new yd("case",bh.keyword,"case"),continue:new yd("continue",bh.keyword,"continue"),continuing:new yd("continuing",bh.keyword,"continuing"),default:new yd("default",bh.keyword,"default"),diagnostic:new yd("diagnostic",bh.keyword,"diagnostic"),discard:new yd("discard",bh.keyword,"discard"),else:new yd("else",bh.keyword,"else"),enable:new yd("enable",bh.keyword,"enable"),fallthrough:new yd("fallthrough",bh.keyword,"fallthrough"),false:new yd("false",bh.keyword,"false"),fn:new yd("fn",bh.keyword,"fn"),for:new yd("for",bh.keyword,"for"),function:new yd("function",bh.keyword,"function"),if:new yd("if",bh.keyword,"if"),let:new yd("let",bh.keyword,"let"),const:new yd("const",bh.keyword,"const"),loop:new yd("loop",bh.keyword,"loop"),while:new yd("while",bh.keyword,"while"),private:new yd("private",bh.keyword,"private"),read:new yd("read",bh.keyword,"read"),read_write:new yd("read_write",bh.keyword,"read_write"),return:new yd("return",bh.keyword,"return"),requires:new yd("requires",bh.keyword,"requires"),storage:new yd("storage",bh.keyword,"storage"),switch:new yd("switch",bh.keyword,"switch"),true:new yd("true",bh.keyword,"true"),alias:new yd("alias",bh.keyword,"alias"),type:new yd("type",bh.keyword,"type"),uniform:new yd("uniform",bh.keyword,"uniform"),var:new yd("var",bh.keyword,"var"),override:new yd("override",bh.keyword,"override"),workgroup:new yd("workgroup",bh.keyword,"workgroup"),write:new yd("write",bh.keyword,"write"),r8unorm:new yd("r8unorm",bh.keyword,"r8unorm"),r8snorm:new yd("r8snorm",bh.keyword,"r8snorm"),r8uint:new yd("r8uint",bh.keyword,"r8uint"),r8sint:new yd("r8sint",bh.keyword,"r8sint"),r16uint:new yd("r16uint",bh.keyword,"r16uint"),r16sint:new yd("r16sint",bh.keyword,"r16sint"),r16float:new yd("r16float",bh.keyword,"r16float"),rg8unorm:new yd("rg8unorm",bh.keyword,"rg8unorm"),rg8snorm:new yd("rg8snorm",bh.keyword,"rg8snorm"),rg8uint:new yd("rg8uint",bh.keyword,"rg8uint"),rg8sint:new yd("rg8sint",bh.keyword,"rg8sint"),r32uint:new yd("r32uint",bh.keyword,"r32uint"),r32sint:new yd("r32sint",bh.keyword,"r32sint"),r32float:new yd("r32float",bh.keyword,"r32float"),rg16uint:new yd("rg16uint",bh.keyword,"rg16uint"),rg16sint:new yd("rg16sint",bh.keyword,"rg16sint"),rg16float:new yd("rg16float",bh.keyword,"rg16float"),rgba8unorm:new yd("rgba8unorm",bh.keyword,"rgba8unorm"),rgba8unorm_srgb:new yd("rgba8unorm_srgb",bh.keyword,"rgba8unorm_srgb"),rgba8snorm:new yd("rgba8snorm",bh.keyword,"rgba8snorm"),rgba8uint:new yd("rgba8uint",bh.keyword,"rgba8uint"),rgba8sint:new yd("rgba8sint",bh.keyword,"rgba8sint"),bgra8unorm:new yd("bgra8unorm",bh.keyword,"bgra8unorm"),bgra8unorm_srgb:new yd("bgra8unorm_srgb",bh.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new yd("rgb10a2unorm",bh.keyword,"rgb10a2unorm"),rg11b10float:new yd("rg11b10float",bh.keyword,"rg11b10float"),rg32uint:new yd("rg32uint",bh.keyword,"rg32uint"),rg32sint:new yd("rg32sint",bh.keyword,"rg32sint"),rg32float:new yd("rg32float",bh.keyword,"rg32float"),rgba16uint:new yd("rgba16uint",bh.keyword,"rgba16uint"),rgba16sint:new yd("rgba16sint",bh.keyword,"rgba16sint"),rgba16float:new yd("rgba16float",bh.keyword,"rgba16float"),rgba32uint:new yd("rgba32uint",bh.keyword,"rgba32uint"),rgba32sint:new yd("rgba32sint",bh.keyword,"rgba32sint"),rgba32float:new yd("rgba32float",bh.keyword,"rgba32float"),static_assert:new yd("static_assert",bh.keyword,"static_assert")},vd.tokens={decimal_float_literal:new yd("decimal_float_literal",bh.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new yd("hex_float_literal",bh.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new yd("int_literal",bh.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new yd("uint_literal",bh.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new yd("name",bh.token,/((?:[A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037B-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFC5D\uFC64-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDF9\uFE71\uFE73\uFE77\uFE79\uFE7B\uFE7D\uFE7F-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037B-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u0870-\u0887\u0889-\u088E\u0897-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1715\u171F-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B4C\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA827\uA82C\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFC5D\uFC64-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDF9\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE71\uFE73\uFE77\uFE79\uFE7B\uFE7D\uFE7F-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF65-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69-\uDD6D\uDD6F-\uDD85\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC4\uDEFC-\uDF1C\uDF27\uDF30-\uDF50\uDF70-\uDF85\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC75\uDC7F-\uDCBA\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD3\uDFE1\uDFE2]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E-\uDC61\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39\uDF40-\uDF46]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B-\uDD43\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF42\uDF50-\uDF5A\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC40-\uDC55\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE7F\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFE4\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD833[\uDCF0-\uDCF9\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAE\uDEC0-\uDEF9]|\uD839[\uDCD0-\uDCF9\uDDD0-\uDDFA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]|\uDB40[\uDD00-\uDDEF])+)|((?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037B-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFC5D\uFC64-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDF9\uFE71\uFE73\uFE77\uFE79\uFE7B\uFE7D\uFE7F-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]))/),ident:new yd("ident",bh.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new yd("and",bh.token,"&"),and_and:new yd("and_and",bh.token,"&&"),arrow:new yd("arrow ",bh.token,"->"),attr:new yd("attr",bh.token,"@"),forward_slash:new yd("forward_slash",bh.token,"/"),bang:new yd("bang",bh.token,"!"),bracket_left:new yd("bracket_left",bh.token,"["),bracket_right:new yd("bracket_right",bh.token,"]"),brace_left:new yd("brace_left",bh.token,"{"),brace_right:new yd("brace_right",bh.token,"}"),colon:new yd("colon",bh.token,":"),comma:new yd("comma",bh.token,","),equal:new yd("equal",bh.token,"="),equal_equal:new yd("equal_equal",bh.token,"=="),not_equal:new yd("not_equal",bh.token,"!="),greater_than:new yd("greater_than",bh.token,">"),greater_than_equal:new yd("greater_than_equal",bh.token,">="),shift_right:new yd("shift_right",bh.token,">>"),less_than:new yd("less_than",bh.token,"<"),less_than_equal:new yd("less_than_equal",bh.token,"<="),shift_left:new yd("shift_left",bh.token,"<<"),modulo:new yd("modulo",bh.token,"%"),minus:new yd("minus",bh.token,"-"),minus_minus:new yd("minus_minus",bh.token,"--"),period:new yd("period",bh.token,"."),plus:new yd("plus",bh.token,"+"),plus_plus:new yd("plus_plus",bh.token,"++"),or:new yd("or",bh.token,"|"),or_or:new yd("or_or",bh.token,"||"),paren_left:new yd("paren_left",bh.token,"("),paren_right:new yd("paren_right",bh.token,")"),semicolon:new yd("semicolon",bh.token,";"),star:new yd("star",bh.token,"*"),tilde:new yd("tilde",bh.token,"~"),underscore:new yd("underscore",bh.token,"_"),xor:new yd("xor",bh.token,"^"),plus_equal:new yd("plus_equal",bh.token,"+="),minus_equal:new yd("minus_equal",bh.token,"-="),times_equal:new yd("times_equal",bh.token,"*="),division_equal:new yd("division_equal",bh.token,"/="),modulo_equal:new yd("modulo_equal",bh.token,"%="),and_equal:new yd("and_equal",bh.token,"&="),or_equal:new yd("or_equal",bh.token,"|="),xor_equal:new yd("xor_equal",bh.token,"^="),shift_right_equal:new yd("shift_right_equal",bh.token,">>="),shift_left_equal:new yd("shift_left_equal",bh.token,"<<=")},vd.simpleTokens={"@":_h.tokens.attr,"{":_h.tokens.brace_left,"}":_h.tokens.brace_right,":":_h.tokens.colon,",":_h.tokens.comma,"(":_h.tokens.paren_left,")":_h.tokens.paren_right,";":_h.tokens.semicolon},vd.literalTokens={"&":_h.tokens.and,"&&":_h.tokens.and_and,"->":_h.tokens.arrow,"/":_h.tokens.forward_slash,"!":_h.tokens.bang,"[":_h.tokens.bracket_left,"]":_h.tokens.bracket_right,"=":_h.tokens.equal,"==":_h.tokens.equal_equal,"!=":_h.tokens.not_equal,">":_h.tokens.greater_than,">=":_h.tokens.greater_than_equal,">>":_h.tokens.shift_right,"<":_h.tokens.less_than,"<=":_h.tokens.less_than_equal,"<<":_h.tokens.shift_left,"%":_h.tokens.modulo,"-":_h.tokens.minus,"--":_h.tokens.minus_minus,".":_h.tokens.period,"+":_h.tokens.plus,"++":_h.tokens.plus_plus,"|":_h.tokens.or,"||":_h.tokens.or_or,"*":_h.tokens.star,"~":_h.tokens.tilde,_:_h.tokens.underscore,"^":_h.tokens.xor,"+=":_h.tokens.plus_equal,"-=":_h.tokens.minus_equal,"*=":_h.tokens.times_equal,"/=":_h.tokens.division_equal,"%=":_h.tokens.modulo_equal,"&=":_h.tokens.and_equal,"|=":_h.tokens.or_equal,"^=":_h.tokens.xor_equal,">>=":_h.tokens.shift_right_equal,"<<=":_h.tokens.shift_left_equal},vd.regexTokens={decimal_float_literal:_h.tokens.decimal_float_literal,hex_float_literal:_h.tokens.hex_float_literal,int_literal:_h.tokens.int_literal,uint_literal:_h.tokens.uint_literal,ident:_h.tokens.ident},vd.storage_class=[_h.keywords.function,_h.keywords.private,_h.keywords.workgroup,_h.keywords.uniform,_h.keywords.storage],vd.access_mode=[_h.keywords.read,_h.keywords.write,_h.keywords.read_write],vd.sampler_type=[_h.keywords.sampler,_h.keywords.sampler_comparison],vd.sampled_texture_type=[_h.keywords.texture_1d,_h.keywords.texture_2d,_h.keywords.texture_2d_array,_h.keywords.texture_3d,_h.keywords.texture_cube,_h.keywords.texture_cube_array],vd.multisampled_texture_type=[_h.keywords.texture_multisampled_2d],vd.storage_texture_type=[_h.keywords.texture_storage_1d,_h.keywords.texture_storage_2d,_h.keywords.texture_storage_2d_array,_h.keywords.texture_storage_3d],vd.depth_texture_type=[_h.keywords.texture_depth_2d,_h.keywords.texture_depth_2d_array,_h.keywords.texture_depth_cube,_h.keywords.texture_depth_cube_array,_h.keywords.texture_depth_multisampled_2d],vd.texture_external_type=[_h.keywords.texture_external],vd.any_texture_type=[..._h.sampled_texture_type,..._h.multisampled_texture_type,..._h.storage_texture_type,..._h.depth_texture_type,..._h.texture_external_type],vd.texel_format=[_h.keywords.r8unorm,_h.keywords.r8snorm,_h.keywords.r8uint,_h.keywords.r8sint,_h.keywords.r16uint,_h.keywords.r16sint,_h.keywords.r16float,_h.keywords.rg8unorm,_h.keywords.rg8snorm,_h.keywords.rg8uint,_h.keywords.rg8sint,_h.keywords.r32uint,_h.keywords.r32sint,_h.keywords.r32float,_h.keywords.rg16uint,_h.keywords.rg16sint,_h.keywords.rg16float,_h.keywords.rgba8unorm,_h.keywords.rgba8unorm_srgb,_h.keywords.rgba8snorm,_h.keywords.rgba8uint,_h.keywords.rgba8sint,_h.keywords.bgra8unorm,_h.keywords.bgra8unorm_srgb,_h.keywords.rgb10a2unorm,_h.keywords.rg11b10float,_h.keywords.rg32uint,_h.keywords.rg32sint,_h.keywords.rg32float,_h.keywords.rgba16uint,_h.keywords.rgba16sint,_h.keywords.rgba16float,_h.keywords.rgba32uint,_h.keywords.rgba32sint,_h.keywords.rgba32float],vd.const_literal=[_h.tokens.int_literal,_h.tokens.uint_literal,_h.tokens.decimal_float_literal,_h.tokens.hex_float_literal,_h.keywords.true,_h.keywords.false],vd.literal_or_ident=[_h.tokens.ident,_h.tokens.int_literal,_h.tokens.uint_literal,_h.tokens.decimal_float_literal,_h.tokens.hex_float_literal,_h.tokens.name],vd.element_count_expression=[_h.tokens.int_literal,_h.tokens.uint_literal,_h.tokens.ident],vd.template_types=[_h.keywords.vec2,_h.keywords.vec3,_h.keywords.vec4,_h.keywords.mat2x2,_h.keywords.mat2x3,_h.keywords.mat2x4,_h.keywords.mat3x2,_h.keywords.mat3x3,_h.keywords.mat3x4,_h.keywords.mat4x2,_h.keywords.mat4x3,_h.keywords.mat4x4,_h.keywords.atomic,_h.keywords.bitcast,..._h.any_texture_type],vd.attribute_name=[_h.tokens.ident,_h.keywords.block,_h.keywords.diagnostic],vd.assignment_operators=[_h.tokens.equal,_h.tokens.plus_equal,_h.tokens.minus_equal,_h.tokens.times_equal,_h.tokens.division_equal,_h.tokens.modulo_equal,_h.tokens.and_equal,_h.tokens.or_equal,_h.tokens.xor_equal,_h.tokens.shift_right_equal,_h.tokens.shift_left_equal],vd.increment_operators=[_h.tokens.plus_plus,_h.tokens.minus_minus];class _d{constructor(e,t,n,r,i){this.type=e,this.lexeme=t,this.line=n,this.start=r,this.end=i}toString(){return this.lexeme}isTemplateType(){return-1!=vd.template_types.indexOf(this.type)}isArrayType(){return this.type==vd.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class bd{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=null!=e?e:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw"Invalid syntax at line ".concat(this._line);return this._tokens.push(new _d(vd.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if("\n"==e)return this._line++,!0;if(this._isWhitespace(e))return!0;if("/"==e){if("/"==this._peekAhead()){for(;"\n"!=e;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let t=1;for(;t>0;){if(this._isAtEnd())return!0;if(e=this._advance(),"\n"==e)this._line++;else if("*"==e){if("/"==this._peekAhead()&&(this._advance(),t--,0==t))return!0}else"/"==e&&"*"==this._peekAhead()&&(this._advance(),t++)}return!0}}const t=vd.simpleTokens[e];if(t)return this._addToken(t),!0;let n=vd.none;const r=this._isAlpha(e),i="_"===e;if(this._isAlphaNumeric(e)){let t=this._peekAhead();for(;this._isAlphaNumeric(t);)e+=this._advance(),t=this._peekAhead()}if(r){const t=vd.keywords[e];if(t)return this._addToken(t),!0}if(r||i)return this._addToken(vd.tokens.ident),!0;for(;;){let t=this._findType(e);const r=this._peekAhead();if("-"==e&&this._tokens.length>0){if("="==r)return this._current++,e+=r,this._addToken(vd.tokens.minus_equal),!0;if("-"==r)return this._current++,e+=r,this._addToken(vd.tokens.minus_minus),!0;const n=this._tokens.length-1;if((-1!=vd.literal_or_ident.indexOf(this._tokens[n].type)||this._tokens[n].type==vd.tokens.paren_right)&&">"!=r)return this._addToken(t),!0}if(">"==e&&(">"==r||"="==r)){let e=!1,n=this._tokens.length-1;for(let t=0;t<5&&n>=0&&-1===vd.assignment_operators.indexOf(this._tokens[n].type);++t,--n)if(this._tokens[n].type===vd.tokens.less_than){n>0&&this._tokens[n-1].isArrayOrTemplateType()&&(e=!0);break}if(e)return this._addToken(t),!0}if(t===vd.none){let r=e,i=0;const s=2;for(let e=0;e<s;++e)if(r+=this._peekAhead(e),t=this._findType(r),t!==vd.none){i=e;break}if(t===vd.none)return n!==vd.none&&(this._current--,this._addToken(n),!0);e=r,this._current+=i+1}if(n=t,this._isAtEnd())break;e+=this._advance()}return n!==vd.none&&(this._addToken(n),!0)}_findType(e){for(const t in vd.regexTokens){const n=vd.regexTokens[t];if(this._match(e,n.rule))return n}return vd.literalTokens[e]||vd.none}_match(e,t){const n=t.exec(e);return n&&0==n.index&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&"_"!==e&&"."!==e&&"("!==e&&")"!==e&&"["!==e&&"]"!==e&&"{"!==e&&"}"!==e&&","!==e&&";"!==e&&":"!==e&&"="!==e&&"!"!==e&&"<"!==e&&">"!==e&&"+"!==e&&"-"!==e&&"*"!==e&&"/"!==e&&"%"!==e&&"&"!==e&&"|"!==e&&"^"!==e&&"~"!==e&&"@"!==e&&"#"!==e&&"?"!==e&&"'"!==e&&"`"!==e&&'"'!==e&&"\\"!==e&&"\n"!==e&&"\r"!==e&&"\t"!==e&&"\0"!==e}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||"_"===e}_isWhitespace(e){return" "==e||"\t"==e||"\r"==e}_advance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new _d(e,t,this._line,this._start,this._current))}}function wd(e){return Array.isArray(e)||(null==e?void 0:e.buffer)instanceof ArrayBuffer}const Ed=new Float32Array(1),xd=new Uint32Array(Ed.buffer),Dd=new Uint32Array(Ed.buffer),Cd=new Int32Array(1),Sd=new Float32Array(Cd.buffer),Td=new Uint32Array(Cd.buffer),Id=new Uint32Array(1),Fd=new Float32Array(Id.buffer),Rd=new Int32Array(Id.buffer);function kd(e,t,n){if(t===n)return e;if("f32"===t){if("i32"===n||"x32"===n)return Ed[0]=e,xd[0];if("u32"===n)return Ed[0]=e,Dd[0]}else if("i32"===t||"x32"===t){if("f32"===n)return Cd[0]=e,Sd[0];if("u32"===n)return Cd[0]=e,Td[0]}else if("u32"===t){if("f32"===n)return Id[0]=e,Fd[0];if("i32"===n||"x32"===n)return Id[0]=e,Rd[0]}return console.error("Unsupported cast from ".concat(t," to ").concat(n)),e}class Pd{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class Md{constructor(e,t){this.align=e,this.size=t}}class Bd{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new QA,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return"texture_storage_1d"==e.name||"texture_storage_2d"==e.name||"texture_storage_2d_array"==e.name||"texture_storage_3d"==e.name}updateAST(e){for(const t of e)t instanceof uh&&this._functions.set(t.name,new Pd(t));for(const t of e)if(t instanceof Nh){const e=this.getTypeInfo(t,null);e instanceof MA&&this.structs.push(e)}for(const t of e)if(t instanceof kh)this.aliases.push(this._getAliasInfo(t));else{if(t instanceof ph){const e=t,n=this._getAttributeNum(e.attributes,"id",0),r=null!=e.type?this.getTypeInfo(e.type,e.attributes):null;this.overrides.push(new GA(e.name,r,e.attributes,n));continue}if(this._isUniformVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this.getTypeInfo(e.type,e.attributes),s=new UA(e.name,i,n,r,e.attributes,NA.Uniform,e.access);s.access||(s.access="read"),this.uniforms.push(s);continue}if(this._isStorageVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this.getTypeInfo(e.type,e.attributes),s=this._isStorageTexture(i),o=new UA(e.name,i,n,r,e.attributes,s?NA.StorageTexture:NA.Storage,e.access);o.access||(o.access="read"),this.storage.push(o);continue}if(this._isTextureVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this.getTypeInfo(e.type,e.attributes),s=this._isStorageTexture(i),o=new UA(e.name,i,n,r,e.attributes,s?NA.StorageTexture:NA.Texture,e.access);o.access||(o.access="read"),s?this.storage.push(o):this.textures.push(o);continue}if(this._isSamplerVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this.getTypeInfo(e.type,e.attributes),s=new UA(e.name,i,n,r,e.attributes,NA.Sampler,e.access);this.samplers.push(s);continue}}for(const t of e)if(t instanceof uh){const e=this._getAttribute(t,"vertex"),n=this._getAttribute(t,"fragment"),r=this._getAttribute(t,"compute"),i=e||n||r,s=new HA(t.name,null==i?void 0:i.name,t.attributes);s.attributes=t.attributes,s.startLine=t.startLine,s.endLine=t.endLine,this.functions.push(s),this._functions.get(t.name).info=s,i&&(this._functions.get(t.name).inUse=!0,s.inUse=!0,s.resources=this._findResources(t,!!i),s.inputs=this._getInputs(t.args),s.outputs=this._getOutputs(t.returnType),this.entry[i.name].push(s)),s.arguments=t.args.map(e=>new WA(e.name,this.getTypeInfo(e.type,e.attributes),e.attributes)),s.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null;continue}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(e=>{var n,r,i;if(e instanceof ld){if(e.value)if(wd(e.value))for(const s of e.value)for(const e of this.overrides)s===e.name&&(null===(n=t.info)||void 0===n||n.overrides.push(e));else for(const s of this.overrides)e.value===s.name&&(null===(r=t.info)||void 0===r||r.overrides.push(s))}else if(e instanceof Xh)for(const s of this.overrides)e.name===s.name&&(null===(i=t.info)||void 0===i||i.overrides.push(s))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getFunctionInfo(e){for(const t of this.functions)if(t.name==e)return t;return null}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var n;for(const r of e.calls){const e=null===(n=this._functions.get(r.name))||void 0===n?void 0:n.info;e&&t.add(e)}}findResource(e,t,n){if(n){for(const r of this.entry.compute)if(r.name===n)for(const n of r.resources)if(n.group==e&&n.binding==t)return n;for(const r of this.entry.vertex)if(r.name===n)for(const n of r.resources)if(n.group==e&&n.binding==t)return n;for(const r of this.entry.fragment)if(r.name===n)for(const n of r.resources)if(n.group==e&&n.binding==t)return n}for(const r of this.uniforms)if(r.group==e&&r.binding==t)return r;for(const r of this.storage)if(r.group==e&&r.binding==t)return r;for(const r of this.textures)if(r.group==e&&r.binding==t)return r;for(const r of this.samplers)if(r.group==e&&r.binding==t)return r;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const n=[],r=this,i=[];return e.search(s=>{if(s instanceof sh)i.push({});else if(s instanceof oh)i.pop();else if(s instanceof fh){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type),i.length>0&&(i[i.length-1][e.name]=e)}else if(s instanceof Hh){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type)}else if(s instanceof gh){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type),i.length>0&&(i[i.length-1][e.name]=e)}else if(s instanceof Xh){const e=s;if(i.length>0&&i[i.length-1][e.name])return;const t=r._findResource(e.name);t&&n.push(t)}else if(s instanceof Qh){const i=s,o=r._functions.get(i.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=r._findResources(o.node,t)),n.push(...o.resources))}else if(s instanceof xh){const i=s,o=r._functions.get(i.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=r._findResources(o.node,t)),n.push(...o.resources))}}),[...new Map(n.map(e=>[e.name,e])).values()]}getBindGroups(){const e=[];function t(t,n){t>=e.length&&(e.length=t+1),void 0===e[t]&&(e[t]=[]),n>=e[t].length&&(e[t].length=n+1)}for(const n of this.uniforms)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)t(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(void 0===t&&(t=[]),e instanceof Nh)this._getStructOutputs(e,t);else{const n=this._getOutputInfo(e);null!==n&&t.push(n)}return t}_getStructOutputs(e,t){for(const n of e.members)if(n.type instanceof Nh)this._getStructOutputs(n.type,t);else{const e=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(null!==e){const r=this.getTypeInfo(n.type,n.type.attributes),i=this._parseInt(e.value),s=new VA(n.name,r,e.name,i);t.push(s)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this.getTypeInfo(e,e.attributes),r=this._parseInt(t.value);return new VA("",n,t.name,r)}return null}_getInputs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;void 0===t&&(t=[]);for(const n of e)if(n.type instanceof Nh)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}return t}_getStructInputs(e,t){for(const n of e.members)if(n.type instanceof Nh)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this._getAttribute(e,"interpolation"),r=this.getTypeInfo(e.type,e.attributes),i=this._parseInt(t.value),s=new jA(e.name,r,t.name,i);return null!==n&&(s.interpolation=this._parseString(n.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new zA(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._types.has(e))return this._types.get(e);if(e instanceof zh){const n=e.type?this.getTypeInfo(e.type,e.attributes):null,r=new LA(e.name,n,t);return this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof jh){const n=e,r=n.format?this.getTypeInfo(n.format,n.attributes):null,i=new BA(n.name,t);return i.format=r,i.count=n.count,this._types.set(e,i),this._updateTypeInfo(i),i}if(e instanceof Nh){const n=e,r=new MA(n.name,t);r.startLine=n.startLine,r.endLine=n.endLine;for(const e of n.members){const t=this.getTypeInfo(e.type,e.attributes);r.members.push(new PA(e.name,t,e.attributes))}return this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof Vh){const n=e,r=n.format instanceof Lh,i=n.format?r?this.getTypeInfo(n.format,null):new kA(n.format,null):null,s=new OA(n.name,i,t,n.access);return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof Uh){const n=e,r=n.format?this.getTypeInfo(n.format,null):null,i=new OA(n.name,r,t,n.access);return this._types.set(e,i),this._updateTypeInfo(i),i}const n=new kA(e.name,t);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var t,n,r;const i=this._getTypeSize(e);if(e.size=null!==(t=null==i?void 0:i.size)&&void 0!==t?t:0,e instanceof BA&&e.format){const t=this._getTypeSize(e.format);e.stride=Math.max(null!==(n=null==t?void 0:t.size)&&void 0!==n?n:0,null!==(r=null==t?void 0:t.align)&&void 0!==r?r:0),this._updateTypeInfo(e.format)}e instanceof LA&&this._updateTypeInfo(e.format),e instanceof MA&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let n=0,r=0,i=0,s=0;for(let o=0,a=e.members.length;o<a;++o){const a=e.members[o],l=this._getTypeSize(a);if(!l)continue;null!==(t=this._getAlias(a.type.name))&&void 0!==t||a.type;const u=l.align,c=l.size;n=this._roundUp(u,n+r),r=c,i=n,s=Math.max(s,u),a.offset=n,a.size=c,this._updateTypeInfo(a.type)}e.size=this._roundUp(s,i+r),e.align=s}_getTypeSize(e){var t,n;if(null==e)return null;const r=this._getAttributeNum(e.attributes,"size",0),i=this._getAttributeNum(e.attributes,"align",0);if(e instanceof PA&&(e=e.type),e instanceof kA){const t=this._getAlias(e.name);null!==t&&(e=t)}{const n=Bd._typeInfo[e.name];if(void 0!==n){const s="f16"===(null===(t=e.format)||void 0===t?void 0:t.name)?2:1;return new Md(Math.max(i,n.align/s),Math.max(r,n.size/s))}}{const t=Bd._typeInfo[e.name.substring(0,e.name.length-1)];if(t){const n="h"===e.name[e.name.length-1]?2:1;return new Md(Math.max(i,t.align/n),Math.max(r,t.size/n))}}if(e instanceof BA){let t=e,s=8,o=8;const a=this._getTypeSize(t.format);return null!==a&&(o=a.size,s=a.align),o=t.count*this._getAttributeNum(null!==(n=null==e?void 0:e.attributes)&&void 0!==n?n:null,"stride",this._roundUp(s,o)),r&&(o=r),new Md(Math.max(i,s),Math.max(r,o))}if(e instanceof MA){let t=0,n=0,s=0,o=0,a=0;for(const r of e.members){const e=this._getTypeSize(r.type);null!==e&&(t=Math.max(e.align,t),s=this._roundUp(e.align,s+o),o=e.size,a=s)}return n=this._roundUp(t,a+o),new Md(Math.max(i,t),Math.max(r,n))}return null}_isUniformVar(e){return e instanceof fh&&"uniform"==e.storage}_isStorageVar(e){return e instanceof fh&&"storage"==e.storage}_isTextureVar(e){return e instanceof fh&&null!==e.type&&-1!=Bd._textureTypes.indexOf(e.type.name)}_isSamplerVar(e){return e instanceof fh&&null!==e.type&&-1!=Bd._samplerTypes.indexOf(e.type.name)}_getAttribute(e,t){const n=e;if(!n||!n.attributes)return null;const r=n.attributes;for(let i of r)if(i.name==t)return i;return null}_getAttributeNum(e,t,n){if(null===e)return n;for(let r of e)if(r.name==t){let e=null!==r&&null!==r.value?r.value:n;return e instanceof Array&&(e=e[0]),"number"==typeof e?e:"string"==typeof e?parseInt(e):n}return n}_roundUp(e,t){return Math.ceil(t/e)*e}}Bd._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Bd._textureTypes=vd.any_texture_type.map(e=>e.name),Bd._samplerTypes=vd.sampler_type.map(e=>e.name);let Ld=0;class Od{constructor(e,t,n){this.id=Ld++,this.name=e,this.value=t,this.node=n}clone(){return new Od(this.name,this.value,this.node)}}class Nd{constructor(e){this.id=Ld++,this.name=e.name,this.node=e}clone(){return new Nd(this.node)}}class Ud{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=Ld++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?null!==(t=this.variables.get(e))&&void 0!==t?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?null!==(t=this.functions.get(e))&&void 0!==t?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,n){this.variables.set(e,new Od(e,t,null!=n?n:null))}setVariable(e,t,n){const r=this.getVariable(e);null!==r?r.value=t:this.createVariable(e,t,n)}getVariableValue(e){var t;const n=this.getVariable(e);return null!==(t=null==n?void 0:n.value)&&void 0!==t?t:null}clone(){return new Ud(this)}}class zd{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}}class jd{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const n=this.exec.evalExpression(e.args[0],t);let r=!0;if(n instanceof fd)return n.data.forEach(e=>{e||(r=!1)}),new hd(r?1:0,this.getTypeInfo("bool"));throw new Error("All() expects a vector argument. Line ".concat(e.line))}Any(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd){const e=n.data.some(e=>e);return new hd(e?1:0,this.getTypeInfo("bool"))}throw new Error("Any() expects a vector argument. Line ".concat(e.line))}Select(e,t){const n=this.exec.evalExpression(e.args[2],t);if(!(n instanceof hd))throw new Error("Select() expects a bool condition. Line ".concat(e.line));return n.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.evalExpression(n,t);if(r instanceof gd&&0===r.typeInfo.size){const e=r.typeInfo,t=r.buffer.byteLength/e.stride;return new hd(t,this.getTypeInfo("u32"))}return new hd(r.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.abs(e)),n.typeInfo);const r=n;return new hd(Math.abs(r.value),r.typeInfo)}Acos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.acos(e)),n.typeInfo);const r=n;return new hd(Math.acos(r.value),n.typeInfo)}Acosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.acosh(e)),n.typeInfo);const r=n;return new hd(Math.acosh(r.value),n.typeInfo)}Asin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.asin(e)),n.typeInfo);const r=n;return new hd(Math.asin(r.value),n.typeInfo)}Asinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.asinh(e)),n.typeInfo);const r=n;return new hd(Math.asinh(r.value),n.typeInfo)}Atan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.atan(e)),n.typeInfo);const r=n;return new hd(Math.atan(r.value),n.typeInfo)}Atanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.atanh(e)),n.typeInfo);const r=n;return new hd(Math.atanh(r.value),n.typeInfo)}Atan2(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof fd&&r instanceof fd)return new fd(n.data.map((e,t)=>Math.atan2(e,r.data[t])),n.typeInfo);const i=n,s=r;return new hd(Math.atan2(i.value,s.value),n.typeInfo)}Ceil(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.ceil(e)),n.typeInfo);const r=n;return new hd(Math.ceil(r.value),n.typeInfo)}_clamp(e,t,n){return Math.min(Math.max(e,t),n)}Clamp(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(n instanceof fd&&r instanceof fd&&i instanceof fd)return new fd(n.data.map((e,t)=>this._clamp(e,r.data[t],i.data[t])),n.typeInfo);const s=n,o=r,a=i;return new hd(this._clamp(s.value,o.value,a.value),n.typeInfo)}Cos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.cos(e)),n.typeInfo);const r=n;return new hd(Math.cos(r.value),n.typeInfo)}Cosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.cosh(e)),n.typeInfo);const r=n;return new hd(Math.cos(r.value),n.typeInfo)}CountLeadingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.clz32(e)),n.typeInfo);const r=n;return new hd(Math.clz32(r.value),n.typeInfo)}_countOneBits(e){let t=0;for(;0!==e;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>this._countOneBits(e)),n.typeInfo);const r=n;return new hd(this._countOneBits(r.value),n.typeInfo)}_countTrailingZeros(e){if(0===e)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>this._countTrailingZeros(e)),n.typeInfo);const r=n;return new hd(this._countTrailingZeros(r.value),n.typeInfo)}Cross(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof fd&&r instanceof fd){if(3!==n.data.length||3!==r.data.length)return console.error("Cross() expects 3D vectors. Line ".concat(e.line)),null;const t=n.data,i=r.data;return new fd([t[1]*i[2]-i[1]*t[2],t[2]*i[0]-i[2]*t[0],t[0]*i[1]-i[0]*t[1]],n.typeInfo)}return console.error("Cross() expects vector arguments. Line ".concat(e.line)),null}Degrees(e,t){const n=this.exec.evalExpression(e.args[0],t),r=180/Math.PI;return n instanceof fd?new fd(n.data.map(e=>e*r),n.typeInfo):new hd(n.value*r,this.getTypeInfo("f32"))}Determinant(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof pd){const e=n.data,t=n.typeInfo.getTypeName(),r=t.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t)return new hd(e[0]*e[3]-e[1]*e[2],r);if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t)return new hd(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),r);if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t)console.error("TODO: Determinant for ".concat(t));else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t)console.error("TODO: Determinant for ".concat(t));else{if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t)return new hd(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),r);"mat3x4"===t||"mat3x4f"===t||"mat3x4h"===t||"mat4x2"===t||"mat4x2f"===t||"mat4x2h"===t||"mat4x3"===t||"mat4x3f"===t||"mat4x3h"===t?console.error("TODO: Determinant for ".concat(t)):"mat4x4"!==t&&"mat4x4f"!==t&&"mat4x4h"!==t||console.error("TODO: Determinant for ".concat(t))}}return console.error("Determinant expects a matrix argument. Line ".concat(e.line)),null}Distance(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof fd&&r instanceof fd){let e=0;for(let t=0;t<n.data.length;++t)e+=(n.data[t]-r.data[t])*(n.data[t]-r.data[t]);return new hd(Math.sqrt(e),this.getTypeInfo("f32"))}const i=n,s=r;return new hd(Math.abs(i.value-s.value),n.typeInfo)}_dot(e,t){let n=0;for(let r=0;r<e.length;++r)n+=t[r]*e[r];return n}Dot(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);return n instanceof fd&&r instanceof fd?new hd(this._dot(n.data,r.data),this.getTypeInfo("f32")):(console.error("Dot() expects vector arguments. Line ".concat(e.line)),null)}Dot4U8Packed(e,t){return console.error("TODO: dot4U8Packed. Line ".concat(e.line)),null}Dot4I8Packed(e,t){return console.error("TODO: dot4I8Packed. Line ".concat(e.line)),null}Exp(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.exp(e)),n.typeInfo);const r=n;return new hd(Math.exp(r.value),n.typeInfo)}Exp2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.pow(2,e)),n.typeInfo);const r=n;return new hd(Math.pow(2,r.value),n.typeInfo)}ExtractBits(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if("u32"!==r.typeInfo.name&&"x32"!==r.typeInfo.name)return console.error("ExtractBits() expects an i32 offset argument. Line ".concat(e.line)),null;if("u32"!==i.typeInfo.name&&"x32"!==i.typeInfo.name)return console.error("ExtractBits() expects an i32 count argument. Line ".concat(e.line)),null;const s=r.value,o=i.value;if(n instanceof fd)return new fd(n.data.map(e=>e>>s&(1<<o)-1),n.typeInfo);if("i32"!==n.typeInfo.name&&"x32"!==n.typeInfo.name)return console.error("ExtractBits() expects an i32 argument. Line ".concat(e.line)),null;const a=n.value;return new hd(a>>s&(1<<o)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(n instanceof fd&&r instanceof fd&&i instanceof fd){const e=this._dot(r.data,i.data);return new fd(e<0?Array.from(n.data):n.data.map(e=>-e),n.typeInfo)}return console.error("FaceForward() expects vector arguments. Line ".concat(e.line)),null}_firstLeadingBit(e){return 0===e?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>this._firstLeadingBit(e)),n.typeInfo);const r=n;return new hd(this._firstLeadingBit(r.value),n.typeInfo)}_firstTrailingBit(e){return 0===e?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>this._firstTrailingBit(e)),n.typeInfo);const r=n;return new hd(this._firstTrailingBit(r.value),n.typeInfo)}Floor(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.floor(e)),n.typeInfo);const r=n;return new hd(Math.floor(r.value),n.typeInfo)}Fma(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(n instanceof fd&&r instanceof fd&&i instanceof fd)return n.data.length!==r.data.length||n.data.length!==i.data.length?(console.error("Fma() expects vectors of the same length. Line ".concat(e.line)),null):new fd(n.data.map((e,t)=>e*r.data[t]+i.data[t]),n.typeInfo);const s=n,o=r,a=i;return new hd(s.value*o.value+a.value,s.typeInfo)}Fract(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>e-Math.floor(e)),n.typeInfo);const r=n;return new hd(r.value-Math.floor(r.value),n.typeInfo)}Frexp(e,t){return console.error("TODO: frexp. Line ".concat(e.line)),null}InsertBits(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t),s=this.exec.evalExpression(e.args[3],t);if("u32"!==i.typeInfo.name&&"x32"!==i.typeInfo.name)return console.error("InsertBits() expects an i32 offset argument. Line ".concat(e.line)),null;const o=i.value,a=(1<<s.value)-1<<o,l=~a;if(n instanceof fd&&r instanceof fd)return new fd(n.data.map((e,t)=>e&l|r.data[t]<<o&a),n.typeInfo);const u=n.value,c=r.value;return new hd(u&l|c<<o&a,n.typeInfo)}InverseSqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>1/Math.sqrt(e)),n.typeInfo);const r=n;return new hd(1/Math.sqrt(r.value),n.typeInfo)}Ldexp(e,t){return console.error("TODO: ldexp. Line ".concat(e.line)),null}Length(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd){let e=0;return n.data.forEach(t=>{e+=t*t}),new hd(Math.sqrt(e),this.getTypeInfo("f32"))}const r=n;return new hd(Math.abs(r.value),n.typeInfo)}Log(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.log(e)),n.typeInfo);const r=n;return new hd(Math.log(r.value),n.typeInfo)}Log2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.log2(e)),n.typeInfo);const r=n;return new hd(Math.log2(r.value),n.typeInfo)}Max(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof fd&&r instanceof fd)return new fd(n.data.map((e,t)=>Math.max(e,r.data[t])),n.typeInfo);const i=n,s=r;return new hd(Math.max(i.value,s.value),n.typeInfo)}Min(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof fd&&r instanceof fd)return new fd(n.data.map((e,t)=>Math.min(e,r.data[t])),n.typeInfo);const i=n,s=r;return new hd(Math.min(i.value,s.value),n.typeInfo)}Mix(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(n instanceof fd&&r instanceof fd&&i instanceof fd)return new fd(n.data.map((e,t)=>n.data[t]*(1-i.data[t])+r.data[t]*i.data[t]),n.typeInfo);const s=r,o=i;return new hd(n.value*(1-o.value)+s.value*o.value,n.typeInfo)}Modf(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof fd&&r instanceof fd)return new fd(n.data.map((e,t)=>e%r.data[t]),n.typeInfo);const i=r;return new hd(n.value%i.value,n.typeInfo)}Normalize(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd){const r=this.Length(e,t).value;return new fd(n.data.map(e=>e/r),n.typeInfo)}return console.error("Normalize() expects a vector argument. Line ".concat(e.line)),null}Pow(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof fd&&r instanceof fd)return new fd(n.data.map((e,t)=>Math.pow(e,r.data[t])),n.typeInfo);const i=n,s=r;return new hd(Math.pow(i.value,s.value),n.typeInfo)}QuantizeToF16(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof fd?new fd(n.data.map(e=>e),n.typeInfo):new hd(n.value,n.typeInfo)}Radians(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof fd?new fd(n.data.map(e=>e*Math.PI/180),n.typeInfo):new hd(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof fd&&r instanceof fd){const e=this._dot(n.data,r.data);return new fd(n.data.map((t,n)=>t-2*e*r.data[n]),n.typeInfo)}return console.error("Reflect() expects vector arguments. Line ".concat(e.line)),null}Refract(e,t){let n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(n instanceof fd&&r instanceof fd&&i instanceof hd){const e=this._dot(r.data,n.data);return new fd(n.data.map((t,n)=>{const s=1-i.value*i.value*(1-e*e);if(s<0)return 0;const o=Math.sqrt(s);return i.value*t-(i.value*e+o)*r.data[n]}),n.typeInfo)}return console.error("Refract() expects vector arguments and a scalar argument. Line ".concat(e.line)),null}ReverseBits(e,t){return console.error("TODO: reverseBits. Line ".concat(e.line)),null}Round(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.round(e)),n.typeInfo);const r=n;return new hd(Math.round(r.value),n.typeInfo)}Saturate(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.min(Math.max(e,0),1)),n.typeInfo);const r=n;return new hd(Math.min(Math.max(r.value,0),1),n.typeInfo)}Sign(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.sign(e)),n.typeInfo);const r=n;return new hd(Math.sign(r.value),n.typeInfo)}Sin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.sin(e)),n.typeInfo);const r=n;return new hd(Math.sin(r.value),n.typeInfo)}Sinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.sinh(e)),n.typeInfo);const r=n;return new hd(Math.sinh(r.value),n.typeInfo)}_smoothstep(e,t,n){const r=Math.min(Math.max((n-e)/(t-e),0),1);return r*r*(3-2*r)}SmoothStep(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),i=this.exec.evalExpression(e.args[2],t);if(i instanceof fd&&n instanceof fd&&r instanceof fd)return new fd(i.data.map((e,t)=>this._smoothstep(n.data[t],r.data[t],e)),i.typeInfo);const s=n,o=r,a=i;return new hd(this._smoothstep(s.value,o.value,a.value),i.typeInfo)}Sqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.sqrt(e)),n.typeInfo);const r=n;return new hd(Math.sqrt(r.value),n.typeInfo)}Step(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(r instanceof fd&&n instanceof fd)return new fd(r.data.map((e,t)=>e<n.data[t]?0:1),r.typeInfo);const i=n;return new hd(r.value<i.value?0:1,i.typeInfo)}Tan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.tan(e)),n.typeInfo);const r=n;return new hd(Math.tan(r.value),n.typeInfo)}Tanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.tanh(e)),n.typeInfo);const r=n;return new hd(Math.tanh(r.value),n.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return"mat2x2f"===t||"mat2x2h"===t?e:"mat2x3f"===t?this.getTypeInfo("mat3x2f"):"mat2x3h"===t?this.getTypeInfo("mat3x2h"):"mat2x4f"===t?this.getTypeInfo("mat4x2f"):"mat2x4h"===t?this.getTypeInfo("mat4x2h"):"mat3x2f"===t?this.getTypeInfo("mat2x3f"):"mat3x2h"===t?this.getTypeInfo("mat2x3h"):"mat3x3f"===t||"mat3x3h"===t?e:"mat3x4f"===t?this.getTypeInfo("mat4x3f"):"mat3x4h"===t?this.getTypeInfo("mat4x3h"):"mat4x2f"===t?this.getTypeInfo("mat2x4f"):"mat4x2h"===t?this.getTypeInfo("mat2x4h"):"mat4x3f"===t?this.getTypeInfo("mat3x4f"):"mat4x3h"===t?this.getTypeInfo("mat3x4h"):("mat4x4f"===t||"mat4x4h"===t||console.error("Invalid matrix type ".concat(t)),e)}Transpose(e,t){const n=this.exec.evalExpression(e.args[0],t);if(!(n instanceof pd))return console.error("Transpose() expects a matrix argument. Line ".concat(e.line)),null;const r=this._getTransposeType(n.typeInfo);if("mat2x2"===n.typeInfo.name||"mat2x2f"===n.typeInfo.name||"mat2x2h"===n.typeInfo.name){const e=n.data;return new pd([e[0],e[2],e[1],e[3]],r)}if("mat2x3"===n.typeInfo.name||"mat2x3f"===n.typeInfo.name||"mat2x3h"===n.typeInfo.name){const e=n.data;return new pd([e[0],e[3],e[6],e[1],e[4],e[7]],r)}if("mat2x4"===n.typeInfo.name||"mat2x4f"===n.typeInfo.name||"mat2x4h"===n.typeInfo.name){const e=n.data;return new pd([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13]],r)}if("mat3x2"===n.typeInfo.name||"mat3x2f"===n.typeInfo.name||"mat3x2h"===n.typeInfo.name){const e=n.data;return new pd([e[0],e[3],e[1],e[4],e[2],e[5]],r)}if("mat3x3"===n.typeInfo.name||"mat3x3f"===n.typeInfo.name||"mat3x3h"===n.typeInfo.name){const e=n.data;return new pd([e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]],r)}if("mat3x4"===n.typeInfo.name||"mat3x4f"===n.typeInfo.name||"mat3x4h"===n.typeInfo.name){const e=n.data;return new pd([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14]],r)}if("mat4x2"===n.typeInfo.name||"mat4x2f"===n.typeInfo.name||"mat4x2h"===n.typeInfo.name){const e=n.data;return new pd([e[0],e[4],e[1],e[5],e[2],e[6]],r)}if("mat4x3"===n.typeInfo.name||"mat4x3f"===n.typeInfo.name||"mat4x3h"===n.typeInfo.name){const e=n.data;return new pd([e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]],r)}if("mat4x4"===n.typeInfo.name||"mat4x4f"===n.typeInfo.name||"mat4x4h"===n.typeInfo.name){const e=n.data;return new pd([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]],r)}return console.error("Invalid matrix type ".concat(n.typeInfo.name)),null}Trunc(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof fd)return new fd(n.data.map(e=>Math.trunc(e)),n.typeInfo);const r=n;return new hd(Math.trunc(r.value),n.typeInfo)}Dpdx(e,t){return console.error("TODO: dpdx. Line ".concat(e.line)),null}DpdxCoarse(e,t){return console.error("TODO: dpdxCoarse. Line ".concat(e.line)),null}DpdxFine(e,t){return console.error("TODO: dpdxFine"),null}Dpdy(e,t){return console.error("TODO: dpdy"),null}DpdyCoarse(e,t){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,t){return console.error("TODO: dpdyFine"),null}Fwidth(e,t){return console.error("TODO: fwidth"),null}FwidthCoarse(e,t){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,t){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,t){const n=e.args[0],r=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(n instanceof Xh){const i=n.name,s=t.getVariableValue(i);if(s instanceof md){if(r<0||r>=s.mipLevelCount)return console.error("Invalid mip level for textureDimensions. Line ".concat(e.line)),null;const t=s.getMipLevelSize(r),n=s.dimension;return"1d"===n?new hd(t[0],this.getTypeInfo("u32")):"3d"===n?new fd(t,this.getTypeInfo("vec3u")):"2d"===n?new fd(t.slice(0,2),this.getTypeInfo("vec2u")):(console.error("Invalid texture dimension ".concat(n," not found. Line ").concat(e.line)),null)}return console.error("Texture ".concat(i," not found. Line ").concat(e.line)),null}return console.error("Invalid texture argument for textureDimensions. Line ".concat(e.line)),null}TextureGather(e,t){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,t){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,t){const n=e.args[0],r=this.exec.evalExpression(e.args[1],t),i=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(r instanceof fd)||2!==r.data.length)return console.error("Invalid UV argument for textureLoad. Line ".concat(e.line)),null;if(n instanceof Xh){const s=n.name,o=t.getVariableValue(s);if(o instanceof md){const t=Math.floor(r.data[0]),n=Math.floor(r.data[1]);if(t<0||t>=o.width||n<0||n>=o.height)return console.error("Texture ".concat(s," out of bounds. Line ").concat(e.line)),null;const a=o.getPixel(t,n,0,i);return null===a?(console.error("Invalid texture format for textureLoad. Line ".concat(e.line)),null):new fd(a,this.getTypeInfo("vec4f"))}return console.error("Texture ".concat(s," not found. Line ").concat(e.line)),null}return console.error("Invalid texture argument for textureLoad. Line ".concat(e.line)),null}TextureNumLayers(e,t){const n=e.args[0];if(n instanceof Xh){const r=n.name,i=t.getVariableValue(r);return i instanceof md?new hd(i.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error("Texture ".concat(r," not found. Line ").concat(e.line)),null)}return console.error("Invalid texture argument for textureNumLayers. Line ".concat(e.line)),null}TextureNumLevels(e,t){const n=e.args[0];if(n instanceof Xh){const r=n.name,i=t.getVariableValue(r);return i instanceof md?new hd(i.mipLevelCount,this.getTypeInfo("u32")):(console.error("Texture ".concat(r," not found. Line ").concat(e.line)),null)}return console.error("Invalid texture argument for textureNumLevels. Line ".concat(e.line)),null}TextureNumSamples(e,t){const n=e.args[0];if(n instanceof Xh){const r=n.name,i=t.getVariableValue(r);return i instanceof md?new hd(i.sampleCount,this.getTypeInfo("u32")):(console.error("Texture ".concat(r," not found. Line ").concat(e.line)),null)}return console.error("Invalid texture argument for textureNumSamples. Line ".concat(e.line)),null}TextureSample(e,t){return console.error("TODO: textureSample"),null}TextureSampleBias(e,t){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,t){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,t){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,t){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,t){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,t){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,t){const n=e.args[0],r=this.exec.evalExpression(e.args[1],t),i=4===e.args.length?this.exec.evalExpression(e.args[2],t).value:0,s=4===e.args.length?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(4!==s.length)return console.error("Invalid value argument for textureStore. Line ".concat(e.line)),null;if(!(r instanceof fd)||2!==r.data.length)return console.error("Invalid UV argument for textureStore. Line ".concat(e.line)),null;if(n instanceof Xh){const o=n.name,a=t.getVariableValue(o);if(a instanceof md){const t=a.getMipLevelSize(0),n=Math.floor(r.data[0]),l=Math.floor(r.data[1]);return n<0||n>=t[0]||l<0||l>=t[1]?(console.error("Texture ".concat(o," out of bounds. Line ").concat(e.line)),null):(a.setPixel(n,l,0,i,Array.from(s)),null)}return console.error("Texture ".concat(o," not found. Line ").concat(e.line)),null}return console.error("Invalid texture argument for textureStore. Line ".concat(e.line)),null}AtomicLoad(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t);return t.getVariable(r).value.getSubData(this.exec,n.postfix,t)}AtomicStore(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t),i=t.getVariable(r);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=i.value.getSubData(this.exec,n.postfix,t);return a instanceof hd&&o instanceof hd&&(a.value=o.value),i.value instanceof gd&&i.value.setDataValue(this.exec,a,n.postfix,t),null}AtomicAdd(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t),i=t.getVariable(r);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=i.value.getSubData(this.exec,n.postfix,t),l=new hd(a.value,a.typeInfo);return a instanceof hd&&o instanceof hd&&(a.value+=o.value),i.value instanceof gd&&i.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicSub(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t),i=t.getVariable(r);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=i.value.getSubData(this.exec,n.postfix,t),l=new hd(a.value,a.typeInfo);return a instanceof hd&&o instanceof hd&&(a.value-=o.value),i.value instanceof gd&&i.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicMax(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t),i=t.getVariable(r);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=i.value.getSubData(this.exec,n.postfix,t),l=new hd(a.value,a.typeInfo);return a instanceof hd&&o instanceof hd&&(a.value=Math.max(a.value,o.value)),i.value instanceof gd&&i.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicMin(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t),i=t.getVariable(r);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=i.value.getSubData(this.exec,n.postfix,t),l=new hd(a.value,a.typeInfo);return a instanceof hd&&o instanceof hd&&(a.value=Math.min(a.value,o.value)),i.value instanceof gd&&i.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicAnd(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t),i=t.getVariable(r);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=i.value.getSubData(this.exec,n.postfix,t),l=new hd(a.value,a.typeInfo);return a instanceof hd&&o instanceof hd&&(a.value=a.value&o.value),i.value instanceof gd&&i.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicOr(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t),i=t.getVariable(r);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=i.value.getSubData(this.exec,n.postfix,t),l=new hd(a.value,a.typeInfo);return a instanceof hd&&o instanceof hd&&(a.value=a.value|o.value),i.value instanceof gd&&i.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicXor(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t),i=t.getVariable(r);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=i.value.getSubData(this.exec,n.postfix,t),l=new hd(a.value,a.typeInfo);return a instanceof hd&&o instanceof hd&&(a.value=a.value^o.value),i.value instanceof gd&&i.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicExchange(e,t){let n=e.args[0];n instanceof $h&&(n=n.right);const r=this.exec.getVariableName(n,t),i=t.getVariable(r);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=i.value.getSubData(this.exec,n.postfix,t),l=new hd(a.value,a.typeInfo);return a instanceof hd&&o instanceof hd&&(a.value=o.value),i.value instanceof gd&&i.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicCompareExchangeWeak(e,t){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,t){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,t){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,t){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,t){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,t){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,t){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,t){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,t){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,t){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,t){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,t){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,t){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,t){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,t){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,t){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,t){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,t){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,t){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,t){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,t){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,t){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,t){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,t){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,t){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,t){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,t){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,t){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,t){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,t){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,t){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,t){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,t){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,t){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,t){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,t){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,t){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,t){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,t){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,t){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,t){return console.error("TODO: quadSwapY"),null}}const Vd={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},Gd={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class Wd extends zd{constructor(e,t){var n;super(),this.ast=null!=e?e:[],this.reflection=new Bd,this.reflection.updateAST(this.ast),this.context=null!==(n=null==t?void 0:t.clone())&&void 0!==n?n:new Ud,this.builtins=new jd(this),this.typeInfo={bool:this.getTypeInfo(Lh.bool),i32:this.getTypeInfo(Lh.i32),u32:this.getTypeInfo(Lh.u32),f32:this.getTypeInfo(Lh.f32),f16:this.getTypeInfo(Lh.f16),vec2f:this.getTypeInfo(Uh.vec2f),vec2u:this.getTypeInfo(Uh.vec2u),vec2i:this.getTypeInfo(Uh.vec2i),vec2h:this.getTypeInfo(Uh.vec2h),vec3f:this.getTypeInfo(Uh.vec3f),vec3u:this.getTypeInfo(Uh.vec3u),vec3i:this.getTypeInfo(Uh.vec3i),vec3h:this.getTypeInfo(Uh.vec3h),vec4f:this.getTypeInfo(Uh.vec4f),vec4u:this.getTypeInfo(Uh.vec4u),vec4i:this.getTypeInfo(Uh.vec4i),vec4h:this.getTypeInfo(Uh.vec4h),mat2x2f:this.getTypeInfo(Uh.mat2x2f),mat2x3f:this.getTypeInfo(Uh.mat2x3f),mat2x4f:this.getTypeInfo(Uh.mat2x4f),mat3x2f:this.getTypeInfo(Uh.mat3x2f),mat3x3f:this.getTypeInfo(Uh.mat3x3f),mat3x4f:this.getTypeInfo(Uh.mat3x4f),mat4x2f:this.getTypeInfo(Uh.mat4x2f),mat4x3f:this.getTypeInfo(Uh.mat4x3f),mat4x4f:this.getTypeInfo(Uh.mat4x4f)}}getVariableValue(e){var t,n;const r=null!==(n=null===(t=this.context.getVariable(e))||void 0===t?void 0:t.value)&&void 0!==n?n:null;if(null===r)return null;if(r instanceof hd)return r.value;if(r instanceof fd)return Array.from(r.data);if(r instanceof pd)return Array.from(r.data);if(r instanceof gd&&r.typeInfo instanceof BA){if("u32"===r.typeInfo.format.name)return Array.from(new Uint32Array(r.buffer,r.offset,r.typeInfo.count));if("i32"===r.typeInfo.format.name)return Array.from(new Int32Array(r.buffer,r.offset,r.typeInfo.count));if("f32"===r.typeInfo.format.name)return Array.from(new Float32Array(r.buffer,r.offset,r.typeInfo.count))}return console.error("Unsupported return variable type ".concat(r.typeInfo.name)),null}execute(e){(e=null!=e?e:{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,n,r){const i=this.context.clone();(r=null!=r?r:{}).constants&&this._setOverrides(r.constants,i),this._execStatements(this.ast,i);const s=i.getFunction(e);if(!s)return void console.error("Function ".concat(e," not found"));if("number"==typeof t)t=[t,1,1];else{if(0===t.length)return void console.error("Invalid dispatch count");1===t.length?t=[t[0],1,1]:2===t.length?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const o=t[0],a=t[1],l=t[2],u=this.getTypeInfo("vec3u");i.setVariable("@num_workgroups",new fd(t,u));const c=this.reflection.getFunctionInfo(e);null===c&&console.error("Function ".concat(e," not found in reflection data"));for(const A in n)for(const e in n[A]){const t=n[A][e];i.variables.forEach(n=>{var r;const i=n.node;if(null==i?void 0:i.attributes){let s=null,o=null;for(const e of i.attributes)"binding"===e.name?s=e.value:"group"===e.name&&(o=e.value);if(e==s&&A==o){let s=!1;for(const t of c.resources)if(t.name===n.name&&t.group===parseInt(A)&&t.binding===parseInt(e)){s=!0;break}if(s)if(void 0!==t.texture&&void 0!==t.descriptor){const e=new md(t.texture,this.getTypeInfo(i.type),t.descriptor,null!==(r=t.texture.view)&&void 0!==r?r:null);n.value=e}else void 0!==t.uniform?n.value=new gd(t.uniform,this.getTypeInfo(i.type)):n.value=new gd(t,this.getTypeInfo(i.type))}}})}for(let A=0;A<l;++A)for(let e=0;e<a;++e)for(let t=0;t<o;++t)i.setVariable("@workgroup_id",new fd([t,e,A],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(s,[t,e,A],i)}execStatement(e,t){if(e instanceof Th)return this.evalExpression(e.value,t);if(e instanceof Mh){if(e.condition){const n=this.evalExpression(e.condition,t);if(!(n instanceof hd))throw new Error("Invalid break-if condition");if(!n.value)return null}return Wd._breakObj}if(e instanceof Bh)return Wd._continueObj;if(e instanceof gh)this._let(e,t);else if(e instanceof fh)this._var(e,t);else if(e instanceof mh)this._const(e,t);else if(e instanceof uh)this._function(e,t);else{if(e instanceof Sh)return this._if(e,t);if(e instanceof Ch)return this._switch(e,t);if(e instanceof dh)return this._for(e,t);if(e instanceof Ah)return this._while(e,t);if(e instanceof Dh)return this._loop(e,t);if(e instanceof hh){const n=t.clone();return n.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof Eh)this._assign(e,t);else if(e instanceof wh)this._increment(e,t);else{if(e instanceof Nh)return null;if(e instanceof ph){const n=e.name;null===t.getVariable(n)&&t.setVariable(n,new hd(0,this.getTypeInfo("u32")))}else if(e instanceof xh)this._call(e,t);else{if(e instanceof Rh)return null;if(e instanceof kh)return null;console.error("Invalid statement type.",e,"Line ".concat(e.line))}}}return null}evalExpression(e,t){return e instanceof ed?this._evalBinaryOp(e,t):e instanceof qh?this._evalLiteral(e,t):e instanceof Xh?this._evalVariable(e,t):e instanceof Qh?this._evalCall(e,t):e instanceof Hh?this._evalCreate(e,t):e instanceof Yh?this._evalConst(e,t):e instanceof Kh?this._evalBitcast(e,t):e instanceof $h?this._evalUnaryOp(e,t):(console.error("Invalid expression type",e,"Line ".concat(e.line)),null)}getTypeInfo(e){var t;if(e instanceof Lh){const t=this.reflection.getTypeInfo(e);if(null!==t)return t}let n=null!==(t=this.typeInfo[e])&&void 0!==t?t:null;return null!==n||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,t){for(const n in e){const r=e[n],i=this.reflection.getOverrideInfo(n);null!==i?(null===i.type&&(i.type=this.getTypeInfo("u32")),"u32"===i.type.name||"i32"===i.type.name||"f32"===i.type.name||"f16"===i.type.name?t.setVariable(n,new hd(r,i.type)):"bool"===i.type.name?t.setVariable(n,new hd(r?1:0,i.type)):"vec2"===i.type.name||"vec3"===i.type.name||"vec4"===i.type.name||"vec2f"===i.type.name||"vec3f"===i.type.name||"vec4f"===i.type.name||"vec2i"===i.type.name||"vec3i"===i.type.name||"vec4i"===i.type.name||"vec2u"===i.type.name||"vec3u"===i.type.name||"vec4u"===i.type.name||"vec2h"===i.type.name||"vec3h"===i.type.name||"vec4h"===i.type.name?t.setVariable(n,new fd(r,i.type)):console.error("Invalid constant type for ".concat(n))):console.error("Override ".concat(n," does not exist in the shader."))}}_dispatchWorkgroup(e,t,n){const r=[1,1,1];for(const u of e.node.attributes)if("workgroup_size"===u.name){if(u.value.length>0){const e=n.getVariableValue(u.value[0]);r[0]=e instanceof hd?e.value:parseInt(u.value[0])}if(u.value.length>1){const e=n.getVariableValue(u.value[1]);r[1]=e instanceof hd?e.value:parseInt(u.value[1])}if(u.value.length>2){const e=n.getVariableValue(u.value[2]);r[2]=e instanceof hd?e.value:parseInt(u.value[2])}}const i=this.getTypeInfo("vec3u"),s=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new fd(r,i));const o=r[0],a=r[1],l=r[2];for(let u=0,c=0;u<l;++u)for(let l=0;l<a;++l)for(let a=0;a<o;++a,++c){const o=[a,l,u],A=[a+t[0]*r[0],l+t[1]*r[1],u+t[2]*r[2]];n.setVariable("@local_invocation_id",new fd(o,i)),n.setVariable("@global_invocation_id",new fd(A,i)),n.setVariable("@local_invocation_index",new hd(c,s)),this._dispatchExec(e,n)}}_dispatchExec(e,t){for(const n of e.node.args)for(const e of n.attributes)if("builtin"===e.name){const r="@".concat(e.value),i=t.getVariable(r);void 0!==i&&t.variables.set(n.name,i)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof $h;)e=e.right;return e instanceof Xh?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,t){for(const n of e){if(n instanceof Array){const e=t.clone(),r=this._execStatements(n,e);if(r)return r;continue}const e=this.execStatement(n,t);if(e)return e}return null}_call(e,t){const n=t.clone();n.currentFunctionName=e.name;const r=t.getFunction(e.name);if(r){for(let t=0;t<r.node.args.length;++t){const i=r.node.args[t],s=this.evalExpression(e.args[t],n);n.setVariable(i.name,s,i)}this._execStatements(r.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const n=this.getVariableName(e.variable,t),r=t.getVariable(n);r?"++"===e.operator?r.value instanceof hd?r.value.value++:console.error("Variable ".concat(n," is not a scalar. Line ").concat(e.line)):"--"===e.operator?r.value instanceof hd?r.value.value--:console.error("Variable ".concat(n," is not a scalar. Line ").concat(e.line)):console.error("Unknown increment operator ".concat(e.operator,". Line ").concat(e.line)):console.error("Variable ".concat(n," not found. Line ").concat(e.line))}_getVariableData(e,t){if(e instanceof Xh){const n=this.getVariableName(e,t),r=t.getVariable(n);return null===r?(console.error("Variable ".concat(n," not found. Line ").concat(e.line)),null):r.value.getSubData(this,e.postfix,t)}if(e instanceof $h){if("*"===e.operator){const n=this._getVariableData(e.right,t);return n instanceof Ad?n.reference.getSubData(this,e.postfix,t):(console.error("Variable ".concat(e.right," is not a pointer. Line ").concat(e.line)),null)}if("&"===e.operator){const n=this._getVariableData(e.right,t);return new Ad(n)}}return null}_assign(e,t){let n=null,r="<var>",i=null;if(e.variable instanceof $h){const n=this._getVariableData(e.variable,t),r=this.evalExpression(e.value,t),i=e.operator;if("="===i){if(n instanceof hd||n instanceof fd||n instanceof pd){if(r instanceof hd||r instanceof fd||r instanceof pd&&n.data.length===r.data.length)return void n.data.set(r.data);console.error("Invalid assignment. Line ".concat(e.line))}else if(n instanceof gd&&r instanceof gd&&n.buffer.byteLength-n.offset>=r.buffer.byteLength-r.offset)return void(n.buffer.byteLength%4==0?new Uint32Array(n.buffer,n.offset,n.typeInfo.size/4).set(new Uint32Array(r.buffer,r.offset,r.typeInfo.size/4)):new Uint8Array(n.buffer,n.offset,n.typeInfo.size).set(new Uint8Array(r.buffer,r.offset,r.typeInfo.size)));return console.error("Invalid assignment. Line ".concat(e.line)),null}if("+="===i)return n instanceof hd||n instanceof fd||n instanceof pd?r instanceof hd||r instanceof fd||r instanceof pd?void n.data.set(r.data.map((e,t)=>n.data[t]+e)):void console.error("Invalid assignment . Line ".concat(e.line)):void console.error("Invalid assignment. Line ".concat(e.line));if("-="===i)return(n instanceof hd||n instanceof fd||n instanceof pd)&&(r instanceof hd||r instanceof fd||r instanceof pd)?void n.data.set(r.data.map((e,t)=>n.data[t]-e)):void console.error("Invalid assignment. Line ".concat(e.line))}if(e.variable instanceof $h){if("*"===e.variable.operator){r=this.getVariableName(e.variable.right,t);const i=t.getVariable(r);if(!(i&&i.value instanceof Ad))return void console.error("Variable ".concat(r," is not a pointer. Line ").concat(e.line));n=i.value.reference;let s=e.variable.postfix;if(!s){let t=e.variable.right;for(;t instanceof $h;){if(t.postfix){s=t.postfix;break}t=t.right}}s&&(n=n.getSubData(this,s,t))}}else{i=e.variable.postfix,r=this.getVariableName(e.variable,t);const s=t.getVariable(r);if(null===s)return void console.error("Variable ".concat(r," not found. Line ").concat(e.line));n=s.value}if(n instanceof Ad&&(n=n.reference),null===n)return void console.error("Variable ".concat(r," not found. Line ").concat(e.line));const s=this.evalExpression(e.value,t),o=e.operator;if("="!==o){const r=n.getSubData(this,i,t);if(r instanceof fd&&s instanceof hd){const t=r.data,n=s.value;if("+="===o)for(let e=0;e<t.length;++e)t[e]+=n;else if("-="===o)for(let e=0;e<t.length;++e)t[e]-=n;else if("*="===o)for(let e=0;e<t.length;++e)t[e]*=n;else if("/="===o)for(let e=0;e<t.length;++e)t[e]/=n;else if("%="===o)for(let e=0;e<t.length;++e)t[e]%=n;else if("&="===o)for(let e=0;e<t.length;++e)t[e]&=n;else if("|="===o)for(let e=0;e<t.length;++e)t[e]|=n;else if("^="===o)for(let e=0;e<t.length;++e)t[e]^=n;else if("<<="===o)for(let e=0;e<t.length;++e)t[e]<<=n;else if(">>="===o)for(let e=0;e<t.length;++e)t[e]>>=n;else console.error("Invalid operator ".concat(o,". Line ").concat(e.line))}else if(r instanceof fd&&s instanceof fd){const t=r.data,n=s.data;if(t.length!==n.length)return void console.error("Vector length mismatch. Line ".concat(e.line));if("+="===o)for(let e=0;e<t.length;++e)t[e]+=n[e];else if("-="===o)for(let e=0;e<t.length;++e)t[e]-=n[e];else if("*="===o)for(let e=0;e<t.length;++e)t[e]*=n[e];else if("/="===o)for(let e=0;e<t.length;++e)t[e]/=n[e];else if("%="===o)for(let e=0;e<t.length;++e)t[e]%=n[e];else if("&="===o)for(let e=0;e<t.length;++e)t[e]&=n[e];else if("|="===o)for(let e=0;e<t.length;++e)t[e]|=n[e];else if("^="===o)for(let e=0;e<t.length;++e)t[e]^=n[e];else if("<<="===o)for(let e=0;e<t.length;++e)t[e]<<=n[e];else if(">>="===o)for(let e=0;e<t.length;++e)t[e]>>=n[e];else console.error("Invalid operator ".concat(o,". Line ").concat(e.line))}else{if(!(r instanceof hd&&s instanceof hd))return void console.error("Invalid type for ".concat(e.operator," operator. Line ").concat(e.line));"+="===o?r.value+=s.value:"-="===o?r.value-=s.value:"*="===o?r.value*=s.value:"/="===o?r.value/=s.value:"%="===o?r.value%=s.value:"&="===o?r.value&=s.value:"|="===o?r.value|=s.value:"^="===o?r.value^=s.value:"<<="===o?r.value<<=s.value:">>="===o?r.value>>=s.value:console.error("Invalid operator ".concat(o,". Line ").concat(e.line))}return void(n instanceof gd&&n.setDataValue(this,r,i,t))}if(n instanceof gd)n.setDataValue(this,s,i,t);else if(i){if(!(n instanceof fd||n instanceof pd))return void console.error("Variable ".concat(r," is not a vector or matrix. Line ").concat(e.line));if(i instanceof Zh){const o=this.evalExpression(i.index,t).value;if(n instanceof fd){if(!(s instanceof hd))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[o]=s.value}else{if(!(n instanceof pd))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));{const o=this.evalExpression(i.index,t).value;if(o<0)return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));if(!(s instanceof fd))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));{const t=n.typeInfo.getTypeName();if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t){if(!(o<2&&2===s.data.length))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[2*o]=s.data[0],n.data[2*o+1]=s.data[1]}else if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t){if(!(o<2&&3===s.data.length))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[3*o]=s.data[0],n.data[3*o+1]=s.data[1],n.data[3*o+2]=s.data[2]}else if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t){if(!(o<2&&4===s.data.length))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[4*o]=s.data[0],n.data[4*o+1]=s.data[1],n.data[4*o+2]=s.data[2],n.data[4*o+3]=s.data[3]}else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t){if(!(o<3&&2===s.data.length))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[2*o]=s.data[0],n.data[2*o+1]=s.data[1]}else if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t){if(!(o<3&&3===s.data.length))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[3*o]=s.data[0],n.data[3*o+1]=s.data[1],n.data[3*o+2]=s.data[2]}else if("mat3x4"===t||"mat3x4f"===t||"mat3x4h"===t){if(!(o<3&&4===s.data.length))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[4*o]=s.data[0],n.data[4*o+1]=s.data[1],n.data[4*o+2]=s.data[2],n.data[4*o+3]=s.data[3]}else if("mat4x2"===t||"mat4x2f"===t||"mat4x2h"===t){if(!(o<4&&2===s.data.length))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[2*o]=s.data[0],n.data[2*o+1]=s.data[1]}else if("mat4x3"===t||"mat4x3f"===t||"mat4x3h"===t){if(!(o<4&&3===s.data.length))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[3*o]=s.data[0],n.data[3*o+1]=s.data[1],n.data[3*o+2]=s.data[2]}else{if("mat4x4"!==t&&"mat4x4f"!==t&&"mat4x4h"!==t)return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));if(!(o<4&&4===s.data.length))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));n.data[4*o]=s.data[0],n.data[4*o+1]=s.data[1],n.data[4*o+2]=s.data[2],n.data[4*o+3]=s.data[3]}}}}}else if(i instanceof Wh){const t=i.value;if(!(n instanceof fd))return void console.error("Invalid assignment to ".concat(t,". Variable ").concat(r," is not a vector. Line ").concat(e.line));if(s instanceof hd){if(t.length>1)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(r,". Line ").concat(e.line));if("x"===t)n.data[0]=s.value;else if("y"===t){if(n.data.length<2)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(r,". Line ").concat(e.line));n.data[1]=s.value}else if("z"===t){if(n.data.length<3)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(r,". Line ").concat(e.line));n.data[2]=s.value}else if("w"===t){if(n.data.length<4)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(r,". Line ").concat(e.line));n.data[3]=s.value}}else{if(!(s instanceof fd))return void console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line));if(t.length!==s.data.length)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(r,". Line ").concat(e.line));for(let i=0;i<t.length;++i){const o=t[i];if("x"===o||"r"===o)n.data[0]=s.data[i];else if("y"===o||"g"===o){if(s.data.length<2)return void console.error("Invalid assignment to ".concat(o," for variable ").concat(r,". Line ").concat(e.line));n.data[1]=s.data[i]}else if("z"===o||"b"===o){if(s.data.length<3)return void console.error("Invalid assignment to ".concat(o," for variable ").concat(r,". Line ").concat(e.line));n.data[2]=s.data[i]}else{if("w"!==o&&"a"!==o)return void console.error("Invalid assignment to ".concat(o," for variable ").concat(r,". Line ").concat(e.line));if(s.data.length<4)return void console.error("Invalid assignment to ".concat(o," for variable ").concat(r,". Line ").concat(e.line));n.data[3]=s.data[i]}}}}}else n instanceof hd&&s instanceof hd?n.value=s.value:n instanceof fd&&s instanceof fd||n instanceof pd&&s instanceof pd?n.data.set(s.data):console.error("Invalid assignment to ".concat(r,". Line ").concat(e.line))}_function(e,t){const n=new Nd(e);t.functions.set(e.name,n)}_const(e,t){let n=null;null!==e.value&&(n=this.evalExpression(e.value,t)),t.createVariable(e.name,n,e)}_let(e,t){let n=null;if(null!==e.value){if(n=this.evalExpression(e.value,t),null===n)return void console.error("Invalid value for variable ".concat(e.name,". Line ").concat(e.line));e.value instanceof $h||(n=n.clone())}else{const r=e.type.name;if("f32"===r||"i32"===r||"u32"===r||"bool"===r||"f16"===r||"vec2"===r||"vec3"===r||"vec4"===r||"vec2f"===r||"vec3f"===r||"vec4f"===r||"vec2i"===r||"vec3i"===r||"vec4i"===r||"vec2u"===r||"vec3u"===r||"vec4u"===r||"vec2h"===r||"vec3h"===r||"vec4h"===r||"vec2b"===r||"vec3b"===r||"vec4b"===r||"mat2x2"===r||"mat2x3"===r||"mat2x4"===r||"mat3x2"===r||"mat3x3"===r||"mat3x4"===r||"mat4x2"===r||"mat4x3"===r||"mat4x4"===r||"mat2x2f"===r||"mat2x3f"===r||"mat2x4f"===r||"mat3x2f"===r||"mat3x3f"===r||"mat3x4f"===r||"mat4x2f"===r||"mat4x3f"===r||"mat4x4f"===r||"mat2x2h"===r||"mat2x3h"===r||"mat2x4h"===r||"mat3x2h"===r||"mat3x3h"===r||"mat3x4h"===r||"mat4x2h"===r||"mat4x3h"===r||"mat4x4h"===r||"array"===r){const r=new Hh(e.type,[]);n=this._evalCreate(r,t)}}t.createVariable(e.name,n,e)}_var(e,t){let n=null;if(null!==e.value){if(n=this.evalExpression(e.value,t),null===n)return void console.error("Invalid value for variable ".concat(e.name,". Line ").concat(e.line));e.value instanceof $h||(n=n.clone())}else{if(null===e.type)return void console.error("Variable ".concat(e.name," has no type. Line ").concat(e.line));const r=e.type.name;if("f32"===r||"i32"===r||"u32"===r||"bool"===r||"f16"===r||"vec2"===r||"vec3"===r||"vec4"===r||"vec2f"===r||"vec3f"===r||"vec4f"===r||"vec2i"===r||"vec3i"===r||"vec4i"===r||"vec2u"===r||"vec3u"===r||"vec4u"===r||"vec2h"===r||"vec3h"===r||"vec4h"===r||"vec2b"===r||"vec3b"===r||"vec4b"===r||"mat2x2"===r||"mat2x3"===r||"mat2x4"===r||"mat3x2"===r||"mat3x3"===r||"mat3x4"===r||"mat4x2"===r||"mat4x3"===r||"mat4x4"===r||"mat2x2f"===r||"mat2x3f"===r||"mat2x4f"===r||"mat3x2f"===r||"mat3x3f"===r||"mat3x4f"===r||"mat4x2f"===r||"mat4x3f"===r||"mat4x4f"===r||"mat2x2h"===r||"mat2x3h"===r||"mat2x4h"===r||"mat3x2h"===r||"mat3x3h"===r||"mat3x4h"===r||"mat4x2h"===r||"mat4x3h"===r||"mat4x4h"===r||e.type instanceof jh||e.type instanceof Nh||e.type instanceof Uh){const r=new Hh(e.type,[]);n=this._evalCreate(r,t)}}t.createVariable(e.name,n,e)}_switch(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof hd))return console.error("Invalid if condition. Line ".concat(e.line)),null;let r=null;for(const i of e.cases)if(i instanceof rd)for(const s of i.selectors){if(s instanceof nd){r=i;continue}const o=this.evalExpression(s,t);if(!(o instanceof hd))return console.error("Invalid case selector. Line ".concat(e.line)),null;if(o.value===n.value)return this._execStatements(i.body,t)}else i instanceof id&&(r=i);return r?this._execStatements(r.body,t):null}_if(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof hd))return console.error("Invalid if condition. Line ".concat(e.line)),null;if(n.value)return this._execStatements(e.body,t);for(const r of e.elseif){const n=this.evalExpression(r.condition,t);if(!(n instanceof hd))return console.error("Invalid if condition. Line ".concat(e.line)),null;if(n.value)return this._execStatements(r.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof hd?e.value:(console.error("Expected scalar value.",e),0)}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===Wd._breakObj)break;if(null!==n&&n!==Wd._continueObj)return n;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const n=this._execStatements(e.body,t);if(n===Wd._breakObj)break;if(n===Wd._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===Wd._breakObj)break}else if(null!==n)return n}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===Wd._breakObj)break;if(n!==Wd._continueObj&&null!==n)return n}return null}_evalBitcast(e,t){const n=this.evalExpression(e.value,t),r=e.type;if(n instanceof hd){const e=kd(n.value,n.typeInfo.name,r.name);return new hd(e,this.getTypeInfo(r))}if(n instanceof fd){const t=n.typeInfo.getTypeName();let i="";if(t.endsWith("f"))i="f32";else if(t.endsWith("i"))i="i32";else if(t.endsWith("u"))i="u32";else if(t.endsWith("b"))i="bool";else{if(!t.endsWith("h"))return console.error("Unknown vector type ".concat(t,". Line ").concat(e.line)),null;i="f16"}const s=r.getTypeName();let o="";if(s.endsWith("f"))o="f32";else if(s.endsWith("i"))o="i32";else if(s.endsWith("u"))o="u32";else if(s.endsWith("b"))o="bool";else{if(!s.endsWith("h"))return console.error("Unknown vector type ".concat(o,". Line ").concat(e.line)),null;o="f16"}const a=function(e,t,n){if(t===n)return e;const r=new Array(e.length);for(let i=0;i<e.length;i++)r[i]=kd(e[i],t,n);return r}(Array.from(n.data),i,o);return new fd(a,this.getTypeInfo(r))}return console.error("TODO: bitcast for ".concat(n.typeInfo.name,". Line ").concat(e.line)),null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var n;if(e instanceof Hh){if(null===e.type)return cd.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}const r=e instanceof Hh?e.type.name:e.name,i=e instanceof Hh?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(null===i)return console.error("Unknown type ".concat(r,". Line ").concat(e.line)),null;if(0===i.size)return null;const s=new gd(new ArrayBuffer(i.size),i,0);if(i instanceof MA){if(e.args)for(let o=0;o<e.args.length;++o){const n=i.members[o],r=e.args[o],a=this.evalExpression(r,t);s.setData(this,a,n.type,n.offset,t)}}else if(i instanceof BA){let r=0;if(e.args)for(let o=0;o<e.args.length;++o){const a=e.args[o],l=this.evalExpression(a,t);null===i.format&&("x32"===(null===(n=l.typeInfo)||void 0===n?void 0:n.name)?i.format=this.getTypeInfo("i32"):i.format=l.typeInfo),s.setData(this,l,i.format,r,t),r+=i.stride}}else console.error('Unknown type "'.concat(r,'". Line ').concat(e.line));return e instanceof Hh?s.getSubData(this,e.postfix,t):s}_evalLiteral(e,t){const n=this.getTypeInfo(e.type),r=n.name;return"x32"===r||"u32"===r||"f32"===r||"f16"===r||"i32"===r||"bool"===r?new hd(e.scalarValue,n):"vec2"===r||"vec3"===r||"vec4"===r||"vec2f"===r||"vec3f"===r||"vec4f"===r||"vec2h"===r||"vec3h"===r||"vec4h"===r||"vec2i"===r||"vec3i"===r||"vec4i"===r||"vec2u"===r||"vec3u"===r||"vec4u"===r?this._callConstructorVec(e,t):"mat2x2"===r||"mat2x3"===r||"mat2x4"===r||"mat3x2"===r||"mat3x3"===r||"mat3x4"===r||"mat4x2"===r||"mat4x3"===r||"mat4x4"===r||"mat2x2f"===r||"mat2x3f"===r||"mat2x4f"===r||"mat3x2f"===r||"mat3x3f"===r||"mat3x4f"===r||"mat4x2f"===r||"mat4x3f"===r||"mat4x4f"===r||"mat2x2h"===r||"mat2x3h"===r||"mat2x4h"===r||"mat3x2h"===r||"mat3x3h"===r||"mat3x4h"===r||"mat4x2h"===r||"mat4x3h"===r||"mat4x4h"===r?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const n=t.getVariableValue(e.name);return null===n?n:n.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if("f32"===t.name)return t;for(let n=1;n<e.length;++n){const r=Wd._priority.get(t.name);Wd._priority.get(e[n].name)<r&&(t=e[n])}return"x32"===t.name?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const n=this.evalExpression(e.right,t);if("&"===e.operator)return new Ad(n);if("*"===e.operator)return n instanceof Ad?n.reference.getSubData(this,e.postfix,t):(console.error("Invalid dereference. Line ".concat(e.line)),null);const r=n instanceof hd?n.value:n instanceof fd?Array.from(n.data):null;switch(e.operator){case"+":{if(wd(r)){const e=r.map((e,t)=>+e);return new fd(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new hd(+e,t)}case"-":{if(wd(r)){const e=r.map((e,t)=>-e);return new fd(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new hd(-e,t)}case"!":{if(wd(r)){const e=r.map((e,t)=>e?0:1);return new fd(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new hd(e?0:1,t)}case"~":{if(wd(r)){const e=r.map((e,t)=>~e);return new fd(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new hd(~e,t)}}return console.error("Invalid unary operator ".concat(e.operator,". Line ").concat(e.line)),null}_evalBinaryOp(e,t){const n=this.evalExpression(e.left,t),r=this.evalExpression(e.right,t),i=n instanceof hd?n.value:n instanceof fd||n instanceof pd?Array.from(n.data):null,s=r instanceof hd?r.value:r instanceof fd||r instanceof pd?Array.from(r.data):null;switch(e.operator){case"+":{if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e+r[t]);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t+e);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e+t);return new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t+o,a)}case"-":{if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e-r[t]);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t-e);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e-t);return new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t-o,a)}case"*":{if(wd(i)&&wd(s)){const t=i,o=s;if(n instanceof pd&&r instanceof pd){const i=function(e,t,n,r){if(void 0===Gd[t.name]||void 0===Gd[r.name])return null;const i=Gd[t.name][0],s=Gd[t.name][1],o=Gd[r.name][0];if(i!==Gd[r.name][1])return null;const a=new Array(o*s);for(let l=0;l<s;l++)for(let t=0;t<o;t++){let r=0;for(let o=0;o<i;o++)r+=e[o*s+l]*n[t*i+o];a[l*o+t]=r}return a}(t,n.typeInfo,o,r.typeInfo);if(null===i)return console.error("Matrix multiplication failed. Line ".concat(e.line,".")),null;const s=Gd[r.typeInfo.name][0],a=Gd[n.typeInfo.name][1],l=this.getTypeInfo("mat".concat(s,"x").concat(a,"f"));return new pd(i,l)}if(n instanceof pd&&r instanceof fd){const i=function(e,t,n,r){if(void 0===Gd[t.name]||void 0===Vd[r.name])return null;const i=Gd[t.name][0],s=Gd[t.name][1];if(i!==n.length)return null;const o=new Array(s);for(let a=0;a<s;a++){let t=0;for(let r=0;r<i;r++)t+=e[r*s+a]*n[r];o[a]=t}return o}(t,n.typeInfo,o,r.typeInfo);return null===i?(console.error("Matrix vector multiplication failed. Line ".concat(e.line,".")),null):new fd(i,r.typeInfo)}if(n instanceof fd&&r instanceof pd){const i=function(e,t,n,r){if(void 0===Vd[t.name]||void 0===Gd[r.name])return null;const i=Gd[r.name][0],s=Gd[r.name][1];if(s!==e.length)return null;const o=[];for(let a=0;a<i;a++){let t=0;for(let r=0;r<s;r++)t+=e[r]*n[r*i+a];o[a]=t}return o}(t,n.typeInfo,o,r.typeInfo);return null===i?(console.error("Matrix vector multiplication failed. Line ".concat(e.line,".")),null):new fd(i,n.typeInfo)}{if(t.length!==o.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const r=t.map((e,t)=>e*o[t]);return new fd(r,n.typeInfo)}}if(wd(i)){const e=s,t=i.map((t,n)=>t*e);return n instanceof pd?new pd(t,n.typeInfo):new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e*t);return r instanceof pd?new pd(t,r.typeInfo):new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t*o,a)}case"%":{if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e%r[t]);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t%e);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e%t);return new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t%o,a)}case"/":{if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e/r[t]);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t/e);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e/t);return new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t/o,a)}case"&":{if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e&r[t]);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t&e);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e&t);return new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t&o,a)}case"|":{if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e|r[t]);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t|e);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e|t);return new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t|o,a)}case"^":{if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e^r[t]);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t^e);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e^t);return new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t^o,a)}case"<<":{if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e<<r[t]);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t<<e);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e<<t);return new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t<<o,a)}case">>":{if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e>>r[t]);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t>>e);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e>>t);return new fd(t,r.typeInfo)}const t=i,o=s,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new hd(t>>o,a)}case">":if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e>r[t]?1:0);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t>e?1:0);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e>t?1:0);return new fd(t,r.typeInfo)}return new hd(i>s?1:0,this.getTypeInfo("bool"));case"<":if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e<r[t]?1:0);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t<e?1:0);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e<t?1:0);return new fd(t,r.typeInfo)}return new hd(i<s?1:0,this.getTypeInfo("bool"));case"==":if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e===r[t]?1:0);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t==e?1:0);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e==t?1:0);return new fd(t,r.typeInfo)}return new hd(i===s?1:0,this.getTypeInfo("bool"));case"!=":if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e!==r[t]?1:0);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t!==e?1:0);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e!==t?1:0);return new fd(t,r.typeInfo)}return new hd(i!==s?1:0,this.getTypeInfo("bool"));case">=":if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e>=r[t]?1:0);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t>=e?1:0);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e>=t?1:0);return new fd(t,r.typeInfo)}return new hd(i>=s?1:0,this.getTypeInfo("bool"));case"<=":if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e<=r[t]?1:0);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t<=e?1:0);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e<=t?1:0);return new fd(t,r.typeInfo)}return new hd(i<=s?1:0,this.getTypeInfo("bool"));case"&&":if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e&&r[t]?1:0);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t&&e?1:0);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e&&t?1:0);return new fd(t,r.typeInfo)}return new hd(i&&s?1:0,this.getTypeInfo("bool"));case"||":if(wd(i)&&wd(s)){const t=i,r=s;if(t.length!==r.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e||r[t]?1:0);return new fd(o,n.typeInfo)}if(wd(i)){const e=s,t=i.map((t,n)=>t||e?1:0);return new fd(t,n.typeInfo)}if(wd(s)){const e=i,t=s.map((t,n)=>e||t?1:0);return new fd(t,r.typeInfo)}return new hd(i||s?1:0,this.getTypeInfo("bool"))}return console.error("Unknown operator ".concat(e.operator,". Line ").concat(e.line)),null}_evalCall(e,t){if(null!==e.cachedReturnValue)return e.cachedReturnValue;const n=t.clone();n.currentFunctionName=e.name;const r=t.getFunction(e.name);if(!r)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,t):(console.error('Unknown function "'.concat(e.name,'". Line ').concat(e.line)),null);for(let i=0;i<r.node.args.length;++i){const t=r.node.args[i],s=this.evalExpression(e.args[i],n);n.createVariable(t.name,s,t)}return this._execStatements(r.node.body,n)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothstep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const n=t.getFunction(e.name);if(n){const r=t.clone();for(let t=0;t<n.node.args.length;++t){const i=n.node.args[t],s=this.evalExpression(e.args[t],r);r.setVariable(i.name,s,i)}return this._execStatements(n.node.body,r)}return null}_callConstructorValue(e,t){if(!e.args||0===e.args.length)return new hd(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],t);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const n=this.getTypeInfo(e.type),r=e.type.getTypeName(),i=Vd[r];if(void 0===i)return console.error("Invalid vec constructor ".concat(r,". Line ").concat(e.line)),null;const s=[];if(e instanceof qh)if(e.isVector){const t=e.vectorValue;for(const e of t)s.push(e)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const e=this.evalExpression(o,t);if(e instanceof fd){const t=e.data;for(let e=0;e<t.length;++e){let n=t[e];s.push(n)}}else if(e instanceof hd){let t=e.value;s.push(t)}}if(e.type instanceof Uh&&null===e.type.format&&(e.type.format=Uh.f32),0===s.length){const r=new Array(i).fill(0);return new fd(r,n).getSubData(this,e.postfix,t)}if(1===s.length)for(;s.length<i;)s.push(s[0]);return s.length<i?(console.error("Invalid vec constructor. Line ".concat(e.line)),null):new fd(s.length>i?s.slice(0,i):s,n).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const n=this.getTypeInfo(e.type),r=e.type.getTypeName(),i=Gd[r];if(void 0===i)return console.error("Invalid matrix constructor ".concat(r,". Line ").concat(e.line)),null;const s=[];if(e instanceof qh)if(e.isVector){const t=e.vectorValue;for(const e of t)s.push(e)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const e=this.evalExpression(o,t);e instanceof fd?s.push(...e.data):e instanceof hd?s.push(e.value):e instanceof pd&&s.push(...e.data)}if(n instanceof OA&&null===n.format&&(n.format=this.getTypeInfo("f32")),0===s.length){const r=new Array(i[2]).fill(0);return new pd(r,n).getSubData(this,e.postfix,t)}return s.length!==i[2]?(console.error("Invalid matrix constructor. Line ".concat(e.line)),null):new pd(s,n).getSubData(this,e.postfix,t)}}Wd._breakObj=new ud(new kA("BREAK",null),null),Wd._continueObj=new ud(new kA("CONTINUE",null),null),Wd._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Hd{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class Qd{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new Hd,this._exec=new Wd,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const e=this._global_decl_or_directive();if(!e)break;t.push(e)}if(this._deferArrayCountEval.length>0){for(const t of this._deferArrayCountEval){const n=t.arrayType,r=t.countNode;if(r instanceof Xh){const t=r.name,i=this._context.constants.get(t);if(i)try{const e=i.constEvaluate(this._exec);n.count=e}catch(e){}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const n of t)n.search(e=>{e instanceof ad||e instanceof zh?e.type=this._forwardType(e.type):e instanceof jh?e.format=this._forwardType(e.format):e instanceof fh||e instanceof gh||e instanceof mh?e.type=this._forwardType(e.type):e instanceof uh?e.returnType=this._forwardType(e.returnType):e instanceof sd&&(e.type=this._forwardType(e.type))});return t}_forwardType(e){if(e instanceof Oh){const t=this._getType(e.name);if(t)return t}else e instanceof zh?e.type=this._forwardType(e.type):e instanceof jh&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if("string"==typeof e){const t=new bd(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=null!=t?t:this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>"".concat(t)}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==vd.eof}_match(e){if(e instanceof yd)return!!this._check(e)&&(this._advance(),!0);for(let t=0,n=e.length;t<n;++t){const n=e[t];if(this._check(n))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),"".concat(t,". Line:").concat(this._currentLine))}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const n=t.type;let r=!1;for(const t of e){if(n===t)return!0;t===vd.tokens.name&&(r=!0)}if(r){const e=vd.tokens.name.rule.exec(t.lexeme);if(e&&0==e.index&&e[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===vd.tokens.name){const e=vd.tokens.name.rule.exec(t.lexeme);return e&&0==e.index&&e[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=null!==(t=null===(e=this._peek())||void 0===e?void 0:e.line)&&void 0!==t?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(vd.tokens.semicolon)&&!this._isAtEnd(););if(this._match(vd.keywords.alias)){const e=this._type_alias();return this._consume(vd.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(vd.keywords.diagnostic)){const e=this._diagnostic();return this._consume(vd.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(vd.keywords.requires)){const e=this._requires_directive();return this._consume(vd.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(vd.keywords.enable)){const e=this._enable_directive();return this._consume(vd.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}const e=this._attribute();if(this._check(vd.keywords.var)){const t=this._global_variable_decl();return null!=t&&(t.attributes=e),this._consume(vd.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(vd.keywords.override)){const t=this._override_variable_decl();return null!=t&&(t.attributes=e),this._consume(vd.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(vd.keywords.let)){const t=this._global_let_decl();return null!=t&&(t.attributes=e),this._consume(vd.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(vd.keywords.const)){const t=this._global_const_decl();return null!=t&&(t.attributes=e),this._consume(vd.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(vd.keywords.struct)){const t=this._struct_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(vd.keywords.fn)){const t=this._function_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(vd.keywords.fn))return null;const e=this._currentLine,t=this._consume(vd.tokens.ident,"Expected function name.").toString();this._consume(vd.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(vd.tokens.paren_right))do{if(this._check(vd.tokens.paren_right))break;const e=this._attribute(),t=this._consume(vd.tokens.name,"Expected argument name.").toString();this._consume(vd.tokens.colon,"Expected ':' for argument type.");const r=this._attribute(),i=this._type_decl();null!=i&&(i.attributes=r,n.push(this._updateNode(new sd(t,i,e))))}while(this._match(vd.tokens.comma));this._consume(vd.tokens.paren_right,"Expected ')' after function arguments.");let r=null;if(this._match(vd.tokens.arrow)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}const i=this._compound_statement(),s=this._currentLine;return this._updateNode(new uh(t,n,r,i,e,s),e)}_compound_statement(){const e=[];for(this._consume(vd.tokens.brace_left,"Expected '{' for block.");!this._check(vd.tokens.brace_right);){const t=this._statement();null!==t&&e.push(t)}return this._consume(vd.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(vd.tokens.semicolon)&&!this._isAtEnd(););if(this._check(vd.tokens.attr)&&this._attribute(),this._check(vd.keywords.if))return this._if_statement();if(this._check(vd.keywords.switch))return this._switch_statement();if(this._check(vd.keywords.loop))return this._loop_statement();if(this._check(vd.keywords.for))return this._for_statement();if(this._check(vd.keywords.while))return this._while_statement();if(this._check(vd.keywords.continuing))return this._continuing_statement();if(this._check(vd.keywords.static_assert))return this._static_assert_statement();if(this._check(vd.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(vd.keywords.return))e=this._return_statement();else if(this._check([vd.keywords.var,vd.keywords.let,vd.keywords.const]))e=this._variable_statement();else if(this._match(vd.keywords.discard))e=this._updateNode(new Ph);else if(this._match(vd.keywords.break)){const t=this._updateNode(new Mh);if(this._currentLoop.length>0){const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t,this._check(vd.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(vd.keywords.continue)){const t=this._updateNode(new Bh);if(!(this._currentLoop.length>0))throw this._error(this._peek(),"Continue statement must be inside a loop. Line: ".concat(t.line));{const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return null!=e&&this._consume(vd.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(vd.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new ch(t),e)}_while_statement(){if(!this._match(vd.keywords.while))return null;const e=this._updateNode(new Ah(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(vd.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(vd.keywords.continuing))return null;const t=this._currentLine,n=this._compound_statement();return this._updateNode(new hh(n,e),t)}_for_statement(){if(!this._match(vd.keywords.for))return null;this._consume(vd.tokens.paren_left,"Expected '('.");const e=this._updateNode(new dh(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(vd.tokens.semicolon)?null:this._for_init(),this._consume(vd.tokens.semicolon,"Expected ';'."),e.condition=this._check(vd.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(vd.tokens.semicolon,"Expected ';'."),e.increment=this._check(vd.tokens.paren_right)?null:this._for_increment(),this._consume(vd.tokens.paren_right,"Expected ')'."),this._check(vd.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(vd.keywords.var)){const e=this._variable_decl();if(null===e)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(vd.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new fh(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(vd.keywords.let)){const e=this._currentLine,t=this._consume(vd.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(vd.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}this._consume(vd.tokens.equal,"Expected '=' for let.");const r=this._short_circuit_or_expression();return this._updateNode(new gh(t,n,null,null,r),e)}if(this._match(vd.keywords.const)){const e=this._currentLine,t=this._consume(vd.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(vd.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}this._consume(vd.tokens.equal,"Expected '=' for const.");const r=this._short_circuit_or_expression();return null===n&&r instanceof qh&&(n=r.type),this._updateNode(new mh(t,n,null,null,r),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(null==t)return null;if(!this._check(vd.increment_operators))return this._current=e,null;const n=this._consume(vd.increment_operators,"Expected increment operator");return this._updateNode(new wh(n.type===vd.tokens.plus_plus?yh.increment:yh.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(vd.tokens.brace_right))return null;let n=this._match(vd.tokens.underscore);if(n||(e=this._unary_expression()),!n&&null==e)return null;const r=this._consume(vd.assignment_operators,"Expected assignment operator."),i=this._short_circuit_or_expression();return this._updateNode(new Eh(vh.parse(r.lexeme),e,i),t)}_func_call_statement(){if(!this._check(vd.tokens.ident))return null;const e=this._currentLine,t=this._current,n=this._consume(vd.tokens.ident,"Expected function name."),r=this._argument_expression_list();return null===r?(this._current=t,null):this._updateNode(new xh(n.lexeme,r),e)}_loop_statement(){if(!this._match(vd.keywords.loop))return null;this._check(vd.tokens.attr)&&this._attribute(),this._consume(vd.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new Dh([],null));this._currentLoop.push(e);let t=this._statement();for(;null!==t;){if(Array.isArray(t))for(let n of t)e.body.push(n);else e.body.push(t);if(t instanceof hh){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(vd.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(vd.keywords.switch))return null;const e=this._updateNode(new Ch(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(vd.tokens.attr)&&this._attribute(),this._consume(vd.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),null==e.cases||0==e.cases.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(vd.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([vd.keywords.default,vd.keywords.case]);){if(this._match(vd.keywords.case)){const n=this._case_selectors();for(const e of n)if(e instanceof nd){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(vd.tokens.colon),this._check(vd.tokens.attr)&&this._attribute(),this._consume(vd.tokens.brace_left,"Exected '{' for switch case.");const r=this._case_body();this._consume(vd.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new rd(n,r)))}if(this._match(vd.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(vd.tokens.colon),this._check(vd.tokens.attr)&&this._attribute(),this._consume(vd.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(vd.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new id(n)))}}return e}_case_selectors(){const e=[];for(this._match(vd.keywords.default)?e.push(this._updateNode(new nd)):e.push(this._shift_expression());this._match(vd.tokens.comma);)this._match(vd.keywords.default)?e.push(this._updateNode(new nd)):e.push(this._shift_expression());return e}_case_body(){if(this._match(vd.keywords.fallthrough))return this._consume(vd.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(null==e)return[];e instanceof Array||(e=[e]);const t=this._case_body();return 0==t.length?e:[...e,t[0]]}_if_statement(){if(!this._match(vd.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(vd.tokens.attr)&&this._attribute();const n=this._compound_statement();let r=[];this._match_elseif()&&(this._check(vd.tokens.attr)&&this._attribute(),r=this._elseif_statement(r));let i=null;return this._match(vd.keywords.else)&&(this._check(vd.tokens.attr)&&this._attribute(),i=this._compound_statement()),this._updateNode(new Sh(t,n,r,i),e)}_match_elseif(){return this._tokens[this._current].type===vd.keywords.else&&this._tokens[this._current+1].type===vd.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new od(t,n))),this._match_elseif()&&(this._check(vd.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(vd.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new Th(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(vd.tokens.or_or);)e=this._updateNode(new ed(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(vd.tokens.and_and);)e=this._updateNode(new ed(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(vd.tokens.or);)e=this._updateNode(new ed(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(vd.tokens.xor);)e=this._updateNode(new ed(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(vd.tokens.and);)e=this._updateNode(new ed(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([vd.tokens.equal_equal,vd.tokens.not_equal])?this._updateNode(new ed(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([vd.tokens.less_than,vd.tokens.greater_than,vd.tokens.less_than_equal,vd.tokens.greater_than_equal]);)e=this._updateNode(new ed(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([vd.tokens.shift_left,vd.tokens.shift_right]);)e=this._updateNode(new ed(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([vd.tokens.plus,vd.tokens.minus]);)e=this._updateNode(new ed(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([vd.tokens.star,vd.tokens.forward_slash,vd.tokens.modulo]);)e=this._updateNode(new ed(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([vd.tokens.minus,vd.tokens.bang,vd.tokens.tilde,vd.tokens.star,vd.tokens.and])?this._updateNode(new $h(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(vd.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(vd.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new Zh(e)),n=this._postfix_expression();return n&&(t.postfix=n),t}if(this._match(vd.tokens.period)){const e=this._consume(vd.tokens.name,"Expected member name."),t=this._postfix_expression(),n=this._updateNode(new Wh(e.lexeme));return t&&(n.postfix=t),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(null!==t)return t;switch(e){case"void":return Lh.void;case"bool":return Lh.bool;case"i32":return Lh.i32;case"u32":return Lh.u32;case"f32":return Lh.f32;case"f16":return Lh.f16;case"vec2f":return Uh.vec2f;case"vec3f":return Uh.vec3f;case"vec4f":return Uh.vec4f;case"vec2i":return Uh.vec2i;case"vec3i":return Uh.vec3i;case"vec4i":return Uh.vec4i;case"vec2u":return Uh.vec2u;case"vec3u":return Uh.vec3u;case"vec4u":return Uh.vec4u;case"vec2h":return Uh.vec2h;case"vec3h":return Uh.vec3h;case"vec4h":return Uh.vec4h;case"mat2x2f":return Uh.mat2x2f;case"mat2x3f":return Uh.mat2x3f;case"mat2x4f":return Uh.mat2x4f;case"mat3x2f":return Uh.mat3x2f;case"mat3x3f":return Uh.mat3x3f;case"mat3x4f":return Uh.mat3x4f;case"mat4x2f":return Uh.mat4x2f;case"mat4x3f":return Uh.mat4x3f;case"mat4x4f":return Uh.mat4x4f;case"mat2x2h":return Uh.mat2x2h;case"mat2x3h":return Uh.mat2x3h;case"mat2x4h":return Uh.mat2x4h;case"mat3x2h":return Uh.mat3x2h;case"mat3x3h":return Uh.mat3x3h;case"mat3x4h":return Uh.mat3x4h;case"mat4x2h":return Uh.mat4x2h;case"mat4x3h":return Uh.mat4x3h;case"mat4x4h":return Uh.mat4x4h;case"mat2x2i":return Uh.mat2x2i;case"mat2x3i":return Uh.mat2x3i;case"mat2x4i":return Uh.mat2x4i;case"mat3x2i":return Uh.mat3x2i;case"mat3x3i":return Uh.mat3x3i;case"mat3x4i":return Uh.mat3x4i;case"mat4x2i":return Uh.mat4x2i;case"mat4x3i":return Uh.mat4x3i;case"mat4x4i":return Uh.mat4x4i;case"mat2x2u":return Uh.mat2x2u;case"mat2x3u":return Uh.mat2x3u;case"mat2x4u":return Uh.mat2x4u;case"mat3x2u":return Uh.mat3x2u;case"mat3x3u":return Uh.mat3x3u;case"mat3x4u":return Uh.mat3x4u;case"mat4x2u":return Uh.mat4x2u;case"mat4x3u":return Uh.mat4x3u;case"mat4x4u":return Uh.mat4x4u}return null}_validateTypeRange(e,t){if("i32"===t.name){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),"Value out of range for i32: ".concat(e,". Line: ").concat(this._currentLine,"."))}else if("u32"===t.name&&(e<0||e>4294967295))throw this._error(this._previous(),"Value out of range for u32: ".concat(e,". Line: ").concat(this._currentLine,"."))}_primary_expression(){if(this._match(vd.tokens.ident)){const e=this._previous().toString();if(this._check(vd.tokens.paren_left)){const t=this._argument_expression_list(),n=this._getType(e);return null!==n?this._updateNode(new Hh(n,t)):this._updateNode(new Qh(e,t))}if(this._context.constants.has(e)){const t=this._context.constants.get(e);return this._updateNode(new Yh(e,t.value))}return this._updateNode(new Xh(e))}if(this._match(vd.tokens.int_literal)){const e=this._previous().toString();let t=e.endsWith("i")||e.endsWith("i")?Lh.i32:e.endsWith("u")||e.endsWith("U")?Lh.u32:Lh.x32;const n=parseInt(e);return this._validateTypeRange(n,t),this._updateNode(new qh(new hd(n,this._exec.getTypeInfo(t)),t))}if(this._match(vd.tokens.uint_literal)){const e=parseInt(this._previous().toString());return this._validateTypeRange(e,Lh.u32),this._updateNode(new qh(new hd(e,this._exec.getTypeInfo(Lh.u32)),Lh.u32))}if(this._match([vd.tokens.decimal_float_literal,vd.tokens.hex_float_literal])){let e=this._previous().toString(),t=e.endsWith("h");t&&(e=e.substring(0,e.length-1));const n=parseFloat(e);this._validateTypeRange(n,t?Lh.f16:Lh.f32);const r=t?Lh.f16:Lh.f32;return this._updateNode(new qh(new hd(n,this._exec.getTypeInfo(r)),r))}if(this._match([vd.keywords.true,vd.keywords.false])){let e=this._previous().toString()===vd.keywords.true.rule;return this._updateNode(new qh(new hd(e?1:0,this._exec.getTypeInfo(Lh.bool)),Lh.bool))}if(this._check(vd.tokens.paren_left))return this._paren_expression();if(this._match(vd.keywords.bitcast)){this._consume(vd.tokens.less_than,"Expected '<'.");const e=this._type_decl();this._consume(vd.tokens.greater_than,"Expected '>'.");const t=this._paren_expression();return this._updateNode(new Kh(e,t))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new Hh(e,t))}_argument_expression_list(){if(!this._match(vd.tokens.paren_left))return null;const e=[];do{if(this._check(vd.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(vd.tokens.comma));return this._consume(vd.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(vd.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(vd.tokens.paren_right),e}_paren_expression(){this._consume(vd.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(vd.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(vd.keywords.struct))return null;const e=this._currentLine,t=this._consume(vd.tokens.ident,"Expected name for struct.").toString();this._consume(vd.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(vd.tokens.brace_right);){const e=this._attribute(),t=this._consume(vd.tokens.name,"Expected variable name.").toString();this._consume(vd.tokens.colon,"Expected ':' for struct member type.");const r=this._attribute(),i=this._type_decl();null!=i&&(i.attributes=r),this._check(vd.tokens.brace_right)?this._match(vd.tokens.comma):this._consume(vd.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new ad(t,i,e)))}this._consume(vd.tokens.brace_right,"Expected '}' after struct body.");const r=this._currentLine,i=this._updateNode(new Nh(t,n,e,r),e);return this._context.structs.set(t,i),i}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(vd.tokens.equal)){const t=this._const_expression();e.value=t}if(null!==e.type&&e.value instanceof qh){if("x32"!==e.value.type.name&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),"Invalid cast from ".concat(e.value.type.name," to ").concat(e.type.name,". Line:").concat(this._currentLine));e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else null===e.type&&e.value instanceof qh&&(e.type="x32"===e.value.type.name?Lh.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(vd.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(vd.keywords.const))return null;const t=this._consume(vd.tokens.name,"Expected variable name"),n=this._currentLine;let r=null;if(this._match(vd.tokens.colon)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}let i=null;this._consume(vd.tokens.equal,"const declarations require an assignment");const s=this._short_circuit_or_expression();try{let e=[Lh.f32],n=s.constEvaluate(this._exec,e);n instanceof hd&&this._validateTypeRange(n.value,e[0]),e[0]instanceof Uh&&null===e[0].format&&n.typeInfo instanceof OA&&null!==n.typeInfo.format&&("f16"===n.typeInfo.format.name?e[0].format=Lh.f16:"f32"===n.typeInfo.format.name?e[0].format=Lh.f32:"i32"===n.typeInfo.format.name?e[0].format=Lh.i32:"u32"===n.typeInfo.format.name?e[0].format=Lh.u32:"bool"===n.typeInfo.format.name?e[0].format=Lh.bool:console.error("TODO: impelement template format type ".concat(n.typeInfo.format.name))),i=this._updateNode(new qh(n,e[0])),this._exec.context.setVariable(t.toString(),n)}catch(e){i=s}if(null!==r&&i instanceof qh){if("x32"!==i.type.name&&r.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),"Invalid cast from ".concat(i.type.name," to ").concat(r.name,". Line:").concat(this._currentLine));i.type=r,i.isScalar&&this._validateTypeRange(i.scalarValue,i.type)}else null===r&&i instanceof qh&&(r=null!==(e=null==i?void 0:i.type)&&void 0!==e?e:Lh.f32,r===Lh.x32&&(r=Lh.i32));const o=this._updateNode(new mh(t.toString(),r,"","",i),n);return this._context.constants.set(o.name,o),o}_global_let_decl(){if(!this._match(vd.keywords.let))return null;const e=this._currentLine,t=this._consume(vd.tokens.name,"Expected variable name");let n=null;if(this._match(vd.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}let r=null;if(this._match(vd.tokens.equal)&&(r=this._const_expression()),null!==n&&r instanceof qh){if("x32"!==r.type.name&&n.getTypeName()!==r.type.getTypeName())throw this._error(this._peek(),"Invalid cast from ".concat(r.type.name," to ").concat(n.name,". Line:").concat(this._currentLine));r.type=n}else null===n&&r instanceof qh&&(n="x32"===r.type.name?Lh.i32:r.type);return r instanceof qh&&r.isScalar&&this._validateTypeRange(r.scalarValue,n),this._updateNode(new gh(t.toString(),n,"","",r),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(vd.keywords.var))return null;const e=this._currentLine;let t="",n="";this._match(vd.tokens.less_than)&&(t=this._consume(vd.storage_class,"Expected storage_class.").toString(),this._match(vd.tokens.comma)&&(n=this._consume(vd.access_mode,"Expected access_mode.").toString()),this._consume(vd.tokens.greater_than,"Expected '>'."));const r=this._consume(vd.tokens.name,"Expected variable name");let i=null;if(this._match(vd.tokens.colon)){const e=this._attribute();i=this._type_decl(),null!=i&&(i.attributes=e)}return this._updateNode(new fh(r.toString(),i,t,n,null),e)}_override_decl(){if(!this._match(vd.keywords.override))return null;const e=this._consume(vd.tokens.name,"Expected variable name");let t=null;if(this._match(vd.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}return this._updateNode(new ph(e.toString(),t,null))}_diagnostic(){this._consume(vd.tokens.paren_left,"Expected '('");const e=this._consume(vd.tokens.ident,"Expected severity control name.");this._consume(vd.tokens.comma,"Expected ','");let t=this._consume(vd.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(vd.tokens.period)&&(t+=".".concat(this._consume(vd.tokens.ident,"Expected diagnostic message.").toString())),this._consume(vd.tokens.paren_right,"Expected ')'"),this._updateNode(new Rh(e.toString(),t))}_enable_directive(){const e=this._consume(vd.tokens.ident,"identity expected.");return this._updateNode(new Ih(e.toString()))}_requires_directive(){const e=[this._consume(vd.tokens.ident,"identity expected.").toString()];for(;this._match(vd.tokens.comma);){const t=this._consume(vd.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new Fh(e))}_type_alias(){const e=this._consume(vd.tokens.ident,"identity expected.");this._consume(vd.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(null===t)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const n=this._updateNode(new kh(e.toString(),t));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([vd.tokens.ident,...vd.texel_format,vd.keywords.bool,vd.keywords.f32,vd.keywords.i32,vd.keywords.u32])){const e=this._advance().toString();if(this._context.structs.has(e))return this._context.structs.get(e);if(this._context.aliases.has(e))return this._context.aliases.get(e).type;if(!this._getType(e)){const t=this._updateNode(new Oh(e));return this._forwardTypeCount++,t}return this._updateNode(new Lh(e))}let e=this._texture_sampler_types();if(e)return e;if(this._check(vd.template_types)){let e=this._advance().toString(),t=null,n=null;return this._match(vd.tokens.less_than)&&(t=this._type_decl(),n=null,this._match(vd.tokens.comma)&&(n=this._consume(vd.access_mode,"Expected access_mode for pointer").toString()),this._consume(vd.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new Uh(e,t,n))}if(this._match(vd.keywords.ptr)){let e=this._previous().toString();this._consume(vd.tokens.less_than,"Expected '<' for pointer.");const t=this._consume(vd.storage_class,"Expected storage_class for pointer");this._consume(vd.tokens.comma,"Expected ',' for pointer.");const n=this._type_decl();let r=null;return this._match(vd.tokens.comma)&&(r=this._consume(vd.access_mode,"Expected access_mode for pointer").toString()),this._consume(vd.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new zh(e,t.toString(),n,r))}const t=this._attribute();if(this._match(vd.keywords.array)){let n=null,r=-1;const i=this._previous();let s=null;if(this._match(vd.tokens.less_than)){n=this._type_decl(),this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let t="";if(this._match(vd.tokens.comma)){s=this._shift_expression();try{t=s.constEvaluate(this._exec).toString(),s=null}catch(e){t="1"}}this._consume(vd.tokens.greater_than,"Expected '>' for array."),r=t?parseInt(t):0}const o=this._updateNode(new jh(i.toString(),t,n,r));return s&&this._deferArrayCountEval.push({arrayType:o,countNode:s}),o}return null}_texture_sampler_types(){if(this._match(vd.sampler_type))return this._updateNode(new Vh(this._previous().toString(),null,null));if(this._match(vd.depth_texture_type))return this._updateNode(new Vh(this._previous().toString(),null,null));if(this._match(vd.sampled_texture_type)||this._match(vd.multisampled_texture_type)){const e=this._previous();this._consume(vd.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(vd.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Vh(e.toString(),t,null))}if(this._match(vd.storage_texture_type)){const e=this._previous();this._consume(vd.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(vd.texel_format,"Invalid texel format.").toString();this._consume(vd.tokens.comma,"Expected ',' after texel format.");const n=this._consume(vd.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(vd.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Vh(e.toString(),t,n))}return null}_attribute(){let e=[];for(;this._match(vd.tokens.attr);){const t=this._consume(vd.attribute_name,"Expected attribute name"),n=this._updateNode(new ld(t.toString(),null));if(this._match(vd.tokens.paren_left)){if(n.value=this._consume(vd.literal_or_ident,"Expected attribute value").toString(),this._check(vd.tokens.comma)){this._advance();do{const e=this._consume(vd.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(e)}while(this._match(vd.tokens.comma))}this._consume(vd.tokens.paren_right,"Expected ')'")}e.push(n)}return 0==e.length?null:e}}class Xd extends Bd{constructor(e){super(),e&&this.update(e)}update(e){const t=(new Qd).parse(e);this.updateAST(t)}}function Yd(e){const t={attributes:[],bindings:[]};let n;try{n=function(e){try{return new Xd(e)}catch(t){if(t instanceof Error)throw t;let e="WGSL parse error";throw"object"===typeof t&&null!==t&&void 0!==t&&t.message&&(e+=": ".concat(t.message," ")),"object"===typeof t&&null!==t&&void 0!==t&&t.token&&(e+=t.token.line||""),new Error(e,{cause:t})}}(e)}catch(o){return ja.error(o.message)(),t}for(const a of n.uniforms){const e=[];for(const t of(null===(r=a.type)||void 0===r?void 0:r.members)||[]){var r;e.push({name:t.name,type:qd(t.type)})}t.bindings.push({type:"uniform",name:a.name,group:a.group,location:a.binding,members:e})}for(const a of n.textures)t.bindings.push({type:"texture",name:a.name,group:a.group,location:a.binding});for(const a of n.samplers)t.bindings.push({type:"sampler",name:a.name,group:a.group,location:a.binding});const i=n.entry.vertex[0],s=(null===i||void 0===i?void 0:i.inputs.length)||0;for(let a=0;a<s;a++){const e=i.inputs[a];if("location"===e.locationType){const n=qd(e.type);t.attributes.push({name:e.name,location:Number(e.location),type:n})}}return t}function qd(e){return e.format?"".concat(e.name,"<").concat(e.format.name,">"):e.name}const Kd={};function Zd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";Kd[e]=Kd[e]||1;const t=Kd[e]++;return"".concat(e,"-").concat(t)}class Jd{constructor(e){if(a(this,"id",void 0),a(this,"userData",{}),a(this,"topology",void 0),a(this,"bufferLayout",[]),a(this,"vertexCount",void 0),a(this,"indices",void 0),a(this,"attributes",void 0),this.id=e.id||Zd("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&Ha.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){var e;null===(e=this.indices)||void 0===e||e.destroy();for(const t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function $d(e,t){if(t instanceof Jd)return t;const n=function(e,t){if(!t.indices)return;const n=t.indices.value;return e.createBuffer({usage:Ha.INDEX,data:n})}(e,t),{attributes:r,bufferLayout:i}=function(e,t){const n=[],r={};for(const[s,o]of Object.entries(t.attributes)){let t=s;switch(s){case"POSITION":t="positions";break;case"NORMAL":t="normals";break;case"TEXCOORD_0":t="texCoords";break;case"COLOR_0":t="colors"}if(o){r[t]=e.createBuffer({data:o.value,id:"".concat(s,"-buffer")});const{value:i,size:a,normalized:l}=o;n.push({name:t,format:oA(i,a,l)})}}const i=t._calculateVertexCount(t.attributes,t.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}(e,t);return new Jd({topology:t.topology||"triangle-list",bufferLayout:i,vertexCount:t.vertexCount,indices:n,attributes:r})}class ef extends Wa{get[Symbol.toStringTag](){return"ComputePipeline"}constructor(e,t){super(e,t,ef.defaultProps),a(this,"hash",""),a(this,"shaderLayout",void 0),this.shaderLayout=t.shaderLayout}}a(ef,"defaultProps",u(u({},Wa.defaultProps),{},{shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}));class tf{static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new tf(e),e._lumaData.defaultPipelineFactory}constructor(e){a(this,"device",void 0),a(this,"destroyPolicy",void 0),a(this,"_hashCounter",0),a(this,"_hashes",{}),a(this,"_renderPipelineCache",{}),a(this,"_computePipelineCache",{}),this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createRenderPipeline(e){const t=u(u({},ic.defaultProps),e),n=this._hashRenderPipeline(t);if(!this._renderPipelineCache[n]){const e=this.device.createRenderPipeline(u(u({},t),{},{id:t.id?"".concat(t.id,"-cached"):void 0}));e.hash=n,this._renderPipelineCache[n]={pipeline:e,useCount:0}}return this._renderPipelineCache[n].useCount++,this._renderPipelineCache[n].pipeline}createComputePipeline(e){const t=u(u({},ef.defaultProps),e),n=this._hashComputePipeline(t);if(!this._computePipelineCache[n]){const e=this.device.createComputePipeline(u(u({},t),{},{id:t.id?"".concat(t.id,"-cached"):void 0}));e.hash=n,this._computePipelineCache[n]={pipeline:e,useCount:0}}return this._computePipelineCache[n].useCount++,this._computePipelineCache[n].pipeline}release(e){const t=e.hash,n=e instanceof ef?this._computePipelineCache:this._renderPipelineCache;n[t].useCount--,0===n[t].useCount&&"unused"===this.destroyPolicy&&(n[t].pipeline.destroy(),delete n[t])}_hashComputePipeline(e){const t=this._getHash(e.shader.source);return"".concat(t)}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,r=this._getHash(JSON.stringify(e.bufferLayout));if("webgl"===this.device.type)return"".concat(t,"/").concat(n,"V").concat("-","BL").concat(r);{const i=this._getHash(JSON.stringify(e.parameters));return"".concat(t,"/").concat(n,"V").concat("-","T").concat(e.topology,"P").concat(i,"BL").concat(r)}}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}a(tf,"defaultProps",u({},ic.defaultProps));class nf{static getDefaultShaderFactory(e){var t;return(t=e._lumaData).defaultShaderFactory||(t.defaultShaderFactory=new nf(e)),e._lumaData.defaultShaderFactory}constructor(e){a(this,"device",void 0),a(this,"destroyPolicy",void 0),a(this,"_cache",{}),this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createShader(e){const t=this._hashShader(e);let n=this._cache[t];if(!n){const r=this.device.createShader(u(u({},e),{},{id:e.id?"".concat(e.id,"-cached"):void 0}));this._cache[t]=n={shader:r,useCount:0}}return n.useCount++,n.shader}release(e){const t=this._hashShader(e),n=this._cache[t];n&&(n.useCount--,0===n.useCount&&"unused"===this.destroyPolicy&&(delete this._cache[t],n.shader.destroy()))}_hashShader(e){return"".concat(e.stage,":").concat(e.source)}}a(nf,"defaultProps",u({},Cu.defaultProps));let rf=null,sf=null;function of(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!of(e[r],t[r],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const s of r){if(!t.hasOwnProperty(s))return!1;if(!of(e[s],t[s],n-1))return!1}return!0}return!1}function af(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach(n=>{const r=e[n];!function(e){return pc(e)||"number"===typeof e||"boolean"===typeof e}(r)?t.bindings[n]=r:t.uniforms[n]=r}),t}class lf{constructor(e,t){a(this,"options",{disableWarnings:!1}),a(this,"modules",void 0),a(this,"moduleUniforms",void 0),a(this,"moduleBindings",void 0),Object.assign(this.options,t);const n=T(Object.values(e).filter(e=>e.dependencies));for(const r of n)e[r.name]=r;ja.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[r,i]of Object.entries(e))this._addModule(i),i.name&&r!==i.name&&!this.options.disableWarnings&&ja.warn("Module name: ".concat(r," vs ").concat(i.name))()}destroy(){}setProps(e){for(const n of Object.keys(e)){var t;const r=n,i=e[r]||{},s=this.modules[r];if(!s){this.options.disableWarnings||ja.warn("Module ".concat(n," not found"))();continue}const o=this.moduleUniforms[r],a=this.moduleBindings[r],l=(null===(t=s.getUniforms)||void 0===t?void 0:t.call(s,i,o))||i,{uniforms:c,bindings:A}=af(l);this.moduleUniforms[r]=u(u({},o),c),this.moduleBindings[r]=u(u({},a),A)}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[n,r]of Object.entries(this.moduleUniforms))for(const[i,s]of Object.entries(r)){var t;e["".concat(n,".").concat(i)]={type:null===(t=this.modules[n].uniformTypes)||void 0===t?void 0:t[i],value:String(s)}}return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}let uf="";async function cf(e,t){const n=new Image;return n.crossOrigin=(null===t||void 0===t?void 0:t.crossOrigin)||"anonymous",n.src=e.startsWith("http")?e:uf+e,await n.decode(),t?await createImageBitmap(n,t):await createImageBitmap(n)}class Af{get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return'AsyncTexture:"'.concat(this.id,'"(').concat(this.isReady?"ready":"loading",")")}constructor(e,t){var n;a(this,"device",void 0),a(this,"id",void 0),a(this,"texture",void 0),a(this,"sampler",void 0),a(this,"view",void 0),a(this,"ready",void 0),a(this,"isReady",!1),a(this,"destroyed",!1),a(this,"resolveReady",()=>{}),a(this,"rejectReady",()=>{}),this.device=e,this.id=t.id||Zd("async-texture"),"string"===typeof(null===(n=t)||void 0===n?void 0:n.data)&&"2d"===t.dimension&&(t=u(u({},t),{},{data:cf(t.data)})),this.ready=new Promise((e,t)=>{this.resolveReady=()=>{this.isReady=!0,e()},this.rejectReady=t}),this.initAsync(t)}async initAsync(e){const t=e.data;let n;try{n=await hf(t)}catch(i){this.rejectReady(i)}if(this.destroyed)return;const r=u(u({},e),{},{data:n});this.texture=this.device.createTexture(r),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0,this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}}async function hf(e){if(e=await e,Array.isArray(e))return await Promise.all(e.map(hf));if(e&&"object"===typeof e&&e.constructor===Object){const t=e,n=await Promise.all(Object.values(t)),r=Object.keys(t),i={};for(let e=0;e<r.length;e++)i[r[e]]=n[e];return i}return e}class df{get[Symbol.toStringTag](){return"Model"}toString(){return"Model(".concat(this.id,")")}constructor(e,t){var n,r,i;a(this,"device",void 0),a(this,"id",void 0),a(this,"source",void 0),a(this,"vs",void 0),a(this,"fs",void 0),a(this,"pipelineFactory",void 0),a(this,"shaderFactory",void 0),a(this,"userData",{}),a(this,"parameters",void 0),a(this,"topology",void 0),a(this,"bufferLayout",void 0),a(this,"isInstanced",void 0),a(this,"instanceCount",0),a(this,"vertexCount",void 0),a(this,"indexBuffer",null),a(this,"bufferAttributes",{}),a(this,"constantAttributes",{}),a(this,"bindings",{}),a(this,"uniforms",{}),a(this,"vertexArray",void 0),a(this,"transformFeedback",null),a(this,"pipeline",void 0),a(this,"shaderInputs",void 0),a(this,"_uniformStore",void 0),a(this,"_attributeInfos",{}),a(this,"_gpuGeometry",null),a(this,"_getModuleUniforms",void 0),a(this,"props",void 0),a(this,"_pipelineNeedsUpdate","newly created"),a(this,"_needsRedraw","initializing"),a(this,"_destroyed",!1),a(this,"_lastDrawTimestamp",-1),a(this,"_lastLogTime",0),a(this,"_logOpen",!1),a(this,"_drawCount",0),this.props=u(u({},df.defaultProps),t),t=this.props,this.id=t.id||Zd("model"),this.device=e,Object.assign(this.userData,t.userData);const s=Object.fromEntries((null===(n=this.props.modules)||void 0===n?void 0:n.map(e=>[e.name,e]))||[]),o=t.shaderInputs||new lf(s,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(o);const l=function(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}(e),c=((null===(r=this.props.modules)||void 0===r?void 0:r.length)>0?this.props.modules:null===(i=this.shaderInputs)||void 0===i?void 0:i.getModules())||[];if("webgpu"===this.device.type&&this.props.source){var A;const{source:e,getUniforms:t}=this.props.shaderAssembler.assembleWGSLShader(u(u({platformInfo:l},this.props),{},{modules:c}));this.source=e,this._getModuleUniforms=t,(A=this.props).shaderLayout||(A.shaderLayout=Yd(this.source))}else{const{vs:e,fs:t,getUniforms:n}=this.props.shaderAssembler.assembleGLSLShaderPair(u(u({platformInfo:l},this.props),{},{modules:c}));this.vs=e,this.fs=t,this._getModuleUniforms=n}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||tf.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||nf.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.uniforms&&this.setUniformsWebGL(t.uniforms),t.moduleSettings&&this.updateModuleSettingsWebGL(t.moduleSettings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),null===(e=this._gpuGeometry)||void 0===e||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return ja.info(2,">>> DRAWING ABORTED ".concat(this.id,": ").concat(t," not loaded"))(),!1;try{e.pushDebugGroup("".concat(this,".predraw(").concat(e,")")),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup("".concat(this,".draw(").concat(e,")")),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const t=this._getBindings();this.pipeline.setBindings(t,{disableWarnings:this.props.disableWarnings}),pf(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:r}=this.vertexArray,i=r?r.byteLength/("uint32"===r.indexType?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:i,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){var t;null===(t=this._gpuGeometry)||void 0===t||t.destroy();const n=e&&$d(this.device,e);if(n){this.setTopology(n.topology||"triangle-list");const e=new xA(this.bufferLayout);this.bufferLayout=e.mergeBufferLayouts(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)}this._gpuGeometry=n}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new xA(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){of(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,void 0===this.isInstanced&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new RA(this.shaderInputs.modules);for(const[t,n]of Object.entries(this.shaderInputs.modules))if(ff(n)){const e=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings["".concat(t,"Uniforms")]=e}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){var n;const r=null!==(n=null===t||void 0===t?void 0:t.disableWarnings)&&void 0!==n?n:this.props.disableWarnings;e.indices&&ja.warn("Model:".concat(this.id," setAttributes() - indexBuffer should be set using setIndexBuffer()"))(),this.bufferLayout=function(e,t){const n=Object.fromEntries(e.attributes.map(e=>[e.name,e.location])),r=t.slice();return r.sort((e,t)=>{const r=e.attributes?e.attributes.map(e=>e.attribute):[e.name],i=t.attributes?t.attributes.map(e=>e.attribute):[t.name];return Math.min(...r.map(e=>n[e]))-Math.min(...i.map(e=>n[e]))}),r}(this.pipeline.shaderLayout,this.bufferLayout);const i=new xA(this.bufferLayout);for(const[s,o]of Object.entries(e)){const e=i.getBufferLayout(s);if(!e){r||ja.warn("Model(".concat(this.id,'): Missing layout for buffer "').concat(s,'".'))();continue}const t=i.getAttributeNamesForBuffer(e);let n=!1;for(const r of t){const e=this._attributeInfos[r];if(e){const t="webgpu"===this.device.type?i.getBufferIndex(e.bufferName):e.location;this.vertexArray.setBuffer(t,o),n=!0}}n||r||ja.warn("Model(".concat(this.id,'): Ignoring buffer "').concat(o.id,'" for unknown attribute "').concat(s,'"'))()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[r,i]of Object.entries(e)){var n;const e=this._attributeInfos[r];e?this.vertexArray.setConstantWebGL(e.location,i):(null!==(n=null===t||void 0===t?void 0:t.disableWarnings)&&void 0!==n?n:this.props.disableWarnings)||ja.warn('Model "'.concat(this.id,': Ignoring constant supplied for unknown attribute "').concat(r,'"'))()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){pf(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:t,uniforms:n}=af(this._getModuleUniforms(e));Object.assign(this.bindings,t),Object.assign(this.uniforms,n),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof Af&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,n]of Object.entries(this.bindings))n instanceof Af?n.isReady&&(e[t]=n.texture):e[t]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof Gu?e=Math.max(e,t.texture.updateTimestamp):t instanceof Ha||t instanceof au?e=Math.max(e,t.updateTimestamp):t instanceof Af?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof Ru||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t=u({},e.attributes);for(const[n]of Object.entries(t))this.pipeline.shaderLayout.attributes.find(e=>e.name===n)||"positions"===n||delete t[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(ja.log(1,"Model ".concat(this.id,': Recreating pipeline because "').concat(this._pipelineNeedsUpdate,'".'))(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:"".concat(this.id,"-vertex"),stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let r=null;this.source?r=n:this.fs&&(r=this.shaderFactory.createShader({id:"".concat(this.id,"-fragment"),stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline(u(u({},this.props),{},{bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:r})),this._attributeInfos=Fc(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_logDrawCallStart(){const e=ja.level>3?0:1e4;ja.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,ja.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:ja.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=function(e){var t;const n={},r="Values";if(0===e.attributes.length&&(null===(t=e.varyings)||void 0===t||!t.length))return{"No attributes or varyings":{[r]:"N/A"}};for(const i of e.attributes)if(i){const e="".concat(i.location," ").concat(i.name,": ").concat(i.type);n["in ".concat(e)]={[r]:i.stepMode||"vertex"}}for(const i of e.varyings||[]){const e="".concat(i.location," ").concat(i.name);n["out ".concat(e)]={[r]:JSON.stringify(i)}}return n}(this.pipeline.shaderLayout,this.id);ja.table(2,e)();const t=this.shaderInputs.getDebugTable();for(const[r,i]of Object.entries(this.uniforms))t[r]={value:i};ja.table(2,t)();const n=this._getAttributeDebugTable();ja.table(2,this._attributeInfos)(),ja.table(2,n)(),ja.groupEnd(2)(),this._logOpen=!1}}_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const n=e.props.framebuffer;n&&function(e,t){var n;let{id:r,minimap:i,opaque:s,top:o="0",left:a="0",rgbaScale:l=1}=t;rf||(rf=document.createElement("canvas"),rf.id=r,rf.title=r,rf.style.zIndex="100",rf.style.position="absolute",rf.style.top=o,rf.style.left=a,rf.style.border="blue 5px solid",rf.style.transform="scaleY(-1)",document.body.appendChild(rf),sf=rf.getContext("2d")),rf.width===e.width&&rf.height===e.height||(rf.width=e.width/2,rf.height=e.height/2,rf.style.width="400px",rf.style.height="400px");const u=e.device.readPixelsToArrayWebGL(e),c=null===(n=sf)||void 0===n?void 0:n.createImageData(e.width,e.height);if(c){var A;const e=0;for(let t=0;t<u.length;t+=4)c.data[e+t+0]=u[t+0]*l,c.data[e+t+1]=u[t+1]*l,c.data[e+t+2]=u[t+2]*l,c.data[e+t+3]=s?255:u[t+3]*l;null===(A=sf)||void 0===A||A.putImageData(c,0,0)}}(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,n]of Object.entries(this._attributeInfos)){const r=this.vertexArray.attributes[n.location];e[n.location]={name:t,type:n.shaderType,values:r?this._getBufferOrConstantValues(r,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,n="uint32"===t.indexType?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,t){const n=sA(t);return(e instanceof Ha?new n(e.debugData):e).toString()}}function ff(e){return Boolean(e.uniformTypes&&!pf(e.uniformTypes))}function pf(e){for(const t in e)return!1;return!0}a(df,"defaultProps",u(u({},ic.defaultProps),{},{source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:X.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0}));class gf{static isSupported(e){var t;return"webgl"===(null===e||void 0===e||null===(t=e.info)||void 0===t?void 0:t.type)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gf.defaultProps;if(a(this,"device",void 0),a(this,"model",void 0),a(this,"transformFeedback",void 0),!gf.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new df(this.device,u({id:t.id||"buffer-transform-model",fs:t.fs||EA(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings},t)),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){null!==e&&void 0!==e&&e.inputBuffers&&this.model.setAttributes(e.inputBuffers),null!==e&&void 0!==e&&e.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof Ha)return t.readAsync();const{buffer:n,byteOffset:r=0,byteLength:i=n.byteLength}=t;return n.readAsync(r,i)}}function mf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=Math.fround(e),i=e-r;return t[n]=r,t[n+1]=i,t}function yf(e){return e-Math.fround(e)}function vf(e){const t=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=4*n+r;mf(e[4*r+n],t,2*i)}return t}a(gf,"defaultProps",u(u({},df.defaultProps),{},{outputs:void 0,feedbackBuffers:void 0}));const _f={name:"fp64arithmetic",vs:"\nuniform fp64arithmeticUniforms {\n  uniform float ONE;\n} fp64;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some 'equivalent' form.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * fp64.ONE - (t - a);\n  float a_lo = a * fp64.ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * fp64.ONE;\n  float err = b - (sum - a) * fp64.ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *\n    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",defaultUniforms:{ONE:1},uniformTypes:{ONE:"f32"},fp64ify:mf,fp64LowPart:yf,fp64ifyMatrix4:vf};function bf(e){const{source:t,target:n,start:r=0,size:i,getData:s}=e,o=e.end||n.length,a=t.length,l=o-r;if(a>l)return void n.set(t.subarray(0,l),r);if(n.set(t,r),!s)return;let u=a;for(;u<l;){const e=s(u,t);for(let t=0;t<i;t++)n[r+u]=e[t]||0,u++}}function wf(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(e,'"'))}}function Ef(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function xf(e){e.push(e.shift())}function Df(e){let{device:t,source:n,target:r}=e;var i;(!r||r.byteLength<n.byteLength)&&(null===(i=r)||void 0===i||i.destroy(),r=t.createBuffer({byteLength:n.byteLength,usage:n.usage}));return r}function Cf(e){let{device:t,buffer:n,attribute:r,fromLength:i,toLength:s,fromStartIndices:o,getData:a=e=>e}=e;const l=r.doublePrecision&&r.value instanceof Float64Array?2:1,u=r.size*l,c=r.byteOffset,A=r.settings.bytesPerElement<4?c/r.settings.bytesPerElement*4:c,h=r.startIndices,d=o&&h,f=r.isConstant;if(!d&&n&&i>=s)return n;const p=r.value instanceof Float64Array?Float32Array:r.value.constructor,g=f?r.value:new p(r.getBuffer().readSyncWebGL(c,s*p.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!f){const e=a;a=(t,n)=>r.normalizeConstant(e(t,n))}const m=f?(e,t)=>a(g,t):(e,t)=>a(g.subarray(e+c,e+c+u),t),y=n?new Float32Array(n.readSyncWebGL(A,4*i).buffer):new Float32Array(0),v=new Float32Array(s);var _;(function(e){let{source:t,target:n,size:r,getData:i,sourceStartIndices:s,targetStartIndices:o}=e;if(!s||!o)return bf({source:t,target:n,size:r,getData:i}),n;let a=0,l=0;const u=i&&((e,t)=>i(e+l,t)),c=Math.min(s.length,o.length);for(let A=1;A<c;A++){const e=s[A]*r,i=o[A]*r;bf({source:t.subarray(a,e),target:n,start:l,end:i,size:r,getData:u}),a=e,l=i}l<n.length&&bf({source:[],target:n,start:l,size:r,getData:u})}({source:y,target:v,sourceStartIndices:o,targetStartIndices:h,size:u,getData:m}),!n||n.byteLength<v.byteLength+A)&&(null===(_=n)||void 0===_||_.destroy(),n=t.createBuffer({byteLength:v.byteLength+A,usage:35050}));return n.write(v,A),n}class Sf{constructor(e){let{device:t,attribute:n,timeline:r}=e;this.buffers=[],this.currentLength=0,this.device=t,this.transition=new Is(r),this.attribute=n,this.attributeInTransition=function(e){const{device:t,settings:n,value:r}=e,i=new bA(t,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=function(e,t){const{doublePrecision:n,settings:r,value:i,size:s}=e,o=n&&i instanceof Float64Array?2:1;let a=0;const{shaderAttributes:l}=e.settings;if(l)for(const c of Object.values(l)){var u;a=Math.max(a,null!==(u=c.vertexOffset)&&void 0!==u?u:0)}return(r.noAlloc?i.length:(t+a)*s)*o}(this.attribute,t),this.transition.start(u(u({},e),{},{duration:n}))}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}const Tf={name:"interpolation",vs:"uniform interpolationUniforms {\n  float time;\n} interpolation;\n",uniformTypes:{time:"f32"}},If="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, interpolation.time);\n  gl_Position = vec4(0.0);\n}\n",Ff="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aFrom64Low;\nin ATTRIBUTE_TYPE aTo;\nin ATTRIBUTE_TYPE aTo64Low;\nout ATTRIBUTE_TYPE vCurrent;\nout ATTRIBUTE_TYPE vCurrent64Low;\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid main(void) {\n  for (int i=0; i<ATTRIBUTE_SIZE; i++) {\n    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);\n    vCurrent[i] = value.x;\n    vCurrent64Low[i] = value.y;\n  }\n  gl_Position = vec4(0.0);\n}\n";function Rf(e){return e.doublePrecision&&e.value instanceof Float64Array}const kf={name:"spring",vs:"uniform springUniforms {\n  float damping;\n  float stiffness;\n} spring;\n",uniformTypes:{damping:"f32",stiffness:"f32"}},Pf="#version 300 es\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nin ATTRIBUTE_TYPE aPrev;\nin ATTRIBUTE_TYPE aCur;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vNext;\nout float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE force = delta * spring.stiffness;\n  ATTRIBUTE_TYPE resistance = velocity * spring.damping;\n  return force - resistance + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",Mf="#version 300 es\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nin float vIsTransitioningFlag;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  fragColor = vec4(1.0);\n}";const Bf={interpolation:class extends Sf{constructor(e){let{device:t,attribute:n,timeline:r}=e;super({device:t,attribute:n,timeline:r}),this.type="interpolation",this.transform=function(e,t){const n=t.size,r=wf(n),i=Ef(n),s=t.getBufferLayout();if(Rf(t))return new gf(e,{vs:Ff,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*n}]}],modules:[_f,Tf],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0});return new gf(e,{vs:If,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:s.attributes[0].format}],modules:[Tf],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}(t,n)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0)return void this.transition.cancel();const{buffers:i,attribute:s}=this;xf(i),i[0]=Cf({device:this.device,buffer:i[0],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter}),i[1]=Df({device:this.device,source:i[0],target:i[1]}),this.setBuffer(i[1]);const{transform:o}=this,a=o.model;let l=Math.floor(this.currentLength/s.size);Rf(s)&&(l/=2),a.setVertexCount(l),s.isConstant?(a.setAttributes({aFrom:i[0]}),a.setConstantAttributes({aTo:s.value})):a.setAttributes({aFrom:i[0],aTo:s.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:i[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:n}=this.transition;let r=n/e;t&&(r=t(r));const{model:i}=this.transform,s={time:r};i.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},spring:class extends Sf{constructor(e){let{device:t,attribute:n,timeline:r}=e;super({device:t,attribute:n,timeline:r}),this.type="spring",this.texture=function(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}(t),this.framebuffer=function(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}(t,this.texture),this.transform=function(e,t){const n=wf(t.size),r=Ef(t.size);return new gf(e,{vs:Pf,fs:Mf,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[kf],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}(t,n)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;super.start(e,t);const{buffers:i,attribute:s}=this;for(let a=0;a<2;a++)i[a]=Cf({device:this.device,buffer:i[a],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter});i[2]=Df({device:this.device,source:i[0],target:i[2]}),this.setBuffer(i[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?o.setConstantAttributes({aTo:s.value}):o.setAttributes({aTo:s.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:n,transition:r}=this,i=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]});const s={stiffness:i.stiffness,damping:i.damping};t.model.shaderInputs.setProps({spring:s}),t.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),xf(e),this.setBuffer(e[1]);this.device.readPixelsToArrayWebGL(n)[0]>0||r.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}};class Lf{constructor(e,t){let{id:n,timeline:r}=t;if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=n,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update(e){let{attributes:t,transitions:n,numInstances:r}=e;this.numInstances=r||1;for(const i in t){const e=t[i],r=e.getTransitionSetting(n);r&&this._updateAttribute(i,e,r)}for(const i in this.transitions){const e=t[i];e&&e.getTransitionSetting(n)||this._removeTransition(i)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,n){const r=this.transitions[e];let i=!r||r.type!==n.type;if(i){r&&this._removeTransition(e);const s=Bf[n.type];s?this.transitions[e]=new s({attribute:t,timeline:this.timeline,device:this.device}):(Me.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const Of="attributeManager.invalidate";class Nf{constructor(e){let{id:t="attribute-manager",stats:n,timeline:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.mergeBoundsMemoized=vo(hr),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new Lf(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const n=this._invalidateTrigger(e,t);Oe(Of,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Oe(Of,this,"all")}update(e){let{data:t,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}=e,l=!1;Oe("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const u in this.attributes){const e=this.attributes[u],i=e.settings.accessor;e.startIndices=r,e.numInstances=n,s[u]&&Me.removed("props.".concat(u),"data.attributes.".concat(u))(),e.setExternalBuffer(o[u])||e.setBinaryValue("string"===typeof i?o[i]:void 0,t.startIndices)||"string"===typeof i&&!o[i]&&e.setConstantValue(s[i])||e.needsUpdate()&&(l=!0,this._updateAttribute({attribute:e,numInstances:n,data:t,props:s,context:a})),this.needsRedraw=this.needsRedraw||e.needsRedraw()}l&&Oe("attributeManager.updateEnd",this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return u(u({},this.attributes),this.attributeTransitionManager.getAttributes())}getBounds(e){const t=e.map(e=>{var t;return null===(t=this.attributes[e])||void 0===t?void 0:t.getBounds()});return this.mergeBoundsMemoized(t)}getChangedAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1};const{attributes:t,attributeTransitionManager:n}=this,r=u({},n.getAttributes());for(const i in t){const s=t[i];s.needsRedraw(e)&&!n.hasAttribute(i)&&(r[i]=s)}return r}getBufferLayouts(e){return Object.values(this.getAttributes()).map(t=>t.getBufferLayout(e))}_add(e,t){for(const n in e){const r=e[n],i=u(u({},r),{},{id:n,size:(r.isIndexed?1:r.size)||1},t);this.attributes[n]=new bA(this.device,i)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes){this.attributes[t].getUpdateTriggers().forEach(n=>{e[n]||(e[n]=[]),e[n].push(t)})}this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:r}=this,i=r[e];return i&&i.forEach(e=>{const r=n[e];r&&r.setNeedsUpdate(r.id,t)}),i}_updateAttribute(e){const{attribute:t,numInstances:n}=e;if(Oe("attribute.updateStart",t),t.constant)return void t.setConstantValue(t.value);t.allocate(n)&&Oe("attribute.allocate",t,n);t.updateBuffer(e)&&(this.needsRedraw=!0,Oe("attribute.updateEnd",t,n))}}const Uf=1e-5;function zf(e,t,n,r,i){const s=t-e;return(n-t)*i+-s*r+s+t}function jf(e,t){if(Array.isArray(e)){let n=0;for(let r=0;r<e.length;r++){const i=e[r]-t[r];n+=i*i}return Math.sqrt(n)}return Math.abs(e-t)}const Vf={interpolation:class extends Is{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:r,easing:i}}=this,s=i(e/r);this._value=Ln(t,n,s)}},spring:class extends Is{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:r}=this.settings,{_prevValue:i=e,_currValue:s=e}=this;let o=function(e,t,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=zf(e[o],t[o],n[o],r,i);return s}return zf(e,t,n,r,i)}(i,s,t,n,r);const a=jf(o,t),l=jf(o,s);a<Uf&&l<Uf&&(o=t,this.end()),this._prevValue=s,this._currValue=o}}};class Gf{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,r){const{transitions:i}=this;if(i.has(e)){const n=i.get(e),{value:r=n.settings.fromValue}=n;t=r,this.remove(e)}if(!(r=_A(r)))return;const s=Vf[r.type];if(!s)return void Me.error("unsupported transition type '".concat(r.type,"'"))();const o=new s(this.timeline);o.start(u(u({},r),{},{fromValue:t,toValue:n})),i.set(e,o)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Wf(e,t){const n=Qf({newProps:e,oldProps:t,propTypes:e[ue],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(e,t){if(null===t)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=e;r?r(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied");n&&i&&(n=i(e.data,t.data)||n);return n}(e,t);let i=!1;return r||(i=function(e,t){if(null===t)return{all:!0};if("all"in e.updateTriggers){if(qf(e,t,"all"))return{all:!0}}const n={};let r=!1;for(const i in e.updateTriggers)if("all"!==i){qf(e,t,i)&&(n[i]=!0,r=!0)}return!!r&&n}(e,t)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Yf(e,t),transitionsChanged:Hf(e,t)}}function Hf(e,t){if(!e.transitions)return!1;const n={},r=e[ue];let i=!1;for(const s in e.transitions){const o=r[s],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&Xf(e[s],t[s],o)&&(n[s]=!0,i=!0)}return!!i&&n}function Qf(e){let{newProps:t,oldProps:n,ignoreProps:r={},propTypes:i={},triggerName:s="props"}=e;if(n===t)return!1;if("object"!==typeof t||null===t)return"".concat(s," changed shallowly");if("object"!==typeof n||null===n)return"".concat(s," changed shallowly");for(const o of Object.keys(t))if(!(o in r)){if(!(o in n))return"".concat(s,".").concat(o," added");const e=Xf(t[o],n[o],i[o]);if(e)return"".concat(s,".").concat(o," ").concat(e)}for(const o of Object.keys(n))if(!(o in r)){if(!(o in t))return"".concat(s,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const e=Xf(t[o],n[o],i[o]);if(e)return"".concat(s,".").concat(o," ").concat(e)}}return!1}function Xf(e,t,n){let r=n&&n.equal;return r&&!r(e,t,n)?"changed deeply":r||(r=e&&t&&e.equals,!r||r.call(e,t))?r||t===e?null:"changed shallowly":"changed deeply"}function Yf(e,t){if(null===t)return!0;const n=t.extensions,{extensions:r}=e;if(r===n)return!1;if(!n||!r)return!0;if(r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function qf(e,t,n){let r=e.updateTriggers[n];r=void 0===r||null===r?{}:r;let i=t.updateTriggers[n];i=void 0===i||null===i?{}:i;return Qf({oldProps:i,newProps:r,triggerName:n})}function Kf(e){if(!function(e){return null!==e&&"object"===typeof e}(e))throw new Error("count(): argument not an object");if("function"===typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"===typeof e&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error("count(): argument not a container")}function Zf(e,t){if(!t)return e;const n=u(u({},e),t);if("defines"in t&&(n.defines=u(u({},e.defines),t.defines)),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some(e=>"project64"===e.name))){const e=n.modules.findIndex(e=>"project32"===e.name);e>=0&&n.modules.splice(e,1)}if("inject"in t)if(e.inject){const r=u({},e.inject);for(const e in t.inject)r[e]=(r[e]||"")+t.inject[e];n.inject=r}else n.inject=t.inject;return n}const Jf=[0,0,0];function $f(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=t.projectPosition(e);if(n&&t instanceof Ts){const[n,i,s=0]=e,o=t.getDistanceScales([n,i]);r[2]=s*o.unitsPerMeter[2]}return r}function ep(e,t){let{viewport:n,modelMatrix:r,coordinateSystem:i,coordinateOrigin:s,offsetMode:o}=t,[a,l,u=0]=e;switch(r&&([a,l,u]=Tr([],[a,l,u,1],r)),i){case us.LNGLAT:return $f([a,l,u],n,o);case us.LNGLAT_OFFSETS:return $f([a+s[0],l+s[1],u+(s[2]||0)],n,o);case us.METER_OFFSETS:return $f(ri(s,[a,l,u]),n,o);case us.CARTESIAN:default:return n.isGeospatial?[a+s[0],l+s[1],u+s[2]]:n.projectPosition([a,l,u])}}function tp(e,t){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(e){const{viewport:t,modelMatrix:n,coordinateOrigin:r}=e;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=e;return i===us.DEFAULT&&(i=t.isGeospatial?us.LNGLAT:us.CARTESIAN),void 0===s&&(s=i),void 0===o&&(o=r),{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}(t),{autoOffset:l=!0}=t,{geospatialOrigin:u=Jf,shaderCoordinateOrigin:c=Jf,offsetMode:A=!1}=l?Co(n,r,i):{},h=ep(e,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:A});if(A){const e=n.projectPosition(u||c);$n(h,h,e)}return h}const np={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},rp={};const ip={boolean:{validate:(e,t)=>!0,equal:(e,t,n)=>Boolean(e)===Boolean(t)},number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},color:{validate:(e,t)=>t.optional&&!e||ap(e)&&(3===e.length||4===e.length),equal:(e,t,n)=>bs(e,t,1)},accessor:{validate(e,t){const n=lp(e);return"function"===n||n===lp(t.value)},equal:(e,t,n)=>"function"===typeof t||bs(e,t,1)},array:{validate:(e,t)=>t.optional&&!e||ap(e),equal(e,t,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?bs(e,t,i):e===t}},object:{equal(e,t,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?bs(e,t,i):e===t}},function:{validate:(e,t)=>t.optional&&!e||"function"===typeof e,equal:(e,t,n)=>!n.compare&&!1!==n.ignore||e===t},data:{transform:(e,t,n)=>{if(!e)return e;const{dataTransform:r}=n.props;return r?r(e):"string"===typeof e.shape&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,n)=>{const r=n.context;return r&&r.device?function(e,t,n,r){if(n instanceof au)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let i=null;n.compressed&&(i={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const s=t.createTexture(u(u({},n),{},{sampler:u(u(u({},np),i),r),mipmaps:!0}));return rp[s.id]=e,s}(n.id,r.device,e,u(u({},t.parameters),n.props.textureParameters)):null},release:(e,t,n)=>{var r,i;r=n.id,(i=e)&&i instanceof au&&rp[i.id]===r&&(i.delete(),delete rp[i.id])}}};function sp(e,t){switch(lp(t)){case"object":return op(e,t);case"array":return op(e,{type:"array",value:t,compare:!1});case"boolean":return op(e,{type:"boolean",value:t});case"number":return op(e,{type:"number",value:t});case"function":return op(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function op(e,t){return"type"in t?u(u({name:e},ip[t.type]),t):"value"in t?u({name:e,type:lp(t.value)},t):{name:e,type:"object",value:t}}function ap(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function lp(e){return ap(e)?"array":null===e?"null":typeof e}const up="_mergedDefaultProps";function cp(e,t){if(!(e instanceof gp.constructor))return{};let n=up;if(t)for(const i of t){const e=i.constructor;e&&(n+=":".concat(e.extensionName||e.name))}const r=dp(e,n);return r||(e[n]=function(e,t){const n=e.prototype;if(!n)return null;const r=Object.getPrototypeOf(e),i=cp(r),s=dp(e,"defaultProps")||{},o=function(e){const t={},n={},r={};for(const[i,s]of Object.entries(e)){const e=null===s||void 0===s?void 0:s.deprecatedFor;if(e)r[i]=Array.isArray(e)?e:[e];else{const e=sp(i,s);t[i]=e,n[i]=e.value}}return{propTypes:t,defaultProps:n,deprecatedProps:r}}(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),null===i||void 0===i?void 0:i[ue],o.propTypes),u=Object.assign(Object.create(null),null===i||void 0===i?void 0:i[ce],o.deprecatedProps);for(const c of t){const e=cp(c.constructor);e&&(Object.assign(a,e),Object.assign(l,e[ue]),Object.assign(u,e[ce]))}(function(e,t){const n=function(e){const t=e.componentName;t||Me.warn("".concat(e.name,".componentName not specified"))();return t||e.name}(t);Object.defineProperties(e,{id:{writable:!0,value:n}})})(a,e),function(e,t){const n={},r={};for(const i in t){const e=t[i],{name:s,value:o}=e;e.async&&(n[s]=o,r[s]=Ap(s))}e[Ae]=n,e[he]={},Object.defineProperties(e,r)}(a,l),function(e,t){for(const n in t)Object.defineProperty(e,n,{enumerable:!1,set(e){const r="".concat(this.id,": ").concat(n);for(const i of t[n])hp(this,i)||(this[i]=e);Me.deprecated(r,t[n].join("/"))()}})}(a,u),a[ue]=l,a[ce]=u,0!==t.length||hp(e,"_propTypes")||(e._propTypes=l);return a}(e,t||[]))}function Ap(e){return{enumerable:!0,set(t){"string"===typeof t||t instanceof Promise||pA(t)?this[he][e]=t:this[de][e]=t},get(){if(this[de]){if(e in this[de]){return this[de][e]||this[Ae][e]}if(e in this[he]){const t=this[le]&&this[le].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[Ae][e]}}return this[Ae][e]}}}function hp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function dp(e,t){return hp(e,t)&&e[t]}let fp=0;class pp{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.props=function(e,t){let n;for(let s=t.length-1;s>=0;s--){const e=t[s];"extensions"in e&&(n=e.extensions)}const r=cp(e.constructor,n),i=Object.create(r);i[le]=e,i[he]={},i[de]={};for(let s=0;s<t.length;++s){const e=t[s];for(const t in e)i[t]=e[t]}return Object.freeze(i),i}(this,t),this.id=this.props.id,this.count=fp++}clone(e){const{props:t}=this,n={};for(const r in t[Ae])r in t[de]?n[r]=t[de][r]:r in t[he]&&(n[r]=t[he][r]);return new this.constructor(u(u(u({},t),n),e))}}pp.componentName="Component",pp.defaultProps={};const gp=pp,mp=Object.freeze({});class yp{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||mp}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[le]||this.component;const t=e[de]||{},n=e[he]||e,r=e[Ae]||{};for(const i in t){const e=t[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,e),t[i]=this.getAsyncProp(i)}for(const i in n){const e=n[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,e)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){this._didAsyncInputValueChange(e,t)&&("string"===typeof t&&(t=this._fetch(e,t)),t instanceof Promise?this._watchPromise(e,t):pA(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t!==n.resolvedValue&&t!==n.lastValue&&(n.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,t,n){const r=this.asyncProps[e];r&&n>=r.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const r=n.pendingLoadCount;t.then(t=>{this.component&&(t=this._postProcessValue(n,t),this._setAsyncPropValue(e,t,r),this._onResolve(e,t))}).catch(t=>{this._onError(e,t)})}}async _resolveAsyncIterable(e,t){if("data"!==e)return void this._setPropValue(e,t);const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const r=n.pendingLoadCount;let i=[],s=0;var o,a=!1,l=!1;try{for(var u,c=qt(t);a=!(u=await c.next()).done;a=!1){const t=u.value;{if(!this.component)return;const{dataTransform:n}=this.component.props;i=n?n(t,i):i.concat(t),Object.defineProperty(i,"__diff",{enumerable:!1,value:[{startRow:s,endRow:i.length}]}),s=i.length,this._setAsyncPropValue(e,i,r)}}}catch(A){l=!0,o=A}finally{try{a&&null!=c.return&&await c.return()}finally{if(l)throw o}}this._onResolve(e,i)}_postProcessValue(e,t){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const n=this.component&&this.component.props[ue];this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class vp extends yp{constructor(e){let{attributeManager:t,layer:n}=e;super(n),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const n=this.layer,r=null===n||void 0===n?void 0:n.props.fetch;return r?r(t,{propName:e,layer:n}):super._fetch(e,t)}_onResolve(e,t){const n=this.layer;if(n){const r=n.props.onDataLoad;"data"===e&&r&&r(t,{propName:e,layer:n})}}_onError(e,t){const n=this.layer;n&&n.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}const _p=2**24-1,bp=Object.freeze([]),wp=vo(e=>{let{oldViewport:t,viewport:n}=e;return t.equals(n)});let Ep=new Uint8ClampedArray(0);const xp={data:{type:"data",value:bp,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,t)=>{let{propName:n,layer:r,loaders:i,loadOptions:s,signal:o}=t;const{resourceManager:a}=r.context;var l;(s=s||r.getLoadOptions(),i=i||r.props.loaders,o)&&(s=u(u({},s),{},{fetch:u(u({},null===(l=s)||void 0===l?void 0:l.fetch),{},{signal:o})}));let c=a.contains(e);return c||s||(a.add({resourceId:e,data:Tn(e,i),persistent:!1}),c=!0),c?a.subscribe({resourceId:e,onChange:e=>{var t;return null===(t=r.internalState)||void 0===t?void 0:t.reloadAsyncProp(n,e)},consumerId:r.id,requestId:n}):Tn(e,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:us.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:e=>{let{layerIndex:t}=e;return[0,100*-t]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Dp extends gp{constructor(){super(...arguments),this.internalState=null,this.lifecycle=ne,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ls(this.internalState);const t=this.internalState.viewport||this.context.viewport,n=ep(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,s]=ai(n,t.pixelProjectionMatrix);return 2===e.length?[r,i]:[r,i,s]}unproject(e){Ls(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){Ls(this.internalState);return tp(e,u({viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem},t))}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(){for(const e of this.getModels())e.shaderInputs.setProps(...arguments)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===us.DEFAULT||e===us.LNGLAT||e===us.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Ls(e instanceof Uint8Array);const[t,n,r]=e;return t+256*n+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:Kf(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){e=Zf(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=Zf(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&t)if(Array.isArray(n))for(const r of n)t.invalidateAll(r);else t.invalidateAll();if(t){const{props:n}=e,r=this.internalState.hasPickingBuffer,i=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some(e=>e.getNeedsPickingBuffer.call(this,e));if(r!==i){this.internalState.hasPickingBuffer=i;const{pickingColors:e,instancePickingColors:n}=t.attributes,r=e||n;r&&(i&&r.constant&&(r.constant=!1,t.invalidate(r.id)),r.value||i||(r.constant=!0,r.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e.renderPass)}getPickingInfo(e){let{info:t,mode:n,sourceLayer:r}=e;const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(e,t){var n,r,i,s;(t&&(e=new Error("".concat(t,": ").concat(e.message),{cause:e})),null!==(n=(r=this.props).onError)&&void 0!==n&&n.call(r,e))||(null===(i=this.context)||void 0===i||null===(s=i.onError)||void 0===s||s.call(i,e,this))}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var e;return(null===(e=this.internalState)||void 0===e?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,t&&wp({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const n in e)e[n].layoutChanged()&&(t=!0);for(const n of this.getModels())this._setModelAttributes(n,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,n=this.getNumInstances(),r=this.getStartIndices();e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const e in t)Object.defineProperty(n,e,{value:t[e]});return n}return this.props}calculateInstancePickingColors(e,t){let{numInstances:n}=t;if(e.constant)return;const r=Math.floor(Ep.length/4);if(this.internalState.usesPickingColorCache=!0,r<n){n>_p&&Me.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ep=Rn.allocate(Ep,n,{size:4,copy:!0,maxCount:Math.max(n,_p)});const e=Math.floor(Ep.length/4),t=[0,0,0];for(let n=r;n<e;n++)this.encodePickingColor(n,t),Ep[4*n+0]=t[0],Ep[4*n+1]=t[1],Ep[4*n+2]=t[2],Ep[4*n+3]=0}e.value=Ep.subarray(0,4*n)}_setModelAttributes(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!Object.keys(t).length)return;if(r){const n=this.getAttributeManager();e.setBufferLayout(n.getBufferLayouts(e)),t=n.getAttributes()}const i=(null===(n=e.userData)||void 0===n?void 0:n.excludeAttributes)||{},s={},o={};for(const a in t){if(i[a])continue;const n=t[a].getValue();for(const r in n){const i=n[r];i instanceof Ha?t[a].settings.isIndexed?e.setIndexBuffer(i):s[r]=i:i&&(o[r]=i)}}e.setAttributes(s),e.setConstantAttributes(o)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t))return void this._disablePickingIndex(e);const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r,s=i&&t.attributes&&t.attributes[i.id];if(s&&s.value){const n=s.value,r=this.encodePickingColor(e);for(let e=0;e<t.length;e++){const t=i.getVertexOffset(e);n[t]===r[0]&&n[t+1]===r[1]&&n[t+2]===r[2]&&this._disablePickingIndex(e)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,r=t||n;if(!r)return;const i=r.getVertexOffset(e),s=r.getVertexOffset(e+1);r.buffer.write(new Uint8Array(s-i),i)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Ep.buffer&&(n.value=Ep.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Ls(!this.internalState),Ls(Number.isFinite(this.props.coordinateSystem)),Oe("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new vp({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Me.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Gf(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Oe("layer.matched",this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Oe("layer.update",this,e),!e)return;const t=this.props,n=this.context,r=this.internalState,i=n.viewport,s=this._updateUniformTransition();r.propsInTransition=s,n.viewport=r.viewport||i,this.props=s;try{const e=this._getUpdateParams(),t=this.getModels();if(n.device)this.updateState(e);else try{this.updateState(e)}catch(o){}for(const n of this.props.extensions)n.updateState.call(this,e,n);this.setNeedsRedraw(),this._updateAttributes();const r=this.getModels()[0]!==t[0];this._postUpdate(e,r)}finally{n.viewport=i,this.props=t,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){Oe("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer(e){let{renderPass:t,shaderModuleProps:n=null,uniforms:r={},parameters:i={}}=e;this._updateAttributeTransition();const s=this.props,o=this.context;this.props=this.internalState.propsInTransition||s;try{n&&this.setShaderModuleProps(n);const{getPolygonOffset:e}=this.props,s=e&&e(r)||[0,0];o.device instanceof Vc&&o.device.setParametersWebGL({polygonOffset:s});for(const t of this.getModels())"webgpu"===t.device.type?t.setParameters(u(u({},t.parameters),i)):t.setParameters(i);if(o.device instanceof Vc)o.device.withParametersWebGL(i,()=>{const e={renderPass:t,shaderModuleProps:n,uniforms:r,parameters:i,context:o};for(const t of this.props.extensions)t.draw.call(this,e,t);this.draw(e)});else{const e={renderPass:t,shaderModuleProps:n,uniforms:r,parameters:i,context:o};for(const t of this.props.extensions)t.draw.call(this,e,t);this.draw(e)}}finally{this.props=s}}getChangeFlags(){var e;return null===(e=this.internalState)||void 0===e?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const r in e)if(e[r]){let n=!1;if("dataChanged"===r){const i=e[r],s=t[r];i&&Array.isArray(s)&&(t.dataChanged=Array.isArray(i)?s.concat(i):i,n=!0)}t[r]||(t[r]=e[r],n=!0),n&&Oe("layer.changeFlag",this,r,e)}const n=Boolean(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=n,t.somethingChanged=n||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const n=Wf(e,t);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged){var r;this.internalState.uniformTransitions.add(i,t[i],e[i],null===(r=e.transitions)||void 0===r?void 0:r[i])}return this.setChangeFlags(n)}validateProps(){!function(e){const t=e[ue];for(const n in t){const r=t[n],{validate:i}=r;if(i&&!i(e[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(e[n]))}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&"function"===typeof n&&(t.highlightColor=n(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Nf(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:n,oldProps:r}=e,i=this.state.model;null!==i&&void 0!==i&&i.isInstanced&&i.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=n;if(t||r.autoHighlight!==s||r.highlightedObjectIndex!==o||r.highlightColor!==a){const e={};Array.isArray(a)&&(e.highlightColor=a),(t||r.autoHighlight!==s||o!==r.highlightedObjectIndex)&&(e.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:e})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),r=!!n&&n.getNeedsRedraw(e);if(t=t||r,t)for(const i of this.props.extensions)i.onNeedsRedraw.call(this,i);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}Dp.defaultProps=xp,Dp.layerName="Layer";const Cp=Dp,Sp={position:"absolute",zIndex:-1};function Tp(e,t){if("function"===typeof e)return e(t);if(Array.isArray(e))return e.map(e=>Tp(e,t));if(Ip(e)){if(function(e){var t;return null===(t=e.props)||void 0===t?void 0:t.mapStyle}(e))return t.style=Sp,(0,r.cloneElement)(e,t);if(function(e){const t=e.type;return t&&t.deckGLViewProps}(e))return(0,r.cloneElement)(e,t)}return e}function Ip(e){return e&&"object"===typeof e&&"type"in e||!1}function Fp(e){if("function"===typeof e)return(0,r.createElement)(Cs,{},e);if(Array.isArray(e))return e.map(Fp);if(Ip(e)){if(e.type===r.Fragment)return Fp(e.props.children);if(rA(e.type,Cs))return e}return e}const Rp=(0,r.createContext)();const kp={mixBlendMode:null};function Pp(e){e.redrawReason&&(e.deck._drawLayers(e.redrawReason),e.redrawReason=null)}const Mp=r.forwardRef(function(e,t){const[n,i]=(0,r.useState)(0),s=(0,r.useRef)({control:null,version:n,forceUpdate:()=>i(e=>e+1)}),o=s.current,a=(0,r.useRef)(null),l=(0,r.useRef)(null),c=(0,r.useMemo)(()=>function(e){let{children:t,layers:n=[],views:i=null}=e;const s=[],o=[],a={};return r.Children.forEach(Fp(t),e=>{if(Ip(e)){const t=e.type;if(rA(t,Cp)){const n=function(e,t){const n={},r=e.defaultProps||{};for(const i in t)r[i]!==t[i]&&(n[i]=t[i]);return new e(n)}(t,e.props);o.push(n)}else s.push(e);if(rA(t,Cs)&&t!==Cs&&e.props.id){const n=new t(e.props);a[n.id]=n}}else e&&s.push(e)}),Object.keys(a).length>0&&(Array.isArray(i)?i.forEach(e=>{a[e.id]=e}):i&&(a[i.id]=i),i=Object.values(a)),n=o.length>0?[...o,...n]:n,{layers:n,children:s,views:i}}(e),[e.layers,e.views,e.children]);let A=!0;const h=t=>{var n;return A&&e.viewState?(o.viewStateUpdateRequested=t,null):(o.viewStateUpdateRequested=null,null===(n=e.onViewStateChange)||void 0===n?void 0:n.call(e,t))},d=t=>{var n;A?o.interactionStateUpdateRequested=t:(o.interactionStateUpdateRequested=null,null===(n=e.onInteractionStateChange)||void 0===n||n.call(e,t))},f=(0,r.useMemo)(()=>{const t=u(u({widgets:[]},e),{},{style:null,width:"100%",height:"100%",parent:a.current,canvas:l.current,layers:c.layers,views:c.views,onViewStateChange:h,onInteractionStateChange:d});return delete t._customRender,o.deck&&o.deck.setProps(t),t},[e]);(0,r.useEffect)(()=>{const t=e.Deck||tA;return o.deck=function(e,t,n){var r;const i=new t(u(u({},n),{},{_customRender:"webgpu"===(null===(r=n.deviceProps)||void 0===r||null===(r=r.adapters)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.type)?void 0:t=>{e.redrawReason=t;const n=i.getViewports();e.lastRenderedViewports!==n?e.forceUpdate():Pp(e)}}));return i}(o,t,u(u({},f),{},{parent:a.current,canvas:l.current})),()=>{var e;return null===(e=o.deck)||void 0===e?void 0:e.finalize()}},[]),nA(()=>{Pp(o);const{viewStateUpdateRequested:e,interactionStateUpdateRequested:t}=o;e&&h(e),t&&d(t)}),(0,r.useImperativeHandle)(t,()=>function(e){return{get deck(){return e.deck},pickObject:t=>e.deck.pickObject(t),pickMultipleObjects:t=>e.deck.pickMultipleObjects(t),pickObjects:t=>e.deck.pickObjects(t)}}(o),[]);const p=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:g,width:m="100%",height:y="100%",id:v,style:_}=e,{containerStyle:b,canvasStyle:w}=(0,r.useMemo)(()=>function(e){let{width:t,height:n,style:r}=e;const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:n},s={left:0,top:0};if(r)for(const o in r)o in kp?s[o]=r[o]:i[o]=r[o];return{containerStyle:i,canvasStyle:s}}({width:m,height:y,style:_}),[m,y,_]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===p||o.version!==n){o.lastRenderedViewports=p,o.version=n;const e=function(e){let{children:t,deck:n,ContextProvider:i=Rp.Provider}=e;const{viewManager:s}=n||{};if(!s||!s.views.length)return[];const o={},a=s.views[0].id;for(const r of t){let e=a,t=r;Ip(r)&&rA(r.type,Cs)&&(e=r.props.id||a,t=r.props.children);const n=s.getViewport(e),i=s.getViewState(e);if(n){i.padding=n.padding;const{x:r,y:s,width:a,height:l}=n;t=Tp(t,{x:r,y:s,width:a,height:l,viewport:n,viewState:i}),o[e]||(o[e]={viewport:n,children:[]}),o[e].children.push(t)}}return Object.keys(o).map(e=>{const{viewport:t,children:s}=o[e],{x:a,y:l,width:u,height:c}=t,A={position:"absolute",left:a,top:l,width:u,height:c},h="view-".concat(e),d=(0,r.createElement)("div",{key:h,id:h,style:A},...s),f={deck:n,viewport:t,container:n.canvas.offsetParent,eventManager:n.eventManager,onViewStateChange:t=>{t.viewId=e,n._onViewStateChange(t)},widgets:[]},p="view-".concat(e,"-context");return(0,r.createElement)(i,{key:p,value:f},d)})}({children:c.children,deck:o.deck,ContextProvider:g}),t=(0,r.createElement)("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:l,style:w});o.control=(0,r.createElement)("div",{id:"".concat(v||"deckgl","-wrapper"),ref:a,style:b},[t,e])}return A=!1,o.control}),Bp=Mp;function Lp(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{l(r.next(e))}catch(kA){s(kA)}}function a(e){try{l(r.throw(e))}catch(kA){s(kA)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,a)}l((r=r.apply(e,t||[])).next())})}Object.create;function Op(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Np(e){return this instanceof Np?(this.v=e,this):new Np(e)}function Up(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r=Object.create(("function"===typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),r[Symbol.asyncIterator]=function(){return this},r;function o(e,t){i[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||a(e,t)})},t&&(r[e]=t(r[e])))}function a(e,t){try{!function(e){e.value instanceof Np?Promise.resolve(e.value.v).then(l,u):c(s[0][2],e)}(i[e](t))}catch(kA){c(s[0][3],kA)}}function l(e){a("next",e)}function u(e){a("throw",e)}function c(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function zp(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:Np(e[r](t)),done:!1}:i?i(t):t}:i}}function jp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Op(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}}Object.create;"function"===typeof SuppressedError&&SuppressedError;var Vp,Gp;!function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth",e[e.DurationSecond=-27]="DurationSecond",e[e.DurationMillisecond=-28]="DurationMillisecond",e[e.DurationMicrosecond=-29]="DurationMicrosecond",e[e.DurationNanosecond=-30]="DurationNanosecond"}(Vp||(Vp={})),function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"}(Gp||(Gp={}));function Wp(e){if(null===e)return"null";if(undefined===e)return"undefined";switch(typeof e){case"number":case"bigint":return"".concat(e);case"string":return'"'.concat(e,'"')}return"function"===typeof e[Symbol.toPrimitive]?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof BigInt64Array||e instanceof BigUint64Array?"[".concat([...e].map(e=>Wp(e)),"]"):"[".concat(e,"]"):ArrayBuffer.isView(e)?"[".concat(e,"]"):JSON.stringify(e,(e,t)=>"bigint"===typeof t?"".concat(t):t)}const Hp=new TextDecoder("utf-8"),Qp=e=>Hp.decode(e),Xp=new TextEncoder,Yp=e=>Xp.encode(e),qp=e=>"number"===typeof e,Kp=e=>"boolean"===typeof e,Zp=e=>"function"===typeof e,Jp=e=>null!=e&&Object(e)===e,$p=e=>Jp(e)&&Zp(e.then),eg=e=>Jp(e)&&Zp(e[Symbol.iterator]),tg=e=>Jp(e)&&Zp(e[Symbol.asyncIterator]),ng=e=>Jp(e)&&Jp(e.schema),rg=e=>Jp(e)&&"done"in e&&"value"in e,ig=e=>Jp(e)&&Zp(e.stat)&&qp(e.fd),sg=e=>Jp(e)&&ag(e.body),og=e=>"_getDOMStream"in e&&"_getNodeStream"in e,ag=e=>Jp(e)&&Zp(e.cancel)&&Zp(e.getReader)&&!og(e),lg=e=>Jp(e)&&Zp(e.read)&&Zp(e.pipe)&&Kp(e.readable)&&!og(e),ug="undefined"!==typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function cg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.byteLength;const i=e.byteLength,s=new Uint8Array(e.buffer,e.byteOffset,i),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(r,i));return s.set(o,n),e}function Ag(e,t){const n=function(e){const t=e[0]?[e[0]]:[];let n,r,i,s;for(let o,a,l=0,u=0,c=e.length;++l<c;)o=t[u],a=e[l],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset?a&&(t[++u]=a):(({byteOffset:n,byteLength:i}=o),({byteOffset:r,byteLength:s}=a),n+i<r||r+s<n?a&&(t[++u]=a):t[u]=new Uint8Array(o.buffer,n,r-n+s));return t}(e),r=n.reduce((e,t)=>e+t.byteLength,0);let i,s,o,a=0,l=-1;const u=Math.min(t||Number.POSITIVE_INFINITY,r);for(const c=n.length;++l<c;){if(i=n[l],s=i.subarray(0,Math.min(i.length,u-a)),u<=a+s.length){s.length<i.length?n[l]=i.subarray(s.length):s.length===i.length&&l++,o?cg(o,s,a):o=s;break}cg(o||(o=new Uint8Array(u)),s,a),a+=s.length}return[o||new Uint8Array(0),n.slice(l),r-(o?o.byteLength:0)]}function hg(e,t){let n=rg(t)?t.value:t;return n instanceof e?e===Uint8Array?new e(n.buffer,n.byteOffset,n.byteLength):n:n?("string"===typeof n&&(n=Yp(n)),n instanceof ArrayBuffer||n instanceof ug?new e(n):(e=>Jp(e)&&Zp(e.clear)&&Zp(e.bytes)&&Zp(e.position)&&Zp(e.setPosition)&&Zp(e.capacity)&&Zp(e.getBufferIdentifier)&&Zp(e.createLong))(n)?hg(e,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new e(0):new e(n.buffer,n.byteOffset,n.byteLength/e.BYTES_PER_ELEMENT):e.from(n)):new e(0)}const dg=e=>hg(Int32Array,e),fg=e=>hg(BigInt64Array,e),pg=e=>hg(Uint8Array,e),gg=e=>(e.next(),e);function*mg(e,t){const n=function*(e){yield e},r="string"===typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof ug?n(t):eg(t)?t:n(t);return yield*gg(function*(t){let n=null;do{n=t.next(yield hg(e,n))}while(!n.done)}(r[Symbol.iterator]())),new e}function yg(e,t){return Up(this,arguments,function*(){if($p(t))return yield Np(yield Np(yield*zp(jp(yg(e,yield Np(t))))));const n=function(e){return Up(this,arguments,function*(){yield yield Np(yield Np(e))})},r="string"===typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof ug?n(t):eg(t)?function(e){return Up(this,arguments,function*(){yield Np(yield*zp(jp(gg(function*(e){let t=null;do{t=e.next(yield null===t||void 0===t?void 0:t.value)}while(!t.done)}(e[Symbol.iterator]())))))})}(t):tg(t)?t:n(t);return yield Np(yield*zp(jp(gg(function(t){return Up(this,arguments,function*(){let n=null;do{n=yield Np(t.next(yield yield Np(hg(e,n))))}while(!n.done)})}(r[Symbol.asyncIterator]()))))),yield Np(new e)})}function vg(e,t,n){if(0!==e)for(let r=-1,i=(n=n.slice(0,t)).length;++r<i;)n[r]+=e;return n.subarray(0,t)}function _g(e){if("bigint"===typeof e&&(e<Number.MIN_SAFE_INTEGER||e>Number.MAX_SAFE_INTEGER))throw new TypeError("".concat(e," is not safe to convert to a number."));return Number(e)}function bg(e,t){return _g(e/t)+_g(e%t)/_g(t)}const wg=Symbol.for("isArrowBigNum");function Eg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return 0===n.length?Object.setPrototypeOf(hg(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...n),this.constructor.prototype)}function xg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Eg.apply(this,t)}function Dg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Eg.apply(this,t)}function Cg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Eg.apply(this,t)}Eg.prototype[wg]=!0,Eg.prototype.toJSON=function(){return'"'.concat(Ig(this),'"')},Eg.prototype.valueOf=function(e){return Tg(this,e)},Eg.prototype.toString=function(){return Ig(this)},Eg.prototype[Symbol.toPrimitive]=function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default"){case"number":return Tg(this);case"string":return Ig(this);case"default":return function(e){if(8===e.byteLength){return new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}return Ig(e)}(this)}return Ig(this)},Object.setPrototypeOf(xg.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(Dg.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(Cg.prototype,Object.create(Uint32Array.prototype)),Object.assign(xg.prototype,Eg.prototype,{constructor:xg,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array}),Object.assign(Dg.prototype,Eg.prototype,{constructor:Dg,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array}),Object.assign(Cg.prototype,Eg.prototype,{constructor:Cg,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});const Sg=BigInt(4294967296)*BigInt(4294967296)-BigInt(1);function Tg(e,t){const{buffer:n,byteOffset:r,byteLength:i,signed:s}=e,o=new BigUint64Array(n,r,i/8),a=s&&o.at(-1)&BigInt(1)<<BigInt(63);let l=BigInt(0),u=0;if(a){for(const e of o)l|=(e^Sg)*(BigInt(1)<<BigInt(64*u++));l*=BigInt(-1),l-=BigInt(1)}else for(const c of o)l|=c*(BigInt(1)<<BigInt(64*u++));if("number"===typeof t){const e=BigInt(Math.pow(10,t)),n=l%e;return _g(l/e)+_g(n)/_g(e)}return _g(l)}function Ig(e){if(8===e.byteLength){const t=new e.BigIntArray(e.buffer,e.byteOffset,1);return"".concat(t[0])}if(!e.signed)return Fg(e);let t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);if(new Int16Array([t.at(-1)])[0]>=0)return Fg(e);t=t.slice();let n=1;for(let i=0;i<t.length;i++){const e=t[i],r=~e+n;t[i]=r,n&=0===e?1:0}const r=Fg(t);return"-".concat(r)}function Fg(e){let t="";const n=new Uint32Array(2);let r=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);const i=new Uint32Array((r=new Uint16Array(r).reverse()).buffer);let s=-1;const o=r.length-1;do{for(n[0]=r[s=0];s<o;)r[s++]=n[1]=n[0]/10,n[0]=(n[0]-10*n[1]<<16)+r[s];r[s]=n[1]=n[0]/10,n[0]=n[0]-10*n[1],t="".concat(n[0]).concat(t)}while(i[0]||i[1]||i[2]||i[3]);return null!==t&&void 0!==t?t:"0"}class Rg{static new(e,t){switch(t){case!0:return new xg(e);case!1:return new Dg(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new xg(e)}return 16===e.byteLength?new Cg(e):new Dg(e)}static signed(e){return new xg(e)}static unsigned(e){return new Dg(e)}static decimal(e){return new Cg(e)}constructor(e,t){return Rg.new(e,t)}}var kg,Pg,Mg,Bg,Lg,Og,Ng,Ug,zg,jg,Vg,Gg,Wg,Hg,Qg,Xg,Yg,qg,Kg,Zg,Jg,$g,em,tm,nm,rm,im,sm;!function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"}(kg||(kg={})),function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"}(Pg||(Pg={})),function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"}(Mg||(Mg={})),function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(Bg||(Bg={})),function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"}(Lg||(Lg={}));class om{static isNull(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Null}static isInt(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Int}static isFloat(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Float}static isBinary(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Binary}static isLargeBinary(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.LargeBinary}static isUtf8(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Utf8}static isLargeUtf8(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.LargeUtf8}static isBool(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Bool}static isDecimal(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Decimal}static isDate(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Date}static isTime(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Time}static isTimestamp(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Timestamp}static isInterval(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Interval}static isDuration(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Duration}static isList(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.List}static isStruct(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Struct}static isUnion(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Union}static isFixedSizeBinary(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.FixedSizeBinary}static isFixedSizeList(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.FixedSizeList}static isMap(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Map}static isDictionary(e){return(null===e||void 0===e?void 0:e.typeId)===Vp.Dictionary}static isDenseUnion(e){return om.isUnion(e)&&e.mode===Lg.Dense}static isSparseUnion(e){return om.isUnion(e)&&e.mode===Lg.Sparse}constructor(e){this.typeId=e}}Og=Symbol.toStringTag,om[Og]=((sm=om.prototype).children=null,sm.ArrayType=Array,sm.OffsetArrayType=Int32Array,sm[Symbol.toStringTag]="DataType");class am extends om{constructor(){super(Vp.Null)}toString(){return"Null"}}Ng=Symbol.toStringTag,am[Ng]=(e=>e[Symbol.toStringTag]="Null")(am.prototype);class lm extends om{constructor(e,t){super(Vp.Int),this.isSigned=e,this.bitWidth=t}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error("Unrecognized ".concat(this[Symbol.toStringTag]," type"))}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}Ug=Symbol.toStringTag,lm[Ug]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(lm.prototype);class um extends lm{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(class extends lm{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(class extends lm{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(um.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(class extends lm{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}.prototype,"ArrayType",{value:BigInt64Array}),Object.defineProperty(class extends lm{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(class extends lm{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends lm{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(class extends lm{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}.prototype,"ArrayType",{value:BigUint64Array});class cm extends om{constructor(e){super(Vp.Float),this.precision=e}get ArrayType(){switch(this.precision){case kg.HALF:return Uint16Array;case kg.SINGLE:return Float32Array;case kg.DOUBLE:return Float64Array}throw new Error("Unrecognized ".concat(this[Symbol.toStringTag]," type"))}toString(){return"Float".concat(this.precision<<5||16)}}zg=Symbol.toStringTag,cm[zg]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(cm.prototype);Object.defineProperty(class extends cm{constructor(){super(kg.HALF)}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends cm{constructor(){super(kg.SINGLE)}}.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(class extends cm{constructor(){super(kg.DOUBLE)}}.prototype,"ArrayType",{value:Float64Array});class Am extends om{constructor(){super(Vp.Binary)}toString(){return"Binary"}}jg=Symbol.toStringTag,Am[jg]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(Am.prototype);class hm extends om{constructor(){super(Vp.LargeBinary)}toString(){return"LargeBinary"}}Vg=Symbol.toStringTag,hm[Vg]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeBinary"))(hm.prototype);class dm extends om{constructor(){super(Vp.Utf8)}toString(){return"Utf8"}}Gg=Symbol.toStringTag,dm[Gg]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(dm.prototype);class fm extends om{constructor(){super(Vp.LargeUtf8)}toString(){return"LargeUtf8"}}Wg=Symbol.toStringTag,fm[Wg]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeUtf8"))(fm.prototype);class pm extends om{constructor(){super(Vp.Bool)}toString(){return"Bool"}}Hg=Symbol.toStringTag,pm[Hg]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(pm.prototype);class gm extends om{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128;super(Vp.Decimal),this.scale=e,this.precision=t,this.bitWidth=n}toString(){return"Decimal[".concat(this.precision,"e").concat(this.scale>0?"+":"").concat(this.scale,"]")}}Qg=Symbol.toStringTag,gm[Qg]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(gm.prototype);class mm extends om{constructor(e){super(Vp.Date),this.unit=e}toString(){return"Date".concat(32*(this.unit+1),"<").concat(Mg[this.unit],">")}get ArrayType(){return this.unit===Mg.DAY?Int32Array:BigInt64Array}}Xg=Symbol.toStringTag,mm[Xg]=(e=>(e.unit=null,e[Symbol.toStringTag]="Date"))(mm.prototype);class ym extends om{constructor(e,t){super(Vp.Time),this.unit=e,this.bitWidth=t}toString(){return"Time".concat(this.bitWidth,"<").concat(Pg[this.unit],">")}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error("Unrecognized ".concat(this[Symbol.toStringTag]," type"))}}Yg=Symbol.toStringTag,ym[Yg]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))(ym.prototype);class vm extends om{constructor(e,t){super(Vp.Timestamp),this.unit=e,this.timezone=t}toString(){return"Timestamp<".concat(Pg[this.unit]).concat(this.timezone?", ".concat(this.timezone):"",">")}}qg=Symbol.toStringTag,vm[qg]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Timestamp"))(vm.prototype);class _m extends om{constructor(e){super(Vp.Interval),this.unit=e}toString(){return"Interval<".concat(Bg[this.unit],">")}}Kg=Symbol.toStringTag,_m[Kg]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(_m.prototype);class bm extends om{constructor(e){super(Vp.Duration),this.unit=e}toString(){return"Duration<".concat(Pg[this.unit],">")}}Zg=Symbol.toStringTag,bm[Zg]=(e=>(e.unit=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Duration"))(bm.prototype);class wm extends om{constructor(e){super(Vp.List),this.children=[e]}toString(){return"List<".concat(this.valueType,">")}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}Jg=Symbol.toStringTag,wm[Jg]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(wm.prototype);class Em extends om{constructor(e){super(Vp.Struct),this.children=e}toString(){return"Struct<{".concat(this.children.map(e=>"".concat(e.name,":").concat(e.type)).join(", "),"}>")}}$g=Symbol.toStringTag,Em[$g]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(Em.prototype);class xm extends om{constructor(e,t,n){super(Vp.Union),this.mode=e,this.children=n,this.typeIds=t=Int32Array.from(t),this.typeIdToChildIndex=t.reduce((e,t,n)=>(e[t]=n)&&e||e,Object.create(null))}toString(){return"".concat(this[Symbol.toStringTag],"<").concat(this.children.map(e=>"".concat(e.type)).join(" | "),">")}}em=Symbol.toStringTag,xm[em]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(xm.prototype);class Dm extends om{constructor(e){super(Vp.FixedSizeBinary),this.byteWidth=e}toString(){return"FixedSizeBinary[".concat(this.byteWidth,"]")}}tm=Symbol.toStringTag,Dm[tm]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(Dm.prototype);class Cm extends om{constructor(e,t){super(Vp.FixedSizeList),this.listSize=e,this.children=[t]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}nm=Symbol.toStringTag,Cm[nm]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(Cm.prototype);class Sm extends om{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n,r,i;if(super(Vp.Map),this.children=[e],this.keysSorted=t,e&&(e.name="entries",null===(n=null===e||void 0===e?void 0:e.type)||void 0===n?void 0:n.children)){const t=null===(r=null===e||void 0===e?void 0:e.type)||void 0===r?void 0:r.children[0];t&&(t.name="key");const n=null===(i=null===e||void 0===e?void 0:e.type)||void 0===i?void 0:i.children[1];n&&(n.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return"Map<{".concat(this.children[0].type.children.map(e=>"".concat(e.name,":").concat(e.type)).join(", "),"}>")}}rm=Symbol.toStringTag,Sm[rm]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(Sm.prototype);const Tm=(Im=-1,()=>++Im);var Im;class Fm extends om{constructor(e,t,n,r){super(Vp.Dictionary),this.indices=t,this.dictionary=e,this.isOrdered=r||!1,this.id=null==n?Tm():_g(n)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return"Dictionary<".concat(this.indices,", ").concat(this.dictionary,">")}}function Rm(e){const t=e;switch(e.typeId){case Vp.Decimal:return e.bitWidth/32;case Vp.Interval:return 1+t.unit;case Vp.FixedSizeList:return t.listSize;case Vp.FixedSizeBinary:return t.byteWidth;default:return 1}}im=Symbol.toStringTag,Fm[im]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(Fm.prototype);class km{visitMany(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.map((e,t)=>this.visit(e,...n.map(e=>e[t])))}visit(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(e){return function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("number"===typeof t)return Pm(e,t,n);if("string"===typeof t&&t in Vp)return Pm(e,Vp[t],n);if(t&&t instanceof om)return Pm(e,Mm(t),n);if((null===t||void 0===t?void 0:t.type)&&t.type instanceof om)return Pm(e,Mm(t.type),n);return Pm(e,Vp.NONE,n)}(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}getVisitFnByTypeId(e){return Pm(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}visitNull(e){return null}visitBool(e){return null}visitInt(e){return null}visitFloat(e){return null}visitUtf8(e){return null}visitLargeUtf8(e){return null}visitBinary(e){return null}visitLargeBinary(e){return null}visitFixedSizeBinary(e){return null}visitDate(e){return null}visitTimestamp(e){return null}visitTime(e){return null}visitDecimal(e){return null}visitList(e){return null}visitStruct(e){return null}visitUnion(e){return null}visitDictionary(e){return null}visitInterval(e){return null}visitDuration(e){return null}visitFixedSizeList(e){return null}visitMap(e){return null}}function Pm(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=null;switch(t){case Vp.Null:r=e.visitNull;break;case Vp.Bool:r=e.visitBool;break;case Vp.Int:r=e.visitInt;break;case Vp.Int8:r=e.visitInt8||e.visitInt;break;case Vp.Int16:r=e.visitInt16||e.visitInt;break;case Vp.Int32:r=e.visitInt32||e.visitInt;break;case Vp.Int64:r=e.visitInt64||e.visitInt;break;case Vp.Uint8:r=e.visitUint8||e.visitInt;break;case Vp.Uint16:r=e.visitUint16||e.visitInt;break;case Vp.Uint32:r=e.visitUint32||e.visitInt;break;case Vp.Uint64:r=e.visitUint64||e.visitInt;break;case Vp.Float:r=e.visitFloat;break;case Vp.Float16:r=e.visitFloat16||e.visitFloat;break;case Vp.Float32:r=e.visitFloat32||e.visitFloat;break;case Vp.Float64:r=e.visitFloat64||e.visitFloat;break;case Vp.Utf8:r=e.visitUtf8;break;case Vp.LargeUtf8:r=e.visitLargeUtf8;break;case Vp.Binary:r=e.visitBinary;break;case Vp.LargeBinary:r=e.visitLargeBinary;break;case Vp.FixedSizeBinary:r=e.visitFixedSizeBinary;break;case Vp.Date:r=e.visitDate;break;case Vp.DateDay:r=e.visitDateDay||e.visitDate;break;case Vp.DateMillisecond:r=e.visitDateMillisecond||e.visitDate;break;case Vp.Timestamp:r=e.visitTimestamp;break;case Vp.TimestampSecond:r=e.visitTimestampSecond||e.visitTimestamp;break;case Vp.TimestampMillisecond:r=e.visitTimestampMillisecond||e.visitTimestamp;break;case Vp.TimestampMicrosecond:r=e.visitTimestampMicrosecond||e.visitTimestamp;break;case Vp.TimestampNanosecond:r=e.visitTimestampNanosecond||e.visitTimestamp;break;case Vp.Time:r=e.visitTime;break;case Vp.TimeSecond:r=e.visitTimeSecond||e.visitTime;break;case Vp.TimeMillisecond:r=e.visitTimeMillisecond||e.visitTime;break;case Vp.TimeMicrosecond:r=e.visitTimeMicrosecond||e.visitTime;break;case Vp.TimeNanosecond:r=e.visitTimeNanosecond||e.visitTime;break;case Vp.Decimal:r=e.visitDecimal;break;case Vp.List:r=e.visitList;break;case Vp.Struct:r=e.visitStruct;break;case Vp.Union:r=e.visitUnion;break;case Vp.DenseUnion:r=e.visitDenseUnion||e.visitUnion;break;case Vp.SparseUnion:r=e.visitSparseUnion||e.visitUnion;break;case Vp.Dictionary:r=e.visitDictionary;break;case Vp.Interval:r=e.visitInterval;break;case Vp.IntervalDayTime:r=e.visitIntervalDayTime||e.visitInterval;break;case Vp.IntervalYearMonth:r=e.visitIntervalYearMonth||e.visitInterval;break;case Vp.Duration:r=e.visitDuration;break;case Vp.DurationSecond:r=e.visitDurationSecond||e.visitDuration;break;case Vp.DurationMillisecond:r=e.visitDurationMillisecond||e.visitDuration;break;case Vp.DurationMicrosecond:r=e.visitDurationMicrosecond||e.visitDuration;break;case Vp.DurationNanosecond:r=e.visitDurationNanosecond||e.visitDuration;break;case Vp.FixedSizeList:r=e.visitFixedSizeList;break;case Vp.Map:r=e.visitMap}if("function"===typeof r)return r;if(!n)return()=>null;throw new Error("Unrecognized type '".concat(Vp[t],"'"))}function Mm(e){switch(e.typeId){case Vp.Null:return Vp.Null;case Vp.Int:{const{bitWidth:t,isSigned:n}=e;switch(t){case 8:return n?Vp.Int8:Vp.Uint8;case 16:return n?Vp.Int16:Vp.Uint16;case 32:return n?Vp.Int32:Vp.Uint32;case 64:return n?Vp.Int64:Vp.Uint64}return Vp.Int}case Vp.Float:switch(e.precision){case kg.HALF:return Vp.Float16;case kg.SINGLE:return Vp.Float32;case kg.DOUBLE:return Vp.Float64}return Vp.Float;case Vp.Binary:return Vp.Binary;case Vp.LargeBinary:return Vp.LargeBinary;case Vp.Utf8:return Vp.Utf8;case Vp.LargeUtf8:return Vp.LargeUtf8;case Vp.Bool:return Vp.Bool;case Vp.Decimal:return Vp.Decimal;case Vp.Time:switch(e.unit){case Pg.SECOND:return Vp.TimeSecond;case Pg.MILLISECOND:return Vp.TimeMillisecond;case Pg.MICROSECOND:return Vp.TimeMicrosecond;case Pg.NANOSECOND:return Vp.TimeNanosecond}return Vp.Time;case Vp.Timestamp:switch(e.unit){case Pg.SECOND:return Vp.TimestampSecond;case Pg.MILLISECOND:return Vp.TimestampMillisecond;case Pg.MICROSECOND:return Vp.TimestampMicrosecond;case Pg.NANOSECOND:return Vp.TimestampNanosecond}return Vp.Timestamp;case Vp.Date:switch(e.unit){case Mg.DAY:return Vp.DateDay;case Mg.MILLISECOND:return Vp.DateMillisecond}return Vp.Date;case Vp.Interval:switch(e.unit){case Bg.DAY_TIME:return Vp.IntervalDayTime;case Bg.YEAR_MONTH:return Vp.IntervalYearMonth}return Vp.Interval;case Vp.Duration:switch(e.unit){case Pg.SECOND:return Vp.DurationSecond;case Pg.MILLISECOND:return Vp.DurationMillisecond;case Pg.MICROSECOND:return Vp.DurationMicrosecond;case Pg.NANOSECOND:return Vp.DurationNanosecond}return Vp.Duration;case Vp.Map:return Vp.Map;case Vp.List:return Vp.List;case Vp.Struct:return Vp.Struct;case Vp.Union:switch(e.mode){case Lg.Dense:return Vp.DenseUnion;case Lg.Sparse:return Vp.SparseUnion}return Vp.Union;case Vp.FixedSizeBinary:return Vp.FixedSizeBinary;case Vp.FixedSizeList:return Vp.FixedSizeList;case Vp.Dictionary:return Vp.Dictionary}throw new Error("Unrecognized type '".concat(Vp[e.typeId],"'"))}km.prototype.visitInt8=null,km.prototype.visitInt16=null,km.prototype.visitInt32=null,km.prototype.visitInt64=null,km.prototype.visitUint8=null,km.prototype.visitUint16=null,km.prototype.visitUint32=null,km.prototype.visitUint64=null,km.prototype.visitFloat16=null,km.prototype.visitFloat32=null,km.prototype.visitFloat64=null,km.prototype.visitDateDay=null,km.prototype.visitDateMillisecond=null,km.prototype.visitTimestampSecond=null,km.prototype.visitTimestampMillisecond=null,km.prototype.visitTimestampMicrosecond=null,km.prototype.visitTimestampNanosecond=null,km.prototype.visitTimeSecond=null,km.prototype.visitTimeMillisecond=null,km.prototype.visitTimeMicrosecond=null,km.prototype.visitTimeNanosecond=null,km.prototype.visitDenseUnion=null,km.prototype.visitSparseUnion=null,km.prototype.visitIntervalDayTime=null,km.prototype.visitIntervalYearMonth=null,km.prototype.visitDuration=null,km.prototype.visitDurationSecond=null,km.prototype.visitDurationMillisecond=null,km.prototype.visitDurationMicrosecond=null,km.prototype.visitDurationNanosecond=null;const Bm=new Float64Array(1),Lm=new Uint32Array(Bm.buffer);function Om(e){const t=(31744&e)>>10,n=(1023&e)/1024,r=Math.pow(-1,(32768&e)>>15);switch(t){case 31:return r*(n?Number.NaN:1/0);case 0:return r*(n?6103515625e-14*n:0)}return r*Math.pow(2,t-15)*(1+n)}class Nm extends km{}function Um(e){return(t,n,r)=>{if(t.setValid(n,null!=r))return e(t,n,r)}}const zm=(e,t,n,r)=>{if(n+1<t.length){const i=_g(t[n]),s=_g(t[n+1]);e.set(r.subarray(0,s-i),i)}},jm=(e,t,n)=>{let{values:r}=e;r[t]=n},Vm=(e,t,n)=>{let{values:r}=e;r[t]=n},Gm=(e,t,n)=>{let{values:r}=e;r[t]=function(e){if(e!==e)return 32256;Bm[0]=e;const t=(2147483648&Lm[1])>>16&65535;let n=2146435072&Lm[1],r=0;return n>=1089470464?Lm[0]>0?n=31744:(n=(2080374784&n)>>16,r=(1048575&Lm[1])>>10):n<=1056964608?(r=1048576+(1048575&Lm[1]),r=1048576+(r<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,r=512+(1048575&Lm[1])>>10),t|n|65535&r}(n)},Wm=(e,t,n)=>{let{values:r}=e;((e,t,n)=>{e[t]=Math.floor(n/864e5)})(r,t,n.valueOf())},Hm=(e,t,n)=>{let{values:r}=e;r[t]=BigInt(n)},Qm=(e,t,n)=>{let{values:r,valueOffsets:i}=e;return zm(r,i,t,n)},Xm=(e,t,n)=>{let{values:r,valueOffsets:i}=e;return zm(r,i,t,Yp(n))},Ym=(e,t,n)=>{let{values:r}=e;r[t]=BigInt(n/1e3)},qm=(e,t,n)=>{let{values:r}=e;r[t]=BigInt(n)},Km=(e,t,n)=>{let{values:r}=e;r[t]=BigInt(1e3*n)},Zm=(e,t,n)=>{let{values:r}=e;r[t]=BigInt(1e6*n)},Jm=(e,t,n)=>{let{values:r}=e;r[t]=n},$m=(e,t,n)=>{let{values:r}=e;r[t]=n},ey=(e,t,n)=>{let{values:r}=e;r[t]=n},ty=(e,t,n)=>{let{values:r}=e;r[t]=n},ny=(e,t,n)=>{const r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];cy.visit(i,e.valueOffsets[t],n)},ry=(e,t,n)=>{const r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];cy.visit(i,t,n)},iy=(e,t,n)=>{let{values:r}=e;r.set(n.subarray(0,2),2*t)},sy=(e,t,n)=>{let{values:r}=e;r[t]=12*n[0]+n[1]%12},oy=(e,t,n)=>{let{values:r}=e;r[t]=n},ay=(e,t,n)=>{let{values:r}=e;r[t]=n},ly=(e,t,n)=>{let{values:r}=e;r[t]=n},uy=(e,t,n)=>{let{values:r}=e;r[t]=n};Nm.prototype.visitBool=Um((e,t,n)=>{let{offset:r,values:i}=e;const s=r+t;n?i[s>>3]|=1<<s%8:i[s>>3]&=~(1<<s%8)}),Nm.prototype.visitInt=Um(jm),Nm.prototype.visitInt8=Um(jm),Nm.prototype.visitInt16=Um(jm),Nm.prototype.visitInt32=Um(jm),Nm.prototype.visitInt64=Um(jm),Nm.prototype.visitUint8=Um(jm),Nm.prototype.visitUint16=Um(jm),Nm.prototype.visitUint32=Um(jm),Nm.prototype.visitUint64=Um(jm),Nm.prototype.visitFloat=Um((e,t,n)=>{switch(e.type.precision){case kg.HALF:return Gm(e,t,n);case kg.SINGLE:case kg.DOUBLE:return Vm(e,t,n)}}),Nm.prototype.visitFloat16=Um(Gm),Nm.prototype.visitFloat32=Um(Vm),Nm.prototype.visitFloat64=Um(Vm),Nm.prototype.visitUtf8=Um(Xm),Nm.prototype.visitLargeUtf8=Um(Xm),Nm.prototype.visitBinary=Um(Qm),Nm.prototype.visitLargeBinary=Um(Qm),Nm.prototype.visitFixedSizeBinary=Um((e,t,n)=>{let{stride:r,values:i}=e;i.set(n.subarray(0,r),r*t)}),Nm.prototype.visitDate=Um((e,t,n)=>{e.type.unit===Mg.DAY?Wm(e,t,n):Hm(e,t,n)}),Nm.prototype.visitDateDay=Um(Wm),Nm.prototype.visitDateMillisecond=Um(Hm),Nm.prototype.visitTimestamp=Um((e,t,n)=>{switch(e.type.unit){case Pg.SECOND:return Ym(e,t,n);case Pg.MILLISECOND:return qm(e,t,n);case Pg.MICROSECOND:return Km(e,t,n);case Pg.NANOSECOND:return Zm(e,t,n)}}),Nm.prototype.visitTimestampSecond=Um(Ym),Nm.prototype.visitTimestampMillisecond=Um(qm),Nm.prototype.visitTimestampMicrosecond=Um(Km),Nm.prototype.visitTimestampNanosecond=Um(Zm),Nm.prototype.visitTime=Um((e,t,n)=>{switch(e.type.unit){case Pg.SECOND:return Jm(e,t,n);case Pg.MILLISECOND:return $m(e,t,n);case Pg.MICROSECOND:return ey(e,t,n);case Pg.NANOSECOND:return ty(e,t,n)}}),Nm.prototype.visitTimeSecond=Um(Jm),Nm.prototype.visitTimeMillisecond=Um($m),Nm.prototype.visitTimeMicrosecond=Um(ey),Nm.prototype.visitTimeNanosecond=Um(ty),Nm.prototype.visitDecimal=Um((e,t,n)=>{let{values:r,stride:i}=e;r.set(n.subarray(0,i),i*t)}),Nm.prototype.visitList=Um((e,t,n)=>{const r=e.children[0],i=e.valueOffsets,s=cy.getVisitFn(r);if(Array.isArray(n))for(let o=-1,a=i[t],l=i[t+1];a<l;)s(r,a++,n[++o]);else for(let o=-1,a=i[t],l=i[t+1];a<l;)s(r,a++,n.get(++o))}),Nm.prototype.visitStruct=Um((e,t,n)=>{const r=e.type.children.map(e=>cy.getVisitFn(e.type)),i=n instanceof Map?((e,t)=>(n,r,i,s)=>r&&n(r,e,t.get(i.name)))(t,n):n instanceof Iv?((e,t)=>(n,r,i,s)=>r&&n(r,e,t.get(s)))(t,n):Array.isArray(n)?((e,t)=>(n,r,i,s)=>r&&n(r,e,t[s]))(t,n):((e,t)=>(n,r,i,s)=>r&&n(r,e,t[i.name]))(t,n);e.type.children.forEach((t,n)=>i(r[n],e.children[n],t,n))}),Nm.prototype.visitUnion=Um((e,t,n)=>{e.type.mode===Lg.Dense?ny(e,t,n):ry(e,t,n)}),Nm.prototype.visitDenseUnion=Um(ny),Nm.prototype.visitSparseUnion=Um(ry),Nm.prototype.visitDictionary=Um((e,t,n)=>{var r;null===(r=e.dictionary)||void 0===r||r.set(e.values[t],n)}),Nm.prototype.visitInterval=Um((e,t,n)=>{e.type.unit===Bg.DAY_TIME?iy(e,t,n):sy(e,t,n)}),Nm.prototype.visitIntervalDayTime=Um(iy),Nm.prototype.visitIntervalYearMonth=Um(sy),Nm.prototype.visitDuration=Um((e,t,n)=>{switch(e.type.unit){case Pg.SECOND:return oy(e,t,n);case Pg.MILLISECOND:return ay(e,t,n);case Pg.MICROSECOND:return ly(e,t,n);case Pg.NANOSECOND:return uy(e,t,n)}}),Nm.prototype.visitDurationSecond=Um(oy),Nm.prototype.visitDurationMillisecond=Um(ay),Nm.prototype.visitDurationMicrosecond=Um(ly),Nm.prototype.visitDurationNanosecond=Um(uy),Nm.prototype.visitFixedSizeList=Um((e,t,n)=>{const{stride:r}=e,i=e.children[0],s=cy.getVisitFn(i);if(Array.isArray(n))for(let o=-1,a=t*r;++o<r;)s(i,a+o,n[o]);else for(let o=-1,a=t*r;++o<r;)s(i,a+o,n.get(o))}),Nm.prototype.visitMap=Um((e,t,n)=>{const r=e.children[0],{valueOffsets:i}=e,s=cy.getVisitFn(r);let{[t]:o,[t+1]:a}=i;const l=n instanceof Map?n.entries():Object.entries(n);for(const u of l)if(s(r,o,u),++o>=a)break});const cy=new Nm,Ay=Symbol.for("parent"),hy=Symbol.for("rowIndex");class dy{constructor(e,t){return this[Ay]=e,this[hy]=t,new Proxy(this,new py)}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[hy],t=this[Ay],n=t.type.children,r={};for(let i=-1,s=n.length;++i<s;)r[n[i].name]=jy.visit(t.children[i],e);return r}toString(){return"{".concat([...this].map(e=>{let[t,n]=e;return"".concat(Wp(t),": ").concat(Wp(n))}).join(", "),"}")}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new fy(this[Ay],this[hy])}}class fy{constructor(e,t){this.childIndex=0,this.children=e.children,this.rowIndex=t,this.childFields=e.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const e=this.childIndex;return e<this.numChildren?(this.childIndex=e+1,{done:!1,value:[this.childFields[e].name,jy.visit(this.children[e],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(dy.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Ay]:{writable:!0,enumerable:!1,configurable:!1,value:null},[hy]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class py{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[Ay].type.children.map(e=>e.name)}has(e,t){return-1!==e[Ay].type.children.findIndex(e=>e.name===t)}getOwnPropertyDescriptor(e,t){if(-1!==e[Ay].type.children.findIndex(e=>e.name===t))return{writable:!0,enumerable:!0,configurable:!0}}get(e,t){if(Reflect.has(e,t))return e[t];const n=e[Ay].type.children.findIndex(e=>e.name===t);if(-1!==n){const r=jy.visit(e[Ay].children[n],e[hy]);return Reflect.set(e,t,r),r}}set(e,t,n){const r=e[Ay].type.children.findIndex(e=>e.name===t);return-1!==r?(cy.visit(e[Ay].children[r],e[hy],n),Reflect.set(e,t,n)):!(!Reflect.has(e,t)&&"symbol"!==typeof t)&&Reflect.set(e,t,n)}}class gy extends km{}function my(e){return(t,n)=>t.getValid(n)?e(t,n):null}const yy=(e,t,n)=>{if(n+1>=t.length)return null;const r=_g(t[n]),i=_g(t[n+1]);return e.subarray(r,i)},vy=(e,t)=>{let{values:n}=e;return((e,t)=>864e5*e[t])(n,t)},_y=(e,t)=>{let{values:n}=e;return _g(n[t])},by=(e,t)=>{let{stride:n,values:r}=e;return r[n*t]},wy=(e,t)=>{let{values:n}=e;return n[t]},Ey=(e,t)=>{let{values:n,valueOffsets:r}=e;return yy(n,r,t)},xy=(e,t)=>{let{values:n,valueOffsets:r}=e;const i=yy(n,r,t);return null!==i?Qp(i):null},Dy=(e,t)=>{let{values:n}=e;return 1e3*_g(n[t])},Cy=(e,t)=>{let{values:n}=e;return _g(n[t])},Sy=(e,t)=>{let{values:n}=e;return bg(n[t],BigInt(1e3))},Ty=(e,t)=>{let{values:n}=e;return bg(n[t],BigInt(1e6))},Iy=(e,t)=>{let{values:n}=e;return n[t]},Fy=(e,t)=>{let{values:n}=e;return n[t]},Ry=(e,t)=>{let{values:n}=e;return n[t]},ky=(e,t)=>{let{values:n}=e;return n[t]},Py=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[n];return jy.visit(r,e.valueOffsets[t])},My=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[n];return jy.visit(r,t)},By=(e,t)=>{let{values:n}=e;return n.subarray(2*t,2*(t+1))},Ly=(e,t)=>{let{values:n}=e;const r=n[t],i=new Int32Array(2);return i[0]=Math.trunc(r/12),i[1]=Math.trunc(r%12),i},Oy=(e,t)=>{let{values:n}=e;return n[t]},Ny=(e,t)=>{let{values:n}=e;return n[t]},Uy=(e,t)=>{let{values:n}=e;return n[t]},zy=(e,t)=>{let{values:n}=e;return n[t]};gy.prototype.visitNull=my((e,t)=>null),gy.prototype.visitBool=my((e,t)=>{let{offset:n,values:r}=e;const i=n+t;return 0!==(r[i>>3]&1<<i%8)}),gy.prototype.visitInt=my((e,t)=>{let{values:n}=e;return n[t]}),gy.prototype.visitInt8=my(by),gy.prototype.visitInt16=my(by),gy.prototype.visitInt32=my(by),gy.prototype.visitInt64=my(wy),gy.prototype.visitUint8=my(by),gy.prototype.visitUint16=my(by),gy.prototype.visitUint32=my(by),gy.prototype.visitUint64=my(wy),gy.prototype.visitFloat=my((e,t)=>{let{type:n,values:r}=e;return n.precision!==kg.HALF?r[t]:Om(r[t])}),gy.prototype.visitFloat16=my((e,t)=>{let{stride:n,values:r}=e;return Om(r[n*t])}),gy.prototype.visitFloat32=my(by),gy.prototype.visitFloat64=my(by),gy.prototype.visitUtf8=my(xy),gy.prototype.visitLargeUtf8=my(xy),gy.prototype.visitBinary=my(Ey),gy.prototype.visitLargeBinary=my(Ey),gy.prototype.visitFixedSizeBinary=my((e,t)=>{let{stride:n,values:r}=e;return r.subarray(n*t,n*(t+1))}),gy.prototype.visitDate=my((e,t)=>e.type.unit===Mg.DAY?vy(e,t):_y(e,t)),gy.prototype.visitDateDay=my(vy),gy.prototype.visitDateMillisecond=my(_y),gy.prototype.visitTimestamp=my((e,t)=>{switch(e.type.unit){case Pg.SECOND:return Dy(e,t);case Pg.MILLISECOND:return Cy(e,t);case Pg.MICROSECOND:return Sy(e,t);case Pg.NANOSECOND:return Ty(e,t)}}),gy.prototype.visitTimestampSecond=my(Dy),gy.prototype.visitTimestampMillisecond=my(Cy),gy.prototype.visitTimestampMicrosecond=my(Sy),gy.prototype.visitTimestampNanosecond=my(Ty),gy.prototype.visitTime=my((e,t)=>{switch(e.type.unit){case Pg.SECOND:return Iy(e,t);case Pg.MILLISECOND:return Fy(e,t);case Pg.MICROSECOND:return Ry(e,t);case Pg.NANOSECOND:return ky(e,t)}}),gy.prototype.visitTimeSecond=my(Iy),gy.prototype.visitTimeMillisecond=my(Fy),gy.prototype.visitTimeMicrosecond=my(Ry),gy.prototype.visitTimeNanosecond=my(ky),gy.prototype.visitDecimal=my((e,t)=>{let{values:n,stride:r}=e;return Rg.decimal(n.subarray(r*t,r*(t+1)))}),gy.prototype.visitList=my((e,t)=>{const{valueOffsets:n,stride:r,children:i}=e,{[t*r]:s,[t*r+1]:o}=n,a=i[0].slice(s,o-s);return new Iv([a])}),gy.prototype.visitStruct=my((e,t)=>new dy(e,t)),gy.prototype.visitUnion=my((e,t)=>e.type.mode===Lg.Dense?Py(e,t):My(e,t)),gy.prototype.visitDenseUnion=my(Py),gy.prototype.visitSparseUnion=my(My),gy.prototype.visitDictionary=my((e,t)=>{var n;return null===(n=e.dictionary)||void 0===n?void 0:n.get(e.values[t])}),gy.prototype.visitInterval=my((e,t)=>e.type.unit===Bg.DAY_TIME?By(e,t):Ly(e,t)),gy.prototype.visitIntervalDayTime=my(By),gy.prototype.visitIntervalYearMonth=my(Ly),gy.prototype.visitDuration=my((e,t)=>{switch(e.type.unit){case Pg.SECOND:return Oy(e,t);case Pg.MILLISECOND:return Ny(e,t);case Pg.MICROSECOND:return Uy(e,t);case Pg.NANOSECOND:return zy(e,t)}}),gy.prototype.visitDurationSecond=my(Oy),gy.prototype.visitDurationMillisecond=my(Ny),gy.prototype.visitDurationMicrosecond=my(Uy),gy.prototype.visitDurationNanosecond=my(zy),gy.prototype.visitFixedSizeList=my((e,t)=>{const{stride:n,children:r}=e,i=r[0].slice(t*n,n);return new Iv([i])}),gy.prototype.visitMap=my((e,t)=>{const{valueOffsets:n,children:r}=e,{[t]:i,[t+1]:s}=n,o=r[0];return new Qy(o.slice(i,s-i))});const jy=new gy,Vy=Symbol.for("keys"),Gy=Symbol.for("vals"),Wy=Symbol.for("kKeysAsStrings"),Hy=Symbol.for("_kKeysAsStrings");class Qy{constructor(e){return this[Vy]=new Iv([e.children[0]]).memoize(),this[Gy]=e.children[1],new Proxy(this,new Yy)}get[Wy](){return this[Hy]||(this[Hy]=Array.from(this[Vy].toArray(),String))}[Symbol.iterator](){return new Xy(this[Vy],this[Gy])}get size(){return this[Vy].length}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[Vy],t=this[Gy],n={};for(let r=-1,i=e.length;++r<i;)n[e.get(r)]=jy.visit(t,r);return n}toString(){return"{".concat([...this].map(e=>{let[t,n]=e;return"".concat(Wp(t),": ").concat(Wp(n))}).join(", "),"}")}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class Xy{constructor(e,t){this.keys=e,this.vals=t,this.keyIndex=0,this.numKeys=e.length}[Symbol.iterator](){return this}next(){const e=this.keyIndex;return e===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(e),jy.visit(this.vals,e)]})}}class Yy{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[Wy]}has(e,t){return e[Wy].includes(t)}getOwnPropertyDescriptor(e,t){if(-1!==e[Wy].indexOf(t))return{writable:!0,enumerable:!0,configurable:!0}}get(e,t){if(Reflect.has(e,t))return e[t];const n=e[Wy].indexOf(t);if(-1!==n){const r=jy.visit(Reflect.get(e,Gy),n);return Reflect.set(e,t,r),r}}set(e,t,n){const r=e[Wy].indexOf(t);return-1!==r?(cy.visit(Reflect.get(e,Gy),r,n),Reflect.set(e,t,n)):!!Reflect.has(e,t)&&Reflect.set(e,t,n)}}let qy;function Ky(e,t,n,r){const{length:i=0}=e;let s="number"!==typeof t?0:t,o="number"!==typeof n?i:n;return s<0&&(s=(s%i+i)%i),o<0&&(o=(o%i+i)%i),o<s&&(qy=s,s=o,o=qy),o>i&&(o=i),r?r(e,s,o):[s,o]}Object.defineProperties(Qy.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Vy]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Gy]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Hy]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const Zy=(e,t)=>e<0?t+e:e,Jy=e=>e!==e;function $y(e){if("object"!==typeof e||null===e)return Jy(e)?Jy:t=>t===e;if(e instanceof Date){const t=e.valueOf();return e=>e instanceof Date&&e.valueOf()===t}return ArrayBuffer.isView(e)?t=>!!t&&function(e,t){let n=0;const r=e.length;if(r!==t.length)return!1;if(r>0)do{if(e[n]!==t[n])return!1}while(++n<r);return!0}(e,t):e instanceof Map?function(e){let t=-1;const n=[];for(const r of e.values())n[++t]=$y(r);return ev(n)}(e):Array.isArray(e)?function(e){const t=[];for(let n=-1,r=e.length;++n<r;)t[n]=$y(e[n]);return ev(t)}(e):e instanceof Iv?function(e){const t=[];for(let n=-1,r=e.length;++n<r;)t[n]=$y(e.get(n));return ev(t)}(e):function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Object.keys(e);if(!t&&0===n.length)return()=>!1;const r=[];for(let i=-1,s=n.length;++i<s;)r[i]=$y(e[n[i]]);return ev(r,n)}(e,!0)}function ev(e,t){return n=>{if(!n||"object"!==typeof n)return!1;switch(n.constructor){case Array:return function(e,t){const n=e.length;if(t.length!==n)return!1;for(let r=-1;++r<n;)if(!e[r](t[r]))return!1;return!0}(e,n);case Map:return tv(e,n,n.keys());case Qy:case dy:case Object:case void 0:return tv(e,n,t||Object.keys(n))}return n instanceof Iv&&function(e,t){const n=e.length;if(t.length!==n)return!1;for(let r=-1;++r<n;)if(!e[r](t.get(r)))return!1;return!0}(e,n)}}function tv(e,t,n){const r=n[Symbol.iterator](),i=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),s=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let o=0;const a=e.length;let l=s.next(),u=r.next(),c=i.next();for(;o<a&&!u.done&&!c.done&&!l.done&&(u.value===c.value&&e[o](l.value));++o,u=r.next(),c=i.next(),l=s.next());return!!(o===a&&u.done&&c.done&&l.done)||(r.return&&r.return(),i.return&&i.return(),s.return&&s.return(),!1)}class nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;this.numChunks=e,this.getChunkIterator=t,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const e=this.chunkIterator.next();if(!e.done)return e;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function rv(e){return e.reduce((e,t)=>e+t.nullCount,0)}function iv(e){return e.reduce((e,t,n)=>(e[n+1]=e[n]+t.length,e),new Uint32Array(e.length+1))}function sv(e,t,n,r){const i=[];for(let s=-1,o=e.length;++s<o;){const o=e[s],a=t[s],{length:l}=o;if(a>=r)break;if(n>=a+l)continue;if(a>=n&&a+l<=r){i.push(o);continue}const u=Math.max(0,n-a),c=Math.min(r-a,l);i.push(o.slice(u,c-u))}return 0===i.length&&i.push(e[0].slice(0,0)),i}function ov(e,t,n,r){let i=0,s=0,o=t.length-1;do{if(i>=o-1)return n<t[o]?r(e,i,n-t[i]):null;s=i+Math.trunc(.5*(o-i)),n<t[s]?o=s:i=s}while(i<o)}function av(e,t){return e.getValid(t)}function lv(e){function t(t,n,r){return e(t[n],r)}return function(e){return ov(this.data,this._offsets,e,t)}}function uv(e){let t;function n(n,r,i){return e(n[r],i,t)}return function(e,r){const i=this.data;t=r;const s=ov(i,this._offsets,e,n);return t=void 0,s}}function cv(e){let t;function n(n,r,i){let s=i,o=0,a=0;for(let l=r-1,u=n.length;++l<u;){const r=n[l];if(~(o=e(r,t,s)))return a+o;s=0,a+=r.length}return-1}return function(e,r){t=e;const i=this.data,s="number"!==typeof r?n(i,0,0):ov(i,this._offsets,r,n);return t=void 0,s}}function Av(e,t,n,r){return 0!==(n&1<<r)}function hv(e,t,n,r){return(n&1<<r)>>r}function dv(e,t,n){const r=n.byteLength+7&-8;if(e>0||n.byteLength<r){const i=new Uint8Array(r);return i.set(e%8===0?n.subarray(e>>3):fv(new pv(n,e,t,null,Av)).subarray(0,r)),i}return n}function fv(e){const t=[];let n=0,r=0,i=0;for(const o of e)o&&(i|=1<<r),8===++r&&(t[n++]=i,i=r=0);(0===n||r>0)&&(t[n++]=i);const s=new Uint8Array(t.length+7&-8);return s.set(t),s}class pv{constructor(e,t,n,r,i){this.bytes=e,this.length=n,this.context=r,this.get=i,this.bit=t%8,this.byteIndex=t>>3,this.byte=e[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function gv(e,t,n){if(n-t<=0)return 0;if(n-t<8){let r=0;for(const i of new pv(e,t,n-t,e,hv))r+=i;return r}const r=n>>3<<3,i=t+(t%8===0?0:8-t%8);return gv(e,t,i)+gv(e,r,n)+function(e,t,n){let r=0,i=Math.trunc(t);const s=new DataView(e.buffer,e.byteOffset,e.byteLength),o=void 0===n?e.byteLength:i+n;for(;o-i>=4;)r+=mv(s.getUint32(i)),i+=4;for(;o-i>=2;)r+=mv(s.getUint16(i)),i+=2;for(;o-i>=1;)r+=mv(s.getUint8(i)),i+=1;return r}(e,i>>3,r-i>>3)}function mv(e){let t=Math.trunc(e);return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24}class yv extends km{}function vv(e,t,n){if(void 0===t)return-1;if(null===t)switch(e.typeId){case Vp.Union:case Vp.Dictionary:break;default:return function(e,t){const{nullBitmap:n}=e;if(!n||e.nullCount<=0)return-1;let r=0;for(const i of new pv(n,e.offset+(t||0),e.length,n,Av)){if(!i)return r;++r}return-1}(e,n)}const r=jy.getVisitFn(e),i=$y(t);for(let s=(n||0)-1,o=e.length;++s<o;)if(i(r(e,s)))return s;return-1}function _v(e,t,n){const r=jy.getVisitFn(e),i=$y(t);for(let s=(n||0)-1,o=e.length;++s<o;)if(i(r(e,s)))return s;return-1}yv.prototype.visitNull=function(e,t){return null===t&&e.length>0?0:-1},yv.prototype.visitBool=vv,yv.prototype.visitInt=vv,yv.prototype.visitInt8=vv,yv.prototype.visitInt16=vv,yv.prototype.visitInt32=vv,yv.prototype.visitInt64=vv,yv.prototype.visitUint8=vv,yv.prototype.visitUint16=vv,yv.prototype.visitUint32=vv,yv.prototype.visitUint64=vv,yv.prototype.visitFloat=vv,yv.prototype.visitFloat16=vv,yv.prototype.visitFloat32=vv,yv.prototype.visitFloat64=vv,yv.prototype.visitUtf8=vv,yv.prototype.visitLargeUtf8=vv,yv.prototype.visitBinary=vv,yv.prototype.visitLargeBinary=vv,yv.prototype.visitFixedSizeBinary=vv,yv.prototype.visitDate=vv,yv.prototype.visitDateDay=vv,yv.prototype.visitDateMillisecond=vv,yv.prototype.visitTimestamp=vv,yv.prototype.visitTimestampSecond=vv,yv.prototype.visitTimestampMillisecond=vv,yv.prototype.visitTimestampMicrosecond=vv,yv.prototype.visitTimestampNanosecond=vv,yv.prototype.visitTime=vv,yv.prototype.visitTimeSecond=vv,yv.prototype.visitTimeMillisecond=vv,yv.prototype.visitTimeMicrosecond=vv,yv.prototype.visitTimeNanosecond=vv,yv.prototype.visitDecimal=vv,yv.prototype.visitList=vv,yv.prototype.visitStruct=vv,yv.prototype.visitUnion=vv,yv.prototype.visitDenseUnion=_v,yv.prototype.visitSparseUnion=_v,yv.prototype.visitDictionary=vv,yv.prototype.visitInterval=vv,yv.prototype.visitIntervalDayTime=vv,yv.prototype.visitIntervalYearMonth=vv,yv.prototype.visitDuration=vv,yv.prototype.visitDurationSecond=vv,yv.prototype.visitDurationMillisecond=vv,yv.prototype.visitDurationMicrosecond=vv,yv.prototype.visitDurationNanosecond=vv,yv.prototype.visitFixedSizeList=vv,yv.prototype.visitMap=vv;const bv=new yv;class wv extends km{}function Ev(e){const{type:t}=e;if(0===e.nullCount&&1===e.stride&&(om.isInt(t)&&64!==t.bitWidth||om.isTime(t)&&64!==t.bitWidth||om.isFloat(t)&&t.precision!==kg.HALF))return new nv(e.data.length,t=>{const n=e.data[t];return n.values.subarray(0,n.length)[Symbol.iterator]()});let n=0;return new nv(e.data.length,t=>{const r=e.data[t].length,i=e.slice(n,n+r);return n+=r,new xv(i)})}class xv{constructor(e){this.vector=e,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}wv.prototype.visitNull=Ev,wv.prototype.visitBool=Ev,wv.prototype.visitInt=Ev,wv.prototype.visitInt8=Ev,wv.prototype.visitInt16=Ev,wv.prototype.visitInt32=Ev,wv.prototype.visitInt64=Ev,wv.prototype.visitUint8=Ev,wv.prototype.visitUint16=Ev,wv.prototype.visitUint32=Ev,wv.prototype.visitUint64=Ev,wv.prototype.visitFloat=Ev,wv.prototype.visitFloat16=Ev,wv.prototype.visitFloat32=Ev,wv.prototype.visitFloat64=Ev,wv.prototype.visitUtf8=Ev,wv.prototype.visitLargeUtf8=Ev,wv.prototype.visitBinary=Ev,wv.prototype.visitLargeBinary=Ev,wv.prototype.visitFixedSizeBinary=Ev,wv.prototype.visitDate=Ev,wv.prototype.visitDateDay=Ev,wv.prototype.visitDateMillisecond=Ev,wv.prototype.visitTimestamp=Ev,wv.prototype.visitTimestampSecond=Ev,wv.prototype.visitTimestampMillisecond=Ev,wv.prototype.visitTimestampMicrosecond=Ev,wv.prototype.visitTimestampNanosecond=Ev,wv.prototype.visitTime=Ev,wv.prototype.visitTimeSecond=Ev,wv.prototype.visitTimeMillisecond=Ev,wv.prototype.visitTimeMicrosecond=Ev,wv.prototype.visitTimeNanosecond=Ev,wv.prototype.visitDecimal=Ev,wv.prototype.visitList=Ev,wv.prototype.visitStruct=Ev,wv.prototype.visitUnion=Ev,wv.prototype.visitDenseUnion=Ev,wv.prototype.visitSparseUnion=Ev,wv.prototype.visitDictionary=Ev,wv.prototype.visitInterval=Ev,wv.prototype.visitIntervalDayTime=Ev,wv.prototype.visitIntervalYearMonth=Ev,wv.prototype.visitDuration=Ev,wv.prototype.visitDurationSecond=Ev,wv.prototype.visitDurationMillisecond=Ev,wv.prototype.visitDurationMicrosecond=Ev,wv.prototype.visitDurationNanosecond=Ev,wv.prototype.visitFixedSizeList=Ev,wv.prototype.visitMap=Ev;const Dv=new wv;var Cv;const Sv={},Tv={};class Iv{constructor(e){var t,n,r;const i=e[0]instanceof Iv?e.flatMap(e=>e.data):e;if(0===i.length||i.some(e=>!(e instanceof Rv)))throw new TypeError("Vector constructor expects an Array of Data instances.");const s=null===(t=i[0])||void 0===t?void 0:t.type;switch(i.length){case 0:this._offsets=[0];break;case 1:{const{get:e,set:t,indexOf:n}=Sv[s.typeId],r=i[0];this.isValid=e=>av(r,e),this.get=t=>e(r,t),this.set=(e,n)=>t(r,e,n),this.indexOf=e=>n(r,e),this._offsets=[0,r.length];break}default:Object.setPrototypeOf(this,Tv[s.typeId]),this._offsets=iv(i)}this.data=i,this.type=s,this.stride=Rm(s),this.numChildren=null!==(r=null===(n=s.children)||void 0===n?void 0:n.length)&&void 0!==r?r:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((e,t)=>e+t.byteLength,0)}get nullable(){return this.data.some(e=>e.nullable)}get nullCount(){return rv(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return"".concat(this.VectorName,"<").concat(this.type[Symbol.toStringTag],">")}get VectorName(){return"".concat(Vp[this.type.typeId],"Vector")}isValid(e){return!1}get(e){return null}at(e){return this.get(Zy(e,this.length))}set(e,t){}indexOf(e,t){return-1}includes(e,t){return this.indexOf(e,t)>-1}[Symbol.iterator](){return Dv.visit(this)}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Iv(this.data.concat(t.flatMap(e=>e.data).flat(Number.POSITIVE_INFINITY)))}slice(e,t){return new Iv(Ky(this,e,t,(e,t,n)=>{let{data:r,_offsets:i}=e;return sv(r,i,t,n)}))}toJSON(){return[...this]}toArray(){const{type:e,data:t,length:n,stride:r,ArrayType:i}=this;switch(e.typeId){case Vp.Int:case Vp.Float:case Vp.Decimal:case Vp.Time:case Vp.Timestamp:switch(t.length){case 0:return new i;case 1:return t[0].values.subarray(0,n*r);default:return t.reduce((e,t)=>{let{values:n,length:i}=t;return e.array.set(n.subarray(0,i*r),e.offset),e.offset+=i*r,e},{array:new i(n*r),offset:0}).array}}return[...this]}toString(){return"[".concat([...this].join(","),"]")}getChild(e){var t;return this.getChildAt(null===(t=this.type.children)||void 0===t?void 0:t.findIndex(t=>t.name===e))}getChildAt(e){return e>-1&&e<this.numChildren?new Iv(this.data.map(t=>{let{children:n}=t;return n[e]})):null}get isMemoized(){return!!om.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(om.isDictionary(this.type)){const e=new Fv(this.data[0].dictionary),t=this.data.map(t=>{const n=t.clone();return n.dictionary=e,n});return new Iv(t)}return new Fv(this)}unmemoize(){if(om.isDictionary(this.type)&&this.isMemoized){const e=this.data[0].dictionary.unmemoize(),t=this.data.map(t=>{const n=t.clone();return n.dictionary=e,n});return new Iv(t)}return this}}Cv=Symbol.toStringTag,Iv[Cv]=(e=>{e.type=om.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;const t=Object.keys(Vp).map(e=>Vp[e]).filter(e=>"number"===typeof e&&e!==Vp.NONE);for(const n of t){const t=jy.getVisitFnByTypeId(n),r=cy.getVisitFnByTypeId(n),i=bv.getVisitFnByTypeId(n);Sv[n]={get:t,set:r,indexOf:i},Tv[n]=Object.create(e,{isValid:{value:lv(av)},get:{value:lv(jy.getVisitFnByTypeId(n))},set:{value:uv(cy.getVisitFnByTypeId(n))},indexOf:{value:cv(bv.getVisitFnByTypeId(n))}})}return"Vector"})(Iv.prototype);class Fv extends Iv{constructor(e){super(e.data);const t=this.get,n=this.set,r=this.slice,i=new Array(this.length);Object.defineProperty(this,"get",{value(e){const n=i[e];if(void 0!==n)return n;const r=t.call(this,e);return i[e]=r,r}}),Object.defineProperty(this,"set",{value(e,t){n.call(this,e,t),i[e]=t}}),Object.defineProperty(this,"slice",{value:(e,t)=>new Fv(r.call(this,e,t))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Iv(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class Rv{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(0!==this._nullCount){const{type:e}=this;return om.isSparseUnion(e)||om.isDenseUnion(e)?this.children.some(e=>e.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let e=0;const{valueOffsets:t,values:n,nullBitmap:r,typeIds:i}=this;return t&&(e+=t.byteLength),n&&(e+=n.byteLength),r&&(e+=r.byteLength),i&&(e+=i.byteLength),this.children.reduce((e,t)=>e+t.byteLength,e)}get nullCount(){if(om.isUnion(this.type))return this.children.reduce((e,t)=>e+t.nullCount,0);let e,t=this._nullCount;return t<=-1&&(e=this.nullBitmap)&&(this._nullCount=t=0===e.length?0:this.length-gv(e,this.offset,this.offset+this.length)),t}constructor(e,t,n,r,i){let s,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=arguments.length>6?arguments[6]:void 0;this.type=e,this.children=o,this.dictionary=a,this.offset=Math.floor(Math.max(t||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(r||0,-1)),i instanceof Rv?(this.stride=i.stride,this.values=i.values,this.typeIds=i.typeIds,this.nullBitmap=i.nullBitmap,this.valueOffsets=i.valueOffsets):(this.stride=Rm(e),i&&((s=i[0])&&(this.valueOffsets=s),(s=i[1])&&(this.values=s),(s=i[2])&&(this.nullBitmap=s),(s=i[3])&&(this.typeIds=s)))}getValid(e){const{type:t}=this;if(om.isUnion(t)){const n=t,r=this.children[n.typeIdToChildIndex[this.typeIds[e]]],i=n.mode===Lg.Dense?this.valueOffsets[e]:e;return r.getValid(i)}if(this.nullable&&this.nullCount>0){const t=this.offset+e;return 0!==(this.nullBitmap[t>>3]&1<<t%8)}return!0}setValid(e,t){let n;const{type:r}=this;if(om.isUnion(r)){const i=r,s=this.children[i.typeIdToChildIndex[this.typeIds[e]]],o=i.mode===Lg.Dense?this.valueOffsets[e]:e;n=s.getValid(o),s.setValid(o,t)}else{let{nullBitmap:r}=this;const{offset:i,length:s}=this,o=i+e,a=1<<o%8,l=o>>3;(!r||r.byteLength<=l)&&(r=new Uint8Array((i+s+63&-64)>>3).fill(255),this.nullCount>0?(r.set(dv(i,s,this.nullBitmap),0),Object.assign(this,{nullBitmap:r})):Object.assign(this,{nullBitmap:r,_nullCount:0}));const u=r[l];n=0!==(u&a),r[l]=t?u|a:u&~a}return n!==!!t&&(this._nullCount=this.nullCount+(t?-1:1)),t}clone(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.type,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.offset,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.length,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._nullCount,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.children;return new Rv(e,t,n,r,i,s,this.dictionary)}slice(e,t){const{stride:n,typeId:r,children:i}=this,s=+(0===this._nullCount)-1,o=16===r?n:1,a=this._sliceBuffers(e,t,n,r);return this.clone(this.type,this.offset+e,t,s,a,0===i.length||this.valueOffsets?i:this._sliceChildren(i,o*e,o*t))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===Vp.Null)return this.clone(this.type,0,e,0);const{length:t,nullCount:n}=this,r=new Uint8Array((e+63&-64)>>3).fill(255,0,t>>3);r[t>>3]=(1<<t-(-8&t))-1,n>0&&r.set(dv(this.offset,t,this.nullBitmap),0);const i=this.buffers;return i[Gp.VALIDITY]=r,this.clone(this.type,0,e,n+(e-t),i)}_sliceBuffers(e,t,n,r){let i;const{buffers:s}=this;return(i=s[Gp.TYPE])&&(s[Gp.TYPE]=i.subarray(e,e+t)),(i=s[Gp.OFFSET])&&(s[Gp.OFFSET]=i.subarray(e,e+t+1))||(i=s[Gp.DATA])&&(s[Gp.DATA]=6===r?i:i.subarray(n*e,n*(e+t))),s}_sliceChildren(e,t,n){return e.map(e=>e.slice(t,n))}}Rv.prototype.children=Object.freeze([]);class kv extends km{visit(e){return this.getVisitFn(e.type).call(this,e)}visitNull(e){const{type:t,offset:n=0,length:r=0}=e;return new Rv(t,n,r,r)}visitBool(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length>>3,nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitInt(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length,nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitFloat(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length,nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitUtf8(e){const{type:t,offset:n=0}=e,r=pg(e.data),i=pg(e.nullBitmap),s=dg(e.valueOffsets),{length:o=s.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,o,a,[s,r,i])}visitLargeUtf8(e){const{type:t,offset:n=0}=e,r=pg(e.data),i=pg(e.nullBitmap),s=fg(e.valueOffsets),{length:o=s.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,o,a,[s,r,i])}visitBinary(e){const{type:t,offset:n=0}=e,r=pg(e.data),i=pg(e.nullBitmap),s=dg(e.valueOffsets),{length:o=s.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,o,a,[s,r,i])}visitLargeBinary(e){const{type:t,offset:n=0}=e,r=pg(e.data),i=pg(e.nullBitmap),s=fg(e.valueOffsets),{length:o=s.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,o,a,[s,r,i])}visitFixedSizeBinary(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length/Rm(t),nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitDate(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length/Rm(t),nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitTimestamp(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length/Rm(t),nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitTime(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length/Rm(t),nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitDecimal(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length/Rm(t),nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitList(e){const{type:t,offset:n=0,child:r}=e,i=pg(e.nullBitmap),s=dg(e.valueOffsets),{length:o=s.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,o,a,[s,void 0,i],[r])}visitStruct(e){const{type:t,offset:n=0,children:r=[]}=e,i=pg(e.nullBitmap),{length:s=r.reduce((e,t)=>{let{length:n}=t;return Math.max(e,n)},0),nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,void 0,i],r)}visitUnion(e){const{type:t,offset:n=0,children:r=[]}=e,i=hg(t.ArrayType,e.typeIds),{length:s=i.length,nullCount:o=-1}=e;if(om.isSparseUnion(t))return new Rv(t,n,s,o,[void 0,void 0,void 0,i],r);const a=dg(e.valueOffsets);return new Rv(t,n,s,o,[a,void 0,void 0,i],r)}visitDictionary(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.indices.ArrayType,e.data),{dictionary:s=new Iv([(new kv).visit({type:t.dictionary})])}=e,{length:o=i.length,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,o,a,[void 0,i,r],[],s)}visitInterval(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length/Rm(t),nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitDuration(e){const{type:t,offset:n=0}=e,r=pg(e.nullBitmap),i=hg(t.ArrayType,e.data),{length:s=i.length,nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,i,r])}visitFixedSizeList(e){const{type:t,offset:n=0,child:r=(new kv).visit({type:t.valueType})}=e,i=pg(e.nullBitmap),{length:s=r.length/Rm(t),nullCount:o=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,s,o,[void 0,void 0,i],[r])}visitMap(e){const{type:t,offset:n=0,child:r=(new kv).visit({type:t.childType})}=e,i=pg(e.nullBitmap),s=dg(e.valueOffsets),{length:o=s.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new Rv(t,n,o,a,[s,void 0,i],[r])}}const Pv=new kv;function Mv(e){return Pv.visit(e)}var Bv;!function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"}(Bv||(Bv={}));class Lv{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(e,t,n,r){return e.prep(8,24),e.writeInt64(BigInt(null!==r&&void 0!==r?r:0)),e.pad(4),e.writeInt32(n),e.writeInt64(BigInt(null!==t&&void 0!==t?t:0)),e.offset()}}const Ov=new Int32Array(2),Nv=new Float32Array(Ov.buffer),Uv=new Float64Array(Ov.buffer),zv=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];var jv,Vv,Gv,Wv,Hv;!function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"}(jv||(jv={}));class Qv{constructor(e){this.bytes_=e,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(e){return new Qv(new Uint8Array(e))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(e){this.position_=e}capacity(){return this.bytes_.length}readInt8(e){return this.readUint8(e)<<24>>24}readUint8(e){return this.bytes_[e]}readInt16(e){return this.readUint16(e)<<16>>16}readUint16(e){return this.bytes_[e]|this.bytes_[e+1]<<8}readInt32(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24}readUint32(e){return this.readInt32(e)>>>0}readInt64(e){return BigInt.asIntN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readUint64(e){return BigInt.asUintN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readFloat32(e){return Ov[0]=this.readInt32(e),Nv[0]}readFloat64(e){return Ov[zv?0:1]=this.readInt32(e),Ov[zv?1:0]=this.readInt32(e+4),Uv[0]}writeInt8(e,t){this.bytes_[e]=t}writeUint8(e,t){this.bytes_[e]=t}writeInt16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeUint16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeInt32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeUint32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeInt64(e,t){this.writeInt32(e,Number(BigInt.asIntN(32,t))),this.writeInt32(e+4,Number(BigInt.asIntN(32,t>>BigInt(32))))}writeUint64(e,t){this.writeUint32(e,Number(BigInt.asUintN(32,t))),this.writeUint32(e+4,Number(BigInt.asUintN(32,t>>BigInt(32))))}writeFloat32(e,t){Nv[0]=t,this.writeInt32(e,Ov[0])}writeFloat64(e,t){Uv[0]=t,this.writeInt32(e,Ov[zv?0:1]),this.writeInt32(e+4,Ov[zv?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let e="";for(let t=0;t<4;t++)e+=String.fromCharCode(this.readInt8(this.position_+4+t));return e}__offset(e,t){const n=e-this.readInt32(e);return t<this.readInt16(n)?this.readInt16(n+t):0}__union(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e}__string(e,t){e+=this.readInt32(e);const n=this.readInt32(e);e+=4;const r=this.bytes_.subarray(e,e+n);return t===jv.UTF8_BYTES?r:this.text_decoder_.decode(r)}__union_with_string(e,t){return"string"===typeof e?this.__string(t):this.__union(e,t)}__indirect(e){return e+this.readInt32(e)}__vector(e){return e+this.readInt32(e)+4}__vector_len(e){return this.readInt32(e+this.readInt32(e))}__has_identifier(e){if(4!=e.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let t=0;t<4;t++)if(e.charCodeAt(t)!=this.readInt8(this.position()+4+t))return!1;return!0}createScalarList(e,t){const n=[];for(let r=0;r<t;++r){const t=e(r);null!==t&&n.push(t)}return n}createObjList(e,t){const n=[];for(let r=0;r<t;++r){const t=e(r);null!==t&&n.push(t.unpack())}return n}}class Xv{constructor(e){let t;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder,t=e||1024,this.bb=Qv.allocate(t),this.space=t}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(e){this.force_defaults=e}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(e,t){e>this.minalign&&(this.minalign=e);const n=1+~(this.bb.capacity()-this.space+t)&e-1;for(;this.space<n+e+t;){const e=this.bb.capacity();this.bb=Xv.growByteBuffer(this.bb),this.space+=this.bb.capacity()-e}this.pad(n)}pad(e){for(let t=0;t<e;t++)this.bb.writeInt8(--this.space,0)}writeInt8(e){this.bb.writeInt8(this.space-=1,e)}writeInt16(e){this.bb.writeInt16(this.space-=2,e)}writeInt32(e){this.bb.writeInt32(this.space-=4,e)}writeInt64(e){this.bb.writeInt64(this.space-=8,e)}writeFloat32(e){this.bb.writeFloat32(this.space-=4,e)}writeFloat64(e){this.bb.writeFloat64(this.space-=8,e)}addInt8(e){this.prep(1,0),this.writeInt8(e)}addInt16(e){this.prep(2,0),this.writeInt16(e)}addInt32(e){this.prep(4,0),this.writeInt32(e)}addInt64(e){this.prep(8,0),this.writeInt64(e)}addFloat32(e){this.prep(4,0),this.writeFloat32(e)}addFloat64(e){this.prep(8,0),this.writeFloat64(e)}addFieldInt8(e,t,n){(this.force_defaults||t!=n)&&(this.addInt8(t),this.slot(e))}addFieldInt16(e,t,n){(this.force_defaults||t!=n)&&(this.addInt16(t),this.slot(e))}addFieldInt32(e,t,n){(this.force_defaults||t!=n)&&(this.addInt32(t),this.slot(e))}addFieldInt64(e,t,n){(this.force_defaults||t!==n)&&(this.addInt64(t),this.slot(e))}addFieldFloat32(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat32(t),this.slot(e))}addFieldFloat64(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat64(t),this.slot(e))}addFieldOffset(e,t,n){(this.force_defaults||t!=n)&&(this.addOffset(t),this.slot(e))}addFieldStruct(e,t,n){t!=n&&(this.nested(t),this.slot(e))}nested(e){if(e!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(e){null!==this.vtable&&(this.vtable[e]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(e){const t=e.capacity();if(3221225472&t)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=t<<1,r=Qv.allocate(n);return r.setPosition(n-t),r.bytes().set(e.bytes(),n-t),r}addOffset(e){this.prep(4,0),this.writeInt32(this.offset()-e+4)}startObject(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(let t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const e=this.offset();let t=this.vtable_in_use-1;for(;t>=0&&0==this.vtable[t];t--);const n=t+1;for(;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);this.addInt16(e-this.object_start);const r=2*(n+2);this.addInt16(r);let i=0;const s=this.space;e:for(t=0;t<this.vtables.length;t++){const e=this.bb.capacity()-this.vtables[t];if(r==this.bb.readInt16(e)){for(let t=2;t<r;t+=2)if(this.bb.readInt16(s+t)!=this.bb.readInt16(e+t))continue e;i=this.vtables[t];break}}return i?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,i-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e}finish(e,t,n){const r=n?4:0;if(t){const e=t;if(this.prep(this.minalign,8+r),4!=e.length)throw new TypeError("FlatBuffers: file identifier must be length 4");for(let t=3;t>=0;t--)this.writeInt8(e.charCodeAt(t))}this.prep(this.minalign,4+r),this.addOffset(e),r&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(e,t){this.finish(e,t,!0)}requiredField(e,t){const n=this.bb.capacity()-e,r=n-this.bb.readInt32(n);if(!(t<this.bb.readInt16(r)&&0!=this.bb.readInt16(r+t)))throw new TypeError("FlatBuffers: field "+t+" must be set")}startVector(e,t,n){this.notNested(),this.vector_num_elems=t,this.prep(4,e*t),this.prep(n,e*t)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(e){if(!e)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(e))return this.string_maps.get(e);const t=this.createString(e);return this.string_maps.set(e,t),t}createString(e){if(null===e||void 0===e)return 0;let t;return t=e instanceof Uint8Array?e:this.text_encoder.encode(e),this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),this.bb.bytes().set(t,this.space),this.endVector()}createByteVector(e){return null===e||void 0===e?0:(this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length),this.bb.bytes().set(e,this.space),this.endVector())}createObjectOffset(e){return null===e?0:"string"===typeof e?this.createString(e):e.pack(this)}createObjectOffsetList(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n];if(null===r)throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");t.push(this.createObjectOffset(r))}return t}createStructOffsetList(e,t){return t(this,e.length),this.createObjectOffsetList(e.slice().reverse()),this.endVector()}}class Yv{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKeyValue(e,t){return(t||new Yv).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKeyValue(e,t){return e.setPosition(e.position()+4),(t||new Yv).__init(e.readInt32(e.position())+e.position(),e)}key(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}value(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startKeyValue(e){e.startObject(2)}static addKey(e,t){e.addFieldOffset(0,t,0)}static addValue(e,t){e.addFieldOffset(1,t,0)}static endKeyValue(e){return e.endObject()}static createKeyValue(e,t,n){return Yv.startKeyValue(e),Yv.addKey(e,t),Yv.addValue(e,n),Yv.endKeyValue(e)}}!function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"}(Vv||(Vv={})),function(e){e[e.Little=0]="Little",e[e.Big=1]="Big"}(Gv||(Gv={})),function(e){e[e.DenseArray=0]="DenseArray"}(Wv||(Wv={}));class qv{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInt(e,t){return(t||new qv).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInt(e,t){return e.setPosition(e.position()+4),(t||new qv).__init(e.readInt32(e.position())+e.position(),e)}bitWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}isSigned(){const e=this.bb.__offset(this.bb_pos,6);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startInt(e){e.startObject(2)}static addBitWidth(e,t){e.addFieldInt32(0,t,0)}static addIsSigned(e,t){e.addFieldInt8(1,+t,0)}static endInt(e){return e.endObject()}static createInt(e,t,n){return qv.startInt(e),qv.addBitWidth(e,t),qv.addIsSigned(e,n),qv.endInt(e)}}class Kv{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryEncoding(e,t){return(t||new Kv).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryEncoding(e,t){return e.setPosition(e.position()+4),(t||new Kv).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}indexType(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new qv).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}isOrdered(){const e=this.bb.__offset(this.bb_pos,8);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}dictionaryKind(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt16(this.bb_pos+e):Wv.DenseArray}static startDictionaryEncoding(e){e.startObject(4)}static addId(e,t){e.addFieldInt64(0,t,BigInt("0"))}static addIndexType(e,t){e.addFieldOffset(1,t,0)}static addIsOrdered(e,t){e.addFieldInt8(2,+t,0)}static addDictionaryKind(e,t){e.addFieldInt16(3,t,Wv.DenseArray)}static endDictionaryEncoding(e){return e.endObject()}}!function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList",e[e.RunEndEncoded=22]="RunEndEncoded"}(Hv||(Hv={}));class Zv{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsField(e,t){return(t||new Zv).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsField(e,t){return e.setPosition(e.position()+4),(t||new Zv).__init(e.readInt32(e.position())+e.position(),e)}name(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}nullable(){const e=this.bb.__offset(this.bb_pos,6);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}typeType(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb_pos+e):Hv.NONE}type(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__union(e,this.bb_pos+t):null}dictionary(e){const t=this.bb.__offset(this.bb_pos,12);return t?(e||new Kv).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}children(e,t){const n=this.bb.__offset(this.bb_pos,14);return n?(t||new Zv).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}childrenLength(){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,16);return n?(t||new Yv).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}static startField(e){e.startObject(7)}static addName(e,t){e.addFieldOffset(0,t,0)}static addNullable(e,t){e.addFieldInt8(1,+t,0)}static addTypeType(e,t){e.addFieldInt8(2,t,Hv.NONE)}static addType(e,t){e.addFieldOffset(3,t,0)}static addDictionary(e,t){e.addFieldOffset(4,t,0)}static addChildren(e,t){e.addFieldOffset(5,t,0)}static createChildrenVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startChildrenVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(6,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endField(e){return e.endObject()}}class Jv{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSchema(e,t){return(t||new Jv).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSchema(e,t){return e.setPosition(e.position()+4),(t||new Jv).__init(e.readInt32(e.position())+e.position(),e)}endianness(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Gv.Little}fields(e,t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new Zv).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}fieldsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new Yv).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}features(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):BigInt(0)}featuresLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSchema(e){e.startObject(4)}static addEndianness(e,t){e.addFieldInt16(0,t,Gv.Little)}static addFields(e,t){e.addFieldOffset(1,t,0)}static createFieldsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startFieldsVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(2,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static addFeatures(e,t){e.addFieldOffset(3,t,0)}static createFeaturesVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}static startFeaturesVector(e,t){e.startVector(8,t,8)}static endSchema(e){return e.endObject()}static finishSchemaBuffer(e,t){e.finish(t)}static finishSizePrefixedSchemaBuffer(e,t){e.finish(t,void 0,!0)}static createSchema(e,t,n,r,i){return Jv.startSchema(e),Jv.addEndianness(e,t),Jv.addFields(e,n),Jv.addCustomMetadata(e,r),Jv.addFeatures(e,i),Jv.endSchema(e)}}class $v{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFooter(e,t){return(t||new $v).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFooter(e,t){return e.setPosition(e.position()+4),(t||new $v).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Vv.V1}schema(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new Jv).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}dictionaries(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new Lv).__init(this.bb.__vector(this.bb_pos+n)+24*e,this.bb):null}dictionariesLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}recordBatches(e,t){const n=this.bb.__offset(this.bb_pos,10);return n?(t||new Lv).__init(this.bb.__vector(this.bb_pos+n)+24*e,this.bb):null}recordBatchesLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,12);return n?(t||new Yv).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startFooter(e){e.startObject(5)}static addVersion(e,t){e.addFieldInt16(0,t,Vv.V1)}static addSchema(e,t){e.addFieldOffset(1,t,0)}static addDictionaries(e,t){e.addFieldOffset(2,t,0)}static startDictionariesVector(e,t){e.startVector(24,t,8)}static addRecordBatches(e,t){e.addFieldOffset(3,t,0)}static startRecordBatchesVector(e,t){e.startVector(24,t,8)}static addCustomMetadata(e,t){e.addFieldOffset(4,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endFooter(e){return e.endObject()}static finishFooterBuffer(e,t){e.finish(t)}static finishSizePrefixedFooterBuffer(e,t){e.finish(t,void 0,!0)}}class e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Vv.V5;this.fields=e||[],this.metadata=t||new Map,n||(n=r_(this.fields)),this.dictionaries=n,this.metadataVersion=r}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(e=>e.name)}toString(){return"Schema<{ ".concat(this.fields.map((e,t)=>"".concat(t,": ").concat(e)).join(", ")," }>")}select(e){const t=new Set(e),n=this.fields.filter(e=>t.has(e.name));return new e_(n,this.metadata)}selectAt(e){const t=e.map(e=>this.fields[e]).filter(Boolean);return new e_(t,this.metadata)}assign(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t[0]instanceof e_?t[0]:Array.isArray(t[0])?new e_(t[0]):new e_(t),i=[...this.fields],s=n_(n_(new Map,this.metadata),r.metadata),o=r.fields.filter(e=>{const t=i.findIndex(t=>t.name===e.name);return!~t||(i[t]=e.clone({metadata:n_(n_(new Map,i[t].metadata),e.metadata)}))&&!1}),a=r_(o,new Map);return new e_([...i,...o],s,new Map([...this.dictionaries,...a]))}}e_.prototype.fields=null,e_.prototype.metadata=null,e_.prototype.dictionaries=null;class t_{static new(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let[r,i,s,o]=t;return t[0]&&"object"===typeof t[0]&&(({name:r}=t[0]),void 0===i&&(i=t[0].type),void 0===s&&(s=t[0].nullable),void 0===o&&(o=t[0].metadata)),new t_("".concat(r),i,s,o)}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;this.name=e,this.type=t,this.nullable=n,this.metadata=r||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return"".concat(this.name,": ").concat(this.type)}clone(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let[r,i,s,o]=t;return t[0]&&"object"===typeof t[0]?({name:r=this.name,type:i=this.type,nullable:s=this.nullable,metadata:o=this.metadata}=t[0]):[r=this.name,i=this.type,s=this.nullable,o=this.metadata]=t,t_.new(r,i,s,o)}}function n_(e,t){return new Map([...e||new Map,...t||new Map])}function r_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;for(let n=-1,r=e.length;++n<r;){const r=e[n].type;if(om.isDictionary(r))if(t.has(r.id)){if(t.get(r.id)!==r.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else t.set(r.id,r.dictionary);r.children&&r.children.length>0&&r_(r.children,t)}return t}t_.prototype.type=null,t_.prototype.name=null,t_.prototype.nullable=null,t_.prototype.metadata=null;var i_=Xv,s_=Qv;class o_{static decode(e){e=new s_(pg(e));const t=$v.getRootAsFooter(e),n=e_.decode(t.schema(),new Map,t.version());return new a_(n,t)}static encode(e){const t=new i_,n=e_.encode(t,e.schema);$v.startRecordBatchesVector(t,e.numRecordBatches);for(const s of[...e.recordBatches()].slice().reverse())l_.encode(t,s);const r=t.endVector();$v.startDictionariesVector(t,e.numDictionaries);for(const s of[...e.dictionaryBatches()].slice().reverse())l_.encode(t,s);const i=t.endVector();return $v.startFooter(t),$v.addSchema(t,n),$v.addVersion(t,Vv.V5),$v.addRecordBatches(t,r),$v.addDictionaries(t,i),$v.finishFooterBuffer(t,$v.endFooter(t)),t.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vv.V5,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.schema=e,this.version=t,n&&(this._recordBatches=n),r&&(this._dictionaryBatches=r)}*recordBatches(){for(let e,t=-1,n=this.numRecordBatches;++t<n;)(e=this.getRecordBatch(t))&&(yield e)}*dictionaryBatches(){for(let e,t=-1,n=this.numDictionaries;++t<n;)(e=this.getDictionaryBatch(t))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}}class a_ extends o_{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(e,t){super(e,t.version()),this._footer=t}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){const t=this._footer.recordBatches(e);if(t)return l_.decode(t)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){const t=this._footer.dictionaries(e);if(t)return l_.decode(t)}return null}}class l_{static decode(e){return new l_(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,t){const{metaDataLength:n}=t,r=BigInt(t.offset),i=BigInt(t.bodyLength);return Lv.createBlock(e,r,n,i)}constructor(e,t,n){this.metaDataLength=e,this.offset=_g(n),this.bodyLength=_g(t)}}const u_={fromIterable:e=>c_(function*(e){let t,n,r,i,s=!1,o=[],a=0;function l(){return"peek"===r?Ag(o,i)[0]:([n,o,a]=Ag(o,i),n)}({cmd:r,size:i}=(yield null)||{cmd:"read",size:0});const u=(c=e,mg(Uint8Array,c))[Symbol.iterator]();var c;try{do{if(({done:t,value:n}=Number.isNaN(i-a)?u.next():u.next(i-a)),!t&&n.byteLength>0&&(o.push(n),a+=n.byteLength),t||i<=a)do{({cmd:r,size:i}=yield l())}while(i<a)}while(!t)}catch(kA){(s=!0)&&"function"===typeof u.throw&&u.throw(kA)}finally{!1===s&&"function"===typeof u.return&&u.return(null)}return null}(e)),fromAsyncIterable:e=>c_(function(e){return Up(this,arguments,function*(){let t,n,r,i,s=!1,o=[],a=0;function l(){return"peek"===r?Ag(o,i)[0]:([n,o,a]=Ag(o,i),n)}({cmd:r,size:i}=(yield yield Np(null))||{cmd:"read",size:0});const u=(c=e,yg(Uint8Array,c))[Symbol.asyncIterator]();var c;try{do{if(({done:t,value:n}=Number.isNaN(i-a)?yield Np(u.next()):yield Np(u.next(i-a))),!t&&n.byteLength>0&&(o.push(n),a+=n.byteLength),t||i<=a)do{({cmd:r,size:i}=yield yield Np(l()))}while(i<a)}while(!t)}catch(kA){(s=!0)&&"function"===typeof u.throw&&(yield Np(u.throw(kA)))}finally{!1===s&&"function"===typeof u.return&&(yield Np(u.return(new Uint8Array(0))))}return yield Np(null)})}(e)),fromDOMStream:e=>c_(function(e){return Up(this,arguments,function*(){let t,n,r,i=!1,s=!1,o=[],a=0;function l(){return"peek"===n?Ag(o,r)[0]:([t,o,a]=Ag(o,r),t)}({cmd:n,size:r}=(yield yield Np(null))||{cmd:"read",size:0});const u=new A_(e);try{do{if(({done:i,value:t}=Number.isNaN(r-a)?yield Np(u.read()):yield Np(u.read(r-a))),!i&&t.byteLength>0&&(o.push(pg(t)),a+=t.byteLength),i||r<=a)do{({cmd:n,size:r}=yield yield Np(l()))}while(r<a)}while(!i)}catch(kA){(s=!0)&&(yield Np(u.cancel(kA)))}finally{!1===s?yield Np(u.cancel()):e.locked&&u.releaseLock()}return yield Np(null)})}(e)),fromNodeStream:e=>c_(function(e){return Up(this,arguments,function*(){const t=[];let n,r,i,s="error",o=!1,a=null,l=0,u=[];function c(){return"peek"===n?Ag(u,r)[0]:([i,u,l]=Ag(u,r),i)}if(({cmd:n,size:r}=(yield yield Np(null))||{cmd:"read",size:0}),e.isTTY)return yield yield Np(new Uint8Array(0)),yield Np(null);try{t[0]=h_(e,"end"),t[1]=h_(e,"error");do{if(t[2]=h_(e,"readable"),[s,a]=yield Np(Promise.race(t.map(e=>e[2]))),"error"===s)break;if((o="end"===s)||(Number.isFinite(r-l)?(i=pg(e.read(r-l)),i.byteLength<r-l&&(i=pg(e.read()))):i=pg(e.read()),i.byteLength>0&&(u.push(i),l+=i.byteLength)),o||r<=l)do{({cmd:n,size:r}=yield yield Np(c()))}while(r<l)}while(!o)}finally{yield Np(A(t,"error"===s?a:null))}return yield Np(null);function A(t,n){return i=u=null,new Promise((r,i)=>{for(const[n,s]of t)e.off(n,s);try{const t=e.destroy;t&&t.call(e,n),n=void 0}catch(kA){n=kA||n}finally{null!=n?i(n):r()}})}})}(e)),toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},c_=e=>(e.next(),e);class A_{constructor(e){this.source=e,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(e){return Lp(this,void 0,void 0,function*(){const{reader:t,source:n}=this;t&&(yield t.cancel(e).catch(()=>{})),n&&n.locked&&this.releaseLock()})}read(e){return Lp(this,void 0,void 0,function*(){if(0===e)return{done:null==this.reader,value:new Uint8Array(0)};const t=yield this.reader.read();return!t.done&&(t.value=pg(t)),t})}}const h_=(e,t)=>{const n=e=>r([t,e]);let r;return[t,n,new Promise(i=>(r=i)&&e.once(t,n))]};const d_=Object.freeze({done:!0,value:void 0});class f_{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class p_{tee(){return this._getDOMStream().tee()}pipe(e,t){return this._getNodeStream().pipe(e,t)}pipeTo(e,t){return this._getDOMStream().pipeTo(e,t)}pipeThrough(e,t){return this._getDOMStream().pipeThrough(e,t)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class g_ extends p_{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}cancel(e){return Lp(this,void 0,void 0,function*(){yield this.return(e)})}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){const{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(d_);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return u_.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return u_.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}throw(e){return Lp(this,void 0,void 0,function*(){return yield this.abort(e),d_})}return(e){return Lp(this,void 0,void 0,function*(){return yield this.close(),d_})}read(e){return Lp(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return Lp(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((e,t)=>{this.resolvers.push({resolve:e,reject:t})}):Promise.resolve(d_)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class m_ extends g_{write(e){if((e=pg(e)).byteLength>0)return super.write(e)}toString(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Qp(this.toUint8Array(!0)):this.toUint8Array(!1).then(Qp)}toUint8Array(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Ag(this._values)[0]:(()=>Lp(this,void 0,void 0,function*(){var e,t,n,r;const i=[];let s=0;try{for(var o,a=!0,l=jp(this);!(e=(o=yield l.next()).done);a=!0){r=o.value,a=!1;const e=r;i.push(e),s+=e.byteLength}}catch(u){t={error:u}}finally{try{a||e||!(n=l.return)||(yield n.call(l))}finally{if(t)throw t.error}}return Ag(i,s)[0]}))()}}class y_{constructor(e){e&&(this.source=new __(u_.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class v_{constructor(e){e instanceof v_?this.source=e.source:e instanceof m_?this.source=new b_(u_.fromAsyncIterable(e)):lg(e)?this.source=new b_(u_.fromNodeStream(e)):ag(e)?this.source=new b_(u_.fromDOMStream(e)):sg(e)?this.source=new b_(u_.fromDOMStream(e.body)):eg(e)?this.source=new b_(u_.fromIterable(e)):($p(e)||tg(e))&&(this.source=new b_(u_.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class __{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";return this.source.next({cmd:t,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||d_)}return(e){return Object.create(this.source.return&&this.source.return(e)||d_)}}class b_{constructor(e){this.source=e,this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}cancel(e){return Lp(this,void 0,void 0,function*(){yield this.return(e)})}get closed(){return this._closedPromise}read(e){return Lp(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return Lp(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(e){return Lp(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";return function*(){return yield t.source.next({cmd:n,size:e})}()})}throw(e){return Lp(this,void 0,void 0,function*(){const t=this.source.throw&&(yield this.source.throw(e))||d_;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)})}return(e){return Lp(this,void 0,void 0,function*(){const t=this.source.return&&(yield this.source.return(e))||d_;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)})}}class w_ extends y_{constructor(e,t){super(),this.position=0,this.buffer=pg(e),this.size=void 0===t?this.buffer.byteLength:t}readInt32(e){const{buffer:t,byteOffset:n}=this.readAt(e,4);return new DataView(t,n).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){const{buffer:t,size:n,position:r}=this;return t&&r<n?("number"!==typeof e&&(e=Number.POSITIVE_INFINITY),this.position=Math.min(n,r+Math.min(n-r,e)),t.subarray(r,this.position)):null}readAt(e,t){const n=this.buffer,r=Math.min(this.size,e+t);return n?n.subarray(e,r):new Uint8Array(t)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}}class E_ extends v_{constructor(e,t){super(),this.position=0,this._handle=e,"number"===typeof t?this.size=t:this._pending=(()=>Lp(this,void 0,void 0,function*(){this.size=(yield e.stat()).size,delete this._pending}))()}readInt32(e){return Lp(this,void 0,void 0,function*(){const{buffer:t,byteOffset:n}=yield this.readAt(e,4);return new DataView(t,n).getInt32(0,!0)})}seek(e){return Lp(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(e,this.size),e<this.size})}read(e){return Lp(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:t,size:n,position:r}=this;if(t&&r<n){"number"!==typeof e&&(e=Number.POSITIVE_INFINITY);let i=r,s=0,o=0;const a=Math.min(n,i+Math.min(n-i,e)),l=new Uint8Array(Math.max(0,(this.position=a)-i));for(;(i+=o)<a&&(s+=o)<l.byteLength;)({bytesRead:o}=yield t.read(l,s,l.byteLength-s,i));return l}return null})}readAt(e,t){return Lp(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:n,size:r}=this;if(n&&e+t<r){const i=Math.min(r,e+t),s=new Uint8Array(i-e);return(yield n.read(s,0,t,e)).buffer}return new Uint8Array(t)})}close(){return Lp(this,void 0,void 0,function*(){const e=this._handle;this._handle=null,e&&(yield e.close())})}throw(e){return Lp(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}return(e){return Lp(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}}function x_(e){return e<0&&(e=4294967295+e+1),"0x".concat(e.toString(16))}const D_=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class C_{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){const t=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),n=new Uint32Array([e.buffer[1]>>>16,65535&e.buffer[1],e.buffer[0]>>>16,65535&e.buffer[0]]);let r=t[3]*n[3];this.buffer[0]=65535&r;let i=r>>>16;return r=t[2]*n[3],i+=r,r=t[3]*n[2]>>>0,i+=r,this.buffer[0]+=i<<16,this.buffer[1]=i>>>0<r?65536:0,this.buffer[1]+=i>>>16,this.buffer[1]+=t[1]*n[3]+t[2]*n[2]+t[3]*n[1],this.buffer[1]+=t[0]*n[3]+t[1]*n[2]+t[2]*n[1]+t[3]*n[0]<<16,this}_plus(e){const t=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],t<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=t}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return"".concat(x_(this.buffer[1])," ").concat(x_(this.buffer[0]))}}class S_ extends C_{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return S_.fromString("string"===typeof e?e:e.toString(),t)}static fromNumber(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return S_.fromString(e.toString(),t)}static fromString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);const n=e.length,r=new S_(t);for(let i=0;i<n;){const t=8<n-i?8:n-i,s=new S_(new Uint32Array([Number.parseInt(e.slice(i,i+t),10),0])),o=new S_(new Uint32Array([D_[t],0]));r.times(o),r.plus(s),i+=t}return r}static convertArray(e){const t=new Uint32Array(2*e.length);for(let n=-1,r=e.length;++n<r;)S_.from(e[n],new Uint32Array(t.buffer,t.byteOffset+2*n*4,2));return t}static multiply(e,t){return new S_(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new S_(new Uint32Array(e.buffer)).plus(t)}}class T_ extends C_{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){const t=this.buffer[1]|0,n=e.buffer[1]|0;return t<n||t===n&&this.buffer[0]<e.buffer[0]}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return T_.fromString("string"===typeof e?e:e.toString(),t)}static fromNumber(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return T_.fromString(e.toString(),t)}static fromString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);const n=e.startsWith("-"),r=e.length,i=new T_(t);for(let s=n?1:0;s<r;){const t=8<r-s?8:r-s,n=new T_(new Uint32Array([Number.parseInt(e.slice(s,s+t),10),0])),o=new T_(new Uint32Array([D_[t],0]));i.times(o),i.plus(n),s+=t}return n?i.negate():i}static convertArray(e){const t=new Uint32Array(2*e.length);for(let n=-1,r=e.length;++n<r;)T_.from(e[n],new Uint32Array(t.buffer,t.byteOffset+2*n*4,2));return t}static multiply(e,t){return new T_(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new T_(new Uint32Array(e.buffer)).plus(t)}}class I_{constructor(e){this.buffer=e}high(){return new T_(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new T_(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(e){const t=new S_(new Uint32Array([this.buffer[3],0])),n=new S_(new Uint32Array([this.buffer[2],0])),r=new S_(new Uint32Array([this.buffer[1],0])),i=new S_(new Uint32Array([this.buffer[0],0])),s=new S_(new Uint32Array([e.buffer[3],0])),o=new S_(new Uint32Array([e.buffer[2],0])),a=new S_(new Uint32Array([e.buffer[1],0])),l=new S_(new Uint32Array([e.buffer[0],0]));let u=S_.multiply(i,l);this.buffer[0]=u.low();const c=new S_(new Uint32Array([u.high(),0]));u=S_.multiply(r,l),c.plus(u),u=S_.multiply(i,a),c.plus(u),this.buffer[1]=c.low(),this.buffer[3]=c.lessThan(u)?1:0,this.buffer[2]=c.high();return new S_(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(S_.multiply(n,l)).plus(S_.multiply(r,a)).plus(S_.multiply(i,o)),this.buffer[3]+=S_.multiply(t,l).plus(S_.multiply(n,a)).plus(S_.multiply(r,o)).plus(S_.multiply(i,s)).low(),this}plus(e){const t=new Uint32Array(4);return t[3]=this.buffer[3]+e.buffer[3]>>>0,t[2]=this.buffer[2]+e.buffer[2]>>>0,t[1]=this.buffer[1]+e.buffer[1]>>>0,t[0]=this.buffer[0]+e.buffer[0]>>>0,t[0]<this.buffer[0]>>>0&&++t[1],t[1]<this.buffer[1]>>>0&&++t[2],t[2]<this.buffer[2]>>>0&&++t[3],this.buffer[3]=t[3],this.buffer[2]=t[2],this.buffer[1]=t[1],this.buffer[0]=t[0],this}hex(){return"".concat(x_(this.buffer[3])," ").concat(x_(this.buffer[2])," ").concat(x_(this.buffer[1])," ").concat(x_(this.buffer[0]))}static multiply(e,t){return new I_(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new I_(new Uint32Array(e.buffer)).plus(t)}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(4);return I_.fromString("string"===typeof e?e:e.toString(),t)}static fromNumber(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(4);return I_.fromString(e.toString(),t)}static fromString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(4);const n=e.startsWith("-"),r=e.length,i=new I_(t);for(let s=n?1:0;s<r;){const t=8<r-s?8:r-s,n=new I_(new Uint32Array([Number.parseInt(e.slice(s,s+t),10),0,0,0])),o=new I_(new Uint32Array([D_[t],0,0,0]));i.times(o),i.plus(n),s+=t}return n?i.negate():i}static convertArray(e){const t=new Uint32Array(4*e.length);for(let n=-1,r=e.length;++n<r;)I_.from(e[n],new Uint32Array(t.buffer,t.byteOffset+16*n,4));return t}}class F_ extends km{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Vv.V5;super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=t,this.buffers=n,this.dictionaries=r,this.metadataVersion=i}visit(e){return super.visit(e instanceof t_?e.type:e)}visitNull(e){let{length:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t})}visitBool(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitInt(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitFloat(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitUtf8(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitLargeUtf8(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitBinary(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitLargeBinary(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitFixedSizeBinary(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitDate(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitTimestamp(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitTime(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitDecimal(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitList(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}visitStruct(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),children:this.visitMany(e.children)})}visitUnion(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return this.metadataVersion<Vv.V5&&this.readNullBitmap(e,n),e.mode===Lg.Sparse?this.visitSparseUnion(e,{length:t,nullCount:n}):this.visitDenseUnion(e,{length:t,nullCount:n})}visitDenseUnion(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,typeIds:this.readTypeIds(e),valueOffsets:this.readOffsets(e),children:this.visitMany(e.children)})}visitSparseUnion(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,typeIds:this.readTypeIds(e),children:this.visitMany(e.children)})}visitDictionary(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e.indices),dictionary:this.readDictionary(e)})}visitInterval(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitDuration(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitFixedSizeList(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),child:this.visit(e.children[0])})}visitMap(e){let{length:t,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Mv({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.nextBufferRange();return t>0&&this.readData(e,n)||new Uint8Array(0)}readOffsets(e,t){return this.readData(e,t)}readTypeIds(e,t){return this.readData(e,t)}readData(e){let{length:t,offset:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();return this.bytes.subarray(n,n+t)}readDictionary(e){return this.dictionaries.get(e.id)}}class R_ extends F_{constructor(e,t,n,r,i){super(new Uint8Array(0),t,n,r,i),this.sources=e}readNullBitmap(e,t){let{offset:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.nextBufferRange();return t<=0?new Uint8Array(0):fv(this.sources[n])}readOffsets(e){let{offset:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();return hg(Uint8Array,hg(e.OffsetArrayType,this.sources[t]))}readTypeIds(e){let{offset:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();return hg(Uint8Array,hg(e.ArrayType,this.sources[t]))}readData(e){let{offset:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();const{sources:n}=this;return om.isTimestamp(e)||(om.isInt(e)||om.isTime(e))&&64===e.bitWidth||om.isDuration(e)||om.isDate(e)&&e.unit===Mg.MILLISECOND?hg(Uint8Array,T_.convertArray(n[t])):om.isDecimal(e)?hg(Uint8Array,I_.convertArray(n[t])):om.isBinary(e)||om.isLargeBinary(e)||om.isFixedSizeBinary(e)?function(e){const t=e.join(""),n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r>>1]=Number.parseInt(t.slice(r,r+2),16);return n}(n[t]):om.isBool(e)?fv(n[t]):om.isUtf8(e)||om.isLargeUtf8(e)?Yp(n[t].join("")):hg(Uint8Array,hg(e.ArrayType,n[t].map(e=>+e)))}}class k_ extends km{compareSchemas(e,t){return e===t||t instanceof e.constructor&&this.compareManyFields(e.fields,t.fields)}compareManyFields(e,t){return e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e,n)=>this.compareFields(e,t[n]))}compareFields(e,t){return e===t||t instanceof e.constructor&&e.name===t.name&&e.nullable===t.nullable&&this.visit(e.type,t.type)}}function P_(e,t){return t instanceof e.constructor}function M_(e,t){return e===t||P_(e,t)}function B_(e,t){return e===t||P_(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function L_(e,t){return e===t||P_(e,t)&&e.precision===t.precision}function O_(e,t){return e===t||P_(e,t)&&e.unit===t.unit}function N_(e,t){return e===t||P_(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function U_(e,t){return e===t||P_(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function z_(e,t){return e===t||P_(e,t)&&e.mode===t.mode&&e.typeIds.every((e,n)=>e===t.typeIds[n])&&G_.compareManyFields(e.children,t.children)}function j_(e,t){return e===t||P_(e,t)&&e.unit===t.unit}function V_(e,t){return e===t||P_(e,t)&&e.unit===t.unit}k_.prototype.visitNull=M_,k_.prototype.visitBool=M_,k_.prototype.visitInt=B_,k_.prototype.visitInt8=B_,k_.prototype.visitInt16=B_,k_.prototype.visitInt32=B_,k_.prototype.visitInt64=B_,k_.prototype.visitUint8=B_,k_.prototype.visitUint16=B_,k_.prototype.visitUint32=B_,k_.prototype.visitUint64=B_,k_.prototype.visitFloat=L_,k_.prototype.visitFloat16=L_,k_.prototype.visitFloat32=L_,k_.prototype.visitFloat64=L_,k_.prototype.visitUtf8=M_,k_.prototype.visitLargeUtf8=M_,k_.prototype.visitBinary=M_,k_.prototype.visitLargeBinary=M_,k_.prototype.visitFixedSizeBinary=function(e,t){return e===t||P_(e,t)&&e.byteWidth===t.byteWidth},k_.prototype.visitDate=O_,k_.prototype.visitDateDay=O_,k_.prototype.visitDateMillisecond=O_,k_.prototype.visitTimestamp=N_,k_.prototype.visitTimestampSecond=N_,k_.prototype.visitTimestampMillisecond=N_,k_.prototype.visitTimestampMicrosecond=N_,k_.prototype.visitTimestampNanosecond=N_,k_.prototype.visitTime=U_,k_.prototype.visitTimeSecond=U_,k_.prototype.visitTimeMillisecond=U_,k_.prototype.visitTimeMicrosecond=U_,k_.prototype.visitTimeNanosecond=U_,k_.prototype.visitDecimal=M_,k_.prototype.visitList=function(e,t){return e===t||P_(e,t)&&e.children.length===t.children.length&&G_.compareManyFields(e.children,t.children)},k_.prototype.visitStruct=function(e,t){return e===t||P_(e,t)&&e.children.length===t.children.length&&G_.compareManyFields(e.children,t.children)},k_.prototype.visitUnion=z_,k_.prototype.visitDenseUnion=z_,k_.prototype.visitSparseUnion=z_,k_.prototype.visitDictionary=function(e,t){return e===t||P_(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&G_.visit(e.indices,t.indices)&&G_.visit(e.dictionary,t.dictionary)},k_.prototype.visitInterval=j_,k_.prototype.visitIntervalDayTime=j_,k_.prototype.visitIntervalYearMonth=j_,k_.prototype.visitDuration=V_,k_.prototype.visitDurationSecond=V_,k_.prototype.visitDurationMillisecond=V_,k_.prototype.visitDurationMicrosecond=V_,k_.prototype.visitDurationNanosecond=V_,k_.prototype.visitFixedSizeList=function(e,t){return e===t||P_(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&G_.compareManyFields(e.children,t.children)},k_.prototype.visitMap=function(e,t){return e===t||P_(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&G_.compareManyFields(e.children,t.children)};const G_=new k_;function W_(e,t){return G_.compareSchemas(e,t)}function H_(e,t){return function(e,t){const n=[...e.fields],r=[],i={numBatches:t.reduce((e,t)=>Math.max(e,t.length),0)};let s=0,o=0,a=-1;const l=t.length;let u,c=[];for(;i.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<l;)c[a]=u=t[a].shift(),o=Math.min(o,u?u.length:o);Number.isFinite(o)&&(c=Q_(n,o,c,t,i),o>0&&(r[s++]=Mv({type:new Em(n),length:o,nullCount:0,children:c.slice()})))}return[e=e.assign(n),r.map(t=>new J_(e,t))]}(e,t.map(e=>e.data.concat()))}function Q_(e,t,n,r,i){var s;const o=(t+63&-64)>>3;for(let a=-1,l=r.length;++a<l;){const l=n[a],u=null===l||void 0===l?void 0:l.length;if(u>=t)u===t?n[a]=l:(n[a]=l.slice(0,t),i.numBatches=Math.max(i.numBatches,r[a].unshift(l.slice(t,u-t))));else{const r=e[a];e[a]=r.clone({nullable:!0}),n[a]=null!==(s=null===l||void 0===l?void 0:l._changeLengthAndBackfillNullBitmap(t))&&void 0!==s?s:Mv({type:r.type,length:t,nullCount:t,nullBitmap:new Uint8Array(o)})}}return n}var X_,Y_,q_,K_;class Z_{constructor(){for(var e,t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(0===r.length)return this.batches=[],this.schema=new e_([]),this._offsets=[0],this;let s,o;r[0]instanceof e_&&(s=r.shift()),r.at(-1)instanceof Uint32Array&&(o=r.pop());const a=e=>{if(e){if(e instanceof J_)return[e];if(e instanceof Z_)return e.batches;if(e instanceof Rv){if(e.type instanceof Em)return[new J_(new e_(e.type.children),e)]}else{if(Array.isArray(e))return e.flatMap(e=>a(e));if("function"===typeof e[Symbol.iterator])return[...e].flatMap(e=>a(e));if("object"===typeof e){const t=Object.keys(e),n=t.map(t=>new Iv([e[t]])),r=null!==s&&void 0!==s?s:new e_(t.map((e,t)=>new t_(String(e),n[t].type,n[t].nullable))),[,i]=H_(r,n);return 0===i.length?[new J_(e)]:i}}}return[]},l=r.flatMap(e=>a(e));if(s=null!==(t=null!==s&&void 0!==s?s:null===(e=l[0])||void 0===e?void 0:e.schema)&&void 0!==t?t:new e_([]),!(s instanceof e_))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const u of l){if(!(u instanceof J_))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!W_(s,u.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=s,this.batches=l,this._offsets=null!==o&&void 0!==o?o:iv(this.data)}get data(){return this.batches.map(e=>{let{data:t}=e;return t})}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((e,t)=>e+t.length,0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=rv(this.data)),this._nullCount}isValid(e){return!1}get(e){return null}at(e){return this.get(Zy(e,this.numRows))}set(e,t){}indexOf(e,t){return-1}[Symbol.iterator](){return this.batches.length>0?Dv.visit(new Iv(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return"[\n  ".concat(this.toArray().join(",\n  "),"\n]")}concat(){const e=this.schema;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const i=this.data.concat(n.flatMap(e=>{let{data:t}=e;return t}));return new Z_(e,i.map(t=>new J_(e,t)))}slice(e,t){const n=this.schema;[e,t]=Ky({length:this.numRows},e,t);const r=sv(this.data,this._offsets,e,t);return new Z_(n,r.map(e=>new J_(n,e)))}getChild(e){return this.getChildAt(this.schema.fields.findIndex(t=>t.name===e))}getChildAt(e){if(e>-1&&e<this.schema.fields.length){const t=this.data.map(t=>t.children[e]);if(0===t.length){const{type:n}=this.schema.fields[e],r=Mv({type:n,length:0,nullCount:0});t.push(r._changeLengthAndBackfillNullBitmap(this.numRows))}return new Iv(t)}return null}setChild(e,t){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex(t=>t.name===e),t)}setChildAt(e,t){let n=this.schema,r=[...this.batches];if(e>-1&&e<this.numCols){t||(t=new Iv([Mv({type:new am,length:this.numRows})]));const i=n.fields.slice(),s=i[e].clone({type:t.type}),o=this.schema.fields.map((e,t)=>this.getChildAt(t));[i[e],o[e]]=[s,t],[n,r]=H_(n,o)}return new Z_(n,r)}select(e){const t=this.schema.fields.reduce((e,t,n)=>e.set(t.name,n),new Map);return this.selectAt(e.map(e=>t.get(e)).filter(e=>e>-1))}selectAt(e){const t=this.schema.selectAt(e),n=this.batches.map(t=>t.selectAt(e));return new Z_(t,n)}assign(e){const t=this.schema.fields,[n,r]=e.schema.fields.reduce((e,n,r)=>{const[i,s]=e,o=t.findIndex(e=>e.name===n.name);return~o?s[o]=r:i.push(r),e},[[],[]]),i=this.schema.assign(e.schema),s=[...t.map((e,t)=>[t,r[t]]).map(t=>{let[n,r]=t;return void 0===r?this.getChildAt(n):e.getChildAt(r)}),...n.map(t=>e.getChildAt(t))].filter(Boolean);return new Z_(...H_(i,s))}}X_=Symbol.toStringTag,Z_[X_]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=lv(av),e.get=lv(jy.getVisitFn(Vp.Struct)),e.set=uv(cy.getVisitFn(Vp.Struct)),e.indexOf=cv(bv.getVisitFn(Vp.Struct)),"Table"))(Z_.prototype);class J_{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];switch(t.length){case 2:if([this.schema]=t,!(this.schema instanceof e_))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Mv({nullCount:0,type:new Em(this.schema.fields),children:this.schema.fields.map(e=>Mv({type:e.type,nullCount:0}))})]=t,!(this.data instanceof Rv))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=$_(this.schema,this.data.children);break;case 1:{const[e]=t,{fields:n,children:r,length:i}=Object.keys(e).reduce((t,n,r)=>(t.children[r]=e[n],t.length=Math.max(t.length,e[n].length),t.fields[r]=t_.new({name:n,type:e[n].type,nullable:!0}),t),{length:0,fields:new Array,children:new Array}),s=new e_(n),o=Mv({type:new Em(n),length:i,children:r,nullCount:0});[this.schema,this.data]=$_(s,o.children,i);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=eb(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(e){return this.data.getValid(e)}get(e){return jy.visit(this.data,e)}at(e){return this.get(Zy(e,this.numRows))}set(e,t){return cy.visit(this.data,e,t)}indexOf(e,t){return bv.visit(this.data,e,t)}[Symbol.iterator](){return Dv.visit(new Iv([this.data]))}toArray(){return[...this]}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Z_(this.schema,[this,...t])}slice(e,t){const[n]=new Iv([this.data]).slice(e,t).data;return new J_(this.schema,n)}getChild(e){var t;return this.getChildAt(null===(t=this.schema.fields)||void 0===t?void 0:t.findIndex(t=>t.name===e))}getChildAt(e){return e>-1&&e<this.schema.fields.length?new Iv([this.data.children[e]]):null}setChild(e,t){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex(t=>t.name===e),t)}setChildAt(e,t){let n=this.schema,r=this.data;if(e>-1&&e<this.numCols){t||(t=new Iv([Mv({type:new am,length:this.numRows})]));const i=n.fields.slice(),s=r.children.slice(),o=i[e].clone({type:t.type});[i[e],s[e]]=[o,t.data[0]],n=new e_(i,new Map(this.schema.metadata)),r=Mv({type:new Em(i),children:s})}return new J_(n,r)}select(e){const t=this.schema.select(e),n=new Em(t.fields),r=[];for(const i of e){const e=this.schema.fields.findIndex(e=>e.name===i);~e&&(r[e]=this.data.children[e])}return new J_(t,Mv({type:n,length:this.numRows,children:r}))}selectAt(e){const t=this.schema.selectAt(e),n=e.map(e=>this.data.children[e]).filter(Boolean),r=Mv({type:new Em(t.fields),length:this.numRows,children:n});return new J_(t,r)}}function $_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.reduce((e,t)=>Math.max(e,t.length),0);var r;const i=[...e.fields],s=[...t],o=(n+63&-64)>>3;for(const[a,l]of e.fields.entries()){const e=t[a];e&&e.length===n||(i[a]=l.clone({nullable:!0}),s[a]=null!==(r=null===e||void 0===e?void 0:e._changeLengthAndBackfillNullBitmap(n))&&void 0!==r?r:Mv({type:l.type,length:n,nullCount:n,nullBitmap:new Uint8Array(o)}))}return[e.assign(i),Mv({type:new Em(i),length:n,children:s})]}function eb(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;var r,i;if((null!==(r=null===e||void 0===e?void 0:e.length)&&void 0!==r?r:0)>0&&(null===e||void 0===e?void 0:e.length)===(null===t||void 0===t?void 0:t.length))for(let s=-1,o=e.length;++s<o;){const{type:r}=e[s],o=t[s];for(const e of[o,...(null===(i=null===o||void 0===o?void 0:o.dictionary)||void 0===i?void 0:i.data)||[]])eb(r.children,null===e||void 0===e?void 0:e.children,n);if(om.isDictionary(r)){const{id:e}=r;if(n.has(e)){if(n.get(e)!==o.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else(null===o||void 0===o?void 0:o.dictionary)&&n.set(e,o.dictionary)}}return n}Y_=Symbol.toStringTag,J_[Y_]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(J_.prototype);class tb extends J_{constructor(e){const t=e.fields.map(e=>Mv({type:e.type}));super(e,Mv({type:new Em(e.fields),nullCount:0,children:t}))}}!function(e){e[e.BUFFER=0]="BUFFER"}(q_||(q_={})),function(e){e[e.LZ4_FRAME=0]="LZ4_FRAME",e[e.ZSTD=1]="ZSTD"}(K_||(K_={}));class nb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBodyCompression(e,t){return(t||new nb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBodyCompression(e,t){return e.setPosition(e.position()+4),(t||new nb).__init(e.readInt32(e.position())+e.position(),e)}codec(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):K_.LZ4_FRAME}method(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt8(this.bb_pos+e):q_.BUFFER}static startBodyCompression(e){e.startObject(2)}static addCodec(e,t){e.addFieldInt8(0,t,K_.LZ4_FRAME)}static addMethod(e,t){e.addFieldInt8(1,t,q_.BUFFER)}static endBodyCompression(e){return e.endObject()}static createBodyCompression(e,t,n){return nb.startBodyCompression(e),nb.addCodec(e,t),nb.addMethod(e,n),nb.endBodyCompression(e)}}class rb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(e,t,n){return e.prep(8,16),e.writeInt64(BigInt(null!==n&&void 0!==n?n:0)),e.writeInt64(BigInt(null!==t&&void 0!==t?t:0)),e.offset()}}class ib{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(e,t,n){return e.prep(8,16),e.writeInt64(BigInt(null!==n&&void 0!==n?n:0)),e.writeInt64(BigInt(null!==t&&void 0!==t?t:0)),e.offset()}}class sb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsRecordBatch(e,t){return(t||new sb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsRecordBatch(e,t){return e.setPosition(e.position()+4),(t||new sb).__init(e.readInt32(e.position())+e.position(),e)}length(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}nodes(e,t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new ib).__init(this.bb.__vector(this.bb_pos+n)+16*e,this.bb):null}nodesLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}buffers(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new rb).__init(this.bb.__vector(this.bb_pos+n)+16*e,this.bb):null}buffersLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}compression(e){const t=this.bb.__offset(this.bb_pos,10);return t?(e||new nb).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startRecordBatch(e){e.startObject(4)}static addLength(e,t){e.addFieldInt64(0,t,BigInt("0"))}static addNodes(e,t){e.addFieldOffset(1,t,0)}static startNodesVector(e,t){e.startVector(16,t,8)}static addBuffers(e,t){e.addFieldOffset(2,t,0)}static startBuffersVector(e,t){e.startVector(16,t,8)}static addCompression(e,t){e.addFieldOffset(3,t,0)}static endRecordBatch(e){return e.endObject()}}class ob{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryBatch(e,t){return(t||new ob).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryBatch(e,t){return e.setPosition(e.position()+4),(t||new ob).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}data(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new sb).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}isDelta(){const e=this.bb.__offset(this.bb_pos,8);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startDictionaryBatch(e){e.startObject(3)}static addId(e,t){e.addFieldInt64(0,t,BigInt("0"))}static addData(e,t){e.addFieldOffset(1,t,0)}static addIsDelta(e,t){e.addFieldInt8(2,+t,0)}static endDictionaryBatch(e){return e.endObject()}}class ab{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFloatingPoint(e,t){return(t||new ab).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFloatingPoint(e,t){return e.setPosition(e.position()+4),(t||new ab).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):kg.HALF}static startFloatingPoint(e){e.startObject(1)}static addPrecision(e,t){e.addFieldInt16(0,t,kg.HALF)}static endFloatingPoint(e){return e.endObject()}static createFloatingPoint(e,t){return ab.startFloatingPoint(e),ab.addPrecision(e,t),ab.endFloatingPoint(e)}}class lb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDecimal(e,t){return(t||new lb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDecimal(e,t){return e.setPosition(e.position()+4),(t||new lb).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}scale(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0}bitWidth(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):128}static startDecimal(e){e.startObject(3)}static addPrecision(e,t){e.addFieldInt32(0,t,0)}static addScale(e,t){e.addFieldInt32(1,t,0)}static addBitWidth(e,t){e.addFieldInt32(2,t,128)}static endDecimal(e){return e.endObject()}static createDecimal(e,t,n,r){return lb.startDecimal(e),lb.addPrecision(e,t),lb.addScale(e,n),lb.addBitWidth(e,r),lb.endDecimal(e)}}class ub{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDate(e,t){return(t||new ub).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDate(e,t){return e.setPosition(e.position()+4),(t||new ub).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Mg.MILLISECOND}static startDate(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,Mg.MILLISECOND)}static endDate(e){return e.endObject()}static createDate(e,t){return ub.startDate(e),ub.addUnit(e,t),ub.endDate(e)}}class cb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTime(e,t){return(t||new cb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTime(e,t){return e.setPosition(e.position()+4),(t||new cb).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Pg.MILLISECOND}bitWidth(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):32}static startTime(e){e.startObject(2)}static addUnit(e,t){e.addFieldInt16(0,t,Pg.MILLISECOND)}static addBitWidth(e,t){e.addFieldInt32(1,t,32)}static endTime(e){return e.endObject()}static createTime(e,t,n){return cb.startTime(e),cb.addUnit(e,t),cb.addBitWidth(e,n),cb.endTime(e)}}class Ab{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTimestamp(e,t){return(t||new Ab).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTimestamp(e,t){return e.setPosition(e.position()+4),(t||new Ab).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Pg.SECOND}timezone(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startTimestamp(e){e.startObject(2)}static addUnit(e,t){e.addFieldInt16(0,t,Pg.SECOND)}static addTimezone(e,t){e.addFieldOffset(1,t,0)}static endTimestamp(e){return e.endObject()}static createTimestamp(e,t,n){return Ab.startTimestamp(e),Ab.addUnit(e,t),Ab.addTimezone(e,n),Ab.endTimestamp(e)}}class hb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInterval(e,t){return(t||new hb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInterval(e,t){return e.setPosition(e.position()+4),(t||new hb).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Bg.YEAR_MONTH}static startInterval(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,Bg.YEAR_MONTH)}static endInterval(e){return e.endObject()}static createInterval(e,t){return hb.startInterval(e),hb.addUnit(e,t),hb.endInterval(e)}}class db{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDuration(e,t){return(t||new db).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDuration(e,t){return e.setPosition(e.position()+4),(t||new db).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Pg.MILLISECOND}static startDuration(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,Pg.MILLISECOND)}static endDuration(e){return e.endObject()}static createDuration(e,t){return db.startDuration(e),db.addUnit(e,t),db.endDuration(e)}}class fb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUnion(e,t){return(t||new fb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUnion(e,t){return e.setPosition(e.position()+4),(t||new fb).__init(e.readInt32(e.position())+e.position(),e)}mode(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Lg.Sparse}typeIds(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0}typeIdsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}typeIdsArray(){const e=this.bb.__offset(this.bb_pos,6);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}static startUnion(e){e.startObject(2)}static addMode(e,t){e.addFieldInt16(0,t,Lg.Sparse)}static addTypeIds(e,t){e.addFieldOffset(1,t,0)}static createTypeIdsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addInt32(t[n]);return e.endVector()}static startTypeIdsVector(e,t){e.startVector(4,t,4)}static endUnion(e){return e.endObject()}static createUnion(e,t,n){return fb.startUnion(e),fb.addMode(e,t),fb.addTypeIds(e,n),fb.endUnion(e)}}class pb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeBinary(e,t){return(t||new pb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeBinary(e,t){return e.setPosition(e.position()+4),(t||new pb).__init(e.readInt32(e.position())+e.position(),e)}byteWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeBinary(e){e.startObject(1)}static addByteWidth(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeBinary(e){return e.endObject()}static createFixedSizeBinary(e,t){return pb.startFixedSizeBinary(e),pb.addByteWidth(e,t),pb.endFixedSizeBinary(e)}}class gb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeList(e,t){return(t||new gb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeList(e,t){return e.setPosition(e.position()+4),(t||new gb).__init(e.readInt32(e.position())+e.position(),e)}listSize(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeList(e){e.startObject(1)}static addListSize(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeList(e){return e.endObject()}static createFixedSizeList(e,t){return gb.startFixedSizeList(e),gb.addListSize(e,t),gb.endFixedSizeList(e)}}class mb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMap(e,t){return(t||new mb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMap(e,t){return e.setPosition(e.position()+4),(t||new mb).__init(e.readInt32(e.position())+e.position(),e)}keysSorted(){const e=this.bb.__offset(this.bb_pos,4);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startMap(e){e.startObject(1)}static addKeysSorted(e,t){e.addFieldInt8(0,+t,0)}static endMap(e){return e.endObject()}static createMap(e,t){return mb.startMap(e),mb.addKeysSorted(e,t),mb.endMap(e)}}class yb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMessage(e,t){return(t||new yb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMessage(e,t){return e.setPosition(e.position()+4),(t||new yb).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Vv.V1}headerType(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):Bv.NONE}header(e){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}bodyLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,12);return n?(t||new Yv).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startMessage(e){e.startObject(5)}static addVersion(e,t){e.addFieldInt16(0,t,Vv.V1)}static addHeaderType(e,t){e.addFieldInt8(1,t,Bv.NONE)}static addHeader(e,t){e.addFieldOffset(2,t,0)}static addBodyLength(e,t){e.addFieldInt64(3,t,BigInt("0"))}static addCustomMetadata(e,t){e.addFieldOffset(4,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endMessage(e){return e.endObject()}static finishMessageBuffer(e,t){e.finish(t)}static finishSizePrefixedMessageBuffer(e,t){e.finish(t,void 0,!0)}static createMessage(e,t,n,r,i,s){return yb.startMessage(e),yb.addVersion(e,t),yb.addHeaderType(e,n),yb.addHeader(e,r),yb.addBodyLength(e,i),yb.addCustomMetadata(e,s),yb.endMessage(e)}}class vb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNull(e,t){return(t||new vb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNull(e,t){return e.setPosition(e.position()+4),(t||new vb).__init(e.readInt32(e.position())+e.position(),e)}static startNull(e){e.startObject(0)}static endNull(e){return e.endObject()}static createNull(e){return vb.startNull(e),vb.endNull(e)}}class _b{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBinary(e,t){return(t||new _b).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBinary(e,t){return e.setPosition(e.position()+4),(t||new _b).__init(e.readInt32(e.position())+e.position(),e)}static startBinary(e){e.startObject(0)}static endBinary(e){return e.endObject()}static createBinary(e){return _b.startBinary(e),_b.endBinary(e)}}class bb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsLargeBinary(e,t){return(t||new bb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsLargeBinary(e,t){return e.setPosition(e.position()+4),(t||new bb).__init(e.readInt32(e.position())+e.position(),e)}static startLargeBinary(e){e.startObject(0)}static endLargeBinary(e){return e.endObject()}static createLargeBinary(e){return bb.startLargeBinary(e),bb.endLargeBinary(e)}}class wb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBool(e,t){return(t||new wb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBool(e,t){return e.setPosition(e.position()+4),(t||new wb).__init(e.readInt32(e.position())+e.position(),e)}static startBool(e){e.startObject(0)}static endBool(e){return e.endObject()}static createBool(e){return wb.startBool(e),wb.endBool(e)}}class Eb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUtf8(e,t){return(t||new Eb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUtf8(e,t){return e.setPosition(e.position()+4),(t||new Eb).__init(e.readInt32(e.position())+e.position(),e)}static startUtf8(e){e.startObject(0)}static endUtf8(e){return e.endObject()}static createUtf8(e){return Eb.startUtf8(e),Eb.endUtf8(e)}}class xb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsLargeUtf8(e,t){return(t||new xb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsLargeUtf8(e,t){return e.setPosition(e.position()+4),(t||new xb).__init(e.readInt32(e.position())+e.position(),e)}static startLargeUtf8(e){e.startObject(0)}static endLargeUtf8(e){return e.endObject()}static createLargeUtf8(e){return xb.startLargeUtf8(e),xb.endLargeUtf8(e)}}class Db{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsList(e,t){return(t||new Db).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsList(e,t){return e.setPosition(e.position()+4),(t||new Db).__init(e.readInt32(e.position())+e.position(),e)}static startList(e){e.startObject(0)}static endList(e){return e.endObject()}static createList(e){return Db.startList(e),Db.endList(e)}}class Cb{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsStruct_(e,t){return(t||new Cb).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsStruct_(e,t){return e.setPosition(e.position()+4),(t||new Cb).__init(e.readInt32(e.position())+e.position(),e)}static startStruct_(e){e.startObject(0)}static endStruct_(e){return e.endObject()}static createStruct_(e){return Cb.startStruct_(e),Cb.endStruct_(e)}}const Sb=new class extends km{visit(e,t){return null==e||null==t?void 0:super.visit(e,t)}visitNull(e,t){return vb.startNull(t),vb.endNull(t)}visitInt(e,t){return qv.startInt(t),qv.addBitWidth(t,e.bitWidth),qv.addIsSigned(t,e.isSigned),qv.endInt(t)}visitFloat(e,t){return ab.startFloatingPoint(t),ab.addPrecision(t,e.precision),ab.endFloatingPoint(t)}visitBinary(e,t){return _b.startBinary(t),_b.endBinary(t)}visitLargeBinary(e,t){return bb.startLargeBinary(t),bb.endLargeBinary(t)}visitBool(e,t){return wb.startBool(t),wb.endBool(t)}visitUtf8(e,t){return Eb.startUtf8(t),Eb.endUtf8(t)}visitLargeUtf8(e,t){return xb.startLargeUtf8(t),xb.endLargeUtf8(t)}visitDecimal(e,t){return lb.startDecimal(t),lb.addScale(t,e.scale),lb.addPrecision(t,e.precision),lb.addBitWidth(t,e.bitWidth),lb.endDecimal(t)}visitDate(e,t){return ub.startDate(t),ub.addUnit(t,e.unit),ub.endDate(t)}visitTime(e,t){return cb.startTime(t),cb.addUnit(t,e.unit),cb.addBitWidth(t,e.bitWidth),cb.endTime(t)}visitTimestamp(e,t){const n=e.timezone&&t.createString(e.timezone)||void 0;return Ab.startTimestamp(t),Ab.addUnit(t,e.unit),void 0!==n&&Ab.addTimezone(t,n),Ab.endTimestamp(t)}visitInterval(e,t){return hb.startInterval(t),hb.addUnit(t,e.unit),hb.endInterval(t)}visitDuration(e,t){return db.startDuration(t),db.addUnit(t,e.unit),db.endDuration(t)}visitList(e,t){return Db.startList(t),Db.endList(t)}visitStruct(e,t){return Cb.startStruct_(t),Cb.endStruct_(t)}visitUnion(e,t){fb.startTypeIdsVector(t,e.typeIds.length);const n=fb.createTypeIdsVector(t,e.typeIds);return fb.startUnion(t),fb.addMode(t,e.mode),fb.addTypeIds(t,n),fb.endUnion(t)}visitDictionary(e,t){const n=this.visit(e.indices,t);return Kv.startDictionaryEncoding(t),Kv.addId(t,BigInt(e.id)),Kv.addIsOrdered(t,e.isOrdered),void 0!==n&&Kv.addIndexType(t,n),Kv.endDictionaryEncoding(t)}visitFixedSizeBinary(e,t){return pb.startFixedSizeBinary(t),pb.addByteWidth(t,e.byteWidth),pb.endFixedSizeBinary(t)}visitFixedSizeList(e,t){return gb.startFixedSizeList(t),gb.addListSize(t,e.listSize),gb.endFixedSizeList(t)}visitMap(e,t){return mb.startMap(t),mb.addKeysSorted(t,e.keysSorted),mb.endMap(t)}};function Tb(e){return new Nb(e.count,Fb(e.columns),Rb(e.columns))}function Ib(e,t){return(e.children||[]).filter(Boolean).map(e=>t_.fromJSON(e,t))}function Fb(e){return(e||[]).reduce((e,t)=>{return[...e,new jb(t.count,(n=t.VALIDITY,(n||[]).reduce((e,t)=>e+ +(0===t),0))),...Fb(t.children)];var n},[])}function Rb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let n=-1,r=(e||[]).length;++n<r;){const r=e[n];r.VALIDITY&&t.push(new zb(t.length,r.VALIDITY.length)),r.TYPE_ID&&t.push(new zb(t.length,r.TYPE_ID.length)),r.OFFSET&&t.push(new zb(t.length,r.OFFSET.length)),r.DATA&&t.push(new zb(t.length,r.DATA.length)),t=Rb(r.children,t)}return t}function kb(){return new Map((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>{let{key:t,value:n}=e;return[t,n]}))}function Pb(e){return new lm(e.isSigned,e.bitWidth)}function Mb(e,t){const n=e.type.name;switch(n){case"NONE":case"null":return new am;case"binary":return new Am;case"largebinary":return new hm;case"utf8":return new dm;case"largeutf8":return new fm;case"bool":return new pm;case"list":return new wm((t||[])[0]);case"struct":case"struct_":return new Em(t||[])}switch(n){case"int":{const t=e.type;return new lm(t.isSigned,t.bitWidth)}case"floatingpoint":{const t=e.type;return new cm(kg[t.precision])}case"decimal":{const t=e.type;return new gm(t.scale,t.precision,t.bitWidth)}case"date":{const t=e.type;return new mm(Mg[t.unit])}case"time":{const t=e.type;return new ym(Pg[t.unit],t.bitWidth)}case"timestamp":{const t=e.type;return new vm(Pg[t.unit],t.timezone)}case"interval":{const t=e.type;return new _m(Bg[t.unit])}case"duration":{const t=e.type;return new bm(Pg[t.unit])}case"union":{const n=e.type,[r,...i]=(n.mode+"").toLowerCase(),s=r.toUpperCase()+i.join("");return new xm(Lg[s],n.typeIds||[],t||[])}case"fixedsizebinary":{const t=e.type;return new Dm(t.byteWidth)}case"fixedsizelist":{const n=e.type;return new Cm(n.listSize,(t||[])[0])}case"map":{const n=e.type;return new Sm((t||[])[0],n.keysSorted)}}throw new Error('Unrecognized type: "'.concat(n,'"'))}var Bb=Xv,Lb=Qv;class Ob{static fromJSON(e,t){const n=new Ob(0,Vv.V5,t);return n._createHeader=function(e,t){return()=>{switch(t){case Bv.Schema:return e_.fromJSON(e);case Bv.RecordBatch:return Nb.fromJSON(e);case Bv.DictionaryBatch:return Ub.fromJSON(e)}throw new Error("Unrecognized Message type: { name: ".concat(Bv[t],", type: ").concat(t," }"))}}(e,t),n}static decode(e){e=new Lb(pg(e));const t=yb.getRootAsMessage(e),n=t.bodyLength(),r=t.version(),i=t.headerType(),s=new Ob(n,r,i);return s._createHeader=function(e,t){return()=>{switch(t){case Bv.Schema:return e_.decode(e.header(new Jv),new Map,e.version());case Bv.RecordBatch:return Nb.decode(e.header(new sb),e.version());case Bv.DictionaryBatch:return Ub.decode(e.header(new ob),e.version())}throw new Error("Unrecognized Message type: { name: ".concat(Bv[t],", type: ").concat(t," }"))}}(t,i),s}static encode(e){const t=new Bb;let n=-1;return e.isSchema()?n=e_.encode(t,e.header()):e.isRecordBatch()?n=Nb.encode(t,e.header()):e.isDictionaryBatch()&&(n=Ub.encode(t,e.header())),yb.startMessage(t),yb.addVersion(t,Vv.V5),yb.addHeader(t,n),yb.addHeaderType(t,e.headerType),yb.addBodyLength(t,BigInt(e.bodyLength)),yb.finishMessageBuffer(t,yb.endMessage(t)),t.asUint8Array()}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e instanceof e_)return new Ob(0,Vv.V5,Bv.Schema,e);if(e instanceof Nb)return new Ob(t,Vv.V5,Bv.RecordBatch,e);if(e instanceof Ub)return new Ob(t,Vv.V5,Bv.DictionaryBatch,e);throw new Error("Unrecognized Message header: ".concat(e))}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Bv.Schema}isRecordBatch(){return this.headerType===Bv.RecordBatch}isDictionaryBatch(){return this.headerType===Bv.DictionaryBatch}constructor(e,t,n,r){this._version=t,this._headerType=n,this.body=new Uint8Array(0),r&&(this._createHeader=()=>r),this._bodyLength=_g(e)}}class Nb{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(e,t,n){this._nodes=t,this._buffers=n,this._length=_g(e)}}class Ub{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._data=e,this._isDelta=n,this._id=_g(t)}}class zb{constructor(e,t){this.offset=_g(e),this.length=_g(t)}}class jb{constructor(e,t){this.length=_g(e),this.nullCount=_g(t)}}function Vb(e,t){const n=[];for(let r,i=-1,s=-1,o=e.childrenLength();++i<o;)(r=e.children(i))&&(n[++s]=t_.decode(r,t));return n}function Gb(e){const t=new Map;if(e)for(let n,r,i=-1,s=Math.trunc(e.customMetadataLength());++i<s;)(n=e.customMetadata(i))&&null!=(r=n.key())&&t.set(r,n.value());return t}function Wb(e){return new lm(e.isSigned(),e.bitWidth())}function Hb(e,t){const n=e.typeType();switch(n){case Hv.NONE:case Hv.Null:return new am;case Hv.Binary:return new Am;case Hv.LargeBinary:return new hm;case Hv.Utf8:return new dm;case Hv.LargeUtf8:return new fm;case Hv.Bool:return new pm;case Hv.List:return new wm((t||[])[0]);case Hv.Struct_:return new Em(t||[])}switch(n){case Hv.Int:{const t=e.type(new qv);return new lm(t.isSigned(),t.bitWidth())}case Hv.FloatingPoint:{const t=e.type(new ab);return new cm(t.precision())}case Hv.Decimal:{const t=e.type(new lb);return new gm(t.scale(),t.precision(),t.bitWidth())}case Hv.Date:{const t=e.type(new ub);return new mm(t.unit())}case Hv.Time:{const t=e.type(new cb);return new ym(t.unit(),t.bitWidth())}case Hv.Timestamp:{const t=e.type(new Ab);return new vm(t.unit(),t.timezone())}case Hv.Interval:{const t=e.type(new hb);return new _m(t.unit())}case Hv.Duration:{const t=e.type(new db);return new bm(t.unit())}case Hv.Union:{const n=e.type(new fb);return new xm(n.mode(),n.typeIdsArray()||[],t||[])}case Hv.FixedSizeBinary:{const t=e.type(new pb);return new Dm(t.byteWidth())}case Hv.FixedSizeList:{const n=e.type(new gb);return new Cm(n.listSize(),(t||[])[0])}case Hv.Map:{const n=e.type(new mb);return new Sm((t||[])[0],n.keysSorted())}}throw new Error('Unrecognized type: "'.concat(Hv[n],'" (').concat(n,")"))}t_.encode=function(e,t){let n=-1,r=-1,i=-1;const s=t.type;let o=t.typeId;om.isDictionary(s)?(o=s.dictionary.typeId,i=Sb.visit(s,e),r=Sb.visit(s.dictionary,e)):r=Sb.visit(s,e);const a=(s.children||[]).map(t=>t_.encode(e,t)),l=Zv.createChildrenVector(e,a),u=t.metadata&&t.metadata.size>0?Zv.createCustomMetadataVector(e,[...t.metadata].map(t=>{let[n,r]=t;const i=e.createString("".concat(n)),s=e.createString("".concat(r));return Yv.startKeyValue(e),Yv.addKey(e,i),Yv.addValue(e,s),Yv.endKeyValue(e)})):-1;t.name&&(n=e.createString(t.name));Zv.startField(e),Zv.addType(e,r),Zv.addTypeType(e,o),Zv.addChildren(e,l),Zv.addNullable(e,!!t.nullable),-1!==n&&Zv.addName(e,n);-1!==i&&Zv.addDictionary(e,i);-1!==u&&Zv.addCustomMetadata(e,u);return Zv.endField(e)},t_.decode=function(e,t){let n,r,i,s,o,a;t&&(a=e.dictionary())?t.has(n=_g(a.id()))?(s=(s=a.indexType())?Wb(s):new um,o=new Fm(t.get(n),s,n,a.isOrdered()),r=new t_(e.name(),o,e.nullable(),Gb(e))):(s=(s=a.indexType())?Wb(s):new um,t.set(n,i=Hb(e,Vb(e,t))),o=new Fm(i,s,n,a.isOrdered()),r=new t_(e.name(),o,e.nullable(),Gb(e))):(i=Hb(e,Vb(e,t)),r=new t_(e.name(),i,e.nullable(),Gb(e)));return r||null},t_.fromJSON=function(e,t){let n,r,i,s,o,a;return t&&(s=e.dictionary)?t.has(n=s.id)?(r=(r=s.indexType)?Pb(r):new um,a=new Fm(t.get(n),r,n,s.isOrdered),i=new t_(e.name,a,e.nullable,kb(e.metadata))):(r=(r=s.indexType)?Pb(r):new um,t.set(n,o=Mb(e,Ib(e,t))),a=new Fm(o,r,n,s.isOrdered),i=new t_(e.name,a,e.nullable,kb(e.metadata))):(o=Mb(e,Ib(e,t)),i=new t_(e.name,o,e.nullable,kb(e.metadata))),i||null},e_.encode=function(e,t){const n=t.fields.map(t=>t_.encode(e,t));Jv.startFieldsVector(e,n.length);const r=Jv.createFieldsVector(e,n),i=t.metadata&&t.metadata.size>0?Jv.createCustomMetadataVector(e,[...t.metadata].map(t=>{let[n,r]=t;const i=e.createString("".concat(n)),s=e.createString("".concat(r));return Yv.startKeyValue(e),Yv.addKey(e,i),Yv.addValue(e,s),Yv.endKeyValue(e)})):-1;Jv.startSchema(e),Jv.addFields(e,r),Jv.addEndianness(e,Qb?Gv.Little:Gv.Big),-1!==i&&Jv.addCustomMetadata(e,i);return Jv.endSchema(e)},e_.decode=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vv.V5;const r=function(e,t){const n=[];for(let r,i=-1,s=-1,o=e.fieldsLength();++i<o;)(r=e.fields(i))&&(n[++s]=t_.decode(r,t));return n}(e,t);return new e_(r,Gb(e),t,n)},e_.fromJSON=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;return new e_(function(e,t){return(e.fields||[]).filter(Boolean).map(e=>t_.fromJSON(e,t))}(e,t),kb(e.metadata),t)},Nb.encode=function(e,t){const n=t.nodes||[],r=t.buffers||[];sb.startNodesVector(e,n.length);for(const o of n.slice().reverse())jb.encode(e,o);const i=e.endVector();sb.startBuffersVector(e,r.length);for(const o of r.slice().reverse())zb.encode(e,o);const s=e.endVector();return sb.startRecordBatch(e),sb.addLength(e,BigInt(t.length)),sb.addNodes(e,i),sb.addBuffers(e,s),sb.endRecordBatch(e)},Nb.decode=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vv.V5;if(null!==e.compression())throw new Error("Record batch compression not implemented");return new Nb(e.length(),function(e){const t=[];for(let n,r=-1,i=-1,s=e.nodesLength();++r<s;)(n=e.nodes(r))&&(t[++i]=jb.decode(n));return t}(e),function(e,t){const n=[];for(let r,i=-1,s=-1,o=e.buffersLength();++i<o;)(r=e.buffers(i))&&(t<Vv.V4&&(r.bb_pos+=8*(i+1)),n[++s]=zb.decode(r));return n}(e,t))},Nb.fromJSON=Tb,Ub.encode=function(e,t){const n=Nb.encode(e,t.data);return ob.startDictionaryBatch(e),ob.addId(e,BigInt(t.id)),ob.addIsDelta(e,t.isDelta),ob.addData(e,n),ob.endDictionaryBatch(e)},Ub.decode=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vv.V5;return new Ub(Nb.decode(e.data(),t),e.id(),e.isDelta())},Ub.fromJSON=function(e){return new Ub(Tb(e.data),e.id,e.isDelta)},jb.encode=function(e,t){return ib.createFieldNode(e,BigInt(t.length),BigInt(t.nullCount))},jb.decode=function(e){return new jb(e.length(),e.nullCount())},zb.encode=function(e,t){return rb.createBuffer(e,BigInt(t.offset),BigInt(t.length))},zb.decode=function(e){return new zb(e.offset(),e.length())};const Qb=(()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]})(),Xb=e=>"Expected ".concat(Bv[e]," Message in stream, but was null or length 0."),Yb=e=>"Header pointer of flatbuffer-encoded ".concat(Bv[e]," Message is null or length 0."),qb=(e,t)=>"Expected to read ".concat(e," metadata bytes, but only read ").concat(t,"."),Kb=(e,t)=>"Expected to read ".concat(e," bytes for message body, but only read ").concat(t,".");class Zb{constructor(e){this.source=e instanceof y_?e:new y_(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||-1===e.value&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?d_:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(Xb(e));return t.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);const t=pg(this.source.read(e));if(t.byteLength<e)throw new Error(Kb(e,t.byteLength));return t.byteOffset%8===0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()}readSchema(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Bv.Schema,n=this.readMessage(t),r=null===n||void 0===n?void 0:n.header();if(e&&!r)throw new Error(Yb(t));return r}readMetadataLength(){const e=this.source.read(ew),t=e&&new Qv(e),n=(null===t||void 0===t?void 0:t.readInt32(0))||0;return{done:0===n,value:n}}readMetadata(e){const t=this.source.read(e);if(!t)return d_;if(t.byteLength<e)throw new Error(qb(e,t.byteLength));return{done:!1,value:Ob.decode(t)}}}class Jb{constructor(e,t){this.source=e instanceof v_?e:ig(e)?new E_(e,t):new v_(e)}[Symbol.asyncIterator](){return this}next(){return Lp(this,void 0,void 0,function*(){let e;return(e=yield this.readMetadataLength()).done||-1===e.value&&(e=yield this.readMetadataLength()).done||(e=yield this.readMetadata(e.value)).done?d_:e})}throw(e){return Lp(this,void 0,void 0,function*(){return yield this.source.throw(e)})}return(e){return Lp(this,void 0,void 0,function*(){return yield this.source.return(e)})}readMessage(e){return Lp(this,void 0,void 0,function*(){let t;if((t=yield this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(Xb(e));return t.value})}readMessageBody(e){return Lp(this,void 0,void 0,function*(){if(e<=0)return new Uint8Array(0);const t=pg(yield this.source.read(e));if(t.byteLength<e)throw new Error(Kb(e,t.byteLength));return t.byteOffset%8===0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()})}readSchema(){return Lp(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function*(){const n=Bv.Schema,r=yield e.readMessage(n),i=null===r||void 0===r?void 0:r.header();if(t&&!i)throw new Error(Yb(n));return i}()})}readMetadataLength(){return Lp(this,void 0,void 0,function*(){const e=yield this.source.read(ew),t=e&&new Qv(e),n=(null===t||void 0===t?void 0:t.readInt32(0))||0;return{done:0===n,value:n}})}readMetadata(e){return Lp(this,void 0,void 0,function*(){const t=yield this.source.read(e);if(!t)return d_;if(t.byteLength<e)throw new Error(qb(e,t.byteLength));return{done:!1,value:Ob.decode(t)}})}}class $b extends Zb{constructor(e){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof f_?e:new f_(e)}next(){const{_json:e}=this;if(!this._schema){this._schema=!0;return{done:!1,value:Ob.fromJSON(e.schema,Bv.Schema)}}if(this._dictionaryIndex<e.dictionaries.length){const t=e.dictionaries[this._dictionaryIndex++];this._body=t.data.columns;return{done:!1,value:Ob.fromJSON(t,Bv.DictionaryBatch)}}if(this._batchIndex<e.batches.length){const t=e.batches[this._batchIndex++];this._body=t.columns;return{done:!1,value:Ob.fromJSON(t,Bv.RecordBatch)}}return this._body=[],d_}readMessageBody(e){return function e(t){return(t||[]).reduce((t,n)=>[...t,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE_ID&&[n.TYPE_ID]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...e(n.children)],[])}(this._body)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(Xb(e));return t.value}readSchema(){const e=Bv.Schema,t=this.readMessage(e),n=null===t||void 0===t?void 0:t.header();if(!t||!n)throw new Error(Yb(e));return n}}const ew=4,tw="ARROW1",nw=new Uint8Array(6);for(let iB=0;iB<6;iB+=1)nw[iB]=tw.codePointAt(iB);function rw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=-1,r=nw.length;++n<r;)if(nw[n]!==e[t+n])return!1;return!0}const iw=nw.length,sw=iw+ew,ow=2*iw+ew;class aw extends p_{constructor(e){super(),this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){const t=this._impl.open(e);return $p(t)?t.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return u_.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return u_.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof aw?e:ng(e)?function(e){return new lw(new mw(e))}(e):ig(e)?function(e){return Lp(this,void 0,void 0,function*(){const{size:t}=yield e.stat(),n=new E_(e,t);return t>=ow&&rw(yield n.readAt(0,iw+7&-8))?new Aw(new gw(n)):new uw(new fw(n))})}(e):$p(e)?(()=>Lp(this,void 0,void 0,function*(){return yield aw.from(yield e)}))():sg(e)||ag(e)||lg(e)||tg(e)?function(e){return Lp(this,void 0,void 0,function*(){const t=yield e.peek(iw+7&-8);return t&&t.byteLength>=4?rw(t)?new cw(new pw(yield e.read())):new uw(new fw(e)):new uw(new fw(function(){return Up(this,arguments,function*(){})}()))})}(new v_(e)):function(e){const t=e.peek(iw+7&-8);return t&&t.byteLength>=4?rw(t)?new cw(new pw(e.read())):new lw(new dw(e)):new lw(new dw(function*(){}()))}(new y_(e))}static readAll(e){return e instanceof aw?e.isSync()?vw(e):_w(e):ng(e)||ArrayBuffer.isView(e)||eg(e)||rg(e)?vw(e):_w(e)}}class lw extends aw{constructor(e){super(e),this._impl=e}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return Up(this,arguments,function*(){yield Np(yield*zp(jp(this[Symbol.iterator]())))})}}class uw extends aw{constructor(e){super(e),this._impl=e}readAll(){return Lp(this,void 0,void 0,function*(){var e,t,n,r;const i=new Array;try{for(var s,o=!0,a=jp(this);!(e=(s=yield a.next()).done);o=!0){r=s.value,o=!1;const e=r;i.push(e)}}catch(l){t={error:l}}finally{try{o||e||!(n=a.return)||(yield n.call(a))}finally{if(t)throw t.error}}return i})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class cw extends lw{constructor(e){super(e),this._impl=e}}class Aw extends uw{constructor(e){super(e),this._impl=e}}class hw{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,t){const n=this._loadVectors(e,t,this.schema.fields),r=Mv({type:new Em(this.schema.fields),length:e.length,children:n});return new J_(this.schema,r)}_loadDictionaryBatch(e,t){const{id:n,isDelta:r}=e,{dictionaries:i,schema:s}=this,o=i.get(n),a=s.dictionaries.get(n),l=this._loadVectors(e.data,t,[a]);return(o&&r?o.concat(new Iv(l)):new Iv(l)).memoize()}_loadVectors(e,t,n){return new F_(t,e.nodes,e.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(n)}}class dw extends hw{constructor(e,t){super(t),this._reader=ng(e)?new $b(this._handle=e):new Zb(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=yw(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):d_}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):d_}next(){if(this.closed)return d_;let e;const{_reader:t}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const n=e.header(),r=t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const n=e.header(),r=t.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new tb(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}}class fw extends hw{constructor(e,t){super(t),this._reader=new Jb(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return Lp(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(e){return Lp(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=yw(this,e),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(e){return Lp(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(e):d_})}return(e){return Lp(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(e):d_})}next(){return Lp(this,void 0,void 0,function*(){if(this.closed)return d_;let e;const{_reader:t}=this;for(;e=yield this._readNextMessageAndValidate();)if(e.isSchema())yield this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const n=e.header(),r=yield t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const n=e.header(),r=yield t.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new tb(this.schema)}):yield this.return()})}_readNextMessageAndValidate(e){return Lp(this,void 0,void 0,function*(){return yield this._reader.readMessage(e)})}}class pw extends dw{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(e,t){super(e instanceof w_?e:new w_(e),t)}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){var t;if(this.closed)return null;this._footer||this.open();const n=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(e);if(n&&this._handle.seek(n.offset)){const e=this._reader.readMessage(Bv.RecordBatch);if(null===e||void 0===e?void 0:e.isRecordBatch()){const t=e.header(),n=this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,n)}}return null}_readDictionaryBatch(e){var t;const n=null===(t=this._footer)||void 0===t?void 0:t.getDictionaryBatch(e);if(n&&this._handle.seek(n.offset)){const e=this._reader.readMessage(Bv.DictionaryBatch);if(null===e||void 0===e?void 0:e.isDictionaryBatch()){const t=e.header(),n=this._reader.readMessageBody(e.bodyLength),r=this._loadDictionaryBatch(t,n);this.dictionaries.set(t.id,r)}}}_readFooter(){const{_handle:e}=this,t=e.size-sw,n=e.readInt32(t),r=e.readAt(t-n,n);return o_.decode(r)}_readNextMessageAndValidate(e){var t;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(e)}return null}}class gw extends fw{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i="number"!==typeof n[0]?n.shift():void 0,s=n[0]instanceof Map?n.shift():void 0;super(e instanceof E_?e:new E_(e,i),s)}isFile(){return!0}isAsync(){return!0}open(e){const t=Object.create(null,{open:{get:()=>super.open}});return Lp(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield t.open.call(this,e)})}readRecordBatch(e){return Lp(this,void 0,void 0,function*(){var t;if(this.closed)return null;this._footer||(yield this.open());const n=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(e);if(n&&(yield this._handle.seek(n.offset))){const e=yield this._reader.readMessage(Bv.RecordBatch);if(null===e||void 0===e?void 0:e.isRecordBatch()){const t=e.header(),n=yield this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,n)}}return null})}_readDictionaryBatch(e){return Lp(this,void 0,void 0,function*(){var t;const n=null===(t=this._footer)||void 0===t?void 0:t.getDictionaryBatch(e);if(n&&(yield this._handle.seek(n.offset))){const e=yield this._reader.readMessage(Bv.DictionaryBatch);if(null===e||void 0===e?void 0:e.isDictionaryBatch()){const t=e.header(),n=yield this._reader.readMessageBody(e.bodyLength),r=this._loadDictionaryBatch(t,n);this.dictionaries.set(t.id,r)}}})}_readFooter(){return Lp(this,void 0,void 0,function*(){const{_handle:e}=this;e._pending&&(yield e._pending);const t=e.size-sw,n=yield e.readInt32(t),r=yield e.readAt(t-n,n);return o_.decode(r)})}_readNextMessageAndValidate(e){return Lp(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const t=this._footer.getRecordBatch(this._recordBatchIndex);if(t&&(yield this._handle.seek(t.offset)))return yield this._reader.readMessage(e)}return null})}}class mw extends dw{constructor(e,t){super(e,t)}_loadVectors(e,t,n){return new R_(t,e.nodes,e.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(n)}}function yw(e,t){return t&&"boolean"===typeof t.autoDestroy?t.autoDestroy:e.autoDestroy}function*vw(e){const t=aw.from(e);try{if(!t.open({autoDestroy:!1}).closed)do{yield t}while(!t.reset().open().closed)}finally{t.cancel()}}function _w(e){return Up(this,arguments,function*(){const t=yield Np(aw.from(e));try{if(!(yield Np(t.open({autoDestroy:!1}))).closed)do{yield yield Np(t)}while(!(yield Np(t.reset().open())).closed)}finally{yield Np(t.cancel())}})}class bw extends km{static assemble(){const e=t=>t.flatMap(t=>Array.isArray(t)?e(t):t instanceof J_?t.data.children:t.data),t=new bw;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.visitMany(e(r)),t}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(e){if(e instanceof Iv)return this.visitMany(e.data),this;const{type:t}=e;if(!om.isDictionary(t)){const{length:n}=e;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(om.isUnion(t))this.nodes.push(new jb(n,0));else{const{nullCount:r}=e;om.isNull(t)||ww.call(this,r<=0?new Uint8Array(0):dv(e.offset,n,e.nullBitmap)),this.nodes.push(new jb(n,r))}}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.clone(e.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function ww(e){const t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new zb(this._byteLength,t)),this._byteLength+=t,this}function Ew(e){return ww.call(this,e.values.subarray(0,e.length*e.stride))}function xw(e){const{length:t,values:n,valueOffsets:r}=e,i=_g(r[0]),s=_g(r[t]),o=Math.min(s-i,n.byteLength-i);return ww.call(this,vg(-i,t+1,r)),ww.call(this,n.subarray(i,i+o)),this}function Dw(e){const{length:t,valueOffsets:n}=e;if(n){const{0:r,[t]:i}=n;return ww.call(this,vg(-r,t+1,n)),this.visit(e.children[0].slice(r,i-r))}return this.visit(e.children[0])}function Cw(e){return this.visitMany(e.type.children.map((t,n)=>e.children[n]).filter(Boolean))[0]}bw.prototype.visitBool=function(e){let t;return e.nullCount>=e.length?ww.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?ww.call(this,dv(e.offset,e.length,t)):ww.call(this,fv(e.values))},bw.prototype.visitInt=Ew,bw.prototype.visitFloat=Ew,bw.prototype.visitUtf8=xw,bw.prototype.visitLargeUtf8=xw,bw.prototype.visitBinary=xw,bw.prototype.visitLargeBinary=xw,bw.prototype.visitFixedSizeBinary=Ew,bw.prototype.visitDate=Ew,bw.prototype.visitTimestamp=Ew,bw.prototype.visitTime=Ew,bw.prototype.visitDecimal=Ew,bw.prototype.visitList=Dw,bw.prototype.visitStruct=Cw,bw.prototype.visitUnion=function(e){var t;const{type:n,length:r,typeIds:i,valueOffsets:s}=e;if(ww.call(this,i),n.mode===Lg.Sparse)return Cw.call(this,e);if(n.mode===Lg.Dense){if(e.offset<=0)return ww.call(this,s),Cw.call(this,e);{const o=new Int32Array(r),a=Object.create(null),l=Object.create(null);for(let e,n,u=-1;++u<r;)void 0!==(e=i[u])&&(void 0===(n=a[e])&&(n=a[e]=s[u]),o[u]=s[u]-n,l[e]=(null!==(t=l[e])&&void 0!==t?t:0)+1);ww.call(this,o),this.visitMany(e.children.map((e,t)=>{const i=n.typeIds[t],s=a[i],o=l[i];return e.slice(s,Math.min(r,o))}))}}return this},bw.prototype.visitInterval=Ew,bw.prototype.visitDuration=Ew,bw.prototype.visitFixedSizeList=Dw,bw.prototype.visitMap=Dw;class Sw extends p_{static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}constructor(e){super(),this._position=0,this._started=!1,this._sink=new m_,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,Jp(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy="boolean"!==typeof e.autoDestroy||e.autoDestroy,this._writeLegacyIpcFormat="boolean"===typeof e.writeLegacyIpcFormat&&e.writeLegacyIpcFormat}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sink.toString(e)}toUint8Array(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sink.toUint8Array(e)}writeAll(e){return $p(e)?e.then(e=>this.writeAll(e)):tg(e)?Rw(this,e):Fw(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._sink,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e===this._sink||e instanceof m_?this._sink=e:(this._sink=new m_,e&&(e=>Jp(e)&&Zp(e.abort)&&Zp(e.getWriter)&&!og(e))(e)?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&(e=>Jp(e)&&Zp(e.end)&&Zp(e.write)&&Kp(e.writable)&&!og(e))(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,t&&W_(t,this._schema)||(null==t?(this._position=0,this._schema=null):(this._started=!0,this._schema=t,this._writeSchema(t))),this}write(e){let t=null;if(!this._sink)throw new Error("RecordBatchWriter is closed");if(null==e)return this.finish()&&void 0;if(e instanceof Z_&&!(t=e.schema))return this.finish()&&void 0;if(e instanceof J_&&!(t=e.schema))return this.finish()&&void 0;if(t&&!W_(t,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,t)}e instanceof J_?e instanceof tb||this._writeRecordBatch(e):e instanceof Z_?this.writeAll(e.batches):eg(e)&&this.writeAll(e)}_writeMessage(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-1,n=Ob.encode(e),r=n.byteLength,i=this._writeLegacyIpcFormat?4:8,s=r+i+t&~t,o=s-r-i;return e.headerType===Bv.RecordBatch?this._recordBatchBlocks.push(new l_(s,e.bodyLength,this._position)):e.headerType===Bv.DictionaryBatch&&this._dictionaryBlocks.push(new l_(s,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(s-i)),r>0&&this._write(n),this._writePadding(o)}_write(e){if(this._started){const t=pg(e);t&&t.byteLength>0&&(this._sink.write(t),this._position+=t.byteLength)}return this}_writeSchema(e){return this._writeMessage(Ob.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(nw)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){const{byteLength:t,nodes:n,bufferRegions:r,buffers:i}=bw.assemble(e),s=new Nb(e.numRows,n,r),o=Ob.from(s,t);return this._writeDictionaries(e)._writeMessage(o)._writeBodyBuffers(i)}_writeDictionaryBatch(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{byteLength:r,nodes:i,bufferRegions:s,buffers:o}=bw.assemble(new Iv([e])),a=new Nb(e.length,i,s),l=new Ub(a,t,n),u=Ob.from(l,r);return this._writeMessage(u)._writeBodyBuffers(o)}_writeBodyBuffers(e){let t,n,r;for(let i=-1,s=e.length;++i<s;)(t=e[i])&&(n=t.byteLength)>0&&(this._write(t),(r=(n+7&-8)-n)>0&&this._writePadding(r));return this}_writeDictionaries(e){var t,n;for(const[r,i]of e.dictionaries){const e=null!==(t=null===i||void 0===i?void 0:i.data)&&void 0!==t?t:[],s=this._seenDictionaries.get(r),o=null!==(n=this._dictionaryDeltaOffsets.get(r))&&void 0!==n?n:0;if(s&&s.data[0]===e[0]){if(o<e.length)for(const t of e.slice(o))this._writeDictionaryBatch(t,r,!0)}else for(const[t,n]of e.entries())this._writeDictionaryBatch(n,r,t>0);this._seenDictionaries.set(r,i),this._dictionaryDeltaOffsets.set(r,e.length)}return this}}class Tw extends Sw{static writeAll(e,t){const n=new Tw(t);return $p(e)?e.then(e=>n.writeAll(e)):tg(e)?Rw(n,e):Fw(n,e)}}class Iw extends Sw{static writeAll(e){const t=new Iw;return $p(e)?e.then(e=>t.writeAll(e)):tg(e)?Rw(t,e):Fw(t,e)}constructor(){super(),this._autoDestroy=!0}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeDictionaryBatch(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n&&this._seenDictionaries.has(t))throw new Error("The Arrow File format does not support replacement dictionaries. ");return super._writeDictionaryBatch(e,t,n)}_writeFooter(e){const t=o_.encode(new o_(e,Vv.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(t)._write(Int32Array.of(t.byteLength))._writeMagic()}}function Fw(e,t){let n=t;t instanceof Z_&&(n=t.batches,e.reset(void 0,t.schema));for(const r of n)e.write(r);return e.finish()}function Rw(e,t){return Lp(this,void 0,void 0,function*(){var n,r,i,s,o,a,l;try{for(n=!0,r=jp(t);!(s=(i=yield r.next()).done);n=!0){l=i.value,n=!1;const t=l;e.write(t)}}catch(u){o={error:u}}finally{try{n||s||!(a=r.return)||(yield a.call(r))}finally{if(o)throw o.error}}return e.finish()})}var kw=Object.create,Pw=Object.defineProperty,Mw=Object.getOwnPropertyDescriptor,Bw=Object.getOwnPropertyNames,Lw=Object.getPrototypeOf,Ow=Object.prototype.hasOwnProperty,Nw=((e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports))((e,t)=>{t.exports=Worker}),Uw=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.AUTOMATIC=1]="AUTOMATIC",e[e.READ_ONLY=2]="READ_ONLY",e[e.READ_WRITE=3]="READ_WRITE",e))(Uw||{}),zw=(e=>(e[e.IDENTIFIER=0]="IDENTIFIER",e[e.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",e[e.STRING_CONSTANT=2]="STRING_CONSTANT",e[e.OPERATOR=3]="OPERATOR",e[e.KEYWORD=4]="KEYWORD",e[e.COMMENT=5]="COMMENT",e))(zw||{}),jw=(e=>(e[e.NONE=0]="NONE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR",e))(jw||{}),Vw=(e=>(e[e.NONE=0]="NONE",e[e.CONNECT=1]="CONNECT",e[e.DISCONNECT=2]="DISCONNECT",e[e.OPEN=3]="OPEN",e[e.QUERY=4]="QUERY",e[e.INSTANTIATE=5]="INSTANTIATE",e))(Vw||{}),Gw=(e=>(e[e.NONE=0]="NONE",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR",e[e.START=3]="START",e[e.RUN=4]="RUN",e[e.CAPTURE=5]="CAPTURE",e))(Gw||{}),Ww=(e=>(e[e.NONE=0]="NONE",e[e.WEB_WORKER=1]="WEB_WORKER",e[e.NODE_WORKER=2]="NODE_WORKER",e[e.BINDINGS=3]="BINDINGS",e[e.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",e))(Ww||{}),Hw=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;this.level=e}log(e){e.level>=this.level&&console.log(e)}};var Qw=(e=>(e[e.SUCCESS=0]="SUCCESS",e))(Qw||{}),Xw=class{constructor(e,t){this._bindings=e,this._conn=t}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(e){return e(this._bindings,this._conn)}async query(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let t=await this._bindings.runQuery(this._conn,e),n=aw.from(t);return console.assert(n.isSync(),"Reader is not sync"),console.assert(n.isFile(),"Reader is not file"),new Z_(n)}async send(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let t=await this._bindings.startPendingQuery(this._conn,e);for(;null==t;)t=await this._bindings.pollPendingQuery(this._conn);let n=new Yw(this._bindings,this._conn,t),r=await aw.from(n);return console.assert(r.isAsync()),console.assert(r.isStream()),r}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(e){return await this._bindings.getTableNames(this._conn,e)}async prepare(e){let t=await this._bindings.createPrepared(this._conn,e);return new qw(this._bindings,this._conn,t)}async insertArrowTable(e,t){let n=function(e){return("stream"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stream")?Tw:Iw).writeAll(e).toUint8Array(!0)}(e,"stream");await this.insertArrowFromIPCStream(n,t)}async insertArrowFromIPCStream(e,t){await this._bindings.insertArrowFromIPCStream(this._conn,e,t)}async insertCSVFromPath(e,t){await this._bindings.insertCSVFromPath(this._conn,e,t)}async insertJSONFromPath(e,t){await this._bindings.insertJSONFromPath(this._conn,e,t)}},Yw=class{constructor(e,t,n){this.db=e,this.conn=t,this.header=n,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e;return null!=this._inFlight?(e=await this._inFlight,this._inFlight=null):e=await this.db.fetchQueryResults(this.conn),this._depleted=0==e.length,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},qw=class{constructor(e,t,n){this.bindings=e,this.connectionId=t,this.statementId=n}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=await this.bindings.runPrepared(this.connectionId,this.statementId,t),i=aw.from(r);return console.assert(i.isSync()),console.assert(i.isFile()),new Z_(i)}async send(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=await this.bindings.sendPrepared(this.connectionId,this.statementId,t),i=new Yw(this.bindings,this.connectionId,r),s=await aw.from(i);return console.assert(s.isAsync()),console.assert(s.isStream()),s}},Kw=(e=>(e.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",e.CLOSE_PREPARED="CLOSE_PREPARED",e.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",e.CONNECT="CONNECT",e.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",e.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",e.CREATE_PREPARED="CREATE_PREPARED",e.DISCONNECT="DISCONNECT",e.DROP_FILE="DROP_FILE",e.DROP_FILES="DROP_FILES",e.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",e.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",e.FLUSH_FILES="FLUSH_FILES",e.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",e.GET_TABLE_NAMES="GET_TABLE_NAMES",e.GET_VERSION="GET_VERSION",e.GLOB_FILE_INFOS="GLOB_FILE_INFOS",e.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",e.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",e.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",e.INSTANTIATE="INSTANTIATE",e.OPEN="OPEN",e.PING="PING",e.POLL_PENDING_QUERY="POLL_PENDING_QUERY",e.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",e.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",e.REGISTER_FILE_URL="REGISTER_FILE_URL",e.RESET="RESET",e.RUN_PREPARED="RUN_PREPARED",e.RUN_QUERY="RUN_QUERY",e.SEND_PREPARED="SEND_PREPARED",e.START_PENDING_QUERY="START_PENDING_QUERY",e.TOKENIZE="TOKENIZE",e))(Kw||{}),Zw=(e=>(e.CONNECTION_INFO="CONNECTION_INFO",e.ERROR="ERROR",e.FEATURE_FLAGS="FEATURE_FLAGS",e.FILE_BUFFER="FILE_BUFFER",e.FILE_INFOS="FILE_INFOS",e.FILE_SIZE="FILE_SIZE",e.FILE_STATISTICS="FILE_STATISTICS",e.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",e.LOG="LOG",e.OK="OK",e.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",e.QUERY_PLAN="QUERY_PLAN",e.QUERY_RESULT="QUERY_RESULT",e.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",e.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",e.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",e.REGISTERED_FILE="REGISTERED_FILE",e.SCRIPT_TOKENS="SCRIPT_TOKENS",e.SUCCESS="SUCCESS",e.TABLE_NAMES="TABLE_NAMES",e.VERSION_STRING="VERSION_STRING",e))(Zw||{}),Jw=class{constructor(e,t){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=e,this.data=t,this.promise=new Promise((e,t)=>{this.promiseResolver=e,this.promiseRejecter=t})}};function $w(e){switch(e.typeId){case Vp.Binary:return{sqlType:"binary"};case Vp.Bool:return{sqlType:"bool"};case Vp.Date:return{sqlType:"date"};case Vp.DateDay:return{sqlType:"date32[d]"};case Vp.DateMillisecond:return{sqlType:"date64[ms]"};case Vp.Decimal:{let t=e;return{sqlType:"decimal",precision:t.precision,scale:t.scale}}case Vp.Float:return{sqlType:"float"};case Vp.Float16:return{sqlType:"float16"};case Vp.Float32:return{sqlType:"float32"};case Vp.Float64:return{sqlType:"float64"};case Vp.Int:return{sqlType:"int32"};case Vp.Int16:return{sqlType:"int16"};case Vp.Int32:return{sqlType:"int32"};case Vp.Int64:return{sqlType:"int64"};case Vp.Uint16:return{sqlType:"uint16"};case Vp.Uint32:return{sqlType:"uint32"};case Vp.Uint64:return{sqlType:"uint64"};case Vp.Uint8:return{sqlType:"uint8"};case Vp.IntervalDayTime:return{sqlType:"interval[dt]"};case Vp.IntervalYearMonth:return{sqlType:"interval[m]"};case Vp.List:return{sqlType:"list",valueType:$w(e.valueType)};case Vp.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:e.byteWidth};case Vp.Null:return{sqlType:"null"};case Vp.Utf8:return{sqlType:"utf8"};case Vp.Struct:return{sqlType:"struct",fields:e.children.map(e=>eE(e.name,e.type))};case Vp.Map:{let t=e;return{sqlType:"map",keyType:$w(t.keyType),valueType:$w(t.valueType)}}case Vp.Time:return{sqlType:"time[s]"};case Vp.TimeMicrosecond:return{sqlType:"time[us]"};case Vp.TimeMillisecond:return{sqlType:"time[ms]"};case Vp.TimeNanosecond:return{sqlType:"time[ns]"};case Vp.TimeSecond:return{sqlType:"time[s]"};case Vp.Timestamp:return{sqlType:"timestamp",timezone:e.timezone||void 0};case Vp.TimestampSecond:return{sqlType:"timestamp[s]",timezone:e.timezone||void 0};case Vp.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:e.timezone||void 0};case Vp.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:e.timezone||void 0};case Vp.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error("unsupported arrow type: ".concat(e.toString()))}function eE(e,t){let n=$w(t);return n.name=e,n}var tE=new TextEncoder,nE=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._onInstantiationProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),null!=t&&this.attach(t)}get logger(){return this._logger}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((e,t)=>{this._workerShutdownResolver=e})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!this._worker)return void console.error("cannot send a message since the worker is not set!");let n=this._nextMessageId++;return this._pendingRequests.set(n,e),this._worker.postMessage({messageId:n,type:e.type,data:e.data},t),await e.promise}onMessage(e){var t;let n=e.data;switch(n.type){case"LOG":return void this._logger.log(n.data);case"INSTANTIATE_PROGRESS":for(let e of this._onInstantiationProgress)e(n.data);return}let r=this._pendingRequests.get(n.requestId);if(r){if(this._pendingRequests.delete(n.requestId),"ERROR"==n.type){let e=new Error(n.data.message);return e.name=n.data.name,null!=(t=Object.getOwnPropertyDescriptor(e,"stack"))&&t.writable&&(e.stack=n.data.stack),void r.promiseRejecter(e)}switch(r.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if("OK"==n.type)return void r.promiseResolver(n.data);break;case"INSTANTIATE":if(this._onInstantiationProgress=[],"OK"==n.type)return void r.promiseResolver(n.data);break;case"GLOB_FILE_INFOS":if("FILE_INFOS"==n.type)return void r.promiseResolver(n.data);break;case"GET_VERSION":if("VERSION_STRING"==n.type)return void r.promiseResolver(n.data);break;case"GET_FEATURE_FLAGS":if("FEATURE_FLAGS"==n.type)return void r.promiseResolver(n.data);break;case"GET_TABLE_NAMES":if("TABLE_NAMES"==n.type)return void r.promiseResolver(n.data);break;case"TOKENIZE":if("SCRIPT_TOKENS"==n.type)return void r.promiseResolver(n.data);break;case"COPY_FILE_TO_BUFFER":if("FILE_BUFFER"==n.type)return void r.promiseResolver(n.data);break;case"EXPORT_FILE_STATISTICS":if("FILE_STATISTICS"==n.type)return void r.promiseResolver(n.data);break;case"CONNECT":if("CONNECTION_INFO"==n.type)return void r.promiseResolver(n.data);break;case"RUN_PREPARED":case"RUN_QUERY":if("QUERY_RESULT"==n.type)return void r.promiseResolver(n.data);break;case"SEND_PREPARED":if("QUERY_RESULT_HEADER"==n.type)return void r.promiseResolver(n.data);break;case"START_PENDING_QUERY":case"POLL_PENDING_QUERY":if("QUERY_RESULT_HEADER_OR_NULL"==n.type)return void r.promiseResolver(n.data);break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],"SUCCESS"==n.type)return void r.promiseResolver(n.data);break;case"FETCH_QUERY_RESULTS":if("QUERY_RESULT_CHUNK"==n.type)return void r.promiseResolver(n.data);break;case"CREATE_PREPARED":if("PREPARED_STATEMENT_ID"==n.type)return void r.promiseResolver(n.data)}r.promiseRejecter(new Error("unexpected response type: ".concat(n.type.toString())))}else console.warn("unassociated response: [".concat(n.requestId,", ").concat(n.type.toString(),"]"))}onError(e){console.error(e),console.error("error in duckdb worker: ".concat(e.message)),this._pendingRequests.clear()}onClose(){this._workerShutdownResolver(null),0==this._pendingRequests.size?this._pendingRequests.clear():console.warn("worker terminated with ".concat(this._pendingRequests.size," pending requests"))}async reset(){let e=new Jw("RESET",null);return await this.postTask(e)}async ping(){let e=new Jw("PING",null);await this.postTask(e)}async dropFile(e){let t=new Jw("DROP_FILE",e);return await this.postTask(t)}async dropFiles(){let e=new Jw("DROP_FILES",null);return await this.postTask(e)}async flushFiles(){let e=new Jw("FLUSH_FILES",null);return await this.postTask(e)}async instantiate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>{};this._onInstantiationProgress.push(n);let r=new Jw("INSTANTIATE",[e,t]);return await this.postTask(r)}async getVersion(){let e=new Jw("GET_VERSION",null);return await this.postTask(e)}async getFeatureFlags(){let e=new Jw("GET_FEATURE_FLAGS",null);return await this.postTask(e)}async open(e){let t=new Jw("OPEN",e);await this.postTask(t)}async tokenize(e){let t=new Jw("TOKENIZE",e);return await this.postTask(t)}async connectInternal(){let e=new Jw("CONNECT",null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new Xw(this,e)}async disconnect(e){let t=new Jw("DISCONNECT",e);await this.postTask(t)}async runQuery(e,t){let n=new Jw("RUN_QUERY",[e,t]);return await this.postTask(n)}async startPendingQuery(e,t){let n=new Jw("START_PENDING_QUERY",[e,t]);return await this.postTask(n)}async pollPendingQuery(e){let t=new Jw("POLL_PENDING_QUERY",e);return await this.postTask(t)}async cancelPendingQuery(e){let t=new Jw("CANCEL_PENDING_QUERY",e);return await this.postTask(t)}async fetchQueryResults(e){let t=new Jw("FETCH_QUERY_RESULTS",e);return await this.postTask(t)}async getTableNames(e,t){let n=new Jw("GET_TABLE_NAMES",[e,t]);return await this.postTask(n)}async createPrepared(e,t){let n=new Jw("CREATE_PREPARED",[e,t]);return await this.postTask(n)}async closePrepared(e,t){let n=new Jw("CLOSE_PREPARED",[e,t]);await this.postTask(n)}async runPrepared(e,t,n){let r=new Jw("RUN_PREPARED",[e,t,n]);return await this.postTask(r)}async sendPrepared(e,t,n){let r=new Jw("SEND_PREPARED",[e,t,n]);return await this.postTask(r)}async globFiles(e){let t=new Jw("GLOB_FILE_INFOS",e);return await this.postTask(t)}async registerFileText(e,t){let n=tE.encode(t);await this.registerFileBuffer(e,n)}async registerFileURL(e,t,n,r){void 0===t&&(t=e);let i=new Jw("REGISTER_FILE_URL",[e,t,n,r]);await this.postTask(i)}async registerEmptyFileBuffer(e){}async registerFileBuffer(e,t){let n=new Jw("REGISTER_FILE_BUFFER",[e,t]);await this.postTask(n,[t.buffer])}async registerFileHandle(e,t,n,r){let i=new Jw("REGISTER_FILE_HANDLE",[e,t,n,r]);await this.postTask(i,[])}async collectFileStatistics(e,t){let n=new Jw("COLLECT_FILE_STATISTICS",[e,t]);await this.postTask(n,[])}async exportFileStatistics(e){let t=new Jw("EXPORT_FILE_STATISTICS",e);return await this.postTask(t,[])}async copyFileToBuffer(e){let t=new Jw("COPY_FILE_TO_BUFFER",e);return await this.postTask(t)}async copyFileToPath(e,t){let n=new Jw("COPY_FILE_TO_PATH",[e,t]);await this.postTask(n)}async insertArrowFromIPCStream(e,t,n){if(0==t.length)return;let r=new Jw("INSERT_ARROW_FROM_IPC_STREAM",[e,t,n]);await this.postTask(r,[t.buffer])}async insertCSVFromPath(e,t,n){if(void 0!==n.columns){let e=[];for(let t in n.columns){let r=n.columns[t];e.push(eE(t,r))}n.columnsFlat=e,delete n.columns}let r=new Jw("IMPORT_CSV_FROM_PATH",[e,t,n]);await this.postTask(r)}async insertJSONFromPath(e,t,n){if(void 0!==n.columns){let e=[];for(let t in n.columns){let r=n.columns[t];e.push(eE(t,r))}n.columnsFlat=e,delete n.columns}let r=new Jw("IMPORT_JSON_FROM_PATH",[e,t,n]);await this.postTask(r)}},rE={name:"@duckdb/duckdb-wasm",version:"1.29.0",description:"DuckDB powered by WebAssembly",license:"MIT",repository:{type:"git",url:"https://github.com/duckdb/duckdb-wasm.git"},keywords:["sql","duckdb","relational","database","data","query","wasm","analytics","olap","arrow","parquet","json","csv"],dependencies:{"apache-arrow":"^17.0.0"},devDependencies:{"@types/emscripten":"^1.39.10","@types/jasmine":"^5.1.4","@typescript-eslint/eslint-plugin":"^6.21.0","@typescript-eslint/parser":"^6.21.0",esbuild:"^0.20.2",eslint:"^8.57.0","eslint-plugin-jasmine":"^4.1.3","eslint-plugin-react":"^7.34.0","fast-glob":"^3.3.2",jasmine:"^5.1.0","jasmine-core":"^5.1.2","jasmine-spec-reporter":"^7.0.0","js-sha256":"^0.11.0",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-coverage":"^2.2.1","karma-firefox-launcher":"^2.1.3","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.1.0","karma-sourcemap-loader":"^0.4.0","karma-spec-reporter":"^0.0.36","make-dir":"^4.0.0",nyc:"^15.1.0",prettier:"^3.2.5",puppeteer:"^22.8.0",rimraf:"^5.0.5",s3rver:"^3.7.1",typedoc:"^0.25.13",typescript:"^5.3.3","wasm-feature-detect":"^1.6.1","web-worker":"^1.2.0"},scripts:{"build:debug":"node bundle.mjs debug && tsc --emitDeclarationOnly","build:release":"node bundle.mjs release && tsc --emitDeclarationOnly",docs:"typedoc",report:"node ./coverage.mjs","test:node":"node --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:debug":"node --inspect-brk --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:coverage":"nyc -r json --report-dir ./coverage/node node ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:firefox":"karma start ./karma/tests-firefox.cjs","test:chrome":"karma start ./karma/tests-chrome.cjs","test:chrome:eh":"karma start ./karma/tests-chrome-eh.cjs","test:chrome:coverage":"karma start ./karma/tests-chrome-coverage.cjs","test:browser":"karma start ./karma/tests-all.cjs","test:browser:debug":"karma start ./karma/tests-debug.cjs",test:"npm run test:chrome && npm run test:node","test:coverage":"npm run test:chrome:coverage && npm run test:node:coverage && npm run report",lint:"eslint src test"},files:["dist","!dist/tests-*","!dist/duckdb-browser-mvp.worker.js.map","!dist/types/test"],main:"dist/duckdb-browser.cjs",module:"dist/duckdb-browser.mjs",types:"dist/duckdb-browser.d.ts",jsdelivr:"dist/duckdb-browser.cjs",unpkg:"dist/duckdb-browser.mjs",sideEffects:!1,browser:{fs:!1,path:!1,perf_hooks:!1,os:!1,worker_threads:!1},exports:{"./dist/duckdb-mvp.wasm":"./dist/duckdb-mvp.wasm","./dist/duckdb-eh.wasm":"./dist/duckdb-eh.wasm","./dist/duckdb-coi.wasm":"./dist/duckdb-coi.wasm","./dist/duckdb-browser":"./dist/duckdb-browser.mjs","./dist/duckdb-browser.cjs":"./dist/duckdb-browser.cjs","./dist/duckdb-browser.mjs":"./dist/duckdb-browser.mjs","./dist/duckdb-browser-coi.pthread.worker.js":"./dist/duckdb-browser-coi.pthread.worker.js","./dist/duckdb-browser-coi.worker.js":"./dist/duckdb-browser-coi.worker.js","./dist/duckdb-browser-eh.worker.js":"./dist/duckdb-browser-eh.worker.js","./dist/duckdb-browser-mvp.worker.js":"./dist/duckdb-browser-mvp.worker.js","./dist/duckdb-node":"./dist/duckdb-node.cjs","./dist/duckdb-node.cjs":"./dist/duckdb-node.cjs","./dist/duckdb-node-blocking":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-blocking.cjs":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-eh.worker.cjs":"./dist/duckdb-node-eh.worker.cjs","./dist/duckdb-node-mvp.worker.cjs":"./dist/duckdb-node-mvp.worker.cjs","./blocking":{node:{types:"./dist/duckdb-node-blocking.d.ts",require:"./dist/duckdb-node-blocking.cjs",import:"./dist/duckdb-node-blocking.cjs"},types:"./dist/duckdb-node-blocking.d.ts",import:"./dist/duckdb-node-blocking.mjs",require:"./dist/duckdb-node-blocking.cjs"},".":{browser:{types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"},node:{types:"./dist/duckdb-node.d.ts",import:"./dist/duckdb-node.cjs",require:"./dist/duckdb-node.cjs"},types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"}}},iE=(rE.name,rE.version,rE.version.split(".")),sE=(iE[0],iE[1],iE[2],()=>typeof navigator>"u");var oE=null,aE=null,lE=null,uE=null,cE=null;async function AE(){return null==oE&&(oE=typeof BigInt64Array<"u"),null==aE&&(aE=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])))()),null==lE&&(lE=await(async e=>{try{return typeof MessageChannel<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(kA){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))),null==uE&&(uE=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))()),null==cE&&(cE=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])))()),{bigInt64Array:oE,crossOriginIsolated:sE()||globalThis.crossOriginIsolated||!1,wasmExceptions:aE,wasmSIMD:uE,wasmThreads:lE,wasmBulkMemory:cE}}((e,t,n)=>{n=null!=e?kw(Lw(e)):{},((e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of Bw(t))!Ow.call(e,i)&&i!==n&&Pw(e,i,{get:()=>t[i],enumerable:!(r=Mw(t,i))||r.enumerable})})(!t&&e&&e.__esModule?n:Pw(n,"default",{value:e,enumerable:!0}),e)})(Nw());!function(){let e=new TextDecoder}();var hE=(e=>(e[e.BUFFER=0]="BUFFER",e[e.NODE_FS=1]="NODE_FS",e[e.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",e[e.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",e[e.HTTP=4]="HTTP",e[e.S3=5]="S3",e))(hE||{});const dE=()=>{const[e,t]=(0,r.useState)({isLoading:!0,isReady:!1,error:null,connection:null}),n=(0,r.useRef)(null),i=(0,r.useRef)(null);(0,r.useEffect)(()=>((async()=>{try{t(e=>u(u({},e),{},{isLoading:!0,error:null}));const e=new Hw(jw.WARNING),r={mvp:{mainModule:"/projects/imoveis/duckdb-mvp.wasm",mainWorker:"/projects/imoveis/duckdb-browser-mvp.worker.js"},eh:{mainModule:"/projects/imoveis/duckdb-eh.wasm",mainWorker:"/projects/imoveis/duckdb-browser-eh.worker.js"}},s=await async function(e){let t=await AE();if(t.wasmExceptions){if(t.wasmSIMD&&t.wasmThreads&&t.crossOriginIsolated&&e.coi)return{mainModule:e.coi.mainModule,mainWorker:e.coi.mainWorker,pthreadWorker:e.coi.pthreadWorker};if(e.eh)return{mainModule:e.eh.mainModule,mainWorker:e.eh.mainWorker,pthreadWorker:null}}return{mainModule:e.mvp.mainModule,mainWorker:e.mvp.mainWorker,pthreadWorker:null}}(r),o=new Worker(s.mainWorker);o.onerror=e=>{console.warn("DuckDB Worker error (non-critical):",e)};const a=new nE(e,o);await a.instantiate(s.mainModule,s.pthreadWorker),n.current=a;const l=await a.connect();i.current=l,console.log("Fetching database...");const c=await fetch("/projects/imoveis/properties_webapp.duckdb");if(!c.ok)throw new Error("Failed to fetch database: ".concat(c.status));console.log("Database fetched, converting to array buffer...");const A=await c.arrayBuffer(),h=new Uint8Array(A);console.log("Registering file buffer..."),await a.registerFileBuffer("properties_webapp.duckdb",h),console.log("Attaching database..."),await l.query("ATTACH 'properties_webapp.duckdb' AS properties_db;"),console.log("Database attached successfully"),t({isLoading:!1,isReady:!0,error:null,connection:l})}catch(e){console.error("Failed to initialize DuckDB:",e),t({isLoading:!1,isReady:!1,error:e instanceof Error?e.message:"Unknown error",connection:null})}})(),()=>{i.current&&i.current.close().catch(console.error),n.current&&n.current.terminate().catch(console.error)}),[]);const s=(0,r.useCallback)(async t=>{if(!e.connection||!e.isReady)throw new Error("DuckDB is not ready");try{return(await e.connection.query(t)).toArray().map(e=>e.toJSON())}catch(n){throw console.error("Query failed:",t,n),n}},[e.connection,e.isReady]);return{isLoading:e.isLoading,isReady:e.isReady,error:e.error,query:s,useQuery:t=>{const[n,i]=(0,r.useState)({data:[],isLoading:!1,error:null});return(0,r.useEffect)(()=>{if(!t||!e.isReady)return;(async()=>{i(e=>u(u({},e),{},{isLoading:!0,error:null}));try{const e=await s(t);i({data:e,isLoading:!1,error:null})}catch(e){i({data:[],isLoading:!1,error:e instanceof Error?e.message:"Query failed"})}})()},[t,e.isReady]),n}}};var fE=n(579);const pE=e=>{let{data:t}=e;if(!t||0===t.length)return(0,fE.jsxs)("div",{className:"amenity-chart-container",children:[(0,fE.jsx)("h3",{children:"Pr\xeamio/Desconto de Pre\xe7o por Comodidade"}),(0,fE.jsx)("div",{style:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center",color:"#a0aec0"},children:"Nenhum dado de pre\xe7o de comodidade dispon\xedvel"})]});const n=t.filter(e=>!isNaN(e.diff)&&isFinite(e.diff)).map(e=>({amenity:e.amenity,value:Number(e.diff)})).sort((e,t)=>t.value-e.value);return(0,fE.jsxs)("div",{className:"amenity-chart-container",children:[(0,fE.jsxs)("h3",{children:["Pr\xeamio/Desconto de Pre\xe7o por Comodidade (",n.length," comodidades)"]}),(0,fE.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[(0,fE.jsx)("thead",{children:(0,fE.jsxs)("tr",{style:{borderBottom:"2px solid #2d3748",textAlign:"left"},children:[(0,fE.jsx)("th",{style:{padding:"8px",color:"#9AA8BD"},children:"Comodidade"}),(0,fE.jsx)("th",{style:{padding:"8px",textAlign:"right",color:"#9AA8BD"},children:"Impacto no Pre\xe7o (R$/m\xb2)"})]})}),(0,fE.jsx)("tbody",{children:n.map((e,t)=>(0,fE.jsxs)("tr",{style:{borderBottom:"1px solid #2d3748",transition:"background 200ms, transform 200ms",cursor:"pointer"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.05)",e.currentTarget.style.transform="scale(1.01)"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.transform="scale(1)"},children:[(0,fE.jsx)("td",{style:{padding:"8px",color:"#EAEAEA"},children:e.amenity}),(0,fE.jsxs)("td",{style:{padding:"8px",textAlign:"right",fontWeight:"bold",color:e.value>=0?"#27ae60":"#e74c3c"},children:[e.value>=0?"+":"","R$",e.value.toFixed(1)]})]},t))})]})]})},gE=e=>{let t;const n=new Set,r=(e,r)=>{const i="function"===typeof e?e(t):e;if(!Object.is(i,t)){const e=t;t=(null!=r?r:"object"!==typeof i||null===i)?i:Object.assign({},t,i),n.forEach(n=>n(t,e))}},i=()=>t,s={setState:r,getState:i,getInitialState:()=>o,subscribe:e=>(n.add(e),()=>n.delete(e))},o=t=e(r,i,s);return s},mE=e=>e;const yE=e=>{const t=(e=>e?gE(e):gE)(e),n=e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mE;const n=r.useSyncExternalStore(e.subscribe,r.useCallback(()=>t(e.getState()),[e,t]),r.useCallback(()=>t(e.getInitialState()),[e,t]));return r.useDebugValue(n),n}(t,e);return Object.assign(n,t),n},vE=(_E=e=>({filters:{bairros:void 0,h3:void 0,unitTypes:void 0,bedrooms:void 0,bathrooms:void 0,parking:void 0,floor:void 0,priceRange:void 0,priceTotalTier:void 0,areaTier:void 0},set:t=>e(e=>u(u({},e),{},{filters:u(u({},e.filters),t)}))}),_E?yE(_E):yE);var _E;function bE(e,t){var n,r,i,s,o,a,l,u,c,A;const h=[];if(null===(n=e.bairros)||void 0===n||!n.length||null!==t&&void 0!==t&&t.includes("bairros")||h.push("bairro IN (".concat(e.bairros.map(e=>"'".concat(e.replace(/'/g,"''"),"'")).join(","),")")),null===(r=e.h3)||void 0===r||!r.length||null!==t&&void 0!==t&&t.includes("h3")||h.push("h3_7 IN (".concat(e.h3.map(e=>"'".concat(e,"'")).join(","),")")),null===(i=e.unitTypes)||void 0===i||!i.length||null!==t&&void 0!==t&&t.includes("unitTypes")||h.push("unit_type IN (".concat(e.unitTypes.map(e=>"'".concat(e,"'")).join(","),")")),null===(s=e.bedrooms)||void 0===s||!s.length||null!==t&&void 0!==t&&t.includes("bedrooms")||h.push("bedrooms_bin IN (".concat(e.bedrooms.join(","),")")),null===(o=e.bathrooms)||void 0===o||!o.length||null!==t&&void 0!==t&&t.includes("bathrooms")||h.push("bathrooms_bin IN (".concat(e.bathrooms.join(","),")")),null===(a=e.parking)||void 0===a||!a.length||null!==t&&void 0!==t&&t.includes("parking")||h.push("parking_bin IN (".concat(e.parking.join(","),")")),null===(l=e.floor)||void 0===l||!l.length||null!==t&&void 0!==t&&t.includes("floor")||h.push("floor_level IN (".concat(e.floor.join(","),")")),null!==(u=e.priceRange)&&void 0!==u&&u.length&&(null===t||void 0===t||!t.includes("priceRange"))){const t=e.priceRange.includes(100),n=e.priceRange.filter(e=>e<100);t&&n.length>0?h.push("(price_m2_bucket IN (".concat(n.join(","),") OR price_m2_bucket >= 100)")):t?h.push("price_m2_bucket >= 100"):n.length>0&&h.push("price_m2_bucket IN (".concat(n.join(","),")"))}return null===(c=e.priceTotalTier)||void 0===c||!c.length||null!==t&&void 0!==t&&t.includes("priceTotalTier")||h.push("price_total_tier IN (".concat(e.priceTotalTier.map(e=>"'".concat(e,"'")).join(","),")")),null===(A=e.areaTier)||void 0===A||!A.length||null!==t&&void 0!==t&&t.includes("areaTier")||h.push("area_tier IN (".concat(e.areaTier.map(e=>"'".concat(e.replace(/'/g,"''"),"'")).join(","),")")),h.length?"WHERE ".concat(h.join(" AND ")):""}const wE=Math.sqrt(50),EE=Math.sqrt(10),xE=Math.sqrt(2);function DE(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=wE?10:s>=EE?5:s>=xE?2:1;let a,l,u;return i<0?(u=Math.pow(10,-i)/o,a=Math.round(e*u),l=Math.round(t*u),a/u<e&&++a,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*o,a=Math.round(e/u),l=Math.round(t/u),a*u<e&&++a,l*u>t&&--l),l<a&&.5<=n&&n<2?DE(e,t,2*n):[a,l,u]}function CE(e,t,n){return DE(e=+e,t=+t,n=+n)[2]}function SE(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function TE(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function IE(e){let t,n,r;function i(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<s){if(0!==t(r,r))return s;do{const t=i+s>>>1;n(e[t],r)<0?i=t+1:s=t}while(i<s)}return i}return 2!==e.length?(t=SE,n=(t,n)=>SE(e(t),n),r=(t,n)=>e(t)-n):(t=e===SE||e===TE?e:FE,n=e,r=e),{left:i,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=i(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return s>n&&r(e[s-1],t)>-r(e[s],t)?s-1:s},right:function(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<s){if(0!==t(r,r))return s;do{const t=i+s>>>1;n(e[t],r)<=0?i=t+1:s=t}while(i<s)}return i}}}function FE(){return 0}const RE=IE(SE),kE=RE.right,PE=(RE.left,IE(function(e){return null===e?NaN:+e}).center,kE);function ME(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function BE(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function LE(){}var OE=.7,NE=1/OE,UE="\\s*([+-]?\\d+)\\s*",zE="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",jE="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",VE=/^#([0-9a-f]{3,8})$/,GE=new RegExp("^rgb\\(".concat(UE,",").concat(UE,",").concat(UE,"\\)$")),WE=new RegExp("^rgb\\(".concat(jE,",").concat(jE,",").concat(jE,"\\)$")),HE=new RegExp("^rgba\\(".concat(UE,",").concat(UE,",").concat(UE,",").concat(zE,"\\)$")),QE=new RegExp("^rgba\\(".concat(jE,",").concat(jE,",").concat(jE,",").concat(zE,"\\)$")),XE=new RegExp("^hsl\\(".concat(zE,",").concat(jE,",").concat(jE,"\\)$")),YE=new RegExp("^hsla\\(".concat(zE,",").concat(jE,",").concat(jE,",").concat(zE,"\\)$")),qE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function KE(){return this.rgb().formatHex()}function ZE(){return this.rgb().formatRgb()}function JE(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=VE.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?$E(t):3===n?new nx(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?ex(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?ex(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=GE.exec(e))?new nx(t[1],t[2],t[3],1):(t=WE.exec(e))?new nx(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=HE.exec(e))?ex(t[1],t[2],t[3],t[4]):(t=QE.exec(e))?ex(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=XE.exec(e))?lx(t[1],t[2]/100,t[3]/100,1):(t=YE.exec(e))?lx(t[1],t[2]/100,t[3]/100,t[4]):qE.hasOwnProperty(e)?$E(qE[e]):"transparent"===e?new nx(NaN,NaN,NaN,0):null}function $E(e){return new nx(e>>16&255,e>>8&255,255&e,1)}function ex(e,t,n,r){return r<=0&&(e=t=n=NaN),new nx(e,t,n,r)}function tx(e,t,n,r){return 1===arguments.length?function(e){return e instanceof LE||(e=JE(e)),e?new nx((e=e.rgb()).r,e.g,e.b,e.opacity):new nx}(e):new nx(e,t,n,null==r?1:r)}function nx(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function rx(){return"#".concat(ax(this.r)).concat(ax(this.g)).concat(ax(this.b))}function ix(){const e=sx(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(ox(this.r),", ").concat(ox(this.g),", ").concat(ox(this.b)).concat(1===e?")":", ".concat(e,")"))}function sx(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ox(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ax(e){return((e=ox(e))<16?"0":"")+e.toString(16)}function lx(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new cx(e,t,n,r)}function ux(e){if(e instanceof cx)return new cx(e.h,e.s,e.l,e.opacity);if(e instanceof LE||(e=JE(e)),!e)return new cx;if(e instanceof cx)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(o=t===s?(n-r)/a+6*(n<r):n===s?(r-t)/a+2:(t-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new cx(o,a,l,e.opacity)}function cx(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Ax(e){return(e=(e||0)%360)<0?e+360:e}function hx(e){return Math.max(0,Math.min(1,e||0))}function dx(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function fx(e,t,n,r,i){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*r+o*i)/6}ME(LE,JE,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:KE,formatHex:KE,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ux(this).formatHsl()},formatRgb:ZE,toString:ZE}),ME(nx,tx,BE(LE,{brighter(e){return e=null==e?NE:Math.pow(NE,e),new nx(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?OE:Math.pow(OE,e),new nx(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new nx(ox(this.r),ox(this.g),ox(this.b),sx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rx,formatHex:rx,formatHex8:function(){return"#".concat(ax(this.r)).concat(ax(this.g)).concat(ax(this.b)).concat(ax(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:ix,toString:ix})),ME(cx,function(e,t,n,r){return 1===arguments.length?ux(e):new cx(e,t,n,null==r?1:r)},BE(LE,{brighter(e){return e=null==e?NE:Math.pow(NE,e),new cx(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?OE:Math.pow(OE,e),new cx(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new nx(dx(e>=240?e-240:e+120,i,r),dx(e,i,r),dx(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new cx(Ax(this.h),hx(this.s),hx(this.l),sx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sx(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Ax(this.h),", ").concat(100*hx(this.s),"%, ").concat(100*hx(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const px=e=>()=>e;function gx(e,t){return function(n){return e+n*t}}function mx(e){return 1===(e=+e)?yx:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):px(isNaN(t)?n:t)}}function yx(e,t){var n=t-e;return n?gx(e,n):px(isNaN(e)?t:e)}const vx=function e(t){var n=mx(t);function r(e,t){var r=n((e=tx(e)).r,(t=tx(t)).r),i=n(e.g,t.g),s=n(e.b,t.b),o=yx(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=s(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function _x(e){return function(t){var n,r,i=t.length,s=new Array(i),o=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=tx(t[n]),s[n]=r.r||0,o[n]=r.g||0,a[n]=r.b||0;return s=e(s),o=e(o),a=e(a),r.opacity=1,function(e){return r.r=s(e),r.g=o(e),r.b=a(e),r+""}}}_x(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],o=r>0?e[r-1]:2*i-s,a=r<t-1?e[r+2]:2*s-i;return fx((n-r/t)*t,o,i,s,a)}}),_x(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],o=e[(r+1)%t],a=e[(r+2)%t];return fx((n-r/t)*t,i,s,o,a)}});function bx(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,s=new Array(i),o=new Array(r);for(n=0;n<i;++n)s[n]=Ix(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=s[n](e);return o}}function wx(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ex(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function xx(e,t){var n,r={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=Ix(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var Dx=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cx=new RegExp(Dx.source,"g");function Sx(e,t){var n,r,i,s=Dx.lastIndex=Cx.lastIndex=0,o=-1,a=[],l=[];for(e+="",t+="";(n=Dx.exec(e))&&(r=Cx.exec(t));)(i=r.index)>s&&(i=t.slice(s,i),a[o]?a[o]+=i:a[++o]=i),(n=n[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:Ex(n,r)})),s=Cx.lastIndex;return s<t.length&&(i=t.slice(s),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)a[(n=l[r]).i]=n.x(e);return a.join("")})}function Tx(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(s){for(n=0;n<r;++n)i[n]=e[n]*(1-s)+t[n]*s;return i}}function Ix(e,t){var n,r=typeof t;return null==t||"boolean"===r?px(t):("number"===r?Ex:"string"===r?(n=JE(t))?(t=n,vx):Sx:t instanceof JE?vx:t instanceof Date?wx:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?Tx:Array.isArray(t)?bx:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?xx:Ex)(e,t)}function Fx(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Rx(e){return+e}var kx=[0,1];function Px(e){return e}function Mx(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function Bx(e,t,n){var r=e[0],i=e[1],s=t[0],o=t[1];return i<r?(r=Mx(i,r),s=n(o,s)):(r=Mx(r,i),s=n(s,o)),function(e){return s(r(e))}}function Lx(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=Mx(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(t){var n=PE(e,t,1,r)-1;return s[n](i[n](t))}}function Ox(){var e,t,n,r,i,s,o=kx,a=kx,l=Ix,u=Px;function c(){var e=Math.min(o.length,a.length);return u!==Px&&(u=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?Lx:Bx,i=s=null,A}function A(t){return null==t||isNaN(t=+t)?n:(i||(i=r(o.map(e),a,l)))(e(u(t)))}return A.invert=function(n){return u(t((s||(s=r(a,o.map(e),Ex)))(n)))},A.domain=function(e){return arguments.length?(o=Array.from(e,Rx),c()):o.slice()},A.range=function(e){return arguments.length?(a=Array.from(e),c()):a.slice()},A.rangeRound=function(e){return a=Array.from(e),l=Fx,c()},A.clamp=function(e){return arguments.length?(u=!!e||Px,c()):u!==Px},A.interpolate=function(e){return arguments.length?(l=e,c()):l},A.unknown=function(e){return arguments.length?(n=e,A):n},function(n,r){return e=n,t=r,c()}}function Nx(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var Ux,zx=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jx(e){if(!(t=zx.exec(e)))throw new Error("invalid format: "+e);var t;return new Vx({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Vx(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Gx(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Wx(e){return(e=Gx(Math.abs(e)))?e[1]:NaN}function Hx(e,t){var n=Gx(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}jx.prototype=Vx.prototype,Vx.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Qx={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Hx(100*e,t),r:Hx,s:function(e,t){var n=Gx(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(Ux=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+Gx(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Xx(e){return e}var Yx,qx,Kx,Zx=Array.prototype.map,Jx=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function $x(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Xx:(t=Zx.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,s=[],o=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),s.push(e.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[o=(o+1)%t.length];return s.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",s=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",a=void 0===e.numerals?Xx:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(Zx.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",u=void 0===e.minus?"\u2212":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function A(e){var t=(e=jx(e)).fill,n=e.align,A=e.sign,h=e.symbol,d=e.zero,f=e.width,p=e.comma,g=e.precision,m=e.trim,y=e.type;"n"===y?(p=!0,y="g"):Qx[y]||(void 0===g&&(g=12),m=!0,y="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var v="$"===h?i:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",_="$"===h?s:/[%p]/.test(y)?l:"",b=Qx[y],w=/[defgprs%]/.test(y);function E(e){var i,s,l,h=v,E=_;if("c"===y)E=b(e)+E,e="";else{var x=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:b(Math.abs(e),g),m&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),x&&0===+e&&"+"!==A&&(x=!1),h=(x?"("===A?A:u:"-"===A||"("===A?"":A)+h,E=("s"===y?Jx[8+Ux/3]:"")+E+(x&&"("===A?")":""),w)for(i=-1,s=e.length;++i<s;)if(48>(l=e.charCodeAt(i))||l>57){E=(46===l?o+e.slice(i+1):e.slice(i))+E,e=e.slice(0,i);break}}p&&!d&&(e=r(e,1/0));var D=h.length+e.length+E.length,C=D<f?new Array(f-D+1).join(t):"";switch(p&&d&&(e=r(C+e,C.length?f-E.length:1/0),C=""),n){case"<":e=h+e+E+C;break;case"=":e=h+C+e+E;break;case"^":e=C.slice(0,D=C.length>>1)+h+e+E+C.slice(D);break;default:e=C+h+e+E}return a(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),E.toString=function(){return e+""},E}return{format:A,formatPrefix:function(e,t){var n=A(((e=jx(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Wx(t)/3))),i=Math.pow(10,-r),s=Jx[8+r/3];return function(e){return n(i*e)+s}}}}function eD(e,t,n,r){var i,s=function(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?CE(t,e,n):CE(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}(e,t,n);switch((r=jx(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Wx(t)/3)))-Wx(Math.abs(e)))}(s,o))||(r.precision=i),Kx(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Wx(t)-Wx(e))+1}(s,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-Wx(Math.abs(e)))}(s))||(r.precision=i-2*("%"===r.type))}return qx(r)}function tD(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[i,s,o]=r?DE(t,e,n):DE(e,t,n);if(!(s>=i))return[];const a=s-i+1,l=new Array(a);if(r)if(o<0)for(let u=0;u<a;++u)l[u]=(s-u)/-o;else for(let u=0;u<a;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(i+u)/-o;else for(let u=0;u<a;++u)l[u]=(i+u)*o;return l}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return eD(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,s=t(),o=0,a=s.length-1,l=s[o],u=s[a],c=10;for(u<l&&(i=l,l=u,u=i,i=o,o=a,a=i);c-- >0;){if((i=CE(l,u,n))===r)return s[o]=l,s[a]=u,t(s);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return e},e}function nD(){var e=Ox()(Px,Px);return e.copy=function(){return function(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}(e,nD())},Nx.apply(e,arguments),tD(e)}Yx=$x({thousands:",",grouping:[3],currency:["$",""]}),qx=Yx.format,Kx=Yx.formatPrefix;const rD=e=>{let{data:t,width:n,barHeight:i=32,barPadding:s=10,margin:o={top:20,right:60,bottom:40,left:140},title:a,xLabel:l,yLabel:u,selectedKeys:c=[],onBarClick:A,formatX:h=e=>String(e),formatKey:d=e=>String(e),highlightTopN:f=0}=e;const[p,g]=(0,r.useState)(null),m=(0,r.useRef)(null),[y,v]=(0,r.useState)(500);if((0,r.useEffect)(()=>{if(!m.current)return;const e=()=>{if(m.current){const e=window.getComputedStyle(m.current),t=parseFloat(e.paddingLeft),n=parseFloat(e.paddingRight),r=m.current.offsetWidth-t-n;v(r)}};e();const t=new ResizeObserver(e);return t.observe(m.current),()=>t.disconnect()},[]),null===t||void 0===t||!t.length)return null;const _=n||y,b=_<500,w=b?{top:20,right:60,bottom:40,left:130}:o,E=b?50:60,x=_-w.left-w.right-E,D=t.length*(i+s)+w.top+w.bottom,C=D-w.top-w.bottom,S=t.some(e=>Number(e.value)<0),T=Math.max(...t.map(e=>Math.abs(Number(e.value)||0)),1),I=Math.max(...t.map(e=>Number(e.value)||0),1),F=S?nD().domain([-T,T]).range([0,x]):b?nD().domain([0,I]).range([0,x]):nD().domain([0,I]).range([0,x]).nice(),R=S?F(0):0;return(0,fE.jsxs)("div",{ref:m,className:"amenity-chart-container",style:{position:"relative",width:"100%"},children:[a?(0,fE.jsx)("h3",{children:a}):null,(0,fE.jsx)("div",{className:"chart-scroll",style:{overflowX:"visible"},children:(0,fE.jsx)("svg",{width:_,height:D,children:(0,fE.jsxs)("g",{transform:"translate(".concat(w.left,", ").concat(w.top,")"),children:[S&&(0,fE.jsx)("line",{x1:R,x2:R,y1:0,y2:C,stroke:"#4a5568",strokeWidth:2,opacity:.8}),t.map((e,t)=>{const n=t*(i+s),r=Number(e.value)||0,o=r>=0,a=S?Math.abs(F(r)-R):F(r),l=S?o?R:R-a:0,u=c.includes(e.key),p=c.length>0&&!u,m=f>0&&t<f,y=e.color||(S?o?"#27ae60":"#e74c3c":m?"#FF5733":"#2979FF"),v=u?"#1d4ed8":y;return(0,fE.jsxs)("g",{children:[(0,fE.jsx)("rect",{x:l,y:n,width:a,height:i,fill:v,opacity:p?.35:.9,stroke:"#2d3748",strokeWidth:1,rx:2,style:{cursor:A?"pointer":"default",transition:"x 400ms, width 400ms, opacity 200ms, fill 200ms, filter 200ms, transform 200ms",transformOrigin:"".concat(l+a/2,"px ").concat(n+i/2,"px")},onClick:()=>A&&A(e.key),onMouseEnter:t=>{t.currentTarget.style.filter="brightness(1.2)",t.currentTarget.style.transform="scale(1.01)";const n=t.currentTarget.getBoundingClientRect();g({key:e.key,value:r,x:n.left+n.width/2,y:n.top})},onMouseLeave:e=>{e.currentTarget.style.filter="brightness(1)",e.currentTarget.style.transform="scale(1)",g(null)}}),(0,fE.jsx)("text",{x:-10,y:n+i/2,textAnchor:"end",dy:"0.35em",fontSize:b?12:14,fill:"#a0aec0",fontWeight:500,style:{pointerEvents:"none"},children:d(e.key)}),(0,fE.jsxs)("text",{x:S?o?l+a+6:l-6:l+a+6,y:n+i/2,textAnchor:S?o?"start":"end":"start",dy:"0.35em",fontSize:b?10:11,fill:"#e2e8f0",fontWeight:600,style:{pointerEvents:"none"},children:[S&&r>=0?"+":"",h(r)]})]},String(e.key))}),(0,fE.jsxs)("g",{transform:"translate(0, ".concat(C,")"),children:[(0,fE.jsx)("line",{x1:0,x2:x,stroke:"#4a5568",strokeWidth:1}),F.ticks(6).map(e=>(0,fE.jsxs)("g",{transform:"translate(".concat(F(e),", 0)"),children:[(0,fE.jsx)("line",{y2:6,stroke:"#4a5568"}),(0,fE.jsx)("text",{y:18,textAnchor:"middle",fontSize:12,fill:"#a0aec0",fontWeight:500,children:h(e)})]},e)),l?(0,fE.jsx)("text",{x:x/2,y:34,textAnchor:"middle",fontSize:14,fill:"#e2e8f0",fontWeight:600,children:l}):null]})]})})}),p&&(0,fE.jsxs)("div",{style:{position:"fixed",left:p.x,top:p.y-10,transform:"translate(-50%, -100%)",background:"rgba(30, 41, 59, 0.95)",color:"#e2e8f0",padding:"8px 12px",borderRadius:"6px",fontSize:"13px",fontWeight:500,pointerEvents:"none",zIndex:1e3,boxShadow:"0 4px 6px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(71, 85, 105, 0.5)",lineHeight:"1.5"},children:[(0,fE.jsxs)("div",{children:[u||"Categoria",": ",d(p.key)]}),(0,fE.jsxs)("div",{children:[l||"Valor",": ",S&&p.value>=0?"+":"",h(p.value)]})]})]})},iD=e=>{let{data:t,colorScaleFunc:n}=e;const{filters:r,set:i}=vE(),s=r.bairros||[],o=(t||[]).map(e=>({key:e.neighborhood,value:Number(e.median_price_per_m2),color:n?n(Number(e.median_price_per_m2)):"#2563eb"})).sort((e,t)=>t.value-e.value);return(0,fE.jsx)(rD,{data:o,title:"Todos os Bairros por Pre\xe7o por m\xb2 (".concat(o.length," total)"),xLabel:"Pre\xe7o por m\xb2 (R$)",selectedKeys:s,onBarClick:e=>{const t=String(e),n=s.includes(t);i({bairros:n?void 0:[t]})},formatX:e=>"R$".concat(Math.round(e)),formatKey:e=>String(e),highlightTopN:0})},sD=e=>{let{data:t}=e;const{filters:n,set:i}=vE(),s=(0,r.useRef)(null),[o,a]=(0,r.useState)(260);(0,r.useEffect)(()=>{if(!s.current)return;const e=()=>{if(s.current){const e=window.getComputedStyle(s.current),t=parseFloat(e.paddingLeft),n=parseFloat(e.paddingRight),r=s.current.offsetWidth-t-n;a(Math.min(r,320))}};e();const t=new ResizeObserver(e);return t.observe(s.current),()=>t.disconnect()},[]);const l=t.reduce((e,t)=>e+(Number(t.count)||0),0)||1,u=o,c=.42*u,A=u/2,h=u/2;let d=0;const f={APARTMENT:"#FF5733",HOME:"#2979FF"},p={APARTMENT:"APARTAMENTO",HOME:"CASA"},g=(n.unitTypes||[]).length>0,m=t.map(e=>{const t=Number(e.count)||0,r=t/l*Math.PI*2,s=d,o=d+r;d=o;const a=A+c*Math.sin(s),u=h-c*Math.cos(s),g=A+c*Math.sin(o),m=h-c*Math.cos(o),y=r>Math.PI?1:0,v="M ".concat(A," ").concat(h," L ").concat(a," ").concat(u," A ").concat(c," ").concat(c," 0 ").concat(y," 1 ").concat(g," ").concat(m," Z"),_="".concat(p[e.unit_type]||e.unit_type,": ").concat((t/l*100).toFixed(1),"% (").concat(t,")"),b=(n.unitTypes||[]).includes(e.unit_type);return{path:v,color:f[e.unit_type]||"#64748b",label:_,isActive:b,onClick:()=>{const t=n.unitTypes||[],r=b?t.filter(t=>t!==e.unit_type):[...t,e.unit_type];i({unitTypes:r.length?r:void 0})}}});return(0,fE.jsxs)("div",{ref:s,className:"donut-chart-container",style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,fE.jsx)("h3",{style:{textAlign:"center"},children:"Distribui\xe7\xe3o por tipo"}),(0,fE.jsx)("div",{children:(0,fE.jsxs)("svg",{width:u,height:u,children:[m.map((e,t)=>(0,fE.jsx)("path",{d:e.path,fill:e.color,opacity:g?e.isActive?.8:.35:.8,style:{cursor:"pointer",stroke:e.isActive?"#fff":"none",strokeWidth:e.isActive?3:0,transition:"filter 200ms, transform 200ms",transformOrigin:"".concat(A,"px ").concat(h,"px")},onClick:e.onClick,onMouseEnter:e=>{e.currentTarget.style.filter="brightness(1.2)",e.currentTarget.style.transform="scale(1.01)"},onMouseLeave:e=>{e.currentTarget.style.filter="brightness(1)",e.currentTarget.style.transform="scale(1)"},children:(0,fE.jsx)("title",{children:e.label})},t)),(0,fE.jsx)("circle",{cx:A,cy:h,r:.75*c,fill:"#171c23",stroke:"#2d3748"}),(0,fE.jsx)("text",{x:A,y:h,textAnchor:"middle",dominantBaseline:"central",fontWeight:700,fill:"#e2e8f0",children:l})]})}),(0,fE.jsx)("div",{style:{display:"flex",gap:12,marginTop:8,justifyContent:"center"},children:t.map(e=>(0,fE.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12},children:[(0,fE.jsx)("span",{style:{width:10,height:10,background:f[e.unit_type]||"#64748b"}}),p[e.unit_type]||e.unit_type," (",Number(e.count)||0,")"]},e.unit_type))})]})};class oD extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cD;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(aD(this,e))}has(e){return super.has(aD(this,e))}set(e,t){return super.set(lD(this,e),t)}delete(e){return super.delete(uD(this,e))}}Set;function aD(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):t}function lD(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function uD(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function cD(e){return null!==e&&"object"===typeof e?e.valueOf():e}const AD=Symbol("implicit");function hD(){var e=new oD,t=[],n=[],r=AD;function i(i){let s=e.get(i);if(void 0===s){if(r!==AD)return r;e.set(i,s=t.push(i)-1)}return n[s%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new oD;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return hD(t,n).unknown(r)},Nx.apply(i,arguments),i}function dD(){var e,t,n=hD().unknown(void 0),r=n.domain,i=n.range,s=0,o=1,a=!1,l=0,u=0,c=.5;function A(){var n=r().length,A=o<s,h=A?o:s,d=A?s:o;e=(d-h)/Math.max(1,n-l+2*u),a&&(e=Math.floor(e)),h+=(d-h-e*(n-l))*c,t=e*(1-l),a&&(h=Math.round(h),t=Math.round(t));var f=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),s=new Array(i);++r<i;)s[r]=e+r*n;return s}(n).map(function(t){return h+e*t});return i(A?f.reverse():f)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),A()):r()},n.range=function(e){return arguments.length?([s,o]=e,s=+s,o=+o,A()):[s,o]},n.rangeRound=function(e){return[s,o]=e,s=+s,o=+o,a=!0,A()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(a=!!e,A()):a},n.padding=function(e){return arguments.length?(l=Math.min(1,u=+e),A()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),A()):l},n.paddingOuter=function(e){return arguments.length?(u=+e,A()):u},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),A()):c},n.copy=function(){return dD(r(),[s,o]).round(a).paddingInner(l).paddingOuter(u).align(c)},Nx.apply(A(),arguments)}const fD=e=>{let{data:t,width:n,height:i=320,margin:s,title:o,xLabel:a,yLabel:l,selectedKeys:u=[],onBarClick:c,formatXTick:A=e=>String(e),formatYTick:h=e=>String(e)}=e;const[d,f]=(0,r.useState)(null),p=(0,r.useRef)(null),[g,m]=(0,r.useState)(500),[y,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!p.current)return;const e=()=>{if(p.current){const e=window.getComputedStyle(p.current),t=parseFloat(e.paddingLeft),n=parseFloat(e.paddingRight),r=p.current.offsetWidth-t-n;m(r),v(r<500)}};e();const t=new ResizeObserver(e);return t.observe(p.current),()=>t.disconnect()},[]);const _=s||(y?{top:12,right:12,bottom:32,left:58}:{top:16,right:24,bottom:36,left:60});if(null===t||void 0===t||!t.length)return null;const b=n||g,w=i,E=b-_.left-_.right,x=w-_.top-_.bottom,D=Math.max(...t.map(e=>Number(e.value)||0),1),C=t.map(e=>e.key),S=dD().domain(C).range([0,E]).padding(.15),T=nD().domain([0,D]).range([x,0]).nice(),I=y?10:12,F=y?10:11,R=y?12:14,k=y?4:6;return(0,fE.jsxs)("div",{ref:p,className:"bedrooms-chart-container",style:{position:"relative",width:"100%"},children:[o?(0,fE.jsx)("h3",{children:o}):null,(0,fE.jsx)("div",{style:{overflowX:"auto"},children:(0,fE.jsx)("svg",{width:b,height:w,children:(0,fE.jsxs)("g",{transform:"translate(".concat(_.left,",").concat(_.top,")"),children:[t.map(e=>{var t;const n=null!==(t=S(e.key))&&void 0!==t?t:0,r=S.bandwidth(),i=Number(e.value)||0,s=T(i),o=x-s,a=u.includes(e.key),l=u.length>0&&!a,A=Math.max(s-6,12);return(0,fE.jsxs)("g",{children:[(0,fE.jsx)("rect",{x:n,y:s,width:r,height:o,fill:a?"#1d4ed8":"#2979FF",opacity:l?.35:.8,stroke:"#2d3748",strokeWidth:1,rx:2,style:{cursor:c?"pointer":"default",transition:"y 400ms, height 400ms, opacity 200ms, fill 200ms, filter 200ms, transform 200ms",transformOrigin:"".concat(n+r/2,"px ").concat(s+o,"px")},onClick:()=>c&&c(e.key),onMouseEnter:t=>{t.currentTarget.style.filter="brightness(1.2)",t.currentTarget.style.transform="scale(1.01)";const n=t.currentTarget.getBoundingClientRect();f({key:e.key,value:i,x:n.left+n.width/2,y:n.top})},onMouseLeave:e=>{e.currentTarget.style.filter="brightness(1)",e.currentTarget.style.transform="scale(1)",f(null)}}),(0,fE.jsx)("text",{x:n+r/2,y:A,textAnchor:"middle",fontSize:F,fill:"#e2e8f0",fontWeight:600,style:{pointerEvents:"none"},children:Math.round(i)})]},String(e.key))}),(0,fE.jsxs)("g",{transform:"translate(0, ".concat(x,")"),children:[(0,fE.jsx)("line",{x1:0,x2:E,stroke:"#4a5568",strokeWidth:1}),C.map(e=>{var t;const n=(null!==(t=S(e))&&void 0!==t?t:0)+S.bandwidth()/2;return(0,fE.jsxs)("g",{transform:"translate(".concat(n,",0)"),children:[(0,fE.jsx)("line",{y1:0,y2:6,stroke:"#4a5568"}),(0,fE.jsx)("text",{y:18,textAnchor:"middle",fontSize:I,fill:"#a0aec0",fontWeight:500,children:A(e)})]},"xtick-".concat(String(e)))}),a?(0,fE.jsx)("text",{x:E/2,y:y?30:34,textAnchor:"middle",fontSize:R,fill:"#e2e8f0",fontWeight:600,children:a}):null]}),(0,fE.jsxs)("g",{children:[(0,fE.jsx)("line",{y1:0,y2:x,stroke:"#4a5568",strokeWidth:1}),T.ticks(k).map(e=>(0,fE.jsxs)("g",{transform:"translate(0, ".concat(T(e),")"),children:[(0,fE.jsx)("line",{x2:-6,stroke:"#4a5568"}),(0,fE.jsx)("text",{x:-10,textAnchor:"end",dy:"0.35em",fontSize:I,fill:"#a0aec0",fontWeight:500,children:h(e)})]},e)),l?(0,fE.jsx)("text",{x:y?-45:-50,y:x/2,textAnchor:"middle",fontSize:R,fill:"#e2e8f0",fontWeight:600,transform:"rotate(-90, ".concat(y?-45:-50,", ").concat(x/2,")"),children:l}):null]})]})})}),d&&(0,fE.jsxs)("div",{style:{position:"fixed",left:d.x,top:d.y-10,transform:"translate(-50%, -100%)",background:"rgba(30, 41, 59, 0.95)",color:"#e2e8f0",padding:y?"6px 10px":"8px 12px",borderRadius:"6px",fontSize:y?"11px":"13px",fontWeight:500,pointerEvents:"none",zIndex:1e3,boxShadow:"0 4px 6px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(71, 85, 105, 0.5)",lineHeight:"1.5"},children:[(0,fE.jsxs)("div",{children:[a||"Categoria",": ",A(d.key)]}),(0,fE.jsxs)("div",{children:[l||"Valor",": ",h(d.value)]})]})]})},pD=e=>{let{data:t}=e;const{filters:n,set:i}=vE(),s=n.bedrooms||[],o=r.useMemo(()=>{const e=new Map;return(t||[]).forEach(t=>{const n=t.bedrooms_bin,r=n>=7?7:n;e.set(r,(e.get(r)||0)+(Number(t.count)||0))}),Array.from(e.entries()).map(e=>{let[t,n]=e;return{key:t,value:n}})},[t]);return(0,fE.jsx)(fD,{data:o,title:"Im\xf3veis por Quartos",xLabel:"Quartos",yLabel:"N\xfamero de Im\xf3veis",selectedKeys:s,onBarClick:e=>{const t=Number(e),n=s.includes(t)?s.filter(e=>e!==t):[...s,t];i({bedrooms:n.length?n:void 0})},formatXTick:e=>Number(e)>=7?"7+":String(e),formatYTick:e=>String(Math.round(e))})};var gD,mD,yD,vD,_D,bD,wD,ED,xD,DD,CD,SD,TD,ID;Array.prototype.slice;function FD(e){return function(){return e}}function RD(e){this._context=e}function kD(e){return new RD(e)}function PD(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}RD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};const MD=Math.PI,BD=2*MD,LD=1e-6,OD=BD-LD;function ND(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class UD{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?ND:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return ND;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(gD||(gD=PD(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(mD||(mD=PD(["Z"]))))}lineTo(e,t){this._append(yD||(yD=PD(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(vD||(vD=PD(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,i,s){this._append(_D||(_D=PD(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+i,this._y1=+s)}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let s=this._x1,o=this._y1,a=n-e,l=r-t,u=s-e,c=o-t,A=u*u+c*c;if(null===this._x1)this._append(bD||(bD=PD(["M",",",""])),this._x1=e,this._y1=t);else if(A>LD)if(Math.abs(c*a-l*u)>LD&&i){let h=n-s,d=r-o,f=a*a+l*l,p=h*h+d*d,g=Math.sqrt(f),m=Math.sqrt(A),y=i*Math.tan((MD-Math.acos((f+A-p)/(2*g*m)))/2),v=y/m,_=y/g;Math.abs(v-1)>LD&&this._append(ED||(ED=PD(["L",",",""])),e+v*u,t+v*c),this._append(xD||(xD=PD(["A",",",",0,0,",",",",",""])),i,i,+(c*h>u*d),this._x1=e+_*a,this._y1=t+_*l)}else this._append(wD||(wD=PD(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,i,s){if(e=+e,t=+t,s=!!s,(n=+n)<0)throw new Error("negative radius: ".concat(n));let o=n*Math.cos(r),a=n*Math.sin(r),l=e+o,u=t+a,c=1^s,A=s?r-i:i-r;null===this._x1?this._append(DD||(DD=PD(["M",",",""])),l,u):(Math.abs(this._x1-l)>LD||Math.abs(this._y1-u)>LD)&&this._append(CD||(CD=PD(["L",",",""])),l,u),n&&(A<0&&(A=A%BD+BD),A>OD?this._append(SD||(SD=PD(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,c,e-o,t-a,n,n,c,this._x1=l,this._y1=u):A>LD&&this._append(TD||(TD=PD(["A",",",",0,",",",",",",",""])),n,n,+(A>=MD),c,this._x1=e+n*Math.cos(i),this._y1=t+n*Math.sin(i)))}rect(e,t,n,r){this._append(ID||(ID=PD(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function zD(e){return e[0]}function jD(e){return e[1]}function VD(e,t){var n=FD(!0),r=null,i=kD,s=null,o=function(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new UD(t)}(a);function a(a){var l,u,c,A=(a=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}(a)).length,h=!1;for(null==r&&(s=i(c=o())),l=0;l<=A;++l)!(l<A&&n(u=a[l],l,a))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(u,l,a),+t(u,l,a));if(c)return s=null,c+""||null}return e="function"===typeof e?e:void 0===e?zD:FD(e),t="function"===typeof t?t:void 0===t?jD:FD(t),a.x=function(t){return arguments.length?(e="function"===typeof t?t:FD(+t),a):e},a.y=function(e){return arguments.length?(t="function"===typeof e?e:FD(+e),a):t},a.defined=function(e){return arguments.length?(n="function"===typeof e?e:FD(!!e),a):n},a.curve=function(e){return arguments.length?(i=e,null!=r&&(s=i(r)),a):i},a.context=function(e){return arguments.length?(null==e?r=s=null:s=i(r=e),a):r},a}function GD(e){return e<0?-1:1}function WD(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),a=(s*i+o*r)/(r+i);return(GD(s)+GD(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function HD(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function QD(e,t,n){var r=e._x0,i=e._y0,s=e._x1,o=e._y1,a=(s-r)/3;e._context.bezierCurveTo(r+a,i+a*t,s-a,o-a*n,s,o)}function XD(e){this._context=e}function YD(e){this._context=new qD(e)}function qD(e){this._context=e}function KD(e){return new XD(e)}XD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:QD(this,this._t0,HD(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,QD(this,HD(this,n=WD(this,e,t)),n);break;default:QD(this,this._t0,n=WD(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(YD.prototype=Object.create(XD.prototype)).point=function(e,t){XD.prototype.point.call(this,t,e)},qD.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};var ZD={value:()=>{}};function JD(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new $D(r)}function $D(e){this._=e}function eC(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function tC(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=ZD,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}$D.prototype=JD.prototype={constructor:$D,on:function(e,t){var n,r,i=this._,s=(r=i,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),o=-1,a=s.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(n=(e=s[o]).type)i[n]=tC(i[n],e.name,t);else if(null==t)for(n in i)i[n]=tC(i[n],e.name,null);return this}for(;++o<a;)if((n=(e=s[o]).type)&&(n=eC(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new $D(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),s=0;s<n;++s)i[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=0,n=(r=this._[e]).length;s<n;++s)r[s].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};const nC=JD;function rC(){}function iC(e){return null==e?rC:function(){return this.querySelector(e)}}function sC(){return[]}function oC(e){return null==e?sC:function(){return this.querySelectorAll(e)}}function aC(e){return function(){return function(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}(e.apply(this,arguments))}}function lC(e){return function(){return this.matches(e)}}function uC(e){return function(t){return t.matches(e)}}var cC=Array.prototype.find;function AC(){return this.firstElementChild}var hC=Array.prototype.filter;function dC(){return Array.from(this.children)}function fC(e){return new Array(e.length)}function pC(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function gC(e,t,n,r,i,s){for(var o,a=0,l=t.length,u=s.length;a<u;++a)(o=t[a])?(o.__data__=s[a],r[a]=o):n[a]=new pC(e,s[a]);for(;a<l;++a)(o=t[a])&&(i[a]=o)}function mC(e,t,n,r,i,s,o){var a,l,u,c=new Map,A=t.length,h=s.length,d=new Array(A);for(a=0;a<A;++a)(l=t[a])&&(d[a]=u=o.call(l,l.__data__,a,t)+"",c.has(u)?i[a]=l:c.set(u,l));for(a=0;a<h;++a)u=o.call(e,s[a],a,s)+"",(l=c.get(u))?(r[a]=l,l.__data__=s[a],c.delete(u)):n[a]=new pC(e,s[a]);for(a=0;a<A;++a)(l=t[a])&&c.get(d[a])===l&&(i[a]=l)}function yC(e){return e.__data__}function vC(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function _C(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}pC.prototype={constructor:pC,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var bC="http://www.w3.org/1999/xhtml";const wC={svg:"http://www.w3.org/2000/svg",xhtml:bC,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function EC(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),wC.hasOwnProperty(t)?{space:wC[t],local:e}:e}function xC(e){return function(){this.removeAttribute(e)}}function DC(e){return function(){this.removeAttributeNS(e.space,e.local)}}function CC(e,t){return function(){this.setAttribute(e,t)}}function SC(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function TC(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function IC(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function FC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function RC(e){return function(){this.style.removeProperty(e)}}function kC(e,t,n){return function(){this.style.setProperty(e,t,n)}}function PC(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function MC(e,t){return e.style.getPropertyValue(t)||FC(e).getComputedStyle(e,null).getPropertyValue(t)}function BC(e){return function(){delete this[e]}}function LC(e,t){return function(){this[e]=t}}function OC(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function NC(e){return e.trim().split(/^|\s+/)}function UC(e){return e.classList||new zC(e)}function zC(e){this._node=e,this._names=NC(e.getAttribute("class")||"")}function jC(e,t){for(var n=UC(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function VC(e,t){for(var n=UC(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function GC(e){return function(){jC(this,e)}}function WC(e){return function(){VC(this,e)}}function HC(e,t){return function(){(t.apply(this,arguments)?jC:VC)(this,e)}}function QC(){this.textContent=""}function XC(e){return function(){this.textContent=e}}function YC(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function qC(){this.innerHTML=""}function KC(e){return function(){this.innerHTML=e}}function ZC(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function JC(){this.nextSibling&&this.parentNode.appendChild(this)}function $C(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function eS(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===bC&&t.documentElement.namespaceURI===bC?t.createElement(e):t.createElementNS(n,e)}}function tS(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function nS(e){var t=EC(e);return(t.local?tS:eS)(t)}function rS(){return null}function iS(){var e=this.parentNode;e&&e.removeChild(this)}function sS(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function oS(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function aS(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,s=t.length;r<s;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function lS(e,t,n){return function(){var r,i=this.__on,s=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var o=0,a=i.length;o<a;++o)if((r=i[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),void(r.value=t);this.addEventListener(e.type,s,n),r={type:e.type,name:e.name,value:t,listener:s,options:n},i?i.push(r):this.__on=[r]}}function uS(e,t,n){var r=FC(e),i=r.CustomEvent;"function"===typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function cS(e,t){return function(){return uS(this,e,t)}}function AS(e,t){return function(){return uS(this,e,t.apply(this,arguments))}}zC.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var hS=[null];function dS(e,t){this._groups=e,this._parents=t}function fS(){return new dS([[document.documentElement]],hS)}dS.prototype=fS.prototype={constructor:dS,select:function(e){"function"!==typeof e&&(e=iC(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s,o,a=t[i],l=a.length,u=r[i]=new Array(l),c=0;c<l;++c)(s=a[c])&&(o=e.call(s,s.__data__,c,a))&&("__data__"in s&&(o.__data__=s.__data__),u[c]=o);return new dS(r,this._parents)},selectAll:function(e){e="function"===typeof e?aC(e):oC(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o,a=t[s],l=a.length,u=0;u<l;++u)(o=a[u])&&(r.push(e.call(o,o.__data__,u,a)),i.push(o));return new dS(r,i)},selectChild:function(e){return this.select(null==e?AC:function(e){return function(){return cC.call(this.children,e)}}("function"===typeof e?e:uC(e)))},selectChildren:function(e){return this.selectAll(null==e?dC:function(e){return function(){return hC.call(this.children,e)}}("function"===typeof e?e:uC(e)))},filter:function(e){"function"!==typeof e&&(e=lC(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s,o=t[i],a=o.length,l=r[i]=[],u=0;u<a;++u)(s=o[u])&&e.call(s,s.__data__,u,o)&&l.push(s);return new dS(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,yC);var n=t?mC:gC,r=this._parents,i=this._groups;"function"!==typeof e&&(e=function(e){return function(){return e}}(e));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),u=0;u<s;++u){var c=r[u],A=i[u],h=A.length,d=vC(e.call(c,c&&c.__data__,u,r)),f=d.length,p=a[u]=new Array(f),g=o[u]=new Array(f);n(c,A,p,g,l[u]=new Array(h),d,t);for(var m,y,v=0,_=0;v<f;++v)if(m=p[v]){for(v>=_&&(_=v+1);!(y=g[_])&&++_<f;);m._next=y||null}}return(o=new dS(o,r))._enter=a,o._exit=l,o},enter:function(){return new dS(this._enter||this._groups.map(fC),this._parents)},exit:function(){return new dS(this._exit||this._groups.map(fC),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,s=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?s.remove():n(s),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var u,c=n[l],A=r[l],h=c.length,d=a[l]=new Array(h),f=0;f<h;++f)(u=c[f]||A[f])&&(d[f]=u);for(;l<i;++l)a[l]=n[l];return new dS(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],s=i.length-1,o=i[s];--s>=0;)(r=i[s])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=_C);for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o,a=n[s],l=a.length,u=i[s]=new Array(l),c=0;c<l;++c)(o=a[c])&&(u[c]=o);u.sort(t)}return new dS(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,s=t[n],o=0,a=s.length;o<a;++o)(i=s[o])&&e.call(i,i.__data__,o,s);return this},attr:function(e,t){var n=EC(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?DC:xC:"function"===typeof t?n.local?IC:TC:n.local?SC:CC)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?RC:"function"===typeof t?PC:kC)(e,t,null==n?"":n)):MC(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?BC:"function"===typeof t?OC:LC)(e,t)):this.node()[e]},classed:function(e,t){var n=NC(e+"");if(arguments.length<2){for(var r=UC(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof t?HC:t?GC:WC)(n,t))},text:function(e){return arguments.length?this.each(null==e?QC:("function"===typeof e?YC:XC)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?qC:("function"===typeof e?ZC:KC)(e)):this.node().innerHTML},raise:function(){return this.each(JC)},lower:function(){return this.each($C)},append:function(e){var t="function"===typeof e?e:nS(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"===typeof e?e:nS(e),r=null==t?rS:"function"===typeof t?t:iC(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(iS)},clone:function(e){return this.select(e?oS:sS)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,s=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),o=s.length;if(!(arguments.length<2)){for(a=t?lS:aS,r=0;r<o;++r)this.each(a(s[r],t,n));return this}var a=this.node().__on;if(a)for(var l,u=0,c=a.length;u<c;++u)for(r=0,l=a[u];r<o;++r)if((i=s[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"===typeof t?AS:cS)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],s=0,o=i.length;s<o;++s)(r=i[s])&&(yield r)}};const pS=fS;function gS(e){return"string"===typeof e?new dS([[document.querySelector(e)]],[document.documentElement]):new dS([[e]],hS)}const mS={capture:!0,passive:!1};function yS(e){e.preventDefault(),e.stopImmediatePropagation()}function vS(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}var _S,bS,wS=0,ES=0,xS=0,DS=0,CS=0,SS=0,TS="object"===typeof performance&&performance.now?performance:Date,IS="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function FS(){return CS||(IS(RS),CS=TS.now()+SS)}function RS(){CS=0}function kS(){this._call=this._time=this._next=null}function PS(e,t,n){var r=new kS;return r.restart(e,t,n),r}function MS(){CS=(DS=TS.now())+SS,wS=ES=0;try{!function(){FS(),++wS;for(var e,t=_S;t;)(e=CS-t._time)>=0&&t._call.call(void 0,e),t=t._next;--wS}()}finally{wS=0,function(){var e,t,n=_S,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:_S=t);bS=e,LS(r)}(),CS=0}}function BS(){var e=TS.now(),t=e-DS;t>1e3&&(SS-=t,DS=e)}function LS(e){wS||(ES&&(ES=clearTimeout(ES)),e-CS>24?(e<1/0&&(ES=setTimeout(MS,e-TS.now()-SS)),xS&&(xS=clearInterval(xS))):(xS||(DS=TS.now(),xS=setInterval(BS,1e3)),wS=1,IS(MS)))}function OS(e,t,n){var r=new kS;return t=null==t?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}kS.prototype=PS.prototype={constructor:kS,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?FS():+n)+(null==t?0:+t),this._next||bS===this||(bS?bS._next=this:_S=this,bS=this),this._call=e,this._time=n,LS()},stop:function(){this._call&&(this._call=null,this._time=1/0,LS())}};var NS=nC("start","end","cancel","interrupt"),US=[];function zS(e,t,n,r,i,s){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function s(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}function o(s){var u,c,A,h;if(1!==n.state)return l();for(u in i)if((h=i[u]).name===n.name){if(3===h.state)return OS(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete i[u]):+u<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete i[u])}if(OS(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(s))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(A=n.tween.length),u=0,c=-1;u<A;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++c]=h);r.length=c+1}}function a(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),s=-1,o=r.length;++s<o;)r[s].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=PS(s,0,n.time)}(e,n,{name:t,index:r,group:i,on:NS,tween:US,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function jS(e,t){var n=GS(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function VS(e,t){var n=GS(e,t);if(n.state>3)throw new Error("too late; already running");return n}function GS(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function WS(e,t){var n,r,i,s=e.__transition,o=!0;if(s){for(i in t=null==t?null:t+"",s)(n=s[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete s[i]):o=!1;o&&delete e.__transition}}var HS,QS=180/Math.PI,XS={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function YS(e,t,n,r,i,s){var o,a,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*QS,skewX:Math.atan(l)*QS,scaleX:o,scaleY:a}}function qS(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(s,o){var a=[],l=[];return s=e(s),o=e(o),function(e,r,i,s,o,a){if(e!==i||r!==s){var l=o.push("translate(",null,t,null,n);a.push({i:l-4,x:Ex(e,i)},{i:l-2,x:Ex(r,s)})}else(i||s)&&o.push("translate("+i+t+s+n)}(s.translateX,s.translateY,o.translateX,o.translateY,a,l),function(e,t,n,s){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),s.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Ex(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(s.rotate,o.rotate,a,l),function(e,t,n,s){e!==t?s.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Ex(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(s.skewX,o.skewX,a,l),function(e,t,n,r,s,o){if(e!==n||t!==r){var a=s.push(i(s)+"scale(",null,",",null,")");o.push({i:a-4,x:Ex(e,n)},{i:a-2,x:Ex(t,r)})}else 1===n&&1===r||s.push(i(s)+"scale("+n+","+r+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,a,l),s=o=null,function(e){for(var t,n=-1,r=l.length;++n<r;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var KS=qS(function(e){const t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?XS:YS(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),ZS=qS(function(e){return null==e?XS:(HS||(HS=document.createElementNS("http://www.w3.org/2000/svg","g")),HS.setAttribute("transform",e),(e=HS.transform.baseVal.consolidate())?YS((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):XS)},", ",")",")");function JS(e,t){var n,r;return function(){var i=VS(this,e),s=i.tween;if(s!==n)for(var o=0,a=(r=n=s).length;o<a;++o)if(r[o].name===t){(r=r.slice()).splice(o,1);break}i.tween=r}}function $S(e,t,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var s=VS(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=a;break}l===u&&i.push(a)}s.tween=i}}function eT(e,t,n){var r=e._id;return e.each(function(){var e=VS(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return GS(e,r).value[t]}}function tT(e,t){var n;return("number"===typeof t?Ex:t instanceof JE?vx:(n=JE(t))?(t=n,vx):Sx)(e,t)}function nT(e){return function(){this.removeAttribute(e)}}function rT(e){return function(){this.removeAttributeNS(e.space,e.local)}}function iT(e,t,n){var r,i,s=n+"";return function(){var o=this.getAttribute(e);return o===s?null:o===r?i:i=t(r=o,n)}}function sT(e,t,n){var r,i,s=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===s?null:o===r?i:i=t(r=o,n)}}function oT(e,t,n){var r,i,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttribute(e))===(a=l+"")?null:o===r&&a===i?s:(i=a,s=t(r=o,l));this.removeAttribute(e)}}function aT(e,t,n){var r,i,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttributeNS(e.space,e.local))===(a=l+"")?null:o===r&&a===i?s:(i=a,s=t(r=o,l));this.removeAttributeNS(e.space,e.local)}}function lT(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,i)),n}return i._value=t,i}function uT(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,i)),n}return i._value=t,i}function cT(e,t){return function(){jS(this,e).delay=+t.apply(this,arguments)}}function AT(e,t){return t=+t,function(){jS(this,e).delay=t}}function hT(e,t){return function(){VS(this,e).duration=+t.apply(this,arguments)}}function dT(e,t){return t=+t,function(){VS(this,e).duration=t}}var fT=pS.prototype.constructor;function pT(e){return function(){this.style.removeProperty(e)}}var gT=0;function mT(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function yT(){return++gT}var vT=pS.prototype;mT.prototype=function(e){return pS().transition(e)}.prototype={constructor:mT,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=iC(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a,l,u=r[o],c=u.length,A=s[o]=new Array(c),h=0;h<c;++h)(a=u[h])&&(l=e.call(a,a.__data__,h,u))&&("__data__"in a&&(l.__data__=a.__data__),A[h]=l,zS(A[h],t,n,h,A,GS(a,n)));return new mT(s,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=oC(e));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var l,u=r[a],c=u.length,A=0;A<c;++A)if(l=u[A]){for(var h,d=e.call(l,l.__data__,A,u),f=GS(l,n),p=0,g=d.length;p<g;++p)(h=d[p])&&zS(h,t,n,p,d,f);s.push(d),o.push(l)}return new mT(s,o,t,n)},selectChild:vT.selectChild,selectChildren:vT.selectChildren,filter:function(e){"function"!==typeof e&&(e=lC(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s,o=t[i],a=o.length,l=r[i]=[],u=0;u<a;++u)(s=o[u])&&e.call(s,s.__data__,u,o)&&l.push(s);return new mT(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var l,u=t[a],c=n[a],A=u.length,h=o[a]=new Array(A),d=0;d<A;++d)(l=u[d]||c[d])&&(h[d]=l);for(;a<r;++a)o[a]=t[a];return new mT(o,this._parents,this._name,this._id)},selection:function(){return new fT(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=yT(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o,a=r[s],l=a.length,u=0;u<l;++u)if(o=a[u]){var c=GS(o,t);zS(o,e,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new mT(r,this._parents,e,n)},call:vT.call,nodes:vT.nodes,node:vT.node,size:vT.size,empty:vT.empty,each:vT.each,on:function(e,t){var n=this._id;return arguments.length<2?GS(this.node(),n).on.on(e):this.each(function(e,t,n){var r,i,s=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?jS:VS;return function(){var o=s(this,e),a=o.on;a!==r&&(i=(r=a).copy()).on(t,n),o.on=i}}(n,e,t))},attr:function(e,t){var n=EC(e),r="transform"===n?ZS:tT;return this.attrTween(e,"function"===typeof t?(n.local?aT:oT)(n,r,eT(this,"attr."+e,t)):null==t?(n.local?rT:nT)(n):(n.local?sT:iT)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=EC(e);return this.tween(n,(r.local?lT:uT)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?KS:tT;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var s=MC(this,e),o=(this.style.removeProperty(e),MC(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}(e,r)).on("end.style."+e,pT(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,i,s;return function(){var o=MC(this,e),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(e),l=a=MC(this,e)),o===l?null:o===r&&l===i?s:(i=l,s=t(r=o,a))}}(e,r,eT(this,"style."+e,t))).each(function(e,t){var n,r,i,s,o="style."+t,a="end."+o;return function(){var l=VS(this,e),u=l.on,c=null==l.value[o]?s||(s=pT(t)):void 0;u===n&&i===c||(r=(n=u).copy()).on(a,i=c),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,s=n+"";return function(){var o=MC(this,e);return o===s?null:o===r?i:i=t(r=o,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,i;function s(){var s=t.apply(this,arguments);return s!==i&&(r=(i=s)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,s,n)),r}return s._value=t,s}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(eT(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=GS(this.node(),n).tween,s=0,o=i.length;s<o;++s)if((r=i[s]).name===e)return r.value;return null}return this.each((null==t?JS:$S)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?cT:AT)(t,e)):GS(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?hT:dT)(t,e)):GS(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){VS(this,e).ease=t}}(t,e)):GS(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;VS(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},l={value:function(){0===--i&&s()}};n.each(function(){var n=VS(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),n.on=t}),0===i&&s()})},[Symbol.iterator]:vT[Symbol.iterator]};var _T={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function bT(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}pS.prototype.interrupt=function(e){return this.each(function(){WS(this,e)})},pS.prototype.transition=function(e){var t,n;e instanceof mT?(t=e._id,e=e._name):(t=yT(),(n=_T).time=FS(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o,a=r[s],l=a.length,u=0;u<l;++u)(o=a[u])&&zS(o,e,t,u,a,n||bT(o,t));return new mT(r,this._parents,e,t)};const wT=e=>()=>e;function ET(e,t){let{sourceEvent:n,target:r,selection:i,mode:s,dispatch:o}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:s,enumerable:!0,configurable:!0},_:{value:o}})}function xT(e){e.preventDefault(),e.stopImmediatePropagation()}var DT={name:"drag"},CT={name:"space"},ST={name:"handle"},TT={name:"center"};const{abs:IT,max:FT,min:RT}=Math;function kT(e){return[+e[0],+e[1]]}function PT(e){return[kT(e[0]),kT(e[1])]}var MT={name:"x",handles:["w","e"].map(jT),input:function(e,t){return null==e?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},BT={name:"y",handles:["n","s"].map(jT),input:function(e,t){return null==e?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},LT=(["n","w","e","s","nw","ne","sw","se"].map(jT),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),OT={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},NT={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},UT={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},zT={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function jT(e){return{type:e}}function VT(e){return!e.ctrlKey&&!e.button}function GT(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function WT(){return navigator.maxTouchPoints||"ontouchstart"in this}function HT(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function QT(e){var t,n=GT,r=VT,i=WT,s=!0,o=nC("start","brush","end"),a=6;function l(t){var n=t.property("__brush",p).selectAll(".overlay").data([jT("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",LT.overlay).merge(n).each(function(){var e=HT(this).extent;gS(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])}),t.selectAll(".selection").data([jT("selection")]).enter().append("rect").attr("class","selection").attr("cursor",LT.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(e.handles,function(e){return e.type});r.exit().remove(),r.enter().append("rect").attr("class",function(e){return"handle handle--"+e.type}).attr("cursor",function(e){return LT[e.type]}),t.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(i).on("touchstart.brush",h).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",f).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){var e=gS(this),t=HT(this).selection;t?(e.selectAll(".selection").style("display",null).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1]),e.selectAll(".handle").style("display",null).attr("x",function(e){return"e"===e.type[e.type.length-1]?t[1][0]-a/2:t[0][0]-a/2}).attr("y",function(e){return"s"===e.type[0]?t[1][1]-a/2:t[0][1]-a/2}).attr("width",function(e){return"n"===e.type||"s"===e.type?t[1][0]-t[0][0]+a:a}).attr("height",function(e){return"e"===e.type||"w"===e.type?t[1][1]-t[0][1]+a:a})):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function c(e,t,n){var r=e.__brush.emitter;return!r||n&&r.clean?new A(e,t,n):r}function A(e,t,n){this.that=e,this.args=t,this.state=e.__brush,this.active=0,this.clean=n}function h(n){if((!t||n.touches)&&r.apply(this,arguments)){var i,o,a,l,A,h,d,f,p,g,m,y=this,v=n.target.__data__.type,_="selection"===(s&&n.metaKey?v="overlay":v)?DT:s&&n.altKey?TT:ST,b=e===BT?null:UT[v],w=e===MT?null:zT[v],E=HT(y),x=E.extent,D=E.selection,C=x[0][0],S=x[0][1],T=x[1][0],I=x[1][1],F=0,R=0,k=b&&w&&s&&n.shiftKey,P=Array.from(n.touches||[n],e=>{const t=e.identifier;return(e=vS(e,y)).point0=e.slice(),e.identifier=t,e});WS(y);var M=c(y,arguments,!0).beforestart();if("overlay"===v){D&&(p=!0);const t=[P[0],P[1]||P[0]];E.selection=D=[[i=e===BT?C:RT(t[0][0],t[1][0]),a=e===MT?S:RT(t[0][1],t[1][1])],[A=e===BT?T:FT(t[0][0],t[1][0]),d=e===MT?I:FT(t[0][1],t[1][1])]],P.length>1&&U(n)}else i=D[0][0],a=D[0][1],A=D[1][0],d=D[1][1];o=i,l=a,h=A,f=d;var B=gS(y).attr("pointer-events","none"),L=B.selectAll(".overlay").attr("cursor",LT[v]);if(n.touches)M.moved=N,M.ended=z;else{var O=gS(n.view).on("mousemove.brush",N,!0).on("mouseup.brush",z,!0);s&&O.on("keydown.brush",function(e){switch(e.keyCode){case 16:k=b&&w;break;case 18:_===ST&&(b&&(A=h-F*b,i=o+F*b),w&&(d=f-R*w,a=l+R*w),_=TT,U(e));break;case 32:_!==ST&&_!==TT||(b<0?A=h-F:b>0&&(i=o-F),w<0?d=f-R:w>0&&(a=l-R),_=CT,L.attr("cursor",LT.selection),U(e));break;default:return}xT(e)},!0).on("keyup.brush",function(e){switch(e.keyCode){case 16:k&&(g=m=k=!1,U(e));break;case 18:_===TT&&(b<0?A=h:b>0&&(i=o),w<0?d=f:w>0&&(a=l),_=ST,U(e));break;case 32:_===CT&&(e.altKey?(b&&(A=h-F*b,i=o+F*b),w&&(d=f-R*w,a=l+R*w),_=TT):(b<0?A=h:b>0&&(i=o),w<0?d=f:w>0&&(a=l),_=ST),L.attr("cursor",LT[v]),U(e));break;default:return}xT(e)},!0),function(e){var t=e.document.documentElement,n=gS(e).on("dragstart.drag",yS,mS);"onselectstart"in t?n.on("selectstart.drag",yS,mS):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}(n.view)}u.call(y),M.start(n,_.name)}function N(e){for(const t of e.changedTouches||[e])for(const e of P)e.identifier===t.identifier&&(e.cur=vS(t,y));if(k&&!g&&!m&&1===P.length){const e=P[0];IT(e.cur[0]-e[0])>IT(e.cur[1]-e[1])?m=!0:g=!0}for(const t of P)t.cur&&(t[0]=t.cur[0],t[1]=t.cur[1]);p=!0,xT(e),U(e)}function U(e){const t=P[0],n=t.point0;var r;switch(F=t[0]-n[0],R=t[1]-n[1],_){case CT:case DT:b&&(F=FT(C-i,RT(T-A,F)),o=i+F,h=A+F),w&&(R=FT(S-a,RT(I-d,R)),l=a+R,f=d+R);break;case ST:P[1]?(b&&(o=FT(C,RT(T,P[0][0])),h=FT(C,RT(T,P[1][0])),b=1),w&&(l=FT(S,RT(I,P[0][1])),f=FT(S,RT(I,P[1][1])),w=1)):(b<0?(F=FT(C-i,RT(T-i,F)),o=i+F,h=A):b>0&&(F=FT(C-A,RT(T-A,F)),o=i,h=A+F),w<0?(R=FT(S-a,RT(I-a,R)),l=a+R,f=d):w>0&&(R=FT(S-d,RT(I-d,R)),l=a,f=d+R));break;case TT:b&&(o=FT(C,RT(T,i-F*b)),h=FT(C,RT(T,A+F*b))),w&&(l=FT(S,RT(I,a-R*w)),f=FT(S,RT(I,d+R*w)))}h<o&&(b*=-1,r=i,i=A,A=r,r=o,o=h,h=r,v in OT&&L.attr("cursor",LT[v=OT[v]])),f<l&&(w*=-1,r=a,a=d,d=r,r=l,l=f,f=r,v in NT&&L.attr("cursor",LT[v=NT[v]])),E.selection&&(D=E.selection),g&&(o=D[0][0],h=D[1][0]),m&&(l=D[0][1],f=D[1][1]),D[0][0]===o&&D[0][1]===l&&D[1][0]===h&&D[1][1]===f||(E.selection=[[o,l],[h,f]],u.call(y),M.brush(e,_.name))}function z(e){if(function(e){e.stopImmediatePropagation()}(e),e.touches){if(e.touches.length)return;t&&clearTimeout(t),t=setTimeout(function(){t=null},500)}else!function(e,t){var n=e.document.documentElement,r=gS(e).on("dragstart.drag",null);t&&(r.on("click.drag",yS,mS),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(e.view,p),O.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);B.attr("pointer-events","all"),L.attr("cursor",LT.overlay),E.selection&&(D=E.selection),function(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}(D)&&(E.selection=null,u.call(y)),M.end(e,_.name)}}function d(e){c(this,arguments).moved(e)}function f(e){c(this,arguments).ended(e)}function p(){var t=this.__brush||{selection:null};return t.extent=PT(n.apply(this,arguments)),t.dim=e,t}return l.move=function(t,n,r){t.tween?t.on("start.brush",function(e){c(this,arguments).beforestart().start(e)}).on("interrupt.brush end.brush",function(e){c(this,arguments).end(e)}).tween("brush",function(){var t=this,r=t.__brush,i=c(t,arguments),s=r.selection,o=e.input("function"===typeof n?n.apply(this,arguments):n,r.extent),a=Ix(s,o);function l(e){r.selection=1===e&&null===o?null:a(e),u.call(t),i.brush()}return null!==s&&null!==o?l:l(1)}):t.each(function(){var t=this,i=arguments,s=t.__brush,o=e.input("function"===typeof n?n.apply(t,i):n,s.extent),a=c(t,i).beforestart();WS(t),s.selection=null===o?null:o,u.call(t),a.start(r).brush(r).end(r)})},l.clear=function(e,t){l.move(e,null,t)},A.prototype={beforestart:function(){return 1===++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(e,t){return this.starting?(this.starting=!1,this.emit("start",e,t)):this.emit("brush",e),this},brush:function(e,t){return this.emit("brush",e,t),this},end:function(e,t){return 0===--this.active&&(delete this.state.emitter,this.emit("end",e,t)),this},emit:function(t,n,r){var i=gS(this.that).datum();o.call(t,this.that,new ET(t,{sourceEvent:n,target:l,selection:e.output(this.state.selection),mode:r,dispatch:o}),i)}},l.extent=function(e){return arguments.length?(n="function"===typeof e?e:wT(PT(e)),l):n},l.filter=function(e){return arguments.length?(r="function"===typeof e?e:wT(!!e),l):r},l.touchable=function(e){return arguments.length?(i="function"===typeof e?e:wT(!!e),l):i},l.handleSize=function(e){return arguments.length?(a=+e,l):a},l.keyModifiers=function(e){return arguments.length?(s=!!e,l):s},l.on=function(){var e=o.on.apply(o,arguments);return e===o?l:e},l}const XT=e=>{let{data:t,width:n,height:i=320,margin:s,title:o,xLabel:a,yLabel:l,formatXTick:u=e=>String(e),formatYTick:c=e=>String(e),onBrush:A,brushRange:h,colorScaleFunc:d}=e;const[f,p]=(0,r.useState)(null),g=(0,r.useRef)(null),m=(0,r.useRef)(null),[y,v]=(0,r.useState)(500),[_,b]=(0,r.useState)(!1),w=(0,r.useRef)(!1);(0,r.useEffect)(()=>{if(!g.current)return;const e=()=>{if(g.current){const e=window.getComputedStyle(g.current),t=parseFloat(e.paddingLeft),n=parseFloat(e.paddingRight),r=g.current.offsetWidth-t-n;v(r),b(r<500)}};e();const t=new ResizeObserver(e);return t.observe(g.current),()=>t.disconnect()},[]);const E=s||(_?{top:12,right:12,bottom:32,left:58}:{top:16,right:24,bottom:36,left:60}),x=n||y,D=i,C=x-E.left-E.right,S=D-E.top-E.bottom,T=null!==t&&void 0!==t&&t.length?Math.max(...t.map(e=>Number(e.value)||0),1):1,I=null!==t&&void 0!==t&&t.length?Math.min(...t.map(e=>Number(e.key))):0,F=null!==t&&void 0!==t&&t.length?Math.max(...t.map(e=>Number(e.key))):1,R=nD().domain([I,F]).range([0,C]),k=nD().domain([0,T]).range([S,0]).nice(),P=VD().x(e=>R(Number(e.key))).y(e=>k(Number(e.value))).curve(KD),M=null!==t&&void 0!==t&&t.length&&P(t)||"",B=_?Math.min(6,Math.floor(C/40)):Math.min(10,(null===t||void 0===t?void 0:t.length)||0),L=R.ticks(B),O=_?10:12,N=_?12:14,U=_?4:6;return(0,r.useEffect)(()=>{if(!m.current||!A||null===t||void 0===t||!t.length)return;const e=QT(MT).extent([[0,0],[C,S]]).on("end",e=>{if(w.current)return void(w.current=!1);if(!e.selection)return void A(null);const[t,n]=e.selection,r=[R.invert(t),R.invert(n)];A(r)}),n=gS(m.current);if(n.call(e),w.current=!0,h){const[t,r]=h;e.move(n,[R(t),R(r)])}else e.move(n,null)},[C,S,R,A,h,t]),null!==t&&void 0!==t&&t.length?(0,fE.jsxs)("div",{className:"line-chart-container",children:[(0,fE.jsx)("style",{children:"\n        .brush .selection {\n          fill: rgba(41, 121, 255, 0.2);\n          stroke: #2979FF;\n          stroke-width: 1px;\n        }\n        .brush .handle {\n          fill: #2979FF;\n        }\n      "}),o?(0,fE.jsx)("h3",{children:o}):null,(0,fE.jsx)("div",{ref:g,style:{position:"relative",width:"100%",overflowX:"auto"},children:(0,fE.jsx)("svg",{width:x,height:D,children:(0,fE.jsxs)("g",{transform:"translate(".concat(E.left,",").concat(E.top,")"),children:[(0,fE.jsx)("path",{d:M,fill:"none",stroke:"#4a5568",strokeWidth:2.5,style:{transition:"d 400ms"}}),t.map(e=>{const t=R(Number(e.key)),n=k(Number(e.value)||0),r=d?d(Number(e.value)):"#2979FF";return(0,fE.jsx)("circle",{cx:t,cy:n,r:4,fill:r,stroke:"#1e293b",strokeWidth:1.5,style:{cursor:"pointer",transition:"cx 400ms, cy 400ms, filter 200ms, transform 200ms",transformOrigin:"".concat(t,"px ").concat(n,"px")},onMouseEnter:t=>{t.currentTarget.style.filter="brightness(1.2)",t.currentTarget.style.transform="scale(1.5)";const n=t.currentTarget.getBoundingClientRect();p({key:e.key,value:Number(e.value),x:n.left+n.width/2,y:n.top})},onMouseLeave:e=>{e.currentTarget.style.filter="brightness(1)",e.currentTarget.style.transform="scale(1)",p(null)}},String(e.key))}),(0,fE.jsxs)("g",{transform:"translate(0, ".concat(S,")"),children:[(0,fE.jsx)("line",{x1:0,x2:C,stroke:"#4a5568",strokeWidth:1}),L.map(e=>{const t=R(e);return(0,fE.jsxs)("g",{transform:"translate(".concat(t,",0)"),children:[(0,fE.jsx)("line",{y1:0,y2:6,stroke:"#4a5568"}),(0,fE.jsx)("text",{y:18,textAnchor:"middle",fontSize:O,fill:"#a0aec0",fontWeight:500,children:u(e)})]},"xtick-".concat(e))}),a?(0,fE.jsx)("text",{x:C/2,y:_?30:34,textAnchor:"middle",fontSize:N,fill:"#e2e8f0",fontWeight:600,children:a}):null]}),(0,fE.jsxs)("g",{children:[(0,fE.jsx)("line",{y1:0,y2:S,stroke:"#4a5568",strokeWidth:1}),k.ticks(U).map(e=>(0,fE.jsxs)("g",{transform:"translate(0, ".concat(k(e),")"),children:[(0,fE.jsx)("line",{x2:-6,stroke:"#4a5568"}),(0,fE.jsx)("text",{x:-10,textAnchor:"end",dy:"0.35em",fontSize:O,fill:"#a0aec0",fontWeight:500,children:c(e)})]},e)),l?(0,fE.jsx)("text",{x:_?-45:-50,y:S/2,textAnchor:"middle",fontSize:N,fill:"#e2e8f0",fontWeight:600,transform:"rotate(-90, ".concat(_?-45:-50,", ").concat(S/2,")"),children:l}):null]}),A&&(0,fE.jsx)("g",{ref:m,className:"brush"})]})})}),f&&(0,fE.jsxs)("div",{style:{position:"fixed",left:f.x,top:f.y-10,transform:"translate(-50%, -100%)",background:"rgba(30, 41, 59, 0.95)",color:"#e2e8f0",padding:_?"6px 10px":"8px 12px",borderRadius:"6px",fontSize:_?"11px":"13px",fontWeight:500,pointerEvents:"none",zIndex:1e3,boxShadow:"0 4px 6px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(71, 85, 105, 0.5)",lineHeight:"1.5"},children:[(0,fE.jsxs)("div",{children:[a||"Categoria",": ",u(f.key)]}),(0,fE.jsxs)("div",{children:[l||"Valor",": ",c(f.value)]})]})]}):null},YT=e=>{let{data:t,colorScaleFunc:n}=e;const{filters:i,set:s}=vE(),o=r.useMemo(()=>{const e=new Map;return(t||[]).forEach(t=>{const n=Number(t.unit_per_floor);if(n>25)return;const r=Number(t.median_price_per_m2)||0,i=Number(t.listing_count)||1,s=e.get(n)||{totalPrice:0,totalCount:0};e.set(n,{totalPrice:s.totalPrice+r*i,totalCount:s.totalCount+i})}),Array.from(e.entries()).map(e=>{let[t,{totalPrice:n,totalCount:r}]=e;return{key:t,value:r>0?n/r:0}}).sort((e,t)=>e.key-t.key)},[t]),a=r.useCallback(e=>{if(!e)return void s({floor:void 0});const[t,n]=e,r=[];for(let i=Math.ceil(t);i<=Math.floor(n);i++)r.push(i);s({floor:r.length>0?r:void 0})},[s]);return(0,fE.jsx)(XT,{data:o,title:"Pre\xe7o M\xe9dio por m\xb2 por Andar",xLabel:"Andar",yLabel:"Pre\xe7o M\xe9dio por m\xb2",formatXTick:e=>String(e),formatYTick:e=>"R$".concat(Math.round(e)),onBrush:a,brushRange:i.floor&&i.floor.length>0?[Math.min(...i.floor),Math.max(...i.floor)]:null,colorScaleFunc:n})},qT=e=>{let{data:t}=e;const{filters:n,set:i}=vE(),s=n.priceRange||[],o=r.useMemo(()=>{const e=new Map;return(t||[]).forEach(t=>{const n=t.price_m2_bucket,r=n>=100?100:n;e.set(r,(e.get(r)||0)+(Number(t.count)||0))}),Array.from(e.entries()).map(e=>{let[t,n]=e;return{key:t,value:n}})},[t]);return(0,fE.jsx)(fD,{data:o,title:"Im\xf3veis por Faixa de Pre\xe7o",xLabel:"Faixa de Pre\xe7o (R$/m\xb2)",yLabel:"N\xfamero de Im\xf3veis",selectedKeys:s,onBarClick:e=>{const t=Number(e),n=s.includes(t)?s.filter(e=>e!==t):[...s,t];i({priceRange:n.length?n:void 0})},formatXTick:e=>Number(e)>=100?"100+":String(Number(e)+10),formatYTick:e=>String(Math.round(e))})},KT={"0-30m\xb2":1,"30-50m\xb2":2,"50-70m\xb2":3,"70-100m\xb2":4,"100-150m\xb2":5,"150-200m\xb2":6,"200-300m\xb2":7,"300+m\xb2":8},ZT=e=>{let{data:t}=e;const{filters:n,set:r}=vE(),i=n.areaTier||[],s=(t||[]).map(e=>({key:e.area_tier,value:Number(e.count),order:KT[e.area_tier]||0})).sort((e,t)=>e.order-t.order);return(0,fE.jsx)(fD,{data:s,title:"Distribui\xe7\xe3o por Tamanho",xLabel:"Tamanho",yLabel:"Quantidade",selectedKeys:i,onBarClick:e=>{const t=String(e),n=i.includes(t);r({areaTier:n?void 0:[t]})},formatXTick:e=>{const t=String(e);if("0-30m\xb2"===t)return"30m\xb2";if("200-300m\xb2"===t)return"300m\xb2";if(t.includes("+"))return"301m\xb2+";const n=t.split("-");return n.length>1?n[1]:t},formatYTick:e=>String(Math.round(e))})},JT={"0-30m\xb2":1,"30-50m\xb2":2,"50-70m\xb2":3,"70-100m\xb2":4,"100-150m\xb2":5,"150-200m\xb2":6,"200-300m\xb2":7,"300+m\xb2":8},$T=e=>{const t=e.match(/(\d+)-(\d+)m\xb2/);if(t){const[,e,n]=t;return(parseInt(e)+parseInt(n))/2}return"300+m\xb2"===e?350:0},eI=e=>{let{data:t,colorScaleFunc:n}=e;const r=(t||[]).filter(e=>e.avg_area>0&&e.avg_price_per_m2>0).map(e=>({tier:e.area_tier,order:JT[e.area_tier]||0,key:$T(e.area_tier),value:e.avg_price_per_m2})).sort((e,t)=>e.order-t.order);return(0,fE.jsx)(XT,{data:r,title:"Pre\xe7o por m\xb2 vs Tamanho",xLabel:"Tamanho (m\xb2)",yLabel:"Pre\xe7o por m\xb2 (R$)",formatXTick:e=>"".concat(Math.round(Number(e)),"m\xb2"),formatYTick:e=>"R$".concat(Math.round(e)),colorScaleFunc:n})},tI=[0,10,20,30,40,50,60,70,80,90,100],nI=["0-300","300-600","600-900","900-1200","1200-1500","1500-1800","1800-2100","2100-2400","2400-2700","2700-3000","3000-3300","3300-3600","3600-3900","3900-4200","4200-4500","4500-4800","4800-5100","5100-5400","5400-5700","5700-6000","6000-6300","6300-6600","6600-6900","6900-7200","7200-14100","14100-24000","24000+"],rI=e=>{if("0-300"===e)return"300";if(e.includes("+"))return e;const t=e.split("-");return t.length>1?t[1]:e},iI=["0-30m\xb2","30-50m\xb2","50-70m\xb2","70-100m\xb2","100-150m\xb2","150-200m\xb2","200-300m\xb2","300+m\xb2"],sI=e=>{if("0-30m\xb2"===e)return"30m\xb2";if("200-300m\xb2"===e)return"300m\xb2";if(e.includes("+"))return"301m\xb2+";const t=e.split("-");return t.length>1?t[1]:e},oI=()=>{const{set:e}=vE(),[t,n]=(0,r.useState)(!1),[i,s]=r.useState(0),[o,a]=r.useState(tI.length-1),[l,u]=r.useState(0),[c,A]=r.useState(nI.length-1),[h,d]=r.useState(0),[f,p]=r.useState(iI.length-1);(0,r.useEffect)(()=>{const e=()=>n(window.innerWidth<1024);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const g=(t,n)=>{s(t),a(n);const r=tI.slice(t,n+1);e({priceRange:r.length===tI.length?void 0:r})},m=(t,n)=>{u(t),A(n);const r=nI.slice(t,n+1);e({priceTotalTier:r.length===nI.length?void 0:r})},y=(t,n)=>{d(t),p(n);const r=iI.slice(t,n+1);e({areaTier:r.length===iI.length?void 0:r})},v=tI.length-1,_=e=>100*e/v,b=_(i),w=_(o)-b,E=tI[i],x=o===v?"100+":String(tI[o]+10),D=nI.length-1,C=e=>100*e/D,S=C(l),T=C(c)-S,I=rI(nI[l]),F=rI(nI[c]),R=iI.length-1,k=e=>100*e/R,P=k(h),M=k(f)-P,B=sI(iI[h]),L=sI(iI[f]),O=(0,fE.jsxs)("div",{className:"control-group",children:[(0,fE.jsxs)("div",{className:"range-slider",children:[(0,fE.jsx)("div",{className:"range-track"}),(0,fE.jsx)("div",{className:"range-highlight",style:{left:"".concat(b,"%"),width:"".concat(w,"%")}}),(0,fE.jsx)("input",{type:"range",min:0,max:v,step:1,value:i,onChange:e=>{const t=Math.min(Number(e.target.value),o);g(t,o)},className:"range-input"}),(0,fE.jsx)("input",{type:"range",min:0,max:v,step:1,value:o,onChange:e=>{const t=Math.max(Number(e.target.value),i);g(i,t)},className:"range-input"})]}),(0,fE.jsxs)("div",{className:"price-range-display",children:["R$",E," - R$",x]})]}),N=(0,fE.jsxs)("div",{className:"control-group",children:[(0,fE.jsxs)("div",{className:"range-slider",children:[(0,fE.jsx)("div",{className:"range-track"}),(0,fE.jsx)("div",{className:"range-highlight",style:{left:"".concat(S,"%"),width:"".concat(T,"%")}}),(0,fE.jsx)("input",{type:"range",min:0,max:D,step:1,value:l,onChange:e=>{const t=Math.min(Number(e.target.value),c);m(t,c)},className:"range-input"}),(0,fE.jsx)("input",{type:"range",min:0,max:D,step:1,value:c,onChange:e=>{const t=Math.max(Number(e.target.value),l);m(l,t)},className:"range-input"})]}),(0,fE.jsxs)("div",{className:"price-range-display",children:[I," - ",F]})]}),U=(0,fE.jsxs)("div",{className:"control-group",children:[(0,fE.jsxs)("div",{className:"range-slider",children:[(0,fE.jsx)("div",{className:"range-track"}),(0,fE.jsx)("div",{className:"range-highlight",style:{left:"".concat(P,"%"),width:"".concat(M,"%")}}),(0,fE.jsx)("input",{type:"range",min:0,max:R,step:1,value:h,onChange:e=>{const t=Math.min(Number(e.target.value),f);y(t,f)},className:"range-input"}),(0,fE.jsx)("input",{type:"range",min:0,max:R,step:1,value:f,onChange:e=>{const t=Math.max(Number(e.target.value),h);y(h,t)},className:"range-input"})]}),(0,fE.jsxs)("div",{className:"price-range-display",children:[B," - ",L]})]});return(0,fE.jsx)("div",{className:"control-panel",children:t?(0,fE.jsxs)(fE.Fragment,{children:[(0,fE.jsxs)("div",{className:"panel-section",children:[(0,fE.jsx)("h3",{children:"Pre\xe7o por m\xb2"}),O]}),(0,fE.jsxs)("div",{className:"panel-section",children:[(0,fE.jsx)("h3",{children:"Pre\xe7o Total"}),N]}),(0,fE.jsxs)("div",{className:"panel-section",children:[(0,fE.jsx)("h3",{children:"Tamanho do Im\xf3vel"}),U]})]}):(0,fE.jsxs)(fE.Fragment,{children:[(0,fE.jsxs)("div",{className:"panel-section",children:[(0,fE.jsx)("h3",{children:"Filtro de Aluguel (R$/m\xb2)"}),O]}),(0,fE.jsxs)("div",{className:"panel-section",children:[(0,fE.jsx)("h3",{children:"Filtro de Aluguel"}),N]}),(0,fE.jsxs)("div",{className:"panel-section",children:[(0,fE.jsx)("h3",{children:"Tamanho do Im\xf3vel"}),U]})]})})};class aI extends Cp{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo(e){let{info:t}=e;const{object:n}=t;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?(t.object=n.__source.object,t.index=n.__source.index,t):t}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||t}getSubLayerRow(e,t,n){return e.__source={parent:this,object:t,index:n},e}getSubLayerAccessor(e){if("function"===typeof e){const t={index:-1,data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,r)}return e}getSubLayerProps(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:A,coordinateOrigin:h,wrapLongitude:d,positionFormat:f,modelMatrix:p,extensions:g,fetch:m,operation:y,_subLayerProps:v}=this.props,_={id:"",updateTriggers:{},opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:A,coordinateOrigin:h,wrapLongitude:d,positionFormat:f,modelMatrix:p,extensions:g,fetch:m,operation:y},b=v&&t.id&&v[t.id],w=b&&b.updateTriggers,E=t.id||"sublayer";if(b){const e=this.props[ue],n=t.type?t.type._propTypes:{};for(const t in b){const r=n[t]||e[t];r&&"accessor"===r.type&&(b[t]=this.getSubLayerAccessor(b[t]))}}Object.assign(_,t,b),_.id="".concat(this.props.id,"-").concat(E),_.updateTriggers=u(u({all:null===(e=this.props.updateTriggers)||void 0===e?void 0:e.all},t.updateTriggers),w);for(const u of g){const e=u.getSubLayerProps.call(this,u);e&&Object.assign(_,e,{updateTriggers:Object.assign(_.updateTriggers,e.updateTriggers)})}return _}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let n=this.internalState.subLayers;const r=!n||this.needsUpdate();if(r){n=Ne(this.renderLayers(),Boolean),this.internalState.subLayers=n}Oe("compositeLayer.renderLayers",this,r,n);for(const i of n)i.parent=this}}aI.layerName="CompositeLayer";const lI=aI;function uI(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function cI(e){let{data:t,getIndex:n,dataRange:r,replace:i}=e;const{startRow:s=0,endRow:o=1/0}=r,a=t.length;let l=a,u=a;for(let h=0;h<a;h++){const e=n(t[h]);if(l>h&&e>=s&&(l=h),e>=o){u=h;break}}let c=l;const A=u-l!==i.length?t.slice(u):void 0;for(let h=0;h<i.length;h++)t[c++]=i[h];if(A){for(let e=0;e<A.length;e++)t[c++]=A[e];t.length=c}return{startRow:l,endRow:l+i.length}}function AI(e,t){if(!e)return null;const n="startIndices"in e?e.startIndices[t]:t,r=e.featureIds.value[n];return-1!==n?function(e,t,n){const r={properties:u({},e.properties[t])};for(const i in e.numericProps)r.properties[i]=e.numericProps[i].value[n];return r}(e,r,n):null}const hI={name:"project32",dependencies:[Oo],source:"// Define a structure to hold both the clip-space position and the common position.\nstruct ProjectResult {\n  clipPosition: vec4<f32>,\n  commonPosition: vec4<f32>,\n};\n\n// This function mimics the GLSL version with the 'out' parameter by returning both values.\nfn project_position_to_clipspace_and_commonspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> ProjectResult {\n  // Compute the projected position.\n  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);\n\n  // Start with the provided offset.\n  var finalOffset: vec3<f32> = offset;\n\n  // Get whether a rotation is needed and the rotation matrix.\n  let rotationResult = project_needs_rotation(projectedPosition);\n\n  // If rotation is needed, update the offset.\n  if (rotationResult.needsRotation) {\n    finalOffset = rotationResult.transform * offset;\n  }\n\n  // Compute the common position.\n  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);\n\n  // Convert to clip-space.\n  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);\n\n  return ProjectResult(clipPosition, commonPosition);\n}\n\n// A convenience overload that returns only the clip-space position.\nfn project_position_to_clipspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> vec4<f32> {\n  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;\n}\n",vs:"vec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},dI={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:[0,1,1,1]},vs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nout vec4 picking_vRGBcolor_Avalid;\n\n// Normalize unsigned byte color to 0-1 range\nvec3 picking_normalizeColor(vec3 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\n// Normalize unsigned byte color to 0-1 range\nvec4 picking_normalizeColor(vec4 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\nbool picking_isColorZero(vec3 color) {\n  return dot(color, vec3(1.0)) < 0.00001;\n}\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.00001;\n}\n\n// Check if this vertex is highlighted \nbool isVertexHighlighted(vec3 vertexColor) {\n  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);\n  return\n    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));\n}\n\n// Set the current picking color\nvoid picking_setPickingColor(vec3 pickingColor) {\n  pickingColor = picking_normalizeColor(pickingColor);\n\n  if (bool(picking.isActive)) {\n    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!bool(picking.isAttribute)) {\n      // Stores the picking color so that the fragment shader can render it during picking\n      picking_vRGBcolor_Avalid.rgb = pickingColor;\n    }\n  } else {\n    // Do the comparison with selected item color in vertex shader as it should mean fewer compares\n    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec2 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec3 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nin vec4 picking_vRGBcolor_Avalid;\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 picking_filterHighlightColor(vec4 color) {\n  // If we are still picking, we don't highlight\n  if (picking.isActive > 0.5) {\n    return color;\n  }\n\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    // Blend in highlight color based on its alpha value\n    float highLightAlpha = picking.highlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 picking_filterPickingColor(vec4 color) {\n  if (bool(picking.isActive)) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 picking_filterColor(vec4 color) {\n  vec4 highlightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highlightColor);\n}\n",getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};if(void 0===e.highlightedObjectColor);else if(null===e.highlightedObjectColor)t.isHighlightActive=!1;else{t.isHighlightActive=!0;const n=e.highlightedObjectColor.slice(0,3);t.highlightedObjectColor=n}if(e.highlightColor){const n=Array.from(e.highlightColor,e=>e/255);Number.isFinite(n[3])||(n[3]=1),t.highlightColor=n}void 0!==e.isActive&&(t.isActive=Boolean(e.isActive),t.isAttribute=Boolean(e.isAttribute));void 0!==e.useFloatColors&&(t.useFloatColors=Boolean(e.useFloatColors));return t}};const fI=u(u({},dI),{},{defaultUniforms:u(u({},dI.defaultUniforms),{},{useFloatColors:!1}),inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}});class pI{constructor(e){a(this,"id",void 0),a(this,"topology",void 0),a(this,"vertexCount",void 0),a(this,"indices",void 0),a(this,"attributes",void 0),a(this,"userData",{});const{attributes:t={},indices:n=null,vertexCount:r=null}=e;this.id=e.id||Zd("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[i,s]of Object.entries(t)){const e=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(e.value))throw new Error("".concat(this._print(i),": must be typed array or object with value as typed array"));if("POSITION"!==i&&"positions"!==i||e.size||(e.size=3),"indices"===i){if(this.indices)throw new Error("Multiple indices detected");this.indices=e}else this.attributes[i]=e}this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=r||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?u({indices:this.indices},this.attributes):this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const r of Object.values(e)){const{value:e,size:t,constant:i}=r;!i&&e&&void 0!==t&&t>=1&&(n=Math.min(n,e.length/t))}return n}}const gI="uniform iconUniforms {\n  float sizeScale;\n  vec2 iconsTextureDim;\n  float sizeMinPixels;\n  float sizeMaxPixels;\n  bool billboard;\n  highp int sizeUnits;\n  float alphaCutoff;\n} icon;\n",mI={name:"icon",vs:gI,fs:gI,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}},yI=()=>{},vI={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},_I={x:0,y:0,width:0,height:0};function bI(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function wI(e,t,n,r){const i=Math.min(n/t.width,r/t.height),s=Math.floor(t.width*i),o=Math.floor(t.height*i);return 1===i?{image:t,width:s,height:o}:(e.canvas.height=o,e.canvas.width=s,e.clearRect(0,0,s,o),e.drawImage(t,0,0,t.width,t.height,0,0,s,o),{image:e.canvas,width:s,height:o})}function EI(e){return e&&(e.id||e.url)}function xI(e,t,n){for(let r=0;r<t.length;r++){const{icon:i,xOffset:s}=t[r];e[EI(i)]=u(u({},i),{},{x:s,y:n})}}class DI{constructor(e,t){let{onUpdate:n=yI,onError:r=yI}=t;this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=n,this.onError=r}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?EI(e):e;return this._mapping[t]||_I}setProps(e){let{loadOptions:t,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}=e;var o;(t&&(this._loadOptions=t),void 0!==n&&(this._autoPacking=n),i&&(this._mapping=i),r)&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=r);s&&(this._samplerParameters=s)}get isLoaded(){return 0===this._pendingCount}packIcons(e,t){if(!this._autoPacking||"undefined"===typeof document)return;const n=Object.values(function(e,t,n){if(!e||!t)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=fA(e);for(const o of i){s.index++;const e=t(o,s),i=EI(e);if(!e)throw new Error("Icon is missing.");if(!e.url)throw new Error("Icon url is missing.");r[i]||n[i]&&e.url===n[i].url||(r[i]=u(u({},e),{},{source:o,sourceIndex:s.index}))}return r}(e,t,this._mapping)||{});if(n.length>0){const{mapping:e,xOffset:t,yOffset:r,rowHeight:i,canvasHeight:s}=function(e){let{icons:t,buffer:n,mapping:r={},xOffset:i=0,yOffset:s=0,rowHeight:o=0,canvasWidth:a}=e,l=[];for(let u=0;u<t.length;u++){const e=t[u];if(!r[EI(e)]){const{height:t,width:u}=e;i+u+n>a&&(xI(r,l,s),i=0,s=o+s+n,o=0,l=[]),l.push({icon:e,xOffset:i}),i=i+u+n,o=Math.max(o,t)}}return l.length>0&&xI(r,l,s),{mapping:r,rowHeight:o,xOffset:i,yOffset:s,canvasWidth:a,canvasHeight:bI(o+s+n)}}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=i,this._mapping=e,this._xOffset=t,this._yOffset=r,this._canvasHeight=s,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||vI,mipmaps:!0})),this._texture.height!==this._canvasHeight&&(this._texture=function(e,t,n,r){const{width:i,height:s,device:o}=e,a=o.createTexture({format:"rgba8unorm",width:t,height:n,sampler:r,mipmaps:!0}),l=o.createCommandEncoder();return l.copyTextureToTexture({sourceTexture:e,destinationTexture:a,width:i,height:s}),l.finish(),e.destroy(),a}(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||vI)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(e){const t=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of e)this._pendingCount++,Tn(n.url,this._loadOptions).then(e=>{var r;const i=EI(n),s=this._mapping[i],{x:o,y:a,width:l,height:u}=s,{image:c,width:A,height:h}=wI(t,e,l,u);null===(r=this._texture)||void 0===r||r.copyExternalImage({image:c,x:o+(l-A)/2,y:a+(u-h)/2,width:A,height:h}),s.width=A,s.height=h,this._texture.generateMipmap(),this.onUpdate()}).catch(e=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:e})}).finally(()=>{this._pendingCount--})}}const CI=[0,0,0,255],SI={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:CI},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class TI extends Cp{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME icon-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceSizes;\nin float instanceAngles;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec4 instanceIconFrames;\nin float instanceColorModes;\nin vec2 instanceOffsets;\nin vec2 instancePixelOffset;\nout float vColorMode;\nout vec4 vColor;\nout vec2 vTextureCoords;\nout vec2 uv;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = angle * PI / 180.0;\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvec2 iconSize = instanceIconFrames.zw;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),\nicon.sizeMinPixels, icon.sizeMaxPixels\n);\nfloat instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\nvec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\npixelOffset += instancePixelOffset;\npixelOffset.y *= -1.0;\nif (icon.billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvTextureCoords = mix(\ninstanceIconFrames.xy,\ninstanceIconFrames.xy + iconSize,\n(positions.xy + 1.0) / 2.0\n) / icon.iconsTextureDim;\nvColor = instanceColors;\nDECKGL_FILTER_COLOR(vColor, geometry);\nvColorMode = instanceColorModes;\n}\n",fs:"#version 300 es\n#define SHADER_NAME icon-layer-fragment-shader\nprecision highp float;\nuniform sampler2D iconsTexture;\nin float vColorMode;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nvec4 texColor = texture(iconsTexture, vTextureCoords);\nvec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\nfloat a = texColor.a * layer.opacity * vColor.a;\nif (a < icon.alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color, a);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[hI,fI,mI]})}initializeState(){this.state={iconManager:new DI(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:CI},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:r}=e,i=this.getAttributeManager(),{iconAtlas:s,iconMapping:o,data:a,getIcon:l,textureParameters:u}=t,{iconManager:c}=this.state;if("string"===typeof s)return;const A=s||this.internalState.isAsyncPropLoading("iconAtlas");var h;(c.setProps({loadOptions:t.loadOptions,autoPacking:!A,iconAtlas:s,iconMapping:A?o:null,textureParameters:u}),A?n.iconMapping!==t.iconMapping&&i.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&c.packIcons(a,l),r.extensionsChanged)&&(null===(h=this.state.model)||void 0===h||h.destroy(),this.state.model=this._getModel(),i.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw(e){let{uniforms:t}=e;const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,u=l.getTexture();if(u){const e=this.state.model,t={iconsTexture:u,iconsTextureDim:[u.width,u.height],sizeUnits:As[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a};e.shaderInputs.setProps({icon:t}),e.draw(this.context.renderPass)}}_getModel(){return new df(this.context.device,u(u({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new pI({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([-1,-1,1,-1,-1,1,1,1])}}}),isInstanced:!0}))}_onUpdate(){this.setNeedsRedraw()}_onError(e){var t;const n=null===(t=this.getCurrentLayer())||void 0===t?void 0:t.props.onIconError;n?n(e):Me.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:n,anchorX:r=t/2,anchorY:i=n/2}=this.state.iconManager.getIconMapping(e);return[t/2-r,n/2-i]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:n,width:r,height:i}=this.state.iconManager.getIconMapping(e);return[t,n,r,i]}}TI.defaultProps=SI,TI.layerName="IconLayer";const II=TI,FI="uniform scatterplotUniforms {\n  float radiusScale;\n  float radiusMinPixels;\n  float radiusMaxPixels;\n  float lineWidthScale;\n  float lineWidthMinPixels;\n  float lineWidthMaxPixels;\n  float stroked;\n  float filled;\n  bool antialiasing;\n  bool billboard;\n  highp int radiusUnits;\n  highp int lineWidthUnits;\n} scatterplot;\n",RI={name:"scatterplot",vs:FI,fs:FI,source:"",uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}},kI=[0,0,0,255],PI={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:kI},getLineColor:{type:"accessor",value:kI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class MI extends Cp{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-vertex-shader\nin vec3 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceRadius;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout vec2 unitPosition;\nout float innerUnitRadius;\nout float outerRadiusPixels;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nouterRadiusPixels = clamp(\nproject_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),\nscatterplot.radiusMinPixels, scatterplot.radiusMaxPixels\n);\nfloat lineWidthPixels = clamp(\nproject_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),\nscatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels\n);\nouterRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;\nfloat edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\nunitPosition = edgePadding * positions.xy;\ngeometry.uv = unitPosition;\ngeometry.pickingColor = instancePickingColors;\ninnerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;\nif (scatterplot.billboard) {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = edgePadding * positions * outerRadiusPixels;\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-fragment-shader\nprecision highp float;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin vec2 unitPosition;\nin float innerUnitRadius;\nin float outerRadiusPixels;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = unitPosition;\nfloat distToCenter = length(unitPosition) * outerRadiusPixels;\nfloat inCircle = scatterplot.antialiasing ?\nsmoothedge(distToCenter, outerRadiusPixels) :\nstep(distToCenter, outerRadiusPixels);\nif (inCircle == 0.0) {\ndiscard;\n}\nif (scatterplot.stroked > 0.5) {\nfloat isLine = scatterplot.antialiasing ?\nsmoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\nstep(innerUnitRadius * outerRadiusPixels, distToCenter);\nif (scatterplot.filled > 0.5) {\nfragColor = mix(vFillColor, vLineColor, isLine);\n} else {\nif (isLine == 0.0) {\ndiscard;\n}\nfragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n}\n} else if (scatterplot.filled < 0.5) {\ndiscard;\n} else {\nfragColor = vFillColor;\n}\nfragColor.a *= inCircle;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",source:'// TODO(ibgreen): Hack for Layer uniforms (move to new "color" module?)\n\nstruct LayerUniforms {\n  opacity: f32,\n};\n\nvar<private> layer: LayerUniforms = LayerUniforms(1.0);\n// @group(0) @binding(1) var<uniform> layer: LayerUniforms;\n\n// Main shaders\n\nstruct ScatterplotUniforms {\n  radiusScale: f32,\n  radiusMinPixels: f32,\n  radiusMaxPixels: f32,\n  lineWidthScale: f32,\n  lineWidthMinPixels: f32,\n  lineWidthMaxPixels: f32,\n  stroked: f32,\n  filled: i32,\n  antialiasing: i32,\n  billboard: i32,\n  radiusUnits: i32,\n  lineWidthUnits: i32,\n};\n\nstruct ConstantAttributeUniforms {\n instancePositions: vec3<f32>,\n instancePositions64Low: vec3<f32>,\n instanceRadius: f32,\n instanceLineWidths: f32,\n instanceFillColors: vec4<f32>,\n instanceLineColors: vec4<f32>,\n instancePickingColors: vec3<f32>,\n\n instancePositionsConstant: i32,\n instancePositions64LowConstant: i32,\n instanceRadiusConstant: i32,\n instanceLineWidthsConstant: i32,\n instanceFillColorsConstant: i32,\n instanceLineColorsConstant: i32,\n instancePickingColorsConstant: i32\n};\n\n@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;\n\nstruct ConstantAttributes {\n  instancePositions: vec3<f32>,\n  instancePositions64Low: vec3<f32>,\n  instanceRadius: f32,\n  instanceLineWidths: f32,\n  instanceFillColors: vec4<f32>,\n  instanceLineColors: vec4<f32>,\n  instancePickingColors: vec3<f32>\n};\n\nconst constants = ConstantAttributes(\n  vec3<f32>(0.0),\n  vec3<f32>(0.0),\n  0.0,\n  0.0,\n  vec4<f32>(0.0, 0.0, 0.0, 1.0),\n  vec4<f32>(0.0, 0.0, 0.0, 1.0),\n  vec3<f32>(0.0)\n);\n\nstruct Attributes {\n  @builtin(instance_index) instanceIndex : u32,\n  @builtin(vertex_index) vertexIndex : u32,\n  @location(0) positions: vec3<f32>,\n  @location(1) instancePositions: vec3<f32>,\n  @location(2) instancePositions64Low: vec3<f32>,\n  @location(3) instanceRadius: f32,\n  @location(4) instanceLineWidths: f32,\n  @location(5) instanceFillColors: vec4<f32>,\n  @location(6) instanceLineColors: vec4<f32>,\n  @location(7) instancePickingColors: vec3<f32>\n};\n\nstruct Varyings {\n  @builtin(position) position: vec4<f32>,\n  @location(0) vFillColor: vec4<f32>,\n  @location(1) vLineColor: vec4<f32>,\n  @location(2) unitPosition: vec2<f32>,\n  @location(3) innerUnitRadius: f32,\n  @location(4) outerRadiusPixels: f32,\n};\n\n@vertex\nfn vertexMain(attributes: Attributes) -> Varyings {\n  var varyings: Varyings;\n\n  // Draw an inline geometry constant array clip space triangle to verify that rendering works.\n  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));\n  // if (attributes.instanceIndex == 0) {\n  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);\n  //   return varyings;\n  // }\n\n  // var geometry: Geometry;\n  // geometry.worldPosition = instancePositions;\n\n  // Multiply out radius and clamp to limits\n  varyings.outerRadiusPixels = clamp(\n    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),\n    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels\n  );\n\n  // Multiply out line width and clamp to limits\n  let lineWidthPixels = clamp(\n    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),\n    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;\n  // Expand geometry to accommodate edge smoothing\n  let edgePadding = select(\n    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,\n    1.0,\n    scatterplot.antialiasing != 0\n  );\n\n  // position on the containing square in [-1, 1] space\n  varyings.unitPosition = edgePadding * attributes.positions.xy;\n  geometry.uv = varyings.unitPosition;\n  geometry.pickingColor = attributes.instancePickingColors;\n\n  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;\n\n  if (scatterplot.billboard != 0) {\n    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);\n    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);\n    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;\n    // DECKGL_FILTER_SIZE(offset, geometry);\n    let clipPixels = project_pixel_size_to_clipspace(offset.xy);\n    varyings.position.x = clipPixels.x;\n    varyings.position.y = clipPixels.y;\n  } else {\n    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);\n    // DECKGL_FILTER_SIZE(offset, geometry);\n    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);\n    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);\n  }\n\n  // Apply opacity to instance color, or return instance picking color\n  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * layer.opacity);\n  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);\n  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * layer.opacity);\n  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);\n\n  return varyings;\n}\n\n@fragment\nfn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {\n  // var geometry: Geometry;\n  // geometry.uv = unitPosition;\n\n  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;\n  let inCircle = select(\n    smoothedge(distToCenter, varyings.outerRadiusPixels),\n    step(distToCenter, varyings.outerRadiusPixels),\n    scatterplot.antialiasing != 0\n  );\n\n  if (inCircle == 0.0) {\n    // discard;\n  }\n\n  var fragColor: vec4<f32>;\n\n  if (scatterplot.stroked != 0) {\n    let isLine = select(\n      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),\n      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),\n      scatterplot.antialiasing != 0\n    );\n\n    if (scatterplot.filled != 0) {\n      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        // discard;\n      }\n      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);\n    }\n  } else if (scatterplot.filled == 0) {\n    // discard;\n  } else {\n    fragColor = varyings.vFillColor;\n  }\n\n  fragColor.a *= inCircle;\n  // DECKGL_FILTER_COLOR(fragColor, geometry);\n\n  return fragColor;\n  // return vec4<f32>(0, 0, 1, 1);\n}\n',modules:[hI,fI,RI]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var t;(super.updateState(e),e.changeFlags.extensionsChanged)&&(null===(t=this.state.model)||void 0===t||t.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw(e){let{uniforms:t}=e;const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:u,lineWidthUnits:c,lineWidthScale:A,lineWidthMinPixels:h,lineWidthMaxPixels:d}=this.props,f={stroked:o,filled:a,billboard:l,antialiasing:u,radiusUnits:As[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:As[c],lineWidthScale:A,lineWidthMinPixels:h,lineWidthMaxPixels:d},p=this.state.model;p.shaderInputs.setProps({scatterplot:f}),p.draw(this.context.renderPass)}_getModel(){return new df(this.context.device,u(u({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new pI({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0])}}}),isInstanced:!0}))}}MI.defaultProps=PI,MI.layerName="ScatterplotLayer";const BI=MI,LI="uniform sdfUniforms {\n  float gamma;\n  bool enabled;\n  float buffer;\n  float outlineBuffer;\n  vec4 outlineColor;\n} sdf;\n",OI={name:"sdf",vs:LI,fs:LI,uniformTypes:{gamma:"f32",enabled:"f32",buffer:"f32",outlineBuffer:"f32",outlineColor:"vec4<f32>"}},NI=.75,UI=[];class zI extends II{getShaders(){const e=super.getShaders();return u(u({},e),{},{modules:[...e.modules,OI],fs:"#version 300 es\n#define SHADER_NAME multi-icon-layer-fragment-shader\nprecision highp float;\nuniform sampler2D iconsTexture;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nif (!bool(picking.isActive)) {\nfloat alpha = texture(iconsTexture, vTextureCoords).a;\nvec4 color = vColor;\nif (sdf.enabled) {\nfloat distance = alpha;\nalpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);\nif (sdf.outlineBuffer > 0.0) {\nfloat inFill = alpha;\nfloat inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);\ncolor = mix(sdf.outlineColor, vColor, inFill);\nalpha = inBorder;\n}\n}\nfloat a = alpha * color.a;\nif (a < icon.alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color.rgb, a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"})}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(e,t)=>{let{index:n,target:r}=t;return this.encodePickingColor(n,r)}}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;let{outlineColor:r}=t;r!==n.outlineColor&&(r=r.map(e=>e/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!t.sdf&&t.outlineWidth&&Me.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:t,smoothing:n,outlineWidth:r}=this.props,{outlineColor:i}=this.state,s=r?Math.max(n,NI*(1-r)):-1,o=this.state.model,a={buffer:NI,outlineBuffer:s,gamma:n,enabled:Boolean(t),outlineColor:i};if(o.shaderInputs.setProps({sdf:a}),super.draw(e),t&&r){const{iconManager:e}=this.state;e.getTexture()&&(o.shaderInputs.setProps({sdf:u(u({},a),{},{outlineBuffer:NI})}),o.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(e=>super.getInstanceOffset(e)):UI}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(e=>super.getInstanceIconFrame(e)):UI}}zI.defaultProps={getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},zI.layerName="MultiIconLayer";const jI=zI,VI=1e20;class GI{constructor(){let{fontSize:e=24,buffer:t=3,radius:n=8,cutoff:r=.25,fontFamily:i="sans-serif",fontWeight:s="normal",fontStyle:o="normal",lang:a=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=r,this.radius=n,this.lang=a;const l=this.size=e+4*t,u=this._createCanvas(l),c=this.ctx=u.getContext("2d",{willReadFrequently:!0});c.font="".concat(o," ").concat(s," ").concat(e,"px ").concat(i),c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:i,actualBoundingBoxRight:s}=this.ctx.measureText(e),o=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-i))),l=Math.min(this.size-this.buffer,o+Math.ceil(r)),u=a+2*this.buffer,c=l+2*this.buffer,A=Math.max(u*c,0),h=new Uint8ClampedArray(A),d={data:h,width:u,height:c,glyphWidth:a,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return d;const{ctx:f,buffer:p,gridInner:g,gridOuter:m}=this;this.lang&&(f.lang=this.lang),f.clearRect(p,p,a,l),f.fillText(e,p,p+o);const y=f.getImageData(p,p,a,l);m.fill(VI,0,A),g.fill(0,0,A);for(let v=0;v<l;v++)for(let e=0;e<a;e++){const t=y.data[4*(v*a+e)+3]/255;if(0===t)continue;const n=(v+p)*u+e+p;if(1===t)m[n]=0,g[n]=VI;else{const e=.5-t;m[n]=e>0?e*e:0,g[n]=e<0?e*e:0}}WI(m,0,0,u,c,u,this.f,this.v,this.z),WI(g,p,p,a,l,u,this.f,this.v,this.z);for(let v=0;v<A;v++){const e=Math.sqrt(m[v])-Math.sqrt(g[v]);h[v]=Math.round(255-255*(e/this.radius+this.cutoff))}return d}}function WI(e,t,n,r,i,s,o,a,l){for(let u=t;u<t+r;u++)HI(e,n*s+u,s,i,o,a,l);for(let u=n;u<n+i;u++)HI(e,u*s+t,1,r,o,a,l)}function HI(e,t,n,r,i,s,o){s[0]=0,o[0]=-VI,o[1]=VI,i[0]=e[t];for(let a=1,l=0,u=0;a<r;a++){i[a]=e[t+a*n];const r=a*a;do{const e=s[l];u=(i[a]-i[e]+r-e*e)/(a-e)/2}while(u<=o[l]&&--l>-1);l++,s[l]=a,o[l]=u,o[l+1]=VI}for(let a=0,l=0;a<r;a++){for(;o[l+1]<a;)l++;const r=s[l],u=a-r;e[t+a*n]=i[r]+u*u}}const QI=[];function XI(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function YI(e,t,n,r){let i=0;for(let o=t;o<n;o++){var s;i+=(null===(s=r[e[o]])||void 0===s?void 0:s.layoutWidth)||0}return i}function qI(e,t,n,r,i,s){let o=t,a=0;for(let l=t;l<n;l++){const t=YI(e,l,l+1,i);a+t>r&&(o<l&&s.push(l),o=l,a=0),a+=t}return a}function KI(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0;void 0===s&&(s=e.length);const o=[];return"break-all"===t?qI(e,i,s,n,r,o):function(e,t,n,r,i,s){let o=t,a=t,l=t,u=0;for(let c=t;c<n;c++)if(" "===e[c]?l=c+1:" "!==e[c+1]&&c+1!==n||(l=c+1),l>a){let t=YI(e,a,l,i);u+t>r&&(o<a&&(s.push(a),o=a,u=0),t>r&&(t=qI(e,a,l,r,i,s),o=s[s.length-1])),a=l,u+=t}}(e,i,s,n,r,o),o}function ZI(e,t,n,r,i,s){let o=0,a=0;for(let l=t;l<n;l++){const t=e[l],n=r[t];n?(a||(a=n.layoutHeight),i[l]=o+n.layoutWidth/2,o+=n.layoutWidth):(Me.warn("Missing character: ".concat(t," (").concat(t.codePointAt(0),")"))(),i[l]=o,o+=32)}s[0]=o,s[1]=a}class JI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this._cache={},this._order=[],this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}const $I={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let eF=new JI(3);function tF(e,t){for(let n=0;n<e.length;n++)t.data[4*n+3]=e[n]}function nF(e,t,n,r){e.font="".concat(r," ").concat(n,"px ").concat(t),e.fillStyle="#000",e.textBaseline="alphabetic",e.textAlign="left"}class rF{constructor(){this.props=u({},$I)}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:t}=this.props;return(1.2*e+2*t)/e}setProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.props,e),this._key=this._getKey();const t=function(e,t){let n;n="string"===typeof t?new Set(Array.from(t)):new Set(t);const r=eF.get(e);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}(this._key,this.props.characterSet),n=eF.get(this._key);if(n&&0===t.size)return void(this._atlas!==n&&(this._atlas=n));const r=this._generateFontAtlas(t,n);this._atlas=r,eF.set(this._key,r)}_generateFontAtlas(e,t){const{fontFamily:n,fontWeight:r,fontSize:i,buffer:s,sdf:o,radius:a,cutoff:l}=this.props;let c=t&&t.data;c||(c=document.createElement("canvas"),c.width=1024);const A=c.getContext("2d",{willReadFrequently:!0});nF(A,n,i,r);const{mapping:h,canvasHeight:d,xOffset:f,yOffset:p}=function(e){let{characterSet:t,getFontWidth:n,fontHeight:r,buffer:i,maxCanvasWidth:s,mapping:o={},xOffset:a=0,yOffset:l=0}=e,u=0,c=a;const A=r+2*i;for(const h of t)if(!o[h]){const e=n(h);c+e+2*i>s&&(c=0,u++),o[h]={x:c+i,y:l+u*A+i,width:e,height:A,layoutWidth:e,layoutHeight:r},c+=e+2*i}return{mapping:o,xOffset:c,yOffset:l+u*A,canvasHeight:XI(l+(u+1)*A)}}(u({getFontWidth:e=>A.measureText(e).width,fontHeight:1.2*i,buffer:s,characterSet:e,maxCanvasWidth:1024},t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset}));if(c.height!==d){const e=A.getImageData(0,0,c.width,c.height);c.height=d,A.putImageData(e,0,0)}if(nF(A,n,i,r),o){const t=new GI({fontSize:i,buffer:s,radius:a,cutoff:l,fontFamily:n,fontWeight:"".concat(r)});for(const n of e){const{data:e,width:r,height:s,glyphTop:o}=t.draw(n);h[n].width=r,h[n].layoutOffsetY=.9*i-o;const a=A.createImageData(r,s);tF(e,a),A.putImageData(a,h[n].x,h[n].y)}}else for(const u of e)A.fillText(u,h[u].x,h[u].y+s+.9*i);return{xOffset:f,yOffset:p,mapping:h,data:c,width:c.width,height:c.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:n,buffer:r,sdf:i,radius:s,cutoff:o}=this.props;return i?"".concat(e," ").concat(t," ").concat(n," ").concat(r," ").concat(s," ").concat(o):"".concat(e," ").concat(t," ").concat(n," ").concat(r)}}const iF="uniform textBackgroundUniforms {\n  bool billboard;\n  float sizeScale;\n  float sizeMinPixels;\n  float sizeMaxPixels;\n  vec4 borderRadius;\n  vec4 padding;\n  highp int sizeUnits;\n  bool stroked;\n} textBackground;\n",sF={name:"textBackground",vs:iF,fs:iF,uniformTypes:{billboard:"f32",sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",borderRadius:"vec4<f32>",padding:"vec4<f32>",sizeUnits:"i32",stroked:"f32"}},oF={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,borderRadius:{type:"object",value:0},padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class aF extends Cp{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME text-background-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceRects;\nin float instanceSizes;\nin float instanceAngles;\nin vec2 instancePixelOffsets;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout float vLineWidth;\nout vec2 uv;\nout vec2 dimensions;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = radians(angle);\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvLineWidth = instanceLineWidths;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),\ntextBackground.sizeMinPixels, textBackground.sizeMaxPixels\n);\ndimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;\nvec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\npixelOffset += instancePixelOffsets;\npixelOffset.y *= -1.0;\nif (textBackground.billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME text-background-layer-fragment-shader\nprecision highp float;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin float vLineWidth;\nin vec2 uv;\nin vec2 dimensions;\nout vec4 fragColor;\nfloat round_rect(vec2 p, vec2 size, vec4 radii) {\nvec2 pixelPositionCB = (p - 0.5) * size;\nvec2 sizeCB = size * 0.5;\nfloat maxBorderRadius = min(size.x, size.y) * 0.5;\nvec4 borderRadius = vec4(min(radii, maxBorderRadius));\nborderRadius.xy =\n(pixelPositionCB.x > 0.0) ? borderRadius.xy : borderRadius.zw;\nborderRadius.x = (pixelPositionCB.y > 0.0) ? borderRadius.x : borderRadius.y;\nvec2 q = abs(pixelPositionCB) - sizeCB + borderRadius.x;\nreturn -(min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - borderRadius.x);\n}\nfloat rect(vec2 p, vec2 size) {\nvec2 pixelPosition = p * size;\nreturn min(min(pixelPosition.x, size.x - pixelPosition.x),\nmin(pixelPosition.y, size.y - pixelPosition.y));\n}\nvec4 get_stroked_fragColor(float dist) {\nfloat isBorder = smoothedge(dist, vLineWidth);\nreturn mix(vFillColor, vLineColor, isBorder);\n}\nvoid main(void) {\ngeometry.uv = uv;\nif (textBackground.borderRadius != vec4(0.0)) {\nfloat distToEdge = round_rect(uv, dimensions, textBackground.borderRadius);\nif (textBackground.stroked) {\nfragColor = get_stroked_fragColor(distToEdge);\n} else {\nfragColor = vFillColor;\n}\nfloat shapeAlpha = smoothedge(-distToEdge, 0.0);\nfragColor.a *= shapeAlpha;\n} else {\nif (textBackground.stroked) {\nfloat distToEdge = rect(uv, dimensions);\nfragColor = get_stroked_fragColor(distToEdge);\n} else {\nfragColor = vFillColor;\n}\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[hI,fI,sF]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;var n;t.extensionsChanged&&(null===(n=this.state.model)||void 0===n||n.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw(e){let{uniforms:t}=e;const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l,borderRadius:u}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),Array.isArray(u)||(u=[u,u,u,u]);const c=this.state.model,A={billboard:n,stroked:Boolean(a),borderRadius:u,padding:l,sizeUnits:As[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o};c.shaderInputs.setProps({textBackground:A}),c.draw(this.context.renderPass)}_getModel(){return new df(this.context.device,u(u({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new pI({topology:"triangle-strip",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,0,1,1,1])}}}),isInstanced:!0}))}}aF.defaultProps=oF,aF.layerName="TextBackgroundLayer";const lF=aF,uF={start:1,middle:0,end:-1},cF={top:1,center:0,bottom:-1},AF=[0,0,0,255],hF={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:AF},getBorderWidth:{type:"accessor",value:0},backgroundBorderRadius:{type:"object",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:$I.characterSet},fontFamily:$I.fontFamily,fontWeight:$I.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:AF},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:AF},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class dF extends lI{constructor(){super(...arguments),this.getBoundingRect=(e,t)=>{let{size:[n,r]}=this.transformParagraph(e,t);const{fontSize:i}=this.state.fontAtlasManager.props;n/=i,r/=i;const{getTextAnchor:s,getAlignmentBaseline:o}=this.props;return[(uF["function"===typeof s?s(e,t):s]-1)*n/2,(cF["function"===typeof o?o(e,t):o]-1)*r/2,n,r]},this.getIconOffsets=(e,t)=>{const{getTextAnchor:n,getAlignmentBaseline:r}=this.props,{x:i,y:s,rowWidth:o,size:[a,l]}=this.transformParagraph(e,t),u=uF["function"===typeof n?n(e,t):n],c=cF["function"===typeof r?r(e,t):r],A=i.length,h=new Array(2*A);let d=0;for(let f=0;f<A;f++){const e=(1-u)*(a-o[f])/2;h[d++]=(u-1)*a/2+e+i[f],h[d++]=(c-1)*l/2+s[f]}return h}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new rF},this.props.maxWidth>0&&Me.once(1,"v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:t,oldProps:n,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText();(this._updateFontAtlas()||t.lineHeight!==n.lineHeight||t.wordBreak!==n.wordBreak||t.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo(e){let{info:t}=e;return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:n}=this.props,{fontAtlasManager:r,characterSet:i}=this.state,s=u(u({},e),{},{characterSet:i,fontFamily:t,fontWeight:n});if(!r.mapping)return r.setProps(s),!0;for(const o in s)if(s[o]!==r.props[o])return r.setProps(s),!0;return!1}_updateText(){var e;const{data:t,characterSet:n}=this.props,r=null===(e=t.attributes)||void 0===e?void 0:e.getText;let i,{getText:s}=this.props,o=t.startIndices;const a="auto"===n&&new Set;if(r&&o){const{texts:e,characterCount:n}=function(e){let{value:t,length:n,stride:r,offset:i,startIndices:s,characterSet:o}=e;const a=t.BYTES_PER_ELEMENT,l=r?r/a:1,u=i?i/a:0,c=s[n]||Math.ceil((t.length-u)/l),A=o&&new Set,h=new Array(n);let d=t;if(l>1||u>0){d=new(0,t.constructor)(c);for(let e=0;e<c;e++)d[e]=t[e*l+u]}for(let f=0;f<n;f++){const e=s[f],t=s[f+1]||c,n=d.subarray(e,t);h[f]=String.fromCodePoint.apply(null,n),A&&n.forEach(A.add,A)}if(A)for(const f of A)o.add(String.fromCodePoint(f));return{texts:h,characterCount:c}}(u(u({},ArrayBuffer.isView(r)?{value:r}:r),{},{length:t.length,startIndices:o,characterSet:a}));i=n,s=(t,n)=>{let{index:r}=n;return e[r]}}else{const{iterable:e,objectInfo:n}=fA(t);o=[0],i=0;for(const t of e){n.index++;const e=Array.from(s(t,n)||"");a&&e.forEach(a.add,a),i+=e.length,o.push(i)}}this.setState({getText:s,startIndices:o,numInstances:i,characterSet:a||n})}transformParagraph(e,t){const{fontAtlasManager:n}=this.state,r=n.mapping,i=this.state.getText,{wordBreak:s,lineHeight:o,maxWidth:a}=this.props;return function(e,t,n,r,i){const s=Array.from(e),o=s.length,a=new Array(o),l=new Array(o),u=new Array(o),c=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,A=[0,0],h=[0,0];let d=0,f=0,p=0;for(let m=0;m<=o;m++){const e=s[m];if("\n"!==e&&m!==o||(p=m),p>f){const e=c?KI(s,n,r,i,f,p):QI;for(let n=0;n<=e.length;n++){const r=0===n?f:e[n-1],o=n<e.length?e[n]:p;ZI(s,r,o,i,a,h);for(let e=r;e<o;e++){var g;a[e];const t=(null===(g=i[s[e]])||void 0===g?void 0:g.layoutOffsetY)||0;l[e]=d+h[1]/2+t,u[e]=h[0]}d+=h[1]*t,A[0]=Math.max(A[0],h[0])}f=p}"\n"===e&&(a[f]=0,l[f]=0,u[f]=0,f++)}return A[1]=d,{x:a,y:l,rowWidth:u,size:A}}(i(e,t)||"",o,s,a*n.props.fontSize,r)}renderLayers(){const{startIndices:e,numInstances:t,getText:n,fontAtlasManager:{scale:r,atlas:i,mapping:s},styleVersion:o}=this.state,{data:a,_dataDiff:l,getPosition:u,getColor:c,getSize:A,getAngle:h,getPixelOffset:d,getBackgroundColor:f,getBorderColor:p,getBorderWidth:g,backgroundBorderRadius:m,backgroundPadding:y,background:v,billboard:_,fontSettings:b,outlineWidth:w,outlineColor:E,sizeScale:x,sizeUnits:D,sizeMinPixels:C,sizeMaxPixels:S,transitions:T,updateTriggers:I}=this.props,F=this.getSubLayerClass("characters",jI),R=this.getSubLayerClass("background",lF);return[v&&new R({getFillColor:f,getLineColor:p,getLineWidth:g,borderRadius:m,padding:y,getPosition:u,getSize:A,getAngle:h,getPixelOffset:d,billboard:_,sizeScale:x,sizeUnits:D,sizeMinPixels:C,sizeMaxPixels:S,transitions:T&&{getPosition:T.getPosition,getAngle:T.getAngle,getSize:T.getSize,getFillColor:T.getBackgroundColor,getLineColor:T.getBorderColor,getLineWidth:T.getBorderWidth,getPixelOffset:T.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:I.getPosition,getAngle:I.getAngle,getSize:I.getSize,getFillColor:I.getBackgroundColor,getLineColor:I.getBorderColor,getLineWidth:I.getBorderWidth,getPixelOffset:I.getPixelOffset,getBoundingRect:{getText:I.getText,getTextAnchor:I.getTextAnchor,getAlignmentBaseline:I.getAlignmentBaseline,styleVersion:o}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new F({sdf:b.sdf,smoothing:Number.isFinite(b.smoothing)?b.smoothing:$I.smoothing,outlineWidth:w/(b.radius||$I.radius),outlineColor:E,iconAtlas:i,iconMapping:s,getPosition:u,getColor:c,getSize:A,getAngle:h,getPixelOffset:d,billboard:_,sizeScale:x*r,sizeUnits:D,sizeMinPixels:C*r,sizeMaxPixels:S*r,transitions:T&&{getPosition:T.getPosition,getAngle:T.getAngle,getColor:T.getColor,getSize:T.getSize,getPixelOffset:T.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:I.getText,getPosition:I.getPosition,getAngle:I.getAngle,getColor:I.getColor,getSize:I.getSize,getPixelOffset:I.getPixelOffset,getIconOffsets:{getTextAnchor:I.getTextAnchor,getAlignmentBaseline:I.getAlignmentBaseline,styleVersion:o}}}),{data:a,_dataDiff:l,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(e){!function(e){Me.assert(Number.isFinite(e)&&e>=3,"Invalid cache limit"),eF=new JI(e)}(e)}}dF.defaultProps=hF,dF.layerName="TextLayer";const fF=dF;class pF{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:t={}}=e;this.typedArrayManager=Rn,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:n={},getGeometry:r,geometryBuffer:i,positionFormat:s,dataChanged:o,normalize:a=!0}=this.opts;if(this.data=t,this.getGeometry=r,this.positionSize=i&&i.size||("XY"===s?2:3),this.buffers=n,this.normalize=a,i&&(Ls(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),a||(n.vertexPositions=i)),this.geometryBuffer=n.vertexPositions,Array.isArray(o))for(const l of o)this._rebuildGeometry(l);else this._rebuildGeometry()}updatePartialGeometry(e){let{startRow:t,endRow:n}=e;this._rebuildGeometry({startRow:t,endRow:n})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?gA(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:n,buffers:r,_attributeDefs:i,typedArrayManager:s}=this;for(const o in i)if(o in r)s.release(n[o]),n[o]=null;else{const r=i[o];r.copy=t,n[o]=s.allocate(n[o],e,r)}}_forEachGeometry(e,t,n){const{data:r,getGeometry:i}=this,{iterable:s,objectInfo:o}=fA(r,t,n);for(const a of s){o.index++;e(i?i(a,o):null,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:n,instanceCount:r}=this;const{data:i,geometryBuffer:s}=this,{startRow:o=0,endRow:a=1/0}=e||{},l={};if(e||(t=[0],n=[0]),this.normalize||!s)this._forEachGeometry((e,t)=>{const r=e&&this.normalizeGeometry(e);l[t]=r,n[t+1]=n[t]+(r?this.getGeometrySize(r):0)},o,a),r=n[n.length-1];else if(n=i.startIndices,r=n[i.length]||0,ArrayBuffer.isView(s))r=r||s.length/this.positionSize;else if(s instanceof Ha){const e=4*this.positionSize;r=r||s.byteLength/e}else if(s.buffer){const e=s.stride||4*this.positionSize;r=r||s.buffer.byteLength/e}else if(s.value){const e=s.value,t=s.stride/e.BYTES_PER_ELEMENT||this.positionSize;r=r||e.length/t}this._allocate(r,Boolean(e)),this.indexStarts=t,this.vertexStarts=n,this.instanceCount=r;const u={};this._forEachGeometry((e,i)=>{const s=l[i]||e;u.vertexStart=n[i],u.indexStart=t[i];const o=i<n.length-1?n[i+1]:r;u.geometrySize=o-n[i],u.geometryIndex=i,this.updateGeometryAttributes(s,u)},o,a),this.vertexCount=t[t.length-1]}}const gF=1,mF=-1;function yF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Math.sign(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{start:n=0,end:r=e.length,plane:i="xy"}=t,s=t.size||2;let o=0;const a=vF[i[0]],l=vF[i[1]];for(let u=n,c=r-s;u<r;u+=s)o+=(e[u+a]-e[c+a])*(e[u+l]+e[c+l]),c=u;return o/2}(e,t))}(e,n);return r!==t&&(function(e,t){const{start:n=0,end:r=e.length,size:i=2}=t,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const t=n+a*i,r=n+(s-1-a)*i;for(let n=0;n<i;++n){const i=e[t+n];e[t+n]=e[r+n],e[r+n]=i}}}(e,n),!0)}const vF={x:0,y:1,z:2};function _F(e,t,n,r){let i,s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)i=(r[3]-e[1])/(t[1]-e[1]),s=3;else if(4&n)i=(r[1]-e[1])/(t[1]-e[1]),s=1;else if(2&n)i=(r[2]-e[0])/(t[0]-e[0]),s=2;else{if(!(1&n))return null;i=(r[0]-e[0])/(t[0]-e[0]),s=0}for(let a=0;a<e.length;a++)o[a]=(1&s)===a?r[s]:i*(t[a]-e[a])+e[a];return o}function bF(e,t){let n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function wF(e,t){const n=t.length,r=e.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(e[r-n+s]!==t[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)e[r+i]=t[i];return!0}function EF(e,t){const n=t.length;for(let r=0;r<n;r++)e[r]=t[r]}function xF(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const s=r+t*n;for(let o=0;o<n;o++)i[o]=e[s+o];return i}function DF(e,t){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=e.length}=t||{},l=(a-o)/n;let u=[];const c=[u],A=xF(e,0,n,o);let h,d;const f=TF(A,i,s,[]),p=[];wF(u,A);for(let g=1;g<l;g++){for(h=xF(e,g,n,o,h),d=bF(h,f);d;){_F(A,h,d,f,p);const e=bF(p,f);e&&(_F(A,p,e,f,p),d=e),wF(u,p),EF(A,p),IF(f,i,d),r&&u.length>n&&(u=[],c.push(u),wF(u,A)),d=bF(h,f)}wF(u,h),EF(A,h)}return r?c:c[0]}function CF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(!e.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],l=[{pos:e,types:o?new Array(e.length/r).fill(1):null,holes:t||[]}],u=[[],[]];let c=[];for(;l.length;){const{pos:e,types:t,holes:n}=l.shift();FF(e,r,n[0]||e.length,u),c=TF(u[0],i,s,c);const A=bF(u[1],c);if(A){let i=SF(e,t,r,0,n[0]||e.length,c,A);const s={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};l.push(s,a);for(let l=0;l<n.length;l++)i=SF(e,t,r,n[l],n[l+1]||e.length,c,A),i[0]&&(s.holes.push(s.pos.length),s.pos=RF(s.pos,i[0].pos),o&&(s.types=RF(s.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=RF(a.pos,i[1].pos),o&&(a.types=RF(a.types,i[1].types)))}else{const r={positions:e};o&&(r.edgeTypes=t),n.length&&(r.holeIndices=n),a.push(r)}}return a}function SF(e,t,n,r,i,s,o){const a=(i-r)/n,l=[],u=[],c=[],A=[],h=[];let d,f,p;const g=xF(e,a-1,n,r);let m=Math.sign(8&o?g[1]-s[3]:g[0]-s[2]),y=t&&t[a-1],v=0,_=0;for(let b=0;b<a;b++)d=xF(e,b,n,r,d),f=Math.sign(8&o?d[1]-s[3]:d[0]-s[2]),p=t&&t[r/n+b],f&&m&&m!==f&&(_F(g,d,o,s,h),wF(l,h)&&c.push(y),wF(u,h)&&A.push(y)),f<=0?(wF(l,d)&&c.push(p),v-=f):c.length&&(c[c.length-1]=0),f>=0?(wF(u,d)&&A.push(p),_+=f):A.length&&(A[A.length-1]=0),EF(g,d),m=f,y=p;return[v?{pos:l,types:t&&c}:null,_?{pos:u,types:t&&A}:null]}function TF(e,t,n,r){const i=Math.floor((e[0]-n[0])/t)*t+n[0],s=Math.floor((e[1]-n[1])/t)*t+n[1];return r[0]=i,r[1]=s,r[2]=i+t,r[3]=s+t,r}function IF(e,t,n){8&n?(e[1]+=t,e[3]+=t):4&n?(e[1]-=t,e[3]-=t):2&n?(e[0]+=t,e[2]+=t):1&n&&(e[0]-=t,e[2]-=t)}function FF(e,t,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let l=0;l<n;l+=t){const t=e[l],n=e[l+1];i=t<i?t:i,s=t>s?t:s,o=n<o?n:o,a=n>a?n:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}function RF(e,t){for(let n=0;n<t.length;n++)e.push(t[n]);return e}function kF(e,t,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=t){const t=Math.abs(e[o]);t>i&&(i=t,s=o-1)}return s}function PF(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:85.051129;const s=e[n],o=e[r-t];if(Math.abs(s-o)>180){const r=xF(e,0,t,n);r[0]+=360*Math.round((o-s)/360),wF(e,r),r[1]=Math.sign(r[1])*i,wF(e,r),r[0]=s,wF(e,r)}}function MF(e,t,n,r){let i,s=e[0];for(let o=n;o<r;o+=t){i=e[o];const t=i-s;(t>180||t<-180)&&(i-=360*Math.round(t/360)),e[o]=s=i}}function BF(e,t){let n;const r=e.length/t;for(let s=0;s<r&&(n=e[s*t],(n+180)%360===0);s++);const i=360*-Math.round(n/360);if(0!==i)for(let s=0;s<r;s++)e[s*t]+=i}function LF(e,t,n,r){let i;if(Array.isArray(e[0])){const n=e.length*t;i=new Array(n);for(let r=0;r<e.length;r++)for(let n=0;n<t;n++)i[r*t+n]=e[r][n]||0}else i=e;return n?DF(i,{size:t,gridResolution:n}):r?function(e,t){const{size:n=2,startIndex:r=0,endIndex:i=e.length,normalize:s=!0}=t||{},o=e.slice(r,i);MF(o,n,0,i-r);const a=DF(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)BF(l,n);return a}(i,{size:t}):i}class OF extends pF{constructor(e){super(u(u({},e),{},{attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}}))}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?LF(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(NF(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(0!==t.geometrySize)if(e&&NF(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const n=this.attributes.segmentTypes,r=!!e&&this.isClosed(e),{vertexStart:i,geometrySize:s}=t;n.fill(0,i,i+s),r?(n[i]=4,n[i+s-2]=4):(n[i]+=1,n[i+s-2]+=2),n[i+s-1]=4}_updatePositions(e,t){const{positions:n}=this.attributes;if(!n||!e)return;const{vertexStart:r,geometrySize:i}=t,s=new Array(3);for(let o=r,a=0;a<i;o++,a++)this.getPointOnPath(e,a,s),n[3*o]=s[0],n[3*o+1]=s[1],n[3*o+2]=s[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const{positionSize:r}=this;t*r>=e.length&&(t+=1-e.length/r);const i=t*r;return n[0]=e[i],n[1]=e[i+1],n[2]=3===r&&e[i+2]||0,n}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:t}=this,n=e.length-t;return e[0]===e[n]&&e[1]===e[n+1]&&(2===t||e[2]===e[n+2])}}function NF(e){return Array.isArray(e[0])}const UF="uniform pathUniforms {\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  float jointType;\n  float capType;\n  float miterLimit;\n  bool billboard;\n  highp int widthUnits;\n} path;\n",zF={name:"path",vs:UF,fs:UF,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}},jF=[0,0,0,255],VF={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:jF},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},GF={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class WF extends Cp{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME path-layer-vertex-shader\nin vec2 positions;\nin float instanceTypes;\nin vec3 instanceStartPositions;\nin vec3 instanceEndPositions;\nin vec3 instanceLeftPositions;\nin vec3 instanceRightPositions;\nin vec3 instanceLeftPositions64Low;\nin vec3 instanceStartPositions64Low;\nin vec3 instanceEndPositions64Low;\nin vec3 instanceRightPositions64Low;\nin float instanceStrokeWidths;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nuniform float opacity;\nout vec4 vColor;\nout vec2 vCornerOffset;\nout float vMiterLength;\nout vec2 vPathPosition;\nout float vPathLength;\nout float vJointType;\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\nfloat flipIfTrue(bool flag) {\nreturn -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\nvec3 prevPoint, vec3 currPoint, vec3 nextPoint,\nvec2 width\n) {\nbool isEnd = positions.x > 0.0;\nfloat sideOfPath = positions.y;\nfloat isJoint = float(sideOfPath == 0.0);\nvec3 deltaA3 = (currPoint - prevPoint);\nvec3 deltaB3 = (nextPoint - currPoint);\nmat3 rotationMatrix;\nbool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);\nif (needsRotation) {\ndeltaA3 = deltaA3 * rotationMatrix;\ndeltaB3 = deltaB3 * rotationMatrix;\n}\nvec2 deltaA = deltaA3.xy / width;\nvec2 deltaB = deltaB3.xy / width;\nfloat lenA = length(deltaA);\nfloat lenB = length(deltaB);\nvec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\nvec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\nvec2 perpA = vec2(-dirA.y, dirA.x);\nvec2 perpB = vec2(-dirB.y, dirB.x);\nvec2 tangent = dirA + dirB;\ntangent = length(tangent) > 0. ? normalize(tangent) : perpA;\nvec2 miterVec = vec2(-tangent.y, tangent.x);\nvec2 dir = isEnd ? dirA : dirB;\nvec2 perp = isEnd ? perpA : perpB;\nfloat L = isEnd ? lenA : lenB;\nfloat sinHalfA = abs(dot(miterVec, perp));\nfloat cosHalfA = abs(dot(dirA, miterVec));\nfloat turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\nfloat cornerPosition = sideOfPath * turnDirection;\nfloat miterSize = 1.0 / max(sinHalfA, EPSILON);\nmiterSize = mix(\nmin(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\nmiterSize,\nstep(0.0, cornerPosition)\n);\nvec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n* (sideOfPath + isJoint * turnDirection);\nbool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\nbool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\nbool isCap = isStartCap || isEndCap;\nif (isCap) {\noffsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);\nvJointType = path.capType;\n} else {\nvJointType = path.jointType;\n}\nvPathLength = L;\nvCornerOffset = offsetVec;\nvMiterLength = dot(vCornerOffset, miterVec * turnDirection);\nvMiterLength = isCap ? isJoint : vMiterLength;\nvec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\nvPathPosition = vec2(\ndot(offsetFromStartOfPath, perp),\ndot(offsetFromStartOfPath, dir)\n);\ngeometry.uv = vPathPosition;\nfloat isValid = step(instanceTypes, 3.5);\nvec3 offset = vec3(offsetVec * width * isValid, 0.0);\nif (needsRotation) {\noffset = rotationMatrix * offset;\n}\nreturn offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\nif (position.w < EPSILON) {\nfloat r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\nposition = refPosition + (position - refPosition) * r;\n}\n}\nvoid main() {\ngeometry.pickingColor = instancePickingColors;\nvColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);\nfloat isEnd = positions.x;\nvec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\nvec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\nvec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\nvec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\nvec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\nvec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\ngeometry.worldPosition = currPosition;\nvec2 widthPixels = vec2(clamp(\nproject_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),\npath.widthMinPixels, path.widthMaxPixels) / 2.0);\nvec3 width;\nif (path.billboard) {\nvec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\nvec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\nvec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\nclipLine(prevPositionScreen, currPositionScreen);\nclipLine(nextPositionScreen, currPositionScreen);\nclipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\nwidth = vec3(widthPixels, 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(\nprevPositionScreen.xyz / prevPositionScreen.w,\ncurrPositionScreen.xyz / currPositionScreen.w,\nnextPositionScreen.xyz / nextPositionScreen.w,\nproject_pixel_size_to_clipspace(width.xy)\n);\nDECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\ngl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n} else {\nprevPosition = project_position(prevPosition, prevPosition64Low);\ncurrPosition = project_position(currPosition, currPosition64Low);\nnextPosition = project_position(nextPosition, nextPosition64Low);\nwidth = vec3(project_pixel_size(widthPixels), 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\ngeometry.position = vec4(currPosition + offset, 1.0);\ngl_Position = project_common_position_to_clipspace(geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME path-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 vCornerOffset;\nin float vMiterLength;\nin vec2 vPathPosition;\nin float vPathLength;\nin float vJointType;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = vPathPosition;\nif (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\nif (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\ndiscard;\n}\nif (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {\ndiscard;\n}\n}\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[hI,fI,zF]})}get wrapLongitude(){return!1}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["vertexPositions"])}initializeState(){const e=!0;this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:GF,accessor:"getPath",update:this.calculatePositions,noAlloc:e,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:e},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:GF,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:GF,defaultValue:jF},instancePickingColors:{size:4,type:"uint8",accessor:(e,t)=>{let{index:n,target:r}=t;return this.encodePickingColor(e&&e.__source?e.__source.index:n,r)}}}),this.setState({pathTesselator:new OF({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:n}=e,r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:e}=this.state,i=t.data.attributes||{};e.updateGeometry({data:t.data,geometryBuffer:i.getPath,buffers:i,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||r.invalidateAll()}var i;n.extensionsChanged&&(null===(i=this.state.model)||void 0===i||i.destroy(),this.state.model=this._getModel(),r.invalidateAll())}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find(e=>e.__source.index===n)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw(e){let{uniforms:t}=e;const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:u}=this.props,c=this.state.model,A={jointType:Number(n),capType:Number(r),billboard:i,widthUnits:As[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:u};c.shaderInputs.setProps({path:A}),c.draw(this.context.renderPass)}_getModel(){return new df(this.context.device,u(u({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new pI({topology:"triangle-list",attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0}))}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}WF.defaultProps=VF,WF.layerName="PathLayer";const HF=WF,QF="precision highp int;\n\n// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\n  vec3 color;\n};\n\nstruct PointLight {\n  vec3 color;\n  vec3 position;\n  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform lightingUniforms {\n  int enabled;\n  int lightType;\n\n  int directionalLightCount;\n  int pointLightCount;\n\n  vec3 ambientColor;\n\n  vec3 lightColor0;\n  vec3 lightPosition0;\n  vec3 lightDirection0;\n  vec3 lightAttenuation0;\n\n  vec3 lightColor1;\n  vec3 lightPosition1;\n  vec3 lightDirection1;\n  vec3 lightAttenuation1;\n\n  vec3 lightColor2;\n  vec3 lightPosition2;\n  vec3 lightDirection2;\n  vec3 lightAttenuation2;\n} lighting;\n\nPointLight lighting_getPointLight(int index) {\n  switch (index) {\n    case 0:\n      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);\n    case 1:\n      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);\n    case 2:\n    default:  \n      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);\n  }\n}\n\nDirectionalLight lighting_getDirectionalLight(int index) {\n  switch (index) {\n    case 0:\n      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);\n    case 1:\n      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);\n    case 2:\n    default:   \n      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);\n  }\n} \n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n// #endif\n";var XF;!function(e){e[e.POINT=0]="POINT",e[e.DIRECTIONAL=1]="DIRECTIONAL"}(XF||(XF={}));const YF={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:3},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:XF.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:"// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\n  color: vec3<f32>,\n};\n\nstruct PointLight {\n  color: vec3<f32>,\n  position: vec3<f32>,\n  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential\n};\n\nstruct DirectionalLight {\n  color: vec3<f32>,\n  direction: vec3<f32>,\n};\n\nstruct lightingUniforms {\n  enabled: i32,\n  pointLightCount: i32,\n  directionalLightCount: i32,\n\n  ambientColor: vec3<f32>,\n\n  // TODO - support multiple lights by uncommenting arrays below\n  lightType: i32,\n  lightColor: vec3<f32>,\n  lightDirection: vec3<f32>,\n  lightPosition: vec3<f32>,\n  lightAttenuation: vec3<f32>,\n\n  // AmbientLight ambientLight;\n  // PointLight pointLight[MAX_LIGHTS];\n  // DirectionalLight directionalLight[MAX_LIGHTS];\n};\n\n// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)\n@binding(1) @group(0) var<uniform> lighting : lightingUniforms;\n\nfn lighting_getPointLight(index: i32) -> PointLight {\n  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);\n}\n\nfn lighting_getDirectionalLight(index: i32) -> DirectionalLight {\n  return DirectionalLight(lighting.lightColor, lighting.lightDirection);\n} \n\nfn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n",vs:QF,fs:QF,getUniforms:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e=e?u({},e):e))return u({},YF.defaultUniforms);e.lights&&(e=u(u(u({},e),function(e){var t,n;const r={pointLights:[],directionalLights:[]};for(const i of e||[])switch(i.type){case"ambient":r.ambientLight=i;break;case"directional":null===(t=r.directionalLights)||void 0===t||t.push(i);break;case"point":null===(n=r.pointLights)||void 0===n||n.push(i)}return r}(e.lights)),{},{lights:void 0}));const{ambientLight:n,pointLights:r,directionalLights:i}=e||{};if(!(n||r&&r.length>0||i&&i.length>0))return u(u({},YF.defaultUniforms),{},{enabled:0});const s=u(u(u({},YF.defaultUniforms),t),function(e){let{ambientLight:t,pointLights:n=[],directionalLights:r=[]}=e;const i={};i.ambientLightColor=qF(t);let s=0;for(const o of n){i.lightType=XF.POINT;const e=s;i["lightColor".concat(e)]=qF(o),i["lightPosition".concat(e)]=o.position,i["lightAttenuation".concat(e)]=o.attenuation||[1,0,0],s++}for(const o of r){i.lightType=XF.DIRECTIONAL;const e=s;i["lightColor".concat(e)]=qF(o),i["lightDirection".concat(e)]=o.direction,s++}s>3&&ja.warn("MAX_LIGHTS exceeded")();return i.directionalLightCount=r.length,i.pointLightCount=n.length,i}({ambientLight:n,pointLights:r,directionalLights:i}));void 0!==e.enabled&&(s.enabled=e.enabled?1:0);return s}};function qF(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:t=[0,0,0],intensity:n=1}=e;return t.map(e=>e*n/255)}const KF="uniform phongMaterialUniforms {\n  uniform float ambient;\n  uniform float diffuse;\n  uniform float shininess;\n  uniform vec3  specularColor;\n} material;\n",ZF="uniform phongMaterialUniforms {\n  uniform float ambient;\n  uniform float diffuse;\n  uniform float shininess;\n  uniform vec3  specularColor;\n} material;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n  vec3 halfway_direction = normalize(light_direction + view_direction);\n  float lambertian = dot(light_direction, normal_worldspace);\n  float specular = 0.0;\n  if (lambertian > 0.0) {\n    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n    specular = pow(specular_angle, material.shininess);\n  }\n  lambertian = max(lambertian, 0.0);\n  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting.enabled == 0) {\n    return lightColor;\n  }\n\n  vec3 view_direction = normalize(cameraPosition - position_worldspace);\n  lightColor = material.ambient * surfaceColor * lighting.ambientColor;\n\n  for (int i = 0; i < lighting.pointLightCount; i++) {\n    PointLight pointLight = lighting_getPointLight(i);\n    vec3 light_position_worldspace = pointLight.position;\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);\n  }\n\n  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);\n  for (int i = lighting.pointLightCount; i < totalLights; i++) {\n    DirectionalLight directionalLight = lighting_getDirectionalLight(i);\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  \n  return lightColor;\n}\n",JF="struct phongMaterialUniforms {\n  ambient: f32,\n  diffuse: f32,\n  shininess: f32,\n  specularColor: vec3<f32>,\n};\n\n@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;\n\nfn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {\n  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);\n  var lambertian: f32 = dot(light_direction, normal_worldspace);\n  var specular: f32 = 0.0;\n  if (lambertian > 0.0) {\n    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n    specular = pow(specular_angle, phongMaterial.shininess);\n  }\n  lambertian = max(lambertian, 0.0);\n  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;\n}\n\nfn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {\n  var lightColor: vec3<f32> = surfaceColor;\n\n  if (lighting.enabled == 0) {\n    return lightColor;\n  }\n\n  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);\n  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;\n\n  if (lighting.lightType == 0) {\n    let pointLight: PointLight  = lighting_getPointLight(0);\n    let light_position_worldspace: vec3<f32> = pointLight.position;\n    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n  } else if (lighting.lightType == 1) {\n    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  \n  return lightColor;\n  /*\n  for (int i = 0; i < MAX_LIGHTS; i++) {\n    if (i >= lighting.pointLightCount) {\n      break;\n    }\n    PointLight pointLight = lighting.pointLight[i];\n    vec3 light_position_worldspace = pointLight.position;\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n  }\n\n  for (int i = 0; i < MAX_LIGHTS; i++) {\n    if (i >= lighting.directionalLightCount) {\n      break;\n    }\n    DirectionalLight directionalLight = lighting.directionalLight[i];\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  */\n}\n\nfn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{\n  var lightColor = vec3<f32>(0, 0, 0);\n  let surfaceColor = vec3<f32>(0, 0, 0);\n\n  if (lighting.enabled == 0) {\n    let view_direction = normalize(cameraPosition - position_worldspace);\n\n    switch (lighting.lightType) {\n      case 0, default: {\n        let pointLight: PointLight = lighting_getPointLight(0);\n        let light_position_worldspace: vec3<f32> = pointLight.position;\n        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);\n        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n      }\n      case 1: {\n        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);\n        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n      }\n    }\n  }\n  return lightColor;\n}\n",$F={props:{},name:"gouraudMaterial",vs:ZF.replace("phongMaterial","gouraudMaterial"),fs:KF.replace("phongMaterial","gouraudMaterial"),source:JF.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[YF],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(e){const t=u({},e);return t.specularColor&&(t.specularColor=t.specularColor.map(e=>e/255)),u(u({},$F.defaultUniforms),t)}};var eR=n(973);const tR=gF,nR=mF,rR={isClosed:!0};function iR(e){return"positions"in e?e.positions:e}function sR(e){return"holeIndices"in e?e.holeIndices:null}function oR(e,t,n,r,i){let s=t;const o=n.length;for(let a=0;a<o;a++)for(let t=0;t<r;t++)e[s++]=n[a][t]||0;if(!function(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}(n))for(let a=0;a<r;a++)e[s++]=n[0][a]||0;return rR.start=t,rR.end=s,rR.size=r,yF(e,i,rR),s}function aR(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;s=s||n.length;const a=s-i;if(a<=0)return t;let l=t;for(let u=0;u<a;u++)e[l++]=n[i+u];if(!function(e,t,n,r){for(let i=0;i<t;i++)if(e[n+i]!==e[r-t+i])return!1;return!0}(n,r,i,s))for(let u=0;u<r;u++)e[l++]=n[i+u];return rR.start=t,rR.end=l,rR.size=r,yF(e,o,rR),l}function lR(e,t){!function(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}(e);const n=[],r=[];if("positions"in e){const{positions:i,holeIndices:s}=e;if(s){let e=0;for(let o=0;o<=s.length;o++)e=aR(n,e,i,t,s[o-1],s[o],0===o?tR:nR),r.push(e);return r.pop(),{positions:n,holeIndices:r}}e=i}if(!function(e){return Array.isArray(e[0])}(e))return aR(n,0,e,t,0,n.length,tR),n;if(!function(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}(e)){let i=0;for(const[s,o]of e.entries())i=oR(n,i,o,t,0===s?tR:nR),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return oR(n,0,e,t,tR),n}function uR(e,t,n){const r=e.length/3;let i=0;for(let s=0;s<r;s++){const o=(s+1)%r;i+=e[3*s+t]*e[3*o+n],i-=e[3*o+t]*e[3*s+n]}return Math.abs(i/2)}function cR(e,t,n,r){const i=e.length/3;for(let s=0;s<i;s++){const i=3*s,o=e[i+0],a=e[i+1],l=e[i+2];e[i+t]=o,e[i+n]=a,e[i+r]=l}}class AR extends pF{constructor(e){const{fp64:t,IndexType:n=Uint32Array}=e;super(u(u({},e),{},{attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:n,size:1}}}))}get(e){const{attributes:t}=this;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=lR(e,this.positionSize);return this.opts.resolution?CF(iR(t),sR(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};t=t||[];const o=[],a=[];let l=0,u=0;for(let A=0;A<=t.length;A++){const i=t[A]||e.length,s=u,c=kF(e,r,l,i);for(let t=c;t<i;t++)o[u++]=e[t];for(let t=l;t<c;t++)o[u++]=e[t];MF(o,r,s,u),PF(o,r,s,u,null===n||void 0===n?void 0:n.maxLatitude),l=i,a[A]=u}a.pop();const c=CF(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const A of c)BF(A.positions,r);return c}(iR(t),sR(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(hR(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}return iR(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&hR(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e,t.indexStart=this.indexStarts[t.geometryIndex+1]}else{const n=e;this._updateIndices(n,t),this._updatePositions(n,t),this._updateVertexValid(n,t)}}_updateIndices(e,t){let{geometryIndex:n,vertexStart:r,indexStart:i}=t;const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let l=s.indices;if(!l||!e)return;let u=i;const c=function(e,t,n,r){let i=sR(e);i&&(i=i.map(e=>e/t));let s=iR(e);const o=r&&3===t;if(n){const e=s.length;s=s.slice();const r=[];for(let i=0;i<e;i+=t){r[0]=s[i],r[1]=s[i+1],o&&(r[2]=s[i+2]);const e=n(r);s[i]=e[0],s[i+1]=e[1],o&&(s[i+2]=e[2])}}if(o){const e=uR(s,0,1),t=uR(s,0,2),r=uR(s,1,2);if(!e&&!t&&!r)return[];e>t&&e>r||(t>r?(n||(s=s.slice()),cR(s,0,2,1)):(n||(s=s.slice()),cR(s,2,0,1)))}return eR(s,i,t)}(e,this.positionSize,this.opts.preproject,this.opts.full3d);l=a.allocate(l,i+c.length,{copy:!0});for(let A=0;A<c.length;A++)l[u++]=c[A]+r;o[n+1]=i+c.length,s.indices=l}_updatePositions(e,t){let{vertexStart:n,geometrySize:r}=t;const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=iR(e);for(let a=n,l=0;l<r;a++,l++){const e=o[l*s],t=o[l*s+1],n=s>2?o[l*s+2]:0;i[3*a]=e,i[3*a+1]=t,i[3*a+2]=n}}_updateVertexValid(e,t){let{vertexStart:n,geometrySize:r}=t;const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&sR(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function hR(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}const dR="uniform solidPolygonUniforms {\n  bool extruded;\n  bool isWireframe;\n  float elevationScale;\n} solidPolygon;\n",fR={name:"solidPolygon",vs:dR,fs:dR,uniformTypes:{extruded:"f32",isWireframe:"f32",elevationScale:"f32"}},pR="in vec4 fillColors;\nin vec4 lineColors;\nin vec3 pickingColors;\nout vec4 vColor;\nstruct PolygonProps {\nvec3 positions;\nvec3 positions64Low;\nvec3 normal;\nfloat elevations;\n};\nvec3 project_offset_normal(vec3 vector) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\nreturn normalize(vector * project.commonUnitsPerWorldUnit);\n}\nreturn project_normal(vector);\n}\nvoid calculatePosition(PolygonProps props) {\nvec3 pos = props.positions;\nvec3 pos64Low = props.positions64Low;\nvec3 normal = props.normal;\nvec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;\ngeometry.worldPosition = props.positions;\ngeometry.pickingColor = pickingColors;\nif (solidPolygon.extruded) {\npos.z += props.elevations * solidPolygon.elevationScale;\n}\ngl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nif (solidPolygon.extruded) {\n#ifdef IS_SIDE_VERTEX\nnormal = project_offset_normal(normal);\n#else\nnormal = project_normal(normal);\n#endif\ngeometry.normal = normal;\nvec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, colors.a * layer.opacity);\n} else {\nvColor = vec4(colors.rgb, colors.a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",gR="#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader\nin vec3 vertexPositions;\nin vec3 vertexPositions64Low;\nin float elevations;\n".concat(pR,"\nvoid main(void) {\nPolygonProps props;\nprops.positions = vertexPositions;\nprops.positions64Low = vertexPositions64Low;\nprops.elevations = elevations;\nprops.normal = vec3(0.0, 0.0, 1.0);\ncalculatePosition(props);\n}\n"),mR="#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\nin vec2 positions;\nin vec3 vertexPositions;\nin vec3 nextVertexPositions;\nin vec3 vertexPositions64Low;\nin vec3 nextVertexPositions64Low;\nin float elevations;\nin float instanceVertexValid;\n".concat(pR,"\nvoid main(void) {\nif(instanceVertexValid < 0.5){\ngl_Position = vec4(0.);\nreturn;\n}\nPolygonProps props;\nvec3 pos;\nvec3 pos64Low;\nvec3 nextPos;\nvec3 nextPos64Low;\n#if RING_WINDING_ORDER_CW == 1\npos = vertexPositions;\npos64Low = vertexPositions64Low;\nnextPos = nextVertexPositions;\nnextPos64Low = nextVertexPositions64Low;\n#else\npos = nextVertexPositions;\npos64Low = nextVertexPositions64Low;\nnextPos = vertexPositions;\nnextPos64Low = vertexPositions64Low;\n#endif\nprops.positions = mix(pos, nextPos, positions.x);\nprops.positions64Low = mix(pos64Low, nextPos64Low, positions.x);\nprops.normal = vec3(\npos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),\nnextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),\n0.0);\nprops.elevations = elevations * positions.y;\ncalculatePosition(props);\n}\n"),yR=[0,0,0,255],vR={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:yR},getLineColor:{type:"accessor",value:yR},material:!0},_R={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class bR extends Cp{getShaders(e){return super.getShaders({vs:"top"===e?gR:mR,fs:"#version 300 es\n#define SHADER_NAME solid-polygon-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\nfragColor = vColor;\ngeometry.uv = vec2(0.);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[hI,$F,fI,fR]})}get wrapLongitude(){return!1}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:t}=this.props;const{_full3d:n}=this.props;let r;e.isGeospatial&&t===us.DEFAULT&&(t=us.LNGLAT),t===us.LNGLAT&&(r=n?e.projectPosition.bind(e):e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new AR({preproject:r,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const i=this.getAttributeManager(),s=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:_R,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,stepMode:"dynamic",transition:_R,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:_R,accessor:"getFillColor",defaultValue:yR},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:_R,accessor:"getLineColor",defaultValue:yR},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(e,t)=>{let{index:n,target:r}=t;return this.encodePickingColor(e&&e.__source?e.__source.index:n,r)}}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find(e=>e.__source.index===n)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw(e){let{uniforms:t}=e;const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,wireframeModel:l,polygonTesselator:c}=this.state,A={extruded:Boolean(n),elevationScale:s,isWireframe:!1};l&&i&&(l.setInstanceCount(c.instanceCount-1),l.shaderInputs.setProps({solidPolygon:u(u({},A),{},{isWireframe:!0})}),l.draw(this.context.renderPass)),a&&r&&(a.setInstanceCount(c.instanceCount-1),a.shaderInputs.setProps({solidPolygon:A}),a.draw(this.context.renderPass)),o&&r&&(o.setVertexCount(c.vertexCount),o.shaderInputs.setProps({solidPolygon:A}),o.draw(this.context.renderPass))}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:n,changeFlags:r}=e,i=this.getAttributeManager();var s;(r.extensionsChanged||t.filled!==n.filled||t.extruded!==n.extruded)&&(null===(s=this.state.models)||void 0===s||s.forEach(e=>e.destroy()),this.setState(this._getModels()),i.invalidateAll())}updateGeometry(e){let{props:t,oldProps:n,changeFlags:r}=e;if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,n=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:n.getPolygon,buffers:n,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:t._full3d}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:t,extruded:n}=this.props;let r,i,s;if(t){const t=this.getShaders("top");t.defines.NON_INSTANCED_MODEL=1;const n=this.getAttributeManager().getBufferLayouts({isInstanced:!1});r=new df(this.context.device,u(u({},t),{},{id:"".concat(e,"-top"),topology:"triangle-list",bufferLayout:n,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}}))}if(n){const t=this.getAttributeManager().getBufferLayouts({isInstanced:!0});i=new df(this.context.device,u(u({},this.getShaders("side")),{},{id:"".concat(e,"-side"),bufferLayout:t,geometry:new pI({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})),s=new df(this.context.device,u(u({},this.getShaders("side")),{},{id:"".concat(e,"-wireframe"),bufferLayout:t,geometry:new pI({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}))}return{models:[i,s,r].filter(Boolean),topModel:r,sideModel:i,wireframeModel:s}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}bR.defaultProps=vR,bR.layerName="SolidPolygonLayer";const wR=bR,ER={circle:{type:BI,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:II,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:fF,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},xR={type:HF,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},DR={type:wR,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function CR(e){let{type:t,props:n}=e;const r={};for(const i in n)r[i]=t.defaultProps[n[i]];return r}function SR(e,t){const{transitions:n,updateTriggers:r}=e.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in t){const o=t[s];let a=e.props[s];s.startsWith("get")&&(a=e.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function TR(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=e.length}=n;for(let o=i;o<s;o++){const n=e[o],{geometry:i}=n;if(i)if("GeometryCollection"===i.type){Me.assert(Array.isArray(i.geometries),"GeoJSON does not have geometries array");const{geometries:e}=i;for(let i=0;i<e.length;i++){IR(e[i],r,t,n,o)}}else IR(i,r,t,n,o)}return r}function IR(e,t,n,r,i){const{type:s,coordinates:o}=e,{pointFeatures:a,lineFeatures:l,polygonFeatures:u,polygonOutlineFeatures:c}=t;if(function(e,t){let n=FR[e];Me.assert(n,"Unknown GeoJSON type ".concat(e));for(;t&&--n>0;)t=t[0];return t&&Number.isFinite(t[0])}(s,o))switch(s){case"Point":a.push(n({geometry:e},r,i));break;case"MultiPoint":o.forEach(e=>{a.push(n({geometry:{type:"Point",coordinates:e}},r,i))});break;case"LineString":l.push(n({geometry:e},r,i));break;case"MultiLineString":o.forEach(e=>{l.push(n({geometry:{type:"LineString",coordinates:e}},r,i))});break;case"Polygon":u.push(n({geometry:e},r,i)),o.forEach(e=>{c.push(n({geometry:{type:"LineString",coordinates:e}},r,i))});break;case"MultiPolygon":o.forEach(e=>{u.push(n({geometry:{type:"Polygon",coordinates:e}},r,i)),e.forEach(e=>{c.push(n({geometry:{type:"LineString",coordinates:e}},r,i))})})}else Me.warn("".concat(s," coordinates are malformed"))()}const FR={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function RR(e){return e.geometry.coordinates}function kR(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:r,lines:i,polygons:s}=e,o=function(e,t){const n={points:null,lines:null,polygons:null};for(const r in n){const i=e[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(4*i.length);const s=[];for(let e=0;e<i.length;e++)t(i[e],s),n[r][4*e+0]=s[0],n[r][4*e+1]=s[1],n[r][4*e+2]=s[2],n[r][4*e+3]=255}return n}(e,t);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:u(u({},r.attributes),{},{getPosition:r.positions,instancePickingColors:{size:4,value:o.points}}),properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:u(u({},i.attributes),{},{getPath:i.positions,instancePickingColors:{size:4,value:o.lines}}),properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:u(u({},s.attributes),{},{getPolygon:s.positions,pickingColors:{size:4,value:o.polygons}}),properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:u(u({},s.attributes),{},{getPath:s.positions,instancePickingColors:{size:4,value:o.polygons}}),properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const PR=["instancePickingColors"],MR=["points","linestrings","polygons"],BR=u(u(u(u(u(u({},CR(ER.circle)),CR(ER.icon)),CR(ER.text)),CR(xR)),CR(DR)),{},{stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}});class LR extends lI{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState(e){let{props:t,changeFlags:n}=e;if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:t,changeFlags:n}):this._updateStateJSON({props:t,changeFlags:n})}_updateStateBinary(e){let{props:t,changeFlags:n}=e;const r=kR(t.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON(e){let{props:t,changeFlags:n}=e;const r=function(e){if(Array.isArray(e))return e;switch(Me.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return Me.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(t.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const e=this.state.features;for(const t in e)s[t]=e[t].slice(),o[t]=[];for(const t of n.dataChanged){const n=TR(r,i,t);for(const r in e)o[r].push(cI({data:s[r],getIndex:e=>e.__source.index,dataRange:t,replace:n[r]}))}}else s=TR(r,i);const a=function(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=e;return n.points.data=r,n.points._dataDiff=t.pointFeatures&&(()=>t.pointFeatures),n.points.getPosition=RR,n.lines.data=i,n.lines._dataDiff=t.lineFeatures&&(()=>t.lineFeatures),n.lines.getPath=RR,n.polygons.data=s,n.polygons._dataDiff=t.polygonFeatures&&(()=>t.polygonFeatures),n.polygons.getPolygon=RR,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&(()=>t.polygonOutlineFeatures),n.polygonsOutline.getPath=RR,n}(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n,sourceLayer:r}=t;return t.featureType=MR.find(e=>r.id.startsWith("".concat(this.id,"-").concat(e,"-"))),n>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[n]),t}_updateAutoHighlight(e){const t="".concat(this.id,"-points-"),n="points"===e.featureType;for(const r of this.getSubLayers())r.id.startsWith(t)===n&&r.updateAutoHighlight(e)}_renderPolygonLayer(){var e;const{extruded:t,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,null===(e=r.polygons)||void 0===e?void 0:e.data)&&this.getSubLayerClass(i,DR.type);if(s){const e=SR(this,DR.props),o=t&&n;return o||delete e.getLineColor,e.updateTriggers.lineColors=o,new s(e,this.getSubLayerProps({id:i,updateTriggers:e.updateTriggers}),r.polygons)}return null}_renderLineLayers(){var e,t;const{extruded:n,stroked:r}=this.props,{layerProps:i}=this.state,s="polygons-stroke",o="linestrings",a=!n&&r&&this.shouldRenderSubLayer(s,null===(e=i.polygonsOutline)||void 0===e?void 0:e.data)&&this.getSubLayerClass(s,xR.type),l=this.shouldRenderSubLayer(o,null===(t=i.lines)||void 0===t?void 0:t.data)&&this.getSubLayerClass(o,xR.type);if(a||l){const e=SR(this,xR.props);return[a&&new a(e,this.getSubLayerProps({id:s,updateTriggers:e.updateTriggers}),i.polygonsOutline),l&&new l(e,this.getSubLayerProps({id:o,updateTriggers:e.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=t.points.data.findIndex(e=>e.__source.index===r));const i=new Set(e.split("+")),s=[];for(const a of i){var o;const e="points-".concat(a),i=ER[a],l=i&&this.shouldRenderSubLayer(e,null===(o=t.points)||void 0===o?void 0:o.data)&&this.getSubLayerClass(e,i.type);if(l){const o=SR(this,i.props);let c=t.points;if("text"===a&&n){const e=c.data.attributes,{instancePickingColors:t}=e,n=uI(e,PR);c=u(u({},c),{},{data:u(u({},c.data),{},{attributes:n})})}s.push(new l(o,this.getSubLayerProps({id:e,updateTriggers:o.updateTriggers,highlightedObjectIndex:r}),c))}}return s}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return t&&"function"===typeof e?(t,n)=>{const{data:r,index:i}=n,s=AI(r,i);return e(s,n)}:super.getSubLayerAccessor(e)}}LR.layerName="GeoJsonLayer",LR.defaultProps=BR;const OR=LR,NR={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0};class UR{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,"props",void 0),a(this,"stats",void 0),a(this,"activeRequestCount",0),a(this,"requestQueue",[]),a(this,"requestMap",new Map),a(this,"updateTimer",null),this.props=u(u({},NR),e),this.stats=new Ge({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const n={handle:e,priority:0,getPriority:t},r=new Promise(e=>(n.resolve=e,n));return this.requestQueue.push(n),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:t,resolve:n}=e;let r=!1;const i=()=>{r||(r=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:i}):Promise.resolve({done:i})}_issueNewRequests(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const n=e[t];this._updateRequest(n)||(e.splice(t,1),this.requestMap.delete(n.handle),t--)}e.sort((e,t)=>e.priority-t.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}class zR{constructor(e){this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,this.boundingBox="west"in e?[[e.west,e.south],[e.east,e.north]]:[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData(e){let{getData:t,requestScheduler:n,onLoad:r,onError:i}=e;const{index:s,id:o,bbox:a,userData:l,zoom:u}=this,c=this._loaderId;this._abortController=new AbortController;const{signal:A}=this._abortController,h=await n.scheduleRequest(this,e=>e.isSelected?1:-1);if(!h)return void(this._isCancelled=!0);if(this._isCancelled)return void h.done();let d,f=null;try{f=await t({index:s,id:o,bbox:a,userData:l,zoom:u,signal:A})}catch(p){d=p||!0}finally{h.done()}c===this._loaderId&&(this._loader=void 0,this.content=f,!this._isCancelled||f?(this._isLoaded=!0,this._isCancelled=!1,d?i(d,this):r(this)):this._isLoaded=!1)}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,null===(e=this._abortController)||void 0===e||e.abort())}}const jR=Math.PI/180,VR=180/Math.PI,GR=6370972,WR=256;function HR(){const e=4018225162502676e-20,t=Math.PI/180*WR;return{unitsPerMeter:[e,e,e],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[t,t,e],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/t,1/t,24886.609375]}}class QR extends vs{constructor(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{longitude:r=0,zoom:i=0,nearZMultiplier:s=.5,farZMultiplier:o=1,resolution:a=10}=n;let{latitude:l=0,height:c,altitude:A=1.5,fovy:h}=n;l=Math.max(Math.min(l,Kr),-85.051129),c=c||1,h?A=oi(h):h=si(A);const d=1/Math.PI/Math.cos(l*Math.PI/180),f=Math.pow(2,i)*d,p=null!==(e=n.nearZ)&&void 0!==e?e:s,g=null!==(t=n.farZ)&&void 0!==t?t:(A+512*f/c)*o,m=(new Br).lookAt({eye:[0,-A,0],up:[0,0,1]});m.rotateX(l*jR),m.rotateZ(-r*jR),m.scale(f/c),super(u(u({},n),{},{height:c,viewMatrix:m,longitude:r,latitude:l,zoom:i,distanceScales:HR(),fovy:h,focalDistance:A,near:p,far:g})),this.scale=f,this.latitude=l,this.longitude=r,this.resolution=a}get projectionMode(){return cs.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(){const e={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},t=this.unproject([0,this.height/2],e),n=this.unproject([this.width/2,0],e),r=this.unproject([this.width,this.height/2],e),i=this.unproject([this.width/2,this.height],e);return r[0]<this.longitude&&(r[0]+=360),t[0]>this.longitude&&(t[0]-=360),[Math.min(t[0],r[0],n[0],i[0]),Math.min(t[1],r[1],n[1],i[1]),Math.max(t[0],r[0],n[0],i[0]),Math.max(t[1],r[1],n[1],i[1])]}unproject(e){let{topLeft:t=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[r,i,s]=e,o=t?i:this.height-i,{pixelUnprojectionMatrix:a}=this;let l;if(Number.isFinite(s))l=XR(a,[r,o,s,1]);else{const e=XR(a,[r,o,-1,1]),t=XR(a,[r,o,1,1]),i=((n||0)/GR+1)*WR,s=tr($n([],e,t)),u=tr(e),c=tr(t),A=4*((4*u*c-(s-u-c)**2)/16)/s;l=function(e,t,n,r){const i=t[0],s=t[1],o=t[2];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=o+r*(n[2]-o),e}([],e,t,(Math.sqrt(u-A)-Math.sqrt(Math.max(0,i*i-A)))/Math.sqrt(s))}const[u,c,A]=this.unprojectPosition(l);return Number.isFinite(s)?[u,c,A]:Number.isFinite(n)?[u,c,n]:[u,c]}projectPosition(e){const[t,n,r=0]=e,i=t*jR,s=n*jR,o=Math.cos(s),a=(r/GR+1)*WR;return[Math.sin(i)*o*a,-Math.cos(i)*o*a,Math.sin(s)*a]}unprojectPosition(e){const[t,n,r]=e,i=er(e),s=Math.asin(r/i);return[Math.atan2(t,-n)*VR,s*VR,(i/WR-1)*GR]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,t){const n=this.unproject(t);return{longitude:e[0]-n[0]+this.longitude,latitude:e[1]-n[1]+this.latitude}}}function XR(e,t){const n=Tr([],t,e);return Dr(n,n,1/n[3]),n}const YR=-1,qR=0,KR=1,ZR=new or,JR=new or;class $R{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=arguments.length>2?arguments[2]:void 0;n=n||ZR.copy(e).add(t).scale(.5),this.center=new or(n),this.halfDiagonal=new or(t).subtract(this.center),this.minimum=new or(e),this.maximum=new or(t)}clone(){return new $R(this.minimum,this.maximum,this.center)}equals(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:t}=this,n=JR.from(e.normal),r=t.x*Math.abs(n.x)+t.y*Math.abs(n.y)+t.z*Math.abs(n.z),i=this.center.dot(n)+e.distance;return i-r>0?KR:i+r<0?YR:qR}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=ZR.from(e).subtract(this.center),{halfDiagonal:n}=this;let r,i=0;return r=Math.abs(t.x)-n.x,r>0&&(i+=r*r),r=Math.abs(t.y)-n.y,r>0&&(i+=r*r),r=Math.abs(t.z)-n.z,r>0&&(i+=r*r),i}}const ek=new or,tk=new or;class nk{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.radius=-0,this.center=new or,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=ek.from(t),this.center=(new or).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new nk(this.center,this.radius)}union(e){const t=this.center,n=this.radius,r=e.center,i=e.radius,s=ek.copy(r).subtract(t),o=s.magnitude();if(n>=o+i)return this.clone();if(i>=o+n)return e.clone();const a=.5*(n+o+i);return tk.copy(s).scale((-n+a)/o).add(t),this.center.copy(tk),this.radius=a,this}expand(e){const t=ek.from(e).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=_r(ek,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=ek.from(e).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const t=this.center,n=this.radius,r=e.normal.dot(t)+e.distance;return r<-n?YR:r<n?qR:KR}}function rk(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],u=t[6],c=t[7],A=t[8],h=n[0],d=n[1],f=n[2],p=n[3],g=n[4],m=n[5],y=n[6],v=n[7],_=n[8];return e[0]=h*r+d*o+f*u,e[1]=h*i+d*a+f*c,e[2]=h*s+d*l+f*A,e[3]=p*r+g*o+m*u,e[4]=p*i+g*a+m*c,e[5]=p*s+g*l+m*A,e[6]=y*r+v*o+_*u,e[7]=y*i+v*a+_*c,e[8]=y*s+v*l+_*A,e}function ik(e,t,n){const r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}var sk;!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"}(sk||(sk={}));const ok=Object.freeze([1,0,0,0,1,0,0,0,1]);class ak extends dr{static get IDENTITY(){return function(){ck||(ck=new ak,Object.freeze(ck));return ck}()}static get ZERO(){return function(){lk||(lk=new ak([0,0,0,0,0,0,0,0,0]),Object.freeze(lk));return lk}()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return sk}constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(ok)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,a=r+r,l=i+i,u=n*o,c=r*o,A=r*a,h=i*o,d=i*a,f=i*l,p=s*o,g=s*a,m=s*l;e[0]=1-A-f,e[3]=c-m,e[6]=h+g,e[1]=c+m,e[4]=1-u-f,e[7]=d-p,e[2]=h-g,e[5]=d+p,e[8]=1-u-A}(this,e),this.check()}set(e,t,n,r,i,s,o,a,l){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=l,this.check()}setRowMajor(e,t,n,r,i,s,o,a,l){return this[0]=e,this[1]=r,this[2]=o,this[3]=t,this[4]=i,this[5]=a,this[6]=n,this[7]=s,this[8]=l,this.check()}determinant(){return function(e){const t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],u=e[8];return t*(u*s-o*l)+n*(-u*i+o*a)+r*(l*i-s*a)}(this)}transpose(){return function(e,t){if(e===t){const n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]}(this,this),this.check()}invert(){return function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],A=c*o-a*u,h=-c*s+a*l,d=u*s-o*l;let f=n*A+r*h+i*d;f&&(f=1/f,e[0]=A*f,e[1]=(-c*r+i*u)*f,e[2]=(a*r-i*o)*f,e[3]=h*f,e[4]=(c*n-i*l)*f,e[5]=(-a*n+i*s)*f,e[6]=d*f,e[7]=(-u*n+r*l)*f,e[8]=(o*n-r*s)*f)}(this,this),this.check()}multiplyLeft(e){return rk(this,e,this),this.check()}multiplyRight(e){return rk(this,this,e),this.check()}rotate(e){return function(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],u=t[6],c=t[7],A=t[8],h=Math.sin(n),d=Math.cos(n);e[0]=d*r+h*o,e[1]=d*i+h*a,e[2]=d*s+h*l,e[3]=d*o-h*r,e[4]=d*a-h*i,e[5]=d*l-h*s,e[6]=u,e[7]=c,e[8]=A}(this,this,e),this.check()}scale(e){return Array.isArray(e)?ik(this,this,e):ik(this,this,[e,e]),this.check()}translate(e){return function(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],u=t[6],c=t[7],A=t[8],h=n[0],d=n[1];e[0]=r,e[1]=i,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=h*r+d*o+u,e[7]=h*i+d*a+c,e[8]=h*s+d*l+A}(this,this,e),this.check()}transform(e,t){let n;switch(e.length){case 2:n=function(e,t,n){const r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}(t||[-0,-0],e,this);break;case 3:n=Zn(t||[-0,-0,-0],e,this);break;case 4:n=rr(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return jn(n,e.length),n}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}let lk,uk,ck=null;class Ak extends Gn{static get ZERO(){return uk||(uk=new Ak(0,0,0,0),Object.freeze(uk)),uk}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(-0,-0,-0,-0),Mn(e)&&1===arguments.length?this.copy(e):(kn.debug&&(zn(e),zn(t),zn(n),zn(r)),this[0]=e,this[1]=t,this[2]=n,this[3]=r)}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return kn.debug&&(zn(e.x),zn(e.y),zn(e.z),zn(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=zn(e)}get w(){return this[3]}set w(e){this[3]=zn(e)}transform(e){return Kn(this,this,e),this.check()}transformByMatrix3(e){return rr(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e[2]=t[2],e[3]=t[3]}(this,this,e),this.check()}transformByQuaternion(e){return Jn(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}function hk(){const e=new Hn(4);return Hn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function dk(e,t,n){n*=.5;const r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function fk(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=n[0],l=n[1],u=n[2],c=n[3];return e[0]=r*c+o*a+i*u-s*l,e[1]=i*c+o*l+s*a-r*u,e[2]=s*c+o*u+r*l-i*a,e[3]=o*c-r*a-i*l-s*u,e}function pk(e,t,n,r){const i=t[0],s=t[1],o=t[2],a=t[3];let l,u,c,A,h,d=n[0],f=n[1],p=n[2],g=n[3];return l=i*d+s*f+o*p+a*g,l<0&&(l=-l,d=-d,f=-f,p=-p,g=-g),1-l>Wn?(u=Math.acos(l),h=Math.sin(u),c=Math.sin((1-r)*u)/h,A=Math.sin(r*u)/h):(c=1-r,A=r),e[0]=c*i+A*d,e[1]=c*s+A*f,e[2]=c*o+A*p,e[3]=c*a+A*g,e}function gk(e,t){const n=t[0]+t[4]+t[8];let r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{let n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);const i=(n+1)%3,s=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*i+i]-t[3*s+s]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*i+s]-t[3*s+i])*r,e[i]=(t[3*i+n]+t[3*n+i])*r,e[s]=(t[3*s+n]+t[3*n+s])*r}return e}const mk=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},yk=Dr,vk=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},_k=function(e,t,n,r){const i=t[0],s=t[1],o=t[2],a=t[3];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=o+r*(n[2]-o),e[3]=a+r*(n[3]-a),e},bk=Cr,wk=Sr,Ek=function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3];let o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=s*o,e};const xk=function(){const e=Qn(),t=Xn(1,0,0),n=Xn(0,1,0);return function(r,i,s){const o=Yn(i,s);return o<-.999999?(qn(e,t,i),er(e)<1e-6&&qn(e,n,i),function(e,t){const n=t[0],r=t[1],i=t[2];let s=n*n+r*r+i*i;s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s}(e,e),dk(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(qn(e,i,s),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,Ek(r,r))}}(),Dk=(function(){const e=hk(),t=hk()}(),function(){const e=function(){const e=new Hn(9);return Hn!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}()}(),[0,0,0,1]);class Ck extends Un{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,n,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return gk(this,e),this.check()}fromAxisRotation(e,t){return dk(this,e,t),this.check()}identity(){var e;return(e=this)[0]=0,e[1]=0,e[2]=0,e[3]=1,this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=zn(e)}get y(){return this[1]}set y(e){this[1]=zn(e)}get z(){return this[2]}set z(e){this[2]=zn(e)}get w(){return this[3]}set w(e){this[3]=zn(e)}len(){return bk(this)}lengthSquared(){return wk(this)}dot(e){return vk(this,e)}rotationTo(e,t){return xk(this,e,t),this.check()}add(e){return mk(this,this,e),this.check()}calculateW(){return function(e,t){const n=t[0],r=t[1],i=t[2];e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i))}(this,this),this.check()}conjugate(){return function(e,t){e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3]}(this,this),this.check()}invert(){return function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;e[0]=-n*a,e[1]=-r*a,e[2]=-i*a,e[3]=s*a}(this,this),this.check()}lerp(e,t,n){return void 0===n?this.lerp(this,e,t):(_k(this,e,t,n),this.check())}multiplyRight(e){return fk(this,this,e),this.check()}multiplyLeft(e){return fk(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(e,t,n){n*=.5;const r=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+o*a,e[1]=i*l+s*a,e[2]=s*l-i*a,e[3]=o*l-r*a}(this,this,e),this.check()}rotateY(e){return function(e,t,n){n*=.5;const r=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l-s*a,e[1]=i*l+o*a,e[2]=s*l+r*a,e[3]=o*l-i*a}(this,this,e),this.check()}rotateZ(e){return function(e,t,n){n*=.5;const r=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+i*a,e[1]=i*l-r*a,e[2]=s*l+o*a,e[3]=o*l-s*a}(this,this,e),this.check()}scale(e){return yk(this,this,e),this.check()}slerp(e,t,n){let r,i,s;switch(arguments.length){case 1:({start:r=Dk,target:i,ratio:s}=e);break;case 2:r=this,i=e,s=t;break;default:r=e,i=t,s=n}return pk(this,r,i,s),this.check()}transformVector4(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ak;return function(e,t,n){const r=t[0],i=t[1],s=t[2],o=n[0],a=n[1],l=n[2],u=n[3],c=u*r+a*s-l*i,A=u*i+l*r-o*s,h=u*s+o*i-a*r,d=-o*r-a*i-l*s;e[0]=c*u+d*-o+A*-l-h*-a,e[1]=A*u+d*-a+h*-o-c*-l,e[2]=h*u+d*-l+c*-a-A*-o,e[3]=t[3]}(t,e,this),jn(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const Sk=new or,Tk=new or,Ik=new or,Fk=new or,Rk=new or,kk=new or,Pk=new or,Mk=0,Bk=1,Lk=2,Ok=3,Nk=4,Uk=5,zk=6,jk=7,Vk=8;class Gk{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];this.center=(new or).from(e),this.halfAxes=new ak(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new or(e).len(),new or(t).len(),new or(n).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new or(e).normalize(),i=new or(t).normalize(),s=new or(n).normalize();return(new Ck).fromMatrix3(new ak([...r,...i,...s]))}fromCenterHalfSizeQuaternion(e,t,n){const r=new Ck(n),i=(new ak).fromQuaternion(r);return i[0]=i[0]*t[0],i[1]=i[1]*t[0],i[2]=i[2]*t[0],i[3]=i[3]*t[1],i[4]=i[4]*t[1],i[5]=i[5]*t[1],i[6]=i[6]*t[2],i[7]=i[7]*t[2],i[8]=i[8]*t[2],this.center=(new or).from(e),this.halfAxes=i,this}clone(){return new Gk(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nk;const t=this.halfAxes,n=t.getColumn(0,Ik),r=t.getColumn(1,Fk),i=t.getColumn(2,Rk),s=Sk.copy(n).add(r).add(i);return e.center.copy(this.center),e.radius=s.magnitude(),e}intersectPlane(e){const t=this.center,n=e.normal,r=this.halfAxes,i=n.x,s=n.y,o=n.z,a=Math.abs(i*r[Mk]+s*r[Bk]+o*r[Lk])+Math.abs(i*r[Ok]+s*r[Nk]+o*r[Uk])+Math.abs(i*r[zk]+s*r[jk]+o*r[Vk]),l=n.dot(t)+e.distance;return l<=-a?YR:l>=a?KR:qR}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=Tk.from(e).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,Ik),i=n.getColumn(1,Fk),s=n.getColumn(2,Rk),o=r.magnitude(),a=i.magnitude(),l=s.magnitude();r.normalize(),i.normalize(),s.normalize();let u,c=0;return u=Math.abs(t.dot(r))-o,u>0&&(c+=u*u),u=Math.abs(t.dot(i))-a,u>0&&(c+=u*u),u=Math.abs(t.dot(s))-l,u>0&&(c+=u*u),c}computePlaneDistances(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const s=this.center,o=this.halfAxes,a=o.getColumn(0,Ik),l=o.getColumn(1,Fk),u=o.getColumn(2,Rk),c=kk.copy(a).add(l).add(u).add(s),A=Pk.copy(c).subtract(e);let h=t.dot(A);return r=Math.min(h,r),i=Math.max(h,i),c.copy(s).add(a).add(l).subtract(u),A.copy(c).subtract(e),h=t.dot(A),r=Math.min(h,r),i=Math.max(h,i),c.copy(s).add(a).subtract(l).add(u),A.copy(c).subtract(e),h=t.dot(A),r=Math.min(h,r),i=Math.max(h,i),c.copy(s).add(a).subtract(l).subtract(u),A.copy(c).subtract(e),h=t.dot(A),r=Math.min(h,r),i=Math.max(h,i),s.copy(c).subtract(a).add(l).add(u),A.copy(c).subtract(e),h=t.dot(A),r=Math.min(h,r),i=Math.max(h,i),s.copy(c).subtract(a).add(l).subtract(u),A.copy(c).subtract(e),h=t.dot(A),r=Math.min(h,r),i=Math.max(h,i),s.copy(c).subtract(a).subtract(l).add(u),A.copy(c).subtract(e),h=t.dot(A),r=Math.min(h,r),i=Math.max(h,i),s.copy(c).subtract(a).subtract(l).subtract(u),A.copy(c).subtract(e),h=t.dot(A),r=Math.min(h,r),i=Math.max(h,i),n[0]=r,n[1]=i,n}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,Ik);t.transformAsPoint(e);const n=this.halfAxes.getColumn(1,Fk);n.transformAsPoint(e);const r=this.halfAxes.getColumn(2,Rk);return r.transformAsPoint(e),this.halfAxes=new ak([...t,...n,...r]),this}getTransform(){throw new Error("not implemented")}}const Wk=new or,Hk=new or;class Qk{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.normal=new or,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return Vn(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=Wk.from(e),this.normal.from(t).normalize();const n=-this.normal.dot(e);return this.distance=n,this}fromCoefficients(e,t,n,r){return this.normal.set(e,t,n),Vn(On(this.normal.len(),1)),this.distance=r,this}clone(){return new Qk(this.normal,this.distance)}equals(e){return On(this.distance,e.distance)&&On(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=Hk.copy(this.normal).transformAsVector(e).normalize(),n=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(n,t)}projectPointOntoPlane(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];const n=Wk.from(e),r=this.getPointDistance(n),i=Hk.copy(this.normal).scale(r);return n.subtract(i).to(t)}}const Xk=[new or([1,0,0]),new or([0,1,0]),new or([0,0,1])],Yk=new or,qk=new or;class Kk{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.planes=e}fromBoundingSphere(e){this.planes.length=2*Xk.length;const t=e.center,n=e.radius;let r=0;for(const i of Xk){let e=this.planes[r],s=this.planes[r+1];e||(e=this.planes[r]=new Qk),s||(s=this.planes[r+1]=new Qk);const o=Yk.copy(i).scale(-n).add(t);e.fromPointNormal(o,i);const a=Yk.copy(i).scale(n).add(t),l=qk.copy(i).negate();s.fromPointNormal(a,l),r+=2}return this}computeVisibility(e){let t=KR;for(const n of this.planes){switch(e.intersectPlane(n)){case YR:return YR;case qR:t=qR}}return t}computeVisibilityWithPlaneMask(e,t){if(Vn(Number.isFinite(t),"parentPlaneMask is required."),t===Kk.MASK_OUTSIDE||t===Kk.MASK_INSIDE)return t;let n=Kk.MASK_INSIDE;const r=this.planes;for(let i=0;i<this.planes.length;++i){const s=i<31?1<<i:0;if(i<31&&0===(t&s))continue;const o=r[i],a=e.intersectPlane(o);if(a===YR)return Kk.MASK_OUTSIDE;a===qR&&(n|=s)}return n}}Kk.MASK_OUTSIDE=4294967295,Kk.MASK_INSIDE=0,Kk.MASK_INDETERMINATE=2147483647;new or,new or,new or,new or,new or;new or,new or,new or,new or,new or,new or,new or,new or,new or,new or,new or,new or;Math.PI,Math.PI,Math.PI,Math.PI;const Zk=new ak,Jk=new ak,$k=new ak,eP=new ak,tP=new ak;function nP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};let n=0,r=0;const i=Jk,s=$k;i.identity(),s.copy(e);const o=1e-20*function(e){let t=0;for(let n=0;n<9;++n){const r=e[n];t+=r*r}return Math.sqrt(t)}(s);for(;r<10&&sP(s)>o;)oP(s,eP),tP.copy(eP).transpose(),s.multiplyRight(eP),s.multiplyLeft(tP),i.multiplyRight(eP),++n>2&&(++r,n=0);return t.unitary=i.toTarget(t.unitary),t.diagonal=s.toTarget(t.diagonal),t}const rP=[1,0,0],iP=[2,2,1];function sP(e){let t=0;for(let n=0;n<3;++n){const r=e[Zk.getElementIndex(iP[n],rP[n])];t+=2*r*r}return Math.sqrt(t)}function oP(e,t){let n=0,r=1;for(let l=0;l<3;++l){const t=Math.abs(e[Zk.getElementIndex(iP[l],rP[l])]);t>n&&(r=l,n=t)}const i=rP[r],s=iP[r];let o=1,a=0;if(Math.abs(e[Zk.getElementIndex(s,i)])>1e-15){const t=(e[Zk.getElementIndex(s,s)]-e[Zk.getElementIndex(i,i)])/2/e[Zk.getElementIndex(s,i)];let n;n=t<0?-1/(-t+Math.sqrt(1+t*t)):1/(t+Math.sqrt(1+t*t)),o=1/Math.sqrt(1+n*n),a=n*o}return ak.IDENTITY.to(t),t[Zk.getElementIndex(i,i)]=t[Zk.getElementIndex(s,s)]=o,t[Zk.getElementIndex(s,i)]=a,t[Zk.getElementIndex(i,s)]=-a,t}const aP=new or,lP=new or,uP=new or,cP=new or,AP=new or,hP=new ak,dP={diagonal:new ak,unitary:new ak};const fP=512,pP=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],gP=pP.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),mP=gP.concat([[.25,.5],[.75,.5]]);class yP{constructor(e,t,n){this.x=e,this.y=t,this.z=n}get children(){if(!this._children){const e=2*this.x,t=2*this.y,n=this.z+1;this._children=[new yP(e,t,n),new yP(e,t+1,n),new yP(e+1,t,n),new yP(e+1,t+1,n)]}return this._children}update(e){const{viewport:t,cullingVolume:n,elevationBounds:r,minZ:i,maxZ:s,bounds:o,offset:a,project:l}=e,u=this.getBoundingVolume(r,a,l);if(o&&!this.insideBounds(o))return!1;if(n.computeVisibility(u)<0)return!1;if(!this.childVisible){let{z:e}=this;if(e<s&&e>=i){const n=u.distanceTo(t.cameraPosition)*t.scale/t.height;e+=Math.floor(Math.log2(n))}if(e>=s)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const c of this.children)c.update(e);return!0}getSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.selected&&e.push(this),this._children)for(const t of this._children)t.getSelected(e);return e}insideBounds(e){let[t,n,r,i]=e;const s=Math.pow(2,this.z),o=fP/s;return this.x*o<r&&this.y*o<i&&(this.x+1)*o>t&&(this.y+1)*o>n}getBoundingVolume(e,t,n){if(n){const t=this.z<1?mP:this.z<2?gP:pP,r=[];for(const i of t){const t=SP(this.x+i[0],this.y+i[1],this.z);t[2]=e[0],r.push(n(t)),e[0]!==e[1]&&(t[2]=e[1],r.push(n(t)))}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Gk;if(!e||0===e.length)return t.halfAxes=new ak([0,0,0,0,0,0,0,0,0]),t.center=new or,t;const n=e.length,r=new or(0,0,0);for(const D of e)r.add(D);const i=1/n;r.multiplyByScalar(i);let s=0,o=0,a=0,l=0,u=0,c=0;for(const D of e){const e=aP.copy(D).subtract(r);s+=e.x*e.x,o+=e.x*e.y,a+=e.x*e.z,l+=e.y*e.y,u+=e.y*e.z,c+=e.z*e.z}s*=i,o*=i,a*=i,l*=i,u*=i,c*=i;const A=hP;A[0]=s,A[1]=o,A[2]=a,A[3]=o,A[4]=l,A[5]=u,A[6]=a,A[7]=u,A[8]=c;const{unitary:h}=nP(A,dP),d=t.halfAxes.copy(h);let f=d.getColumn(0,uP),p=d.getColumn(1,cP),g=d.getColumn(2,AP),m=-Number.MAX_VALUE,y=-Number.MAX_VALUE,v=-Number.MAX_VALUE,_=Number.MAX_VALUE,b=Number.MAX_VALUE,w=Number.MAX_VALUE;for(const D of e)aP.copy(D),m=Math.max(aP.dot(f),m),y=Math.max(aP.dot(p),y),v=Math.max(aP.dot(g),v),_=Math.min(aP.dot(f),_),b=Math.min(aP.dot(p),b),w=Math.min(aP.dot(g),w);f=f.multiplyByScalar(.5*(_+m)),p=p.multiplyByScalar(.5*(b+y)),g=g.multiplyByScalar(.5*(w+v)),t.center.copy(f).add(p).add(g);const E=lP.set(m-_,y-b,v-w).multiplyByScalar(.5),x=new ak([E[0],0,0,0,E[1],0,0,0,E[2]]);return t.halfAxes.multiplyRight(x),t}(r)}const r=Math.pow(2,this.z),i=fP/r,s=this.x*i+t*fP,o=fP-(this.y+1)*i;return new $R([s,o,e[0]],[s+i,o+i,e[1]])}}const vP=512,_P=[-1/0,-1/0,1/0,1/0],bP={type:"object",value:null,validate:(e,t)=>t.optional&&null===e||"string"===typeof e||Array.isArray(e)&&e.every(e=>"string"===typeof e),equal:(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}};function wP(e,t){const n=[t.transformAsPoint([e[0],e[1]]),t.transformAsPoint([e[2],e[1]]),t.transformAsPoint([e[0],e[3]]),t.transformAsPoint([e[2],e[3]])],r=[Math.min(...n.map(e=>e[0])),Math.min(...n.map(e=>e[1])),Math.max(...n.map(e=>e[0])),Math.max(...n.map(e=>e[1]))];return r}function EP(e,t){if(!e||!e.length)return null;const{index:n,id:r}=t;if(Array.isArray(e)){const t=function(e){return Math.abs(e.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)|0,0))}(r)%e.length;e=e[t]}let i=e;for(const s of Object.keys(n)){const e=new RegExp("{".concat(s,"}"),"g");i=i.replace(e,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function xP(e){let{viewport:t,z:n,cullRect:r}=e;return(t.subViewports||[t]).map(e=>DP(e,n||0,r))}function DP(e,t,n){if(!Array.isArray(t)){const r=n.x-e.x,i=n.y-e.y,{width:s,height:o}=n,a={targetZ:t},l=e.unproject([r,i],a),u=e.unproject([r+s,i],a),c=e.unproject([r,i+o],a),A=e.unproject([r+s,i+o],a);return[Math.min(l[0],u[0],c[0],A[0]),Math.min(l[1],u[1],c[1],A[1]),Math.max(l[0],u[0],c[0],A[0]),Math.max(l[1],u[1],c[1],A[1])]}const r=DP(e,t[0],n),i=DP(e,t[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function CP(e,t){return Math.pow(2,e)*vP/t}function SP(e,t,n){const r=CP(n,vP),i=e/r*360-180,s=Math.PI-2*Math.PI*t/r;return[i,180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)))]}function TP(e,t,n,r){const i=CP(n,r);return[e/i*vP,t/i*vP]}function IP(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vP;if(e.isGeospatial){const[e,i]=SP(t,n,r),[s,o]=SP(t+1,n+1,r);return{west:e,north:i,east:s,south:o}}const[s,o]=TP(t,n,r,i),[a,l]=TP(t+1,n+1,r,i);return{left:s,top:o,right:a,bottom:l}}function FP(e,t,n,r,i){const s=function(e,t,n){let r;if(t&&2===t.length){const[n,i]=t,s=e.getBounds({z:n}),o=e.getBounds({z:i});r=[Math.min(s[0],o[0]),Math.min(s[1],o[1]),Math.max(s[2],o[2]),Math.max(s[3],o[3])]}else r=e.getBounds();return e.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}(e,null,r),o=CP(t,n),[a,l,u,c]=function(e,t,n){if(n){const r=wP(e,n).map(e=>e*t/vP);return r}return e.map(e=>e*t/vP)}(s,o,i),A=[];for(let h=Math.floor(a);h<u;h++)for(let e=Math.floor(l);e<c;e++)A.push({x:h,y:e,z:t});return A}function RP(e){let{viewport:t,maxZoom:n,minZoom:r,zRange:i,extent:s,tileSize:o=vP,modelMatrix:a,modelMatrixInverse:l,zoomOffset:u=0}=e,c=t.isGeospatial?Math.round(t.zoom+Math.log2(vP/o))+u:Math.ceil(t.zoom)+u;if("number"===typeof r&&Number.isFinite(r)&&c<r){if(!s)return[];c=r}"number"===typeof n&&Number.isFinite(n)&&c>n&&(c=n);let A=s;return a&&l&&s&&!t.isGeospatial&&(A=wP(s,a)),t.isGeospatial?function(e,t,n,r){const i=e instanceof QR&&e.resolution?e.projectPosition:null,s=Object.values(e.getFrustumPlanes()).map(e=>{let{normal:t,distance:n}=e;return new Qk(t.clone().negate(),n)}),o=new Kk(s),a=e.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,u=n&&n[1]*a||0,c=e instanceof Ts&&e.pitch<=60?t:0;if(r){const[e,t,n,i]=r,s=Jr([e,i]),o=Jr([n,t]);r=[s[0],fP-s[1],o[0],fP-o[1]]}const A=new yP(0,0,0),h={viewport:e,project:i,cullingVolume:o,elevationBounds:[l,u],minZ:c,maxZ:t,bounds:r,offset:0};if(A.update(h),e instanceof Ts&&e.subViewports&&e.subViewports.length>1){for(h.offset=-1;A.update(h)&&!(--h.offset<-3););for(h.offset=1;A.update(h)&&!(++h.offset>3););}return A.getSelected()}(t,c,i,s):FP(t,c,o,A||_P,l)}function kP(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}const PP="never",MP="no-overlap",BP="best-available",LP={[BP]:function(e){for(const t of e)t.state=0;for(const t of e)t.isSelected&&!NP(t)&&UP(t);for(const t of e)t.isVisible=Boolean(2&t.state)},[MP]:function(e){for(const n of e)n.state=0;for(const n of e)n.isSelected&&NP(n);const t=Array.from(e).sort((e,t)=>e.zoom-t.zoom);for(const n of t)if(n.isVisible=Boolean(2&n.state),n.children&&(n.isVisible||1&n.state))for(const e of n.children)e.state=1;else n.isSelected&&UP(n)},[PP]:()=>{}},OP={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};function NP(e){let t=e;for(;t;){if(t.isLoaded||t.content)return t.state|=2,!0;t=t.parent}return!1}function UP(e){for(const t of e.children)t.isLoaded||t.content?t.state|=2:UP(t)}const zP={TilesetClass:class{constructor(e){this._getCullBounds=function(e){let t,n={};return r=>{for(const i in r)if(!kP(r[i],n[i])){t=e(r),n=r;break}return t}}(xP),this.opts=u(u({},OP),e),this.setOptions(this.opts),this.onTileLoad=e=>{var t,n;null===(t=(n=this.opts).onTileLoad)||void 0===t||t.call(n,e),null!==this.opts.maxCacheByteSize&&(this._cacheByteSize+=e.byteLength,this._resizeCache())},this._requestScheduler=new UR({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Br,this._modelMatrixInverse=new Br}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const t=this._cache.get(e);this._selectedTiles&&this._selectedTiles.includes(t)?t.setNeedsReload():this._cache.delete(e)}}update(e){let{zRange:t,modelMatrix:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{zRange:null,modelMatrix:null};const r=n?new Br(n):new Br,i=!r.equals(this._modelMatrix);if(this._viewport&&e.equals(this._viewport)&&On(this._zRange,t)&&!i)this.needsReload&&(this._selectedTiles=this._selectedTiles.map(e=>this._getTile(e.index,!0)));else{i&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=e,this._zRange=t;const n=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:t,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=n.map(e=>this._getTile(e,!0)),this._dirty&&this._rebuildTree()}const s=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),s&&this._frameNumber++,this._frameNumber}isTileVisible(e,t){if(!e.isVisible)return!1;if(t&&this._viewport){const n=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:t}),{bbox:r}=e;for(const[e,t,i,s]of n){let n;if("west"in r)n=r.west<i&&r.east>e&&r.south<s&&r.north>t;else{const o=Math.min(r.top,r.bottom),a=Math.max(r.top,r.bottom);n=r.left<i&&r.right>e&&o<s&&a>t}if(n)return!0}return!1}return!0}getTileIndices(e){let{viewport:t,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:o}=e;const{tileSize:a,extent:l,zoomOffset:u}=this.opts;return RP({viewport:t,maxZoom:n,minZoom:r,zRange:i,tileSize:a,extent:l,modelMatrix:s,modelMatrixInverse:o,zoomOffset:u})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:t}=this.opts;return{bbox:IP(this._viewport,e.x,e.y,e.z,t)}}getParentIndex(e){return{x:Math.floor(e.x/2),y:Math.floor(e.y/2),z:e.z-1}}updateTileStates(){const e=this.opts.refinementStrategy||BP,t=new Array(this._cache.size);let n=0;for(const r of this._cache.values())t[n++]=r.isVisible,r.isSelected=!1,r.isVisible=!1;for(const r of this._selectedTiles)r.isSelected=!0,r.isVisible=!0;("function"===typeof e?e:LP[e])(Array.from(this._cache.values())),n=0;for(const r of this._cache.values())if(t[n++]!==r.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,t=[];let n=0;for(const r of this._cache.values())r.isLoading&&(n++,r.isSelected||r.isVisible||t.push(r));for(;e>0&&n>e&&t.length>0;){t.shift().abort(),n--}}_rebuildTree(){const{_cache:e}=this;for(const t of e.values())t.parent=null,t.children&&(t.children.length=0);for(const t of e.values()){const e=this._getNearestAncestor(t);t.parent=e,null!==e&&void 0!==e&&e.children&&e.children.push(t)}}_resizeCache(){var e,t;const{_cache:n,opts:r}=this,i=null!==(e=r.maxCacheSize)&&void 0!==e?e:null!==r.maxCacheByteSize?1/0:5*this.selectedTiles.length,s=null!==(t=r.maxCacheByteSize)&&void 0!==t?t:1/0;if(n.size>i||this._cacheByteSize>s){for(const[e,t]of n){var o,a;if(!t.isVisible&&!t.isSelected)this._cacheByteSize-=null!==r.maxCacheByteSize?t.byteLength:0,n.delete(e),null===(o=(a=this.opts).onTileUnload)||void 0===o||o.call(a,t);if(n.size<=i&&this._cacheByteSize<=s)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((e,t)=>e.zoom-t.zoom),this._dirty=!1)}_getTile(e,t){const n=this.getTileId(e);let r=this._cache.get(n),i=!1;return!r&&t?(r=new zR(e),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:n,zoom:this.getTileZoom(r.index)}),i=!0,this._cache.set(n,r),this._dirty=!0):r&&r.needsReload&&(i=!0),r&&i&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(e){const{_minZoom:t=0}=this;let n=e.index;for(;this.getTileZoom(n)>t;){n=this.getParentIndex(n);const e=this._getTile(n);if(e)return e}return null}},data:{type:"data",value:[]},dataComparator:bP.equal,renderSubLayers:{type:"function",value:e=>new OR(e)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:e=>{}},onTileUnload:{type:"function",value:e=>{}},onTileError:{type:"function",value:e=>console.error(e)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:BP,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0};class jP extends lI{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e;null===(e=this.state)||void 0===e||null===(e=e.tileset)||void 0===e||e.finalize()}get isLoaded(){var e;return Boolean(null===(e=this.state)||void 0===e||null===(e=e.tileset)||void 0===e||null===(e=e.selectedTiles)||void 0===e?void 0:e.every(e=>e.isLoaded&&e.layers&&e.layers.every(e=>e.isLoaded)))}shouldUpdateState(e){let{changeFlags:t}=e;return t.somethingChanged}updateState(e){let{changeFlags:t}=e,{tileset:n}=this.state;const r=t.propsOrDataChanged||t.updateTriggersChanged,i=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():n.tiles.forEach(e=>{e.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:t,maxCacheByteSize:n,refinementStrategy:r,extent:i,maxZoom:s,minZoom:o,maxRequests:a,debounceTime:l,zoomOffset:u}=this.props;return{maxCacheSize:t,maxCacheByteSize:n,maxZoom:s,minZoom:o,tileSize:e,refinementStrategy:r,extent:i,maxRequests:a,debounceTime:l,zoomOffset:u,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const e=this.state.tileset,{zRange:t,modelMatrix:n}=this.props,r=e.update(this.context.viewport,{zRange:t,modelMatrix:n}),{isLoaded:i}=e,s=this.state.isLoaded!==i,o=this.state.frameNumber!==r;i&&(s||o)&&this._onViewportLoad(),o&&this.setState({frameNumber:r}),this.state.isLoaded=i}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:t}=this.props;t&&t(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,t){this.props.onTileError(e),t.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:t,getTileData:n,fetch:r}=this.props,{signal:i}=e;return e.url="string"===typeof t||Array.isArray(t)?EP(t,e):null,n?n(e):r&&e.url?r(e.url,{propName:"data",layer:this,signal:i}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo(e){const t=e.sourceLayer,n=t.props.tile,r=e.info;return r.picked&&(r.tile=n),r.sourceTile=n,r.sourceTileSubLayer=t,r}_updateAutoHighlight(e){e.sourceTileSubLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const t=this.getSubLayerPropsByTile(e);if(e.isLoaded||e.content)if(e.layers)t&&e.layers[0]&&Object.keys(t).some(n=>e.layers[0].props[n]!==t[n])&&(e.layers=e.layers.map(e=>e.clone(t)));else{const n=this.renderSubLayers(u(u(u({},this.props),this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers})),{},{data:e.content,_offset:0,tile:e}));e.layers=Ne(n,Boolean).map(n=>n.clone(u({tile:e},t)))}else;return e.layers})}filterSubLayer(e){let{layer:t,cullRect:n}=e;const{tile:r}=t.props;return this.state.tileset.isTileVisible(r,n)}}jP.defaultProps=zP,jP.layerName="TileLayer";const VP=jP;var GP=function(e){var t,n="undefined"!==typeof(e=e||{})?e:{},r={};for(t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);var i,s=[],o="";"undefined"!==typeof document&&document.currentScript&&(o=document.currentScript.src),o=0!==o.indexOf("blob:")?o.substr(0,o.lastIndexOf("/")+1):"",i=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){if(200==r.status||0==r.status&&r.response)t(r.response);else{var i=K(e);i?t(i.buffer):n()}},r.onerror=n,r.send(null)};var a=n.print||console.log.bind(console),l=n.printErr||console.warn.bind(console);for(t in r)r.hasOwnProperty(t)&&(n[t]=r[t]);r=null,n.arguments&&(s=n.arguments);var u=0;var c=!1;function A(e){var t,r=n["_"+e];return t="Cannot call unknown function "+e+", make sure it is exported",r||ue("Assertion failed: "+t),r}function h(e,t,n,r,i){var s={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var n=1+(e.length<<2);(function(e,t,n){(function(e,t,n,r){if(!(r>0))return 0;for(var i=n,s=n+r-1,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(a<=127){if(n>=s)break;t[n++]=a}else if(a<=2047){if(n+1>=s)break;t[n++]=192|a>>6,t[n++]=128|63&a}else if(a<=65535){if(n+2>=s)break;t[n++]=224|a>>12,t[n++]=128|a>>6&63,t[n++]=128|63&a}else{if(n+3>=s)break;t[n++]=240|a>>18,t[n++]=128|a>>12&63,t[n++]=128|a>>6&63,t[n++]=128|63&a}}t[n]=0})(e,m,t,n)})(e,t=te(n),n)}return t},array:function(e){var t=te(e.length);return function(e,t){g.set(e,t)}(e,t),t}};var o=A(e),a=[],l=0;if(r)for(var u=0;u<r.length;u++){var c=s[n[u]];c?(0===l&&(l=re()),a[u]=c(r[u])):a[u]=r[u]}var h=o.apply(null,a);return h=function(e){return"string"===t?f(e):"boolean"===t?Boolean(e):e}(h),0!==l&&ne(l),h}var d="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function f(e,t){return e?function(e,t,n){for(var r=t+n,i=t;e[i]&&!(i>=r);)++i;if(i-t>16&&e.subarray&&d)return d.decode(e.subarray(t,i));for(var s="";t<i;){var o=e[t++];if(128&o){var a=63&e[t++];if(192!=(224&o)){var l=63&e[t++];if((o=224==(240&o)?(15&o)<<12|a<<6|l:(7&o)<<18|a<<12|l<<6|63&e[t++])<65536)s+=String.fromCharCode(o);else{var u=o-65536;s+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else s+=String.fromCharCode((31&o)<<6|a)}else s+=String.fromCharCode(o)}return s}(m,e,t):""}var p,g,m,y,v,_,b;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");function w(e,t){return e%t>0&&(e+=t-e%t),e}function E(e){p=e,n.HEAP8=g=new Int8Array(e),n.HEAP16=y=new Int16Array(e),n.HEAP32=v=new Int32Array(e),n.HEAPU8=m=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=new Uint32Array(e),n.HEAPF32=_=new Float32Array(e),n.HEAPF64=b=new Float64Array(e)}var x=n.TOTAL_MEMORY||33554432;function D(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"===typeof r?void 0===t.arg?n.dynCall_v(r):n.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}x=(p=n.buffer?n.buffer:new ArrayBuffer(x)).byteLength,E(p),v[7152]=5271520;var C=[],S=[],T=[],I=[];function F(e){C.unshift(e)}function R(e){I.unshift(e)}var k=Math.abs,P=Math.ceil,M=Math.floor,B=Math.min,L=0,O=null,N=null;n.preloadedImages={},n.preloadedAudios={};var U,z,j=null,V="data:application/octet-stream;base64,";function G(e){return String.prototype.startsWith?e.startsWith(V):0===e.indexOf(V)}j="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";function W(e){return e}function H(e){return e.replace(/\b__Z[\w\d_]+/g,function(e){return e===e?e:e+" ["+e+"]"})}function Q(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(kA){e=kA}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function X(){return g.length}function Y(e){try{var t=new ArrayBuffer(e);if(t.byteLength!=e)return;return new Int8Array(t).set(g),ee(t),E(t),1}catch(kA){}}var q="function"===typeof atob?atob:function(e){var t,n,r,i,s,o,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",u=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=a.indexOf(e.charAt(u++))<<2|(i=a.indexOf(e.charAt(u++)))>>4,n=(15&i)<<4|(s=a.indexOf(e.charAt(u++)))>>2,r=(3&s)<<6|(o=a.indexOf(e.charAt(u++))),l+=String.fromCharCode(t),64!==s&&(l+=String.fromCharCode(n)),64!==o&&(l+=String.fromCharCode(r))}while(u<e.length);return l};function K(e){if(G(e))return function(e){try{for(var t=q(e),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}catch(qA){throw new Error("Converting base64 string to bytes failed.")}}(e.slice(V.length))}var Z,J={a:ue,b:function(e){u=e},c:function(){return u},d:function(e,t,n,r){ue("Assertion failed: "+f(e)+", at: "+[t?f(t):"unknown filename",n,r?f(r):"unknown function"])},e:function(e){return n.___errno_location&&(v[n.___errno_location()>>2]=e),e},f:X,g:function(e,t,n){m.set(m.subarray(t,t+n),e)},h:function(e){var t=X(),n=16777216,r=2130706432;if(e>r)return!1;for(var i=Math.max(t,16777216);i<e;)i=i<=536870912?w(2*i,n):Math.min(w((3*i+2147483648)/4,n),r);return!!Y(i)},i:function(e){ue("OOM")},j:W,k:H,l:Y,m:Q,n:function(){var e=Q();return n.extraStackTrace&&(e+="\n"+n.extraStackTrace()),H(e)},o:28624,p:28608},$=function(e,t,n){var r=new e.Int8Array(n),i=new e.Int32Array(n),s=(new e.Uint8Array(n),new e.Float32Array(n),new e.Float64Array(n)),o=0|t.o,a=0|t.p,l=e.Math.floor,u=e.Math.abs,c=e.Math.sqrt,A=e.Math.pow,h=e.Math.cos,d=e.Math.sin,f=e.Math.tan,p=e.Math.acos,g=e.Math.asin,m=e.Math.atan,y=e.Math.atan2,v=e.Math.ceil,_=e.Math.imul,b=e.Math.min,w=e.Math.max,E=e.Math.clz32,x=t.b,D=t.c,C=t.d,S=t.e,T=t.f,I=t.g,F=t.h,R=t.i,k=28640;function P(e,t,n,r){return 0|M(e|=0,t|=0,n|=0,r|=0,0)}function M(e,t,n,r,s){var o,a=0,l=0,u=0,c=0;if(o=k,k=k+16|0,l=o,!(0|B(e|=0,t|=0,n|=0,r|=0,s|=0)))return k=o,0|(r=0);do{if((0|n)>=0){if((0|n)>13780509){if(0|(a=0|ht(15,l)))break;l=0|i[(u=l)>>2],u=0|i[u+4>>2]}else c=0|nn(0|n,0|(a=((0|n)<0)<<31>>31),3,0),u=0|D(),a=0|Zt(0|n,0|a,1,0),a=0|Zt(0|(a=0|nn(0|c,0|u,0|a,0|D())),0|D(),1,0),u=0|D(),i[l>>2]=a,i[l+4>>2]=u,l=a;if(fn(0|r,0,l<<3),0|s){fn(0|s,0,l<<2),a=0|L(e,t,n,r,s,l,u,0);break}(a=0|Kt(l,4))?(c=0|L(e,t,n,r,a,l,u,0),qt(a),a=c):a=13}else a=2}while(0);return k=o,0|(c=a)}function B(e,t,n,r,s){e|=0,t|=0,n|=0,r|=0,s|=0;var o,a,l=0,u=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0;if(a=k,k=k+16|0,g=a+8|0,i[(p=o=a)>>2]=e,i[p+4>>2]=t,(0|n)<0)return k=a,0|(g=2);if(i[(l=r)>>2]=e,i[l+4>>2]=t,(l=0!=(0|s))&&(i[s>>2]=0),0|Ge(e,t))return k=a,0|(g=9);i[g>>2]=0;e:do{if((0|n)>=1)if(l)for(d=1,h=0,f=0,p=1,l=e;;){if(!(h|f)){if(0|(l=0|O(l,t,4,g,o)))break e;if(0|Ge(l=0|i[(t=o)>>2],t=0|i[t+4>>2])){l=9;break e}}if(0|(l=0|O(l,t,0|i[26800+(f<<2)>>2],g,o)))break e;if(l=0|i[(t=o)>>2],t=0|i[t+4>>2],i[(e=r+(d<<3)|0)>>2]=l,i[e+4>>2]=t,i[s+(d<<2)>>2]=p,u=(0|(e=h+1|0))==(0|p),A=6==(0|(c=f+1|0)),0|Ge(l,t)){l=9;break e}if((0|(p=p+(A&u&1)|0))>(0|n)){l=0;break}d=d+1|0,h=u?0:e,f=u?A?0:c:f}else for(d=1,h=0,f=0,p=1,l=e;;){if(!(h|f)){if(0|(l=0|O(l,t,4,g,o)))break e;if(0|Ge(l=0|i[(t=o)>>2],t=0|i[t+4>>2])){l=9;break e}}if(0|(l=0|O(l,t,0|i[26800+(f<<2)>>2],g,o)))break e;if(l=0|i[(t=o)>>2],t=0|i[t+4>>2],i[(e=r+(d<<3)|0)>>2]=l,i[e+4>>2]=t,u=(0|(e=h+1|0))==(0|p),A=6==(0|(c=f+1|0)),0|Ge(l,t)){l=9;break e}if((0|(p=p+(A&u&1)|0))>(0|n)){l=0;break}d=d+1|0,h=u?0:e,f=u?A?0:c:f}else l=0}while(0);return k=a,0|(g=l)}function L(e,t,n,r,s,o,a,l){n|=0,r|=0,s|=0,l|=0;var u,c,A,h=0,d=0,f=0,p=0,g=0,m=0,y=0;if(A=k,k=k+16|0,u=A+8|0,c=A,h=0|sn(0|(e|=0),0|(t|=0),0|(o|=0),0|(a|=0)),f=0|D(),!(0==(0|(y=0|i[(m=p=r+(h<<3)|0)>>2]))&0==(0|(m=0|i[m+4>>2]))|(d=(0|y)==(0|e)&(0|m)==(0|t))))do{h=0|rn(0|(h=0|Zt(0|h,0|f,1,0)),0|D(),0|o,0|a),f=0|D(),d=(0|(m=0|i[(y=p=r+(h<<3)|0)>>2]))==(0|e)&(0|(y=0|i[y+4>>2]))==(0|t)}while(!(0==(0|m)&0==(0|y)|d));if(h=s+(h<<2)|0,d&&(0|i[h>>2])<=(0|l))return k=A,0|(y=0);if(i[(y=p)>>2]=e,i[y+4>>2]=t,i[h>>2]=l,(0|l)>=(0|n))return k=A,0|(y=0);switch(d=l+1|0,i[u>>2]=0,0|(h=0|O(e,t,2,u,c))){case 9:g=9;break;case 0:(h=0|L(0|i[(h=c)>>2],0|i[h+4>>2],n,r,s,o,a,d))||(g=9)}e:do{if(9==(0|g)){switch(i[u>>2]=0,0|(h=0|O(e,t,3,u,c))){case 9:break;case 0:if(0|(h=0|L(0|i[(h=c)>>2],0|i[h+4>>2],n,r,s,o,a,d)))break e;break;default:break e}switch(i[u>>2]=0,0|(h=0|O(e,t,1,u,c))){case 9:break;case 0:if(0|(h=0|L(0|i[(h=c)>>2],0|i[h+4>>2],n,r,s,o,a,d)))break e;break;default:break e}switch(i[u>>2]=0,0|(h=0|O(e,t,5,u,c))){case 9:break;case 0:if(0|(h=0|L(0|i[(h=c)>>2],0|i[h+4>>2],n,r,s,o,a,d)))break e;break;default:break e}switch(i[u>>2]=0,0|(h=0|O(e,t,4,u,c))){case 9:break;case 0:if(0|(h=0|L(0|i[(h=c)>>2],0|i[h+4>>2],n,r,s,o,a,d)))break e;break;default:break e}switch(i[u>>2]=0,0|(h=0|O(e,t,6,u,c))){case 9:break;case 0:if(0|(h=0|L(0|i[(h=c)>>2],0|i[h+4>>2],n,r,s,o,a,d)))break e;break;default:break e}return k=A,0|(y=0)}}while(0);return k=A,0|(y=h)}function O(e,t,n,r,s){e|=0,t|=0,s|=0;var o,a,l=0,u=0,c=0,A=0,h=0,d=0,f=0;if((n|=0)>>>0>6)return 0|(s=1);if(h=(0|i[(r|=0)>>2])%6|0,i[r>>2]=h,(0|h)>0){l=0;do{n=0|ve(n),l=l+1|0}while((0|l)<(0|i[r>>2]))}if(h=0|an(0|e,0|t,45),D(),(a=127&h)>>>0>121)return 0|(s=5);o=0|Qe(e,t),l=0|an(0|e,0|t,52),D(),l&=15;e:do{if(l){for(;;){if(c=0|an(0|e,0|t,0|(u=3*(15-l|0)|0)),D(),7==(0|(c&=7))){t=5;break}if(f=0==(0|Ze(l)),l=l+-1|0,d=0|ln(7,0,0|u),t&=~D(),e=0|ln(0|i[(f?432:16)+(28*c|0)+(n<<2)>>2],0,0|u)|e&~d,t|=u=0|D(),!(n=0|i[(f?640:224)+(28*c|0)+(n<<2)>>2])){n=0;break e}if(!l){A=8;break e}}return 0|t}A=8}while(0);8==(0|A)&&(e|=0|ln(0|(f=0|i[848+(28*a|0)+(n<<2)>>2]),0,45),t=D()|-1040385&t,n=0|i[4272+(28*a|0)+(n<<2)>>2],127==(127&f)&&(f=0|ln(0|i[848+(28*a|0)+20>>2],0,45),t=D()|-1040385&t,n=0|i[4272+(28*a|0)+20>>2],e=0|Ye(f|e,t),t=0|D(),i[r>>2]=1+(0|i[r>>2]))),c=0|an(0|e,0|t,45),D(),c&=127;e:do{if(0|z(c)){t:do{if(1==(0|Qe(e,t))){if((0|a)!=(0|c)){if(0|W(c,0|i[7696+(28*a|0)>>2])){e=0|Ke(e,t),u=1,t=0|D();break}C(27795,26864,436,26872)}switch(0|o){case 3:e=0|Ye(e,t),t=0|D(),i[r>>2]=1+(0|i[r>>2]),u=0;break t;case 5:e=0|Ke(e,t),t=0|D(),i[r>>2]=5+(0|i[r>>2]),u=0;break t;case 0:return 0|(f=9);default:return 0|(f=1)}}else u=0}while(0);if((0|n)>0){l=0;do{e=0|Xe(e,t),t=0|D(),l=l+1|0}while((0|l)!=(0|n))}if((0|a)!=(0|c)){if(!(0|j(c))){if(0!=(0|u)|5!=(0|Qe(e,t)))break;i[r>>2]=1+(0|i[r>>2]);break}switch(127&h){case 8:case 118:break e}3!=(0|Qe(e,t))&&(i[r>>2]=1+(0|i[r>>2]))}}else if((0|n)>0){l=0;do{e=0|Ye(e,t),t=0|D(),l=l+1|0}while((0|l)!=(0|n))}}while(0);return i[r>>2]=((0|i[r>>2])+n|0)%6|0,i[(f=s)>>2]=e,i[f+4>>2]=t,0|(f=0)}function N(e,t,n,r){n|=0,r|=0;var s,o,a,l=0,u=0;for(a=k,k=k+16|0,s=a,o=a+8|0,l=(l=0==(0|Ge(e|=0,t|=0)))?1:2;;){if(i[o>>2]=0,0==(0|O(e,t,l,o,s))&((0|i[(u=s)>>2])==(0|n)?(0|i[u+4>>2])==(0|r):0)){e=4;break}if((l=l+1|0)>>>0>=7){l=7,e=4;break}}return 4==(0|e)?(k=a,0|l):0}function U(e,t,n,r,o,a,l){t|=0,n|=0,r|=0,o|=0,a|=0,l|=0;var u,c,A,h,d,f,p,g,m,y,v=0,_=0,b=0,w=0,E=0,x=0,C=0,S=0,T=0,I=0,F=0,R=0,P=0,M=0,B=0,L=0,O=0,N=0,U=0;if(y=k,k=k+64|0,p=y+48|0,g=y+32|0,m=y+24|0,u=y+8|0,c=y,(0|(_=0|i[(e|=0)>>2]))<=0)return k=y,0|(B=0);for(A=e+4|0,h=p+8|0,d=g+8|0,f=u+8|0,v=0,P=0;;){R=(b=0|i[A>>2])+(P<<4)|0,i[p>>2]=i[R>>2],i[p+4>>2]=i[R+4>>2],i[p+8>>2]=i[R+8>>2],i[p+12>>2]=i[R+12>>2],(0|P)==(_+-1|0)?(i[g>>2]=i[b>>2],i[g+4>>2]=i[b+4>>2],i[g+8>>2]=i[b+8>>2],i[g+12>>2]=i[b+12>>2]):(R=b+(P+1<<4)|0,i[g>>2]=i[R>>2],i[g+4>>2]=i[R+4>>2],i[g+8>>2]=i[R+8>>2],i[g+12>>2]=i[R+12>>2]),_=0|te(p,g,r,m);e:do{if(_)b=0,v=_;else if(b=0|i[(_=m)>>2],(0|(_=0|i[_+4>>2]))>0|0==(0|_)&b>>>0>0){F=0,R=0;t:for(;;){if(O=1/(+(b>>>0)+4294967296*+(0|_)),U=+s[p>>3],N=+((_=0|Jt(0|b,0|_,0|F,0|R))>>>0)+4294967296*+(0|D()),L=+(F>>>0)+4294967296*+(0|R),s[u>>3]=O*(U*N)+O*(+s[g>>3]*L),s[f>>3]=O*(+s[h>>3]*N)+O*(+s[d>>3]*L),0|(_=0|Je(u,r,c))){v=_;break}x=0|sn(0|(T=0|i[(I=c)>>2]),0|(I=0|i[I+4>>2]),0|t,0|n),w=0|D(),b=0|i[(E=_=l+(x<<3)|0)>>2],E=0|i[E+4>>2];n:do{if(0==(0|b)&0==(0|E))M=_,B=16;else for(C=0,S=0;;){if((0|C)>(0|n)|(0|C)==(0|n)&S>>>0>t>>>0){v=1;break t}if((0|b)==(0|T)&(0|E)==(0|I))break n;if(x=0|rn(0|(_=0|Zt(0|x,0|w,1,0)),0|D(),0|t,0|n),w=0|D(),S=0|Zt(0|S,0|C,1,0),C=0|D(),0==(0|(b=0|i[(E=_=l+(x<<3)|0)>>2]))&0==(0|(E=0|i[E+4>>2]))){M=_,B=16;break}}}while(0);if(16!=(0|B)||(B=0,0==(0|T)&0==(0|I))||(i[(S=M)>>2]=T,i[S+4>>2]=I,S=a+(i[o>>2]<<3)|0,i[S>>2]=T,i[S+4>>2]=I,S=0|Zt(0|i[(S=o)>>2],0|i[S+4>>2],1,0),T=0|D(),i[(I=o)>>2]=S,i[I+4>>2]=T),F=0|Zt(0|F,0|R,1,0),R=0|D(),b=0|i[(_=m)>>2],!((0|(_=0|i[_+4>>2]))>(0|R)|(0|_)==(0|R)&b>>>0>F>>>0)){b=1;break e}}b=0}else b=1}while(0);if(P=P+1|0,!b){B=21;break}if((0|P)>=(0|(_=0|i[e>>2]))){v=0,B=21;break}}return 21==(0|B)?(k=y,0|v):0}function z(e){return(e|=0)>>>0>121?0|(e=0):0|(e=0|i[7696+(28*e|0)+16>>2])}function j(e){return 4==(0|(e|=0))|117==(0|e)|0}function V(e){return 0|i[11120+(216*(0|i[(e|=0)>>2])|0)+(72*(0|i[e+4>>2])|0)+(24*(0|i[e+8>>2])|0)+(i[e+12>>2]<<3)>>2]}function G(e){return 0|i[11120+(216*(0|i[(e|=0)>>2])|0)+(72*(0|i[e+4>>2])|0)+(24*(0|i[e+8>>2])|0)+(i[e+12>>2]<<3)+4>>2]}function W(e,t){return t|=0,(0|i[7696+(28*(e|=0)|0)+20>>2])==(0|t)?0|(t=1):0|(t=(0|i[7696+(28*e|0)+24>>2])==(0|t))}function H(e,t){return 0|i[848+(28*(e|=0)|0)+((t|=0)<<2)>>2]}function Q(e,t){return t|=0,(0|i[848+(28*(e|=0)|0)>>2])==(0|t)?0|(t=0):(0|i[848+(28*e|0)+4>>2])==(0|t)?0|(t=1):(0|i[848+(28*e|0)+8>>2])==(0|t)?0|(t=2):(0|i[848+(28*e|0)+12>>2])==(0|t)?0|(t=3):(0|i[848+(28*e|0)+16>>2])==(0|t)?0|(t=4):(0|i[848+(28*e|0)+20>>2])==(0|t)?0|(t=5):0|((0|i[848+(28*e|0)+24>>2])==(0|t)?6:7)}function X(e){var t,n,r;return t=(r=+s[(e|=0)+16>>3])-(n=+s[e+24>>3]),+(r<n?t+6.283185307179586:t)}function Y(e){return+s[(e|=0)+16>>3]<+s[e+24>>3]|0}function q(e){return+(+s[(e|=0)>>3]-+s[e+8>>3])}function K(e,t){e|=0;var n,r,i=0;return(i=+s[(t|=0)>>3])>=+s[e+8>>3]&&i<=+s[e>>3]?(n=+s[e+16>>3],i=+s[e+24>>3],t=(r=+s[t+8>>3])>=i,e=r<=n&1,n<i?t&&(e=1):t||(e=0),0|(t=0!=(0|e))):0|(t=0)}function Z(e,t){t|=0;var n,r,i,o,a,l=0,u=0,c=0,A=0;return+s[(e|=0)>>3]<+s[t+8>>3]||+s[e+8>>3]>+s[t>>3]?0|(l=0):(i=(u=+s[e+16>>3])<(A=+s[(n=e+24|0)>>3]),c=(a=+s[(l=t+16|0)>>3])<(o=+s[(r=t+24|0)>>3]),t=A-a<o-u,e=i?c|t?1:2:0,t=c?i?1:t?2:1:0,(u=+ut(u,e))<+ut(+s[r>>3],t)||(A=+ut(+s[n>>3],e))>+ut(+s[l>>3],t)?0|(c=0):0|(c=1))}function J(e,t){t|=0;var n,r,i,o,a,l=0,u=0,c=0,A=0;return+s[(e|=0)>>3]<+s[t>>3]||+s[e+8>>3]>+s[t+8>>3]?0|(l=0):(i=(o=+s[(l=e+16|0)>>3])<(u=+s[e+24>>3]),c=(A=+s[(n=t+16|0)>>3])<(a=+s[(r=t+24|0)>>3]),t=u-A<a-o,e=i?c|t?1:2:0,t=c?i?1:t?2:1:0,(u=+ut(u,e))<=+ut(+s[r>>3],t)?0|(c=(A=+ut(+s[l>>3],e))>=+ut(+s[n>>3],t)):0|(c=0))}function $(e,t){e|=0,t|=0;var n,r,o,a,l,u=0;o=k,k=k+176|0,i[(r=o)>>2]=4,u=+s[t>>3],s[r+8>>3]=u,a=+s[t+16>>3],s[r+16>>3]=a,s[r+24>>3]=u,u=+s[t+24>>3],s[r+32>>3]=u,l=+s[t+8>>3],s[r+40>>3]=l,s[r+48>>3]=u,s[r+56>>3]=l,s[r+64>>3]=a,n=(t=r+72|0)+96|0;do{i[t>>2]=0,t=t+4|0}while((0|t)<(0|n));dn(0|e,0|r,168),k=o}function ee(e,t,n){e|=0,t|=0,n|=0;var r,a,c,A,h,d,f,p=0,g=0,m=0,y=0,_=0,w=0,E=0;d=k,k=k+288|0,h=d+264|0,y=d+96|0,g=(p=m=d)+96|0;do{i[p>>2]=0,p=p+4|0}while((0|p)<(0|g));return 0|(t=0|rt(t,m))?(k=d,0|(w=t)):(tt(m=0|i[(g=m)>>2],g=0|i[g+4>>2],h),nt(m,g,y),A=+ct(h,y+8|0),s[h>>3]=+s[e>>3],s[(g=h+8|0)>>3]=+s[e+16>>3],s[y>>3]=+s[e+8>>3],s[(m=y+8|0)>>3]=+s[e+24>>3],a=+ct(h,y),E=+s[g>>3]-+s[m>>3],c=+u(+E),f=+s[h>>3]-+s[y>>3],r=+u(+f),0==E|0==f||(E=+cn(+c,+r),E=+v(+a*a/+An(+E/+An(+c,+r),3)/(A*(2.59807621135*A)*.8)),s[o>>3]=E,_=~~E>>>0,w=+u(E)>=1?E>0?~~+b(+l(E/4294967296),4294967295)>>>0:~~+v((E-+(~~E>>>0))/4294967296)>>>0:0,2146435072==(2146435072&i[o+4>>2]))?t=1:(y=0==(0|_)&0==(0|w),i[(t=n)>>2]=y?1:_,i[t+4>>2]=y?0:w,t=0),k=d,0|(w=t))}function te(e,t,n,r){e|=0,t|=0,n|=0,r|=0;var a,c,A,h,d=0,f=0,p=0;h=k,k=k+288|0,c=h+264|0,A=h+96|0,a=(d=f=h)+96|0;do{i[d>>2]=0,d=d+4|0}while((0|d)<(0|a));return 0|(n=0|rt(n,f))?(k=h,0|(r=n)):(tt(d=0|i[(n=f)>>2],n=0|i[n+4>>2],c),nt(d,n,A),p=+ct(c,A+8|0),p=+v(+ +ct(e,t)/(2*p)),s[o>>3]=p,n=~~p>>>0,d=+u(p)>=1?p>0?~~+b(+l(p/4294967296),4294967295)>>>0:~~+v((p-+(~~p>>>0))/4294967296)>>>0:0,2146435072==(2146435072&i[o+4>>2])?(k=h,0|(r=1)):(f=0==(0|n)&0==(0|d),i[r>>2]=f?1:n,i[r+4>>2]=f?0:d,k=h,0|(r=0)))}function ne(e,t,n,r){t|=0,n|=0,r|=0,i[(e|=0)>>2]=t,i[e+4>>2]=n,i[e+8>>2]=r}function re(e,t){e|=0;var n,r,o,a,l=0,c=0,A=0,h=0,d=0,f=0,p=0;i[(a=(t|=0)+8|0)>>2]=0,r=+s[e>>3],h=+u(+r),o=+s[e+8>>3],h+=.5*(d=1.1547005383792515*+u(+o)),h-=+(0|(l=~~h)),d-=+(0|(e=~~d));do{if(h<.5){if(h<.3333333333333333){if(i[t>>2]=l,d<.5*(h+1)){i[t+4>>2]=e;break}e=e+1|0,i[t+4>>2]=e;break}if(e=(1&!(d<(p=1-h)))+e|0,i[t+4>>2]=e,p<=d&d<2*h){l=l+1|0,i[t>>2]=l;break}i[t>>2]=l;break}if(!(h<.6666666666666666)){if(l=l+1|0,i[t>>2]=l,d<.5*h){i[t+4>>2]=e;break}e=e+1|0,i[t+4>>2]=e;break}if(d<1-h){if(i[t+4>>2]=e,2*h-1<d){i[t>>2]=l;break}}else e=e+1|0,i[t+4>>2]=e;l=l+1|0,i[t>>2]=l}while(0);do{if(r<0){if(1&e){l=~~(+(0|l)-(2*(+((f=0|Jt(0|l,((0|l)<0)<<31>>31,0|(f=(e+1|0)/2|0),((0|f)<0)<<31>>31))>>>0)+4294967296*+(0|D()))+1)),i[t>>2]=l;break}l=~~(+(0|l)-2*(+((f=0|Jt(0|l,((0|l)<0)<<31>>31,0|(f=(0|e)/2|0),((0|f)<0)<<31>>31))>>>0)+4294967296*+(0|D()))),i[t>>2]=l;break}}while(0);f=t+4|0,o<0&&(l=l-((1|e<<1)/2|0)|0,i[t>>2]=l,e=0-e|0,i[f>>2]=e),c=e-l|0,(0|l)<0?(A=0-l|0,i[f>>2]=c,i[a>>2]=A,i[t>>2]=0,e=c,l=0):A=0,(0|e)<0&&(l=l-e|0,i[t>>2]=l,A=A-e|0,i[a>>2]=A,i[f>>2]=0,e=0),n=l-A|0,c=e-A|0,(0|A)<0&&(i[t>>2]=n,i[f>>2]=c,i[a>>2]=0,e=c,l=n,A=0),(0|(c=(0|A)<(0|(c=(0|e)<(0|l)?e:l))?A:c))<=0||(i[t>>2]=l-c,i[f>>2]=e-c,i[a>>2]=A-c)}function ie(e){var t,n=0,r=0,s=0,o=0,a=0;n=0|i[(e|=0)>>2],r=0|i[(t=e+4|0)>>2],(0|n)<0&&(r=r-n|0,i[t>>2]=r,i[(a=e+8|0)>>2]=(0|i[a>>2])-n,i[e>>2]=0,n=0),(0|r)<0?(n=n-r|0,i[e>>2]=n,o=(0|i[(a=e+8|0)>>2])-r|0,i[a>>2]=o,i[t>>2]=0,r=0):(a=o=e+8|0,o=0|i[o>>2]),(0|o)<0&&(n=n-o|0,i[e>>2]=n,r=r-o|0,i[t>>2]=r,i[a>>2]=0,o=0),(0|(s=(0|o)<(0|(s=(0|r)<(0|n)?r:n))?o:s))<=0||(i[e>>2]=n-s,i[t>>2]=r-s,i[a>>2]=o-s)}function se(e,t){t|=0;var n,r;r=0|i[(e|=0)+8>>2],n=+((0|i[e+4>>2])-r|0),s[t>>3]=+((0|i[e>>2])-r|0)-.5*n,s[t+8>>3]=.8660254037844386*n}function oe(e,t,n){e|=0,t|=0,i[(n|=0)>>2]=(0|i[t>>2])+(0|i[e>>2]),i[n+4>>2]=(0|i[t+4>>2])+(0|i[e+4>>2]),i[n+8>>2]=(0|i[t+8>>2])+(0|i[e+8>>2])}function ae(e,t,n){e|=0,t|=0,i[(n|=0)>>2]=(0|i[e>>2])-(0|i[t>>2]),i[n+4>>2]=(0|i[e+4>>2])-(0|i[t+4>>2]),i[n+8>>2]=(0|i[e+8>>2])-(0|i[t+8>>2])}function le(e,t){t|=0;var n,r=0;r=0|_(0|i[(e|=0)>>2],t),i[e>>2]=r,n=0|_(0|i[(r=e+4|0)>>2],t),i[r>>2]=n,t=0|_(0|i[(e=e+8|0)>>2],t),i[e>>2]=t}function ue(e){var t,n,r=0,s=0,o=0,a=0,l=0;l=(0|(n=0|i[(e|=0)>>2]))<0,e=(e=(s=(0|(a=((t=(0|(o=(0|i[e+4>>2])-(l?n:0)|0))<0)?0-o|0:0)+((0|i[e+8>>2])-(l?n:0))|0))<0)?0:a)-((o=(0|(s=(0|e)<(0|(s=(0|(r=(t?0:o)-(s?a:0)|0))<(0|(a=(l?0:n)-(t?o:0)-(s?a:0)|0))?r:a))?e:s))>0)?s:0)|0,r=r-(o?s:0)|0;e:do{switch(a-(o?s:0)|0){case 0:switch(0|r){case 0:return 0|(l=0==(0|e)?0:1==(0|e)?1:7);case 1:return 0|(l=0==(0|e)?2:1==(0|e)?3:7);default:break e}case 1:switch(0|r){case 0:return 0|(l=0==(0|e)?4:1==(0|e)?5:7);case 1:if(e)break e;return 0|(e=6);default:break e}}}while(0);return 0|(l=7)}function ce(e){var t,n,r=0,s=0,o=0,a=0,l=0,u=0,c=0;if(u=0|i[(n=(e|=0)+8|0)>>2],(t=(0|i[e>>2])-u|0)>>>0>715827881|(u=(0|i[(c=e+4|0)>>2])-u|0)>>>0>715827881){if(a=2147483647-t|0,l=-2147483648-t|0,(o=(0|t)>0)?(0|a)<(0|t):(0|l)>(0|t))return 0|(c=1);if(s=t<<1,o?(2147483647-s|0)<(0|t):(-2147483648-s|0)>(0|t))return 0|(c=1);if((0|u)>0?(2147483647-u|0)<(0|u):(-2147483648-u|0)>(0|u))return 0|(c=1);if(r=3*t|0,s=u<<1,(o?(0|a)<(0|s):(0|l)>(0|s))||((0|t)>-1?(-2147483648|r)>=(0|u):(-2147483648^r)<(0|u)))return 0|(c=1)}else s=u<<1,r=3*t|0;return o=0|Xt(.14285714285714285*+(r-u|0)),i[e>>2]=o,a=0|Xt(.14285714285714285*+(s+t|0)),i[c>>2]=a,i[n>>2]=0,r=(s=(0|a)<(0|o))?o:a,(0|(s=s?a:o))<0&&((-2147483648==(0|s)||((0|r)>0?(2147483647-r|0)<(0|s):(-2147483648-r|0)>(0|s)))&&C(27795,26892,354,26903),((0|r)>-1?(-2147483648|r)>=(0|s):(-2147483648^r)<(0|s))&&C(27795,26892,354,26903)),r=a-o|0,(0|o)<0?(s=0-o|0,i[c>>2]=r,i[n>>2]=s,i[e>>2]=0,o=0):(r=a,s=0),(0|r)<0&&(o=o-r|0,i[e>>2]=o,s=s-r|0,i[n>>2]=s,i[c>>2]=0,r=0),l=o-s|0,a=r-s|0,(0|s)<0?(i[e>>2]=l,i[c>>2]=a,i[n>>2]=0,r=a,a=l,s=0):a=o,(0|(o=(0|s)<(0|(o=(0|r)<(0|a)?r:a))?s:o))<=0||(i[e>>2]=a-o,i[c>>2]=r-o,i[n>>2]=s-o),0|(c=0)}function Ae(e){var t,n=0,r=0,s=0,o=0,a=0,l=0,u=0;if(o=0|i[(t=(e|=0)+8|0)>>2],(a=(0|i[e>>2])-o|0)>>>0>715827881|(o=(0|i[(l=e+4|0)>>2])-o|0)>>>0>715827881){if((r=(0|a)>0)?(2147483647-a|0)<(0|a):(-2147483648-a|0)>(0|a))return 0|(l=1);if(n=a<<1,(s=(0|o)>0)?(2147483647-o|0)<(0|o):(-2147483648-o|0)>(0|o))return 0|(l=1);if(u=o<<1,s?(2147483647-u|0)<(0|o):(-2147483648-u|0)>(0|o))return 0|(u=1);if(r?(2147483647-n|0)<(0|o):(-2147483648-n|0)>(0|o))return 0|(u=1);if(r=3*o|0,(0|o)>-1?(-2147483648|r)>=(0|a):(-2147483648^r)<(0|a))return 0|(u=1)}else r=3*o|0,n=a<<1;return s=0|Xt(.14285714285714285*+(n+o|0)),i[e>>2]=s,o=0|Xt(.14285714285714285*+(r-a|0)),i[l>>2]=o,i[t>>2]=0,n=(r=(0|o)<(0|s))?s:o,(0|(r=r?o:s))<0&&((-2147483648==(0|r)||((0|n)>0?(2147483647-n|0)<(0|r):(-2147483648-n|0)>(0|r)))&&C(27795,26892,402,26917),((0|n)>-1?(-2147483648|n)>=(0|r):(-2147483648^n)<(0|r))&&C(27795,26892,402,26917)),n=o-s|0,(0|s)<0?(r=0-s|0,i[l>>2]=n,i[t>>2]=r,i[e>>2]=0,s=0):(n=o,r=0),(0|n)<0&&(s=s-n|0,i[e>>2]=s,r=r-n|0,i[t>>2]=r,i[l>>2]=0,n=0),a=s-r|0,o=n-r|0,(0|r)<0?(i[e>>2]=a,i[l>>2]=o,i[t>>2]=0,n=o,o=a,r=0):o=s,(0|(s=(0|r)<(0|(s=(0|n)<(0|o)?n:o))?r:s))<=0||(i[e>>2]=o-s,i[l>>2]=n-s,i[t>>2]=r-s),0|(u=0)}function he(e){var t,n,r=0,s=0,o=0,a=0,l=0;s=0|i[(t=(e|=0)+8|0)>>2],o=0|Xt(.14285714285714285*+((3*(r=(0|i[e>>2])-s|0)|0)-(s=(0|i[(n=e+4|0)>>2])-s|0)|0)),i[e>>2]=o,r=0|Xt(.14285714285714285*+((s<<1)+r|0)),i[n>>2]=r,i[t>>2]=0,s=r-o|0,(0|o)<0?(l=0-o|0,i[n>>2]=s,i[t>>2]=l,i[e>>2]=0,r=s,o=0,s=l):s=0,(0|r)<0&&(o=o-r|0,i[e>>2]=o,s=s-r|0,i[t>>2]=s,i[n>>2]=0,r=0),l=o-s|0,a=r-s|0,(0|s)<0?(i[e>>2]=l,i[n>>2]=a,i[t>>2]=0,r=a,a=l,s=0):a=o,(0|(o=(0|s)<(0|(o=(0|r)<(0|a)?r:a))?s:o))<=0||(i[e>>2]=a-o,i[n>>2]=r-o,i[t>>2]=s-o)}function de(e){var t,n,r=0,s=0,o=0,a=0,l=0;s=0|i[(t=(e|=0)+8|0)>>2],o=0|Xt(.14285714285714285*+(((r=(0|i[e>>2])-s|0)<<1)+(s=(0|i[(n=e+4|0)>>2])-s|0)|0)),i[e>>2]=o,r=0|Xt(.14285714285714285*+((3*s|0)-r|0)),i[n>>2]=r,i[t>>2]=0,s=r-o|0,(0|o)<0?(l=0-o|0,i[n>>2]=s,i[t>>2]=l,i[e>>2]=0,r=s,o=0,s=l):s=0,(0|r)<0&&(o=o-r|0,i[e>>2]=o,s=s-r|0,i[t>>2]=s,i[n>>2]=0,r=0),l=o-s|0,a=r-s|0,(0|s)<0?(i[e>>2]=l,i[n>>2]=a,i[t>>2]=0,r=a,a=l,s=0):a=o,(0|(o=(0|s)<(0|(o=(0|r)<(0|a)?r:a))?s:o))<=0||(i[e>>2]=a-o,i[n>>2]=r-o,i[t>>2]=s-o)}function fe(e){var t,n,r,s=0,o=0,a=0,l=0;s=0|i[(e|=0)>>2],o=0|i[(n=e+4|0)>>2],a=0|i[(r=e+8|0)>>2],l=o+(3*s|0)|0,i[e>>2]=l,o=a+(3*o|0)|0,i[n>>2]=o,s=(3*a|0)+s|0,i[r>>2]=s,a=o-l|0,(0|l)<0?(s=s-l|0,i[n>>2]=a,i[r>>2]=s,i[e>>2]=0,o=a,a=0):a=l,(0|o)<0&&(a=a-o|0,i[e>>2]=a,s=s-o|0,i[r>>2]=s,i[n>>2]=0,o=0),t=a-s|0,l=o-s|0,(0|s)<0?(i[e>>2]=t,i[n>>2]=l,i[r>>2]=0,a=t,s=0):l=o,(0|(o=(0|s)<(0|(o=(0|l)<(0|a)?l:a))?s:o))<=0||(i[e>>2]=a-o,i[n>>2]=l-o,i[r>>2]=s-o)}function pe(e){var t,n,r,s=0,o=0,a=0,l=0;l=0|i[(e|=0)>>2],a=(3*(s=0|i[(n=e+4|0)>>2])|0)+l|0,l=(o=0|i[(r=e+8|0)>>2])+(3*l|0)|0,i[e>>2]=l,i[n>>2]=a,s=(3*o|0)+s|0,i[r>>2]=s,o=a-l|0,(0|l)<0?(s=s-l|0,i[n>>2]=o,i[r>>2]=s,i[e>>2]=0,l=0):o=a,(0|o)<0&&(l=l-o|0,i[e>>2]=l,s=s-o|0,i[r>>2]=s,i[n>>2]=0,o=0),t=l-s|0,a=o-s|0,(0|s)<0?(i[e>>2]=t,i[n>>2]=a,i[r>>2]=0,l=t,s=0):a=o,(0|(o=(0|s)<(0|(o=(0|a)<(0|l)?a:l))?s:o))<=0||(i[e>>2]=l-o,i[n>>2]=a-o,i[r>>2]=s-o)}function ge(e,t){e|=0;var n,r,s,o=0,a=0,l=0;((t|=0)+-1|0)>>>0>=6||(l=(0|i[15440+(12*t|0)>>2])+(0|i[e>>2])|0,i[e>>2]=l,s=e+4|0,a=(0|i[15440+(12*t|0)+4>>2])+(0|i[s>>2])|0,i[s>>2]=a,r=e+8|0,t=(0|i[15440+(12*t|0)+8>>2])+(0|i[r>>2])|0,i[r>>2]=t,o=a-l|0,(0|l)<0?(t=t-l|0,i[s>>2]=o,i[r>>2]=t,i[e>>2]=0,a=0):(o=a,a=l),(0|o)<0&&(a=a-o|0,i[e>>2]=a,t=t-o|0,i[r>>2]=t,i[s>>2]=0,o=0),n=a-t|0,l=o-t|0,(0|t)<0?(i[e>>2]=n,i[s>>2]=l,i[r>>2]=0,a=n,t=0):l=o,(0|(o=(0|t)<(0|(o=(0|l)<(0|a)?l:a))?t:o))<=0||(i[e>>2]=a-o,i[s>>2]=l-o,i[r>>2]=t-o))}function me(e){var t,n,r,s=0,o=0,a=0,l=0;l=0|i[(e|=0)>>2],a=(s=0|i[(n=e+4|0)>>2])+l|0,l=(o=0|i[(r=e+8|0)>>2])+l|0,i[e>>2]=l,i[n>>2]=a,s=o+s|0,i[r>>2]=s,o=a-l|0,(0|l)<0?(s=s-l|0,i[n>>2]=o,i[r>>2]=s,i[e>>2]=0,a=0):(o=a,a=l),(0|o)<0&&(a=a-o|0,i[e>>2]=a,s=s-o|0,i[r>>2]=s,i[n>>2]=0,o=0),t=a-s|0,l=o-s|0,(0|s)<0?(i[e>>2]=t,i[n>>2]=l,i[r>>2]=0,a=t,s=0):l=o,(0|(o=(0|s)<(0|(o=(0|l)<(0|a)?l:a))?s:o))<=0||(i[e>>2]=a-o,i[n>>2]=l-o,i[r>>2]=s-o)}function ye(e){var t,n,r,s=0,o=0,a=0,l=0;s=0|i[(e|=0)>>2],a=0|i[(n=e+4|0)>>2],o=0|i[(r=e+8|0)>>2],l=a+s|0,i[e>>2]=l,a=o+a|0,i[n>>2]=a,s=o+s|0,i[r>>2]=s,o=a-l|0,(0|l)<0?(s=s-l|0,i[n>>2]=o,i[r>>2]=s,i[e>>2]=0,a=0):(o=a,a=l),(0|o)<0&&(a=a-o|0,i[e>>2]=a,s=s-o|0,i[r>>2]=s,i[n>>2]=0,o=0),t=a-s|0,l=o-s|0,(0|s)<0?(i[e>>2]=t,i[n>>2]=l,i[r>>2]=0,a=t,s=0):l=o,(0|(o=(0|s)<(0|(o=(0|l)<(0|a)?l:a))?s:o))<=0||(i[e>>2]=a-o,i[n>>2]=l-o,i[r>>2]=s-o)}function ve(e){switch(0|(e|=0)){case 1:e=5;break;case 5:e=4;break;case 4:e=6;break;case 6:e=2;break;case 2:e=3;break;case 3:e=1}return 0|e}function _e(e){switch(0|(e|=0)){case 1:e=3;break;case 3:e=2;break;case 2:e=6;break;case 6:e=4;break;case 4:e=5;break;case 5:e=1}return 0|e}function be(e){var t,n,r,s=0,o=0,a=0,l=0;s=0|i[(e|=0)>>2],o=0|i[(n=e+4|0)>>2],a=0|i[(r=e+8|0)>>2],l=o+(s<<1)|0,i[e>>2]=l,o=a+(o<<1)|0,i[n>>2]=o,s=(a<<1)+s|0,i[r>>2]=s,a=o-l|0,(0|l)<0?(s=s-l|0,i[n>>2]=a,i[r>>2]=s,i[e>>2]=0,o=a,a=0):a=l,(0|o)<0&&(a=a-o|0,i[e>>2]=a,s=s-o|0,i[r>>2]=s,i[n>>2]=0,o=0),t=a-s|0,l=o-s|0,(0|s)<0?(i[e>>2]=t,i[n>>2]=l,i[r>>2]=0,a=t,s=0):l=o,(0|(o=(0|s)<(0|(o=(0|l)<(0|a)?l:a))?s:o))<=0||(i[e>>2]=a-o,i[n>>2]=l-o,i[r>>2]=s-o)}function we(e){var t,n,r,s=0,o=0,a=0,l=0;l=0|i[(e|=0)>>2],a=((s=0|i[(n=e+4|0)>>2])<<1)+l|0,l=(o=0|i[(r=e+8|0)>>2])+(l<<1)|0,i[e>>2]=l,i[n>>2]=a,s=(o<<1)+s|0,i[r>>2]=s,o=a-l|0,(0|l)<0?(s=s-l|0,i[n>>2]=o,i[r>>2]=s,i[e>>2]=0,l=0):o=a,(0|o)<0&&(l=l-o|0,i[e>>2]=l,s=s-o|0,i[r>>2]=s,i[n>>2]=0,o=0),t=l-s|0,a=o-s|0,(0|s)<0?(i[e>>2]=t,i[n>>2]=a,i[r>>2]=0,l=t,s=0):a=o,(0|(o=(0|s)<(0|(o=(0|a)<(0|l)?a:l))?s:o))<=0||(i[e>>2]=l-o,i[n>>2]=a-o,i[r>>2]=s-o)}function Ee(e,t){t|=0;var n,r,s,o=0,a=0,l=0;return s=(0|(r=(0|i[(e|=0)>>2])-(0|i[t>>2])|0))<0,n=(0|(a=(0|i[e+4>>2])-(0|i[t+4>>2])-(s?r:0)|0))<0,t=(t=(e=(0|(l=(s?0-r|0:0)+(0|i[e+8>>2])-(0|i[t+8>>2])+(n?0-a|0:0)|0))<0)?0:l)-((a=(0|(e=(0|t)<(0|(e=(0|(o=(n?0:a)-(e?l:0)|0))<(0|(l=(s?0:r)-(n?a:0)-(e?l:0)|0))?o:l))?t:e))>0)?e:0)|0,o=o-(a?e:0)|0,0|((0|(e=(0|(e=l-(a?e:0)|0))>-1?e:0-e|0))>(0|(t=(0|(o=(0|o)>-1?o:0-o|0))>(0|(t=(0|t)>-1?t:0-t|0))?o:t))?e:t)}function xe(e,t){t|=0;var n;n=0|i[(e|=0)+8>>2],i[t>>2]=(0|i[e>>2])-n,i[t+4>>2]=(0|i[e+4>>2])-n}function De(e,t){t|=0;var n,r,s,o=0,a=0,l=0;if(a=0|i[(e|=0)>>2],i[t>>2]=a,l=0|i[e+4>>2],i[(r=t+4|0)>>2]=l,i[(s=t+8|0)>>2]=0,e=(o=(0|l)<(0|a))?a:l,(0|(o=o?l:a))<0){if(-2147483648==(0|o)||((0|e)>0?(2147483647-e|0)<(0|o):(-2147483648-e|0)>(0|o)))return 0|(t=1);if((0|e)>-1?(-2147483648|e)>=(0|o):(-2147483648^e)<(0|o))return 0|(t=1)}return e=l-a|0,(0|a)<0?(o=0-a|0,i[r>>2]=e,i[s>>2]=o,i[t>>2]=0,a=0):(e=l,o=0),(0|e)<0&&(a=a-e|0,i[t>>2]=a,o=o-e|0,i[s>>2]=o,i[r>>2]=0,e=0),n=a-o|0,l=e-o|0,(0|o)<0?(i[t>>2]=n,i[r>>2]=l,i[s>>2]=0,e=l,l=n,o=0):l=a,(0|(a=(0|o)<(0|(a=(0|e)<(0|l)?e:l))?o:a))<=0||(i[t>>2]=l-a,i[r>>2]=e-a,i[s>>2]=o-a),0|(t=0)}function Ce(e){var t,n,r,s;n=(s=0|i[(t=(e|=0)+8|0)>>2])-(0|i[e>>2])|0,i[e>>2]=n,e=(0|i[(r=e+4|0)>>2])-s|0,i[r>>2]=e,i[t>>2]=0-(e+n)}function Se(e){var t,n,r=0,s=0,o=0,a=0,l=0;r=0-(s=0|i[(e|=0)>>2])|0,i[e>>2]=r,i[(t=e+8|0)>>2]=0,a=(o=0|i[(n=e+4|0)>>2])+s|0,(0|s)>0?(i[n>>2]=a,i[t>>2]=s,i[e>>2]=0,r=0,o=a):s=0,(0|o)<0?(l=r-o|0,i[e>>2]=l,s=s-o|0,i[t>>2]=s,i[n>>2]=0,a=l-s|0,r=0-s|0,(0|s)<0?(i[e>>2]=a,i[n>>2]=r,i[t>>2]=0,o=r,s=0):(o=0,a=l)):a=r,(0|(r=(0|s)<(0|(r=(0|o)<(0|a)?o:a))?s:r))<=0||(i[e>>2]=a-r,i[n>>2]=o-r,i[t>>2]=s-r)}function Te(e,t,n){n|=0;var r,s,o=0,a=0;return s=k,k=k+16|0,r=s,a=-2130706433&(t|=0)|134217728,!0&268435456==(2013265920&t)?(o=0|an(0|(e|=0),0|t,56),D(),o=0|function(e,t,n){e|=0,t|=0,n|=0;var r=0,s=0,o=0;if(o=k,k=k+16|0,s=o,r=0|Ge(e,t),(n+-1|0)>>>0>5)return k=o,0|(s=-1);if(r=0!=(0|r),1==(0|n)&r)return k=o,0|(s=-1);do{if(!(0|Nt(e,t,s))){if(r){r=(5+(0|i[26352+(n<<2)>>2])-(0|i[s>>2])|0)%5|0;break}r=(6+(0|i[26384+(n<<2)>>2])-(0|i[s>>2])|0)%6|0;break}r=-1}while(0);return s=r,k=o,0|s}(e,a,7&o),-1==(0|o)?(i[n>>2]=0,k=s,0|(a=6)):(0|et(e,a,r)&&C(27795,26932,282,26947),t=0|an(0|e,0|t,52),D(),t&=15,0|Ge(e,a)?ke(r,t,o,2,n):Le(r,t,o,2,n),k=s,0|(a=0))):(k=s,0|(a=6))}function Ie(e,t,n,r){t|=0,r|=0;var o,a=0,l=0,u=0,c=0;if(o=k,k=k+16|0,function(e,t,n){e|=0,t|=0,n|=0;var r=0,o=0,a=0;a=k,k=k+32|0,o=a,function(e,t){e|=0,t|=0;var n=0,r=0,i=0;n=+s[e>>3],r=+h(+n),n=+d(+n),s[t+16>>3]=n,n=+s[e+8>>3],i=r*+h(+n),s[t>>3]=i,n=r*+d(+n),s[t+8>>3]=n}(e,o),i[t>>2]=0,s[n>>3]=5,r=+Ot(16400,o),r<+s[n>>3]&&(i[t>>2]=0,s[n>>3]=r);r=+Ot(16424,o),r<+s[n>>3]&&(i[t>>2]=1,s[n>>3]=r);r=+Ot(16448,o),r<+s[n>>3]&&(i[t>>2]=2,s[n>>3]=r);r=+Ot(16472,o),r<+s[n>>3]&&(i[t>>2]=3,s[n>>3]=r);r=+Ot(16496,o),r<+s[n>>3]&&(i[t>>2]=4,s[n>>3]=r);r=+Ot(16520,o),r<+s[n>>3]&&(i[t>>2]=5,s[n>>3]=r);r=+Ot(16544,o),r<+s[n>>3]&&(i[t>>2]=6,s[n>>3]=r);r=+Ot(16568,o),r<+s[n>>3]&&(i[t>>2]=7,s[n>>3]=r);r=+Ot(16592,o),r<+s[n>>3]&&(i[t>>2]=8,s[n>>3]=r);r=+Ot(16616,o),r<+s[n>>3]&&(i[t>>2]=9,s[n>>3]=r);r=+Ot(16640,o),r<+s[n>>3]&&(i[t>>2]=10,s[n>>3]=r);r=+Ot(16664,o),r<+s[n>>3]&&(i[t>>2]=11,s[n>>3]=r);r=+Ot(16688,o),r<+s[n>>3]&&(i[t>>2]=12,s[n>>3]=r);r=+Ot(16712,o),r<+s[n>>3]&&(i[t>>2]=13,s[n>>3]=r);r=+Ot(16736,o),r<+s[n>>3]&&(i[t>>2]=14,s[n>>3]=r);r=+Ot(16760,o),r<+s[n>>3]&&(i[t>>2]=15,s[n>>3]=r);r=+Ot(16784,o),r<+s[n>>3]&&(i[t>>2]=16,s[n>>3]=r);r=+Ot(16808,o),r<+s[n>>3]&&(i[t>>2]=17,s[n>>3]=r);r=+Ot(16832,o),r<+s[n>>3]&&(i[t>>2]=18,s[n>>3]=r);if(r=+Ot(16856,o),!(r<+s[n>>3]))return void(k=a);i[t>>2]=19,s[n>>3]=r,k=a}(e|=0,n|=0,c=o),(l=+p(+(1-.5*+s[c>>3])))<1e-16)return i[r>>2]=0,i[r+4>>2]=0,i[r+8>>2]=0,i[r+12>>2]=0,void(k=o);if(c=0|i[n>>2],a=+at((a=+s[15920+(24*c|0)>>3])-+at(+function(e,t){e|=0,t|=0;var n=0,r=0,i=0,o=0,a=0;return o=+s[t>>3],r=+h(+o),i=+s[t+8>>3]-+s[e+8>>3],a=r*+d(+i),n=+s[e>>3],+ +y(+a,+(+d(+o)*+h(+n)-+h(+i)*(r*+d(+n))))}(15600+(c<<4)|0,e))),u=0|Ze(t)?+at(a+-.3334731722518321):a,a=2.618033988749896*+f(+l),(0|t)>0){e=0;do{a*=2.6457513110645907,e=e+1|0}while((0|e)!=(0|t))}l=+h(+u)*a,s[r>>3]=l,u=+d(+u)*a,s[r+8>>3]=u,k=o}function Fe(e,t,n,r,o){t|=0,n|=0,r|=0,o|=0;var a,l=0,A=0;if(l=+function(e){e|=0;var t=0,n=0;return n=+s[e>>3],t=+s[e+8>>3],+ +c(+(n*n+t*t))}(e|=0),l<1e-16)return t=15600+(t<<4)|0,i[o>>2]=i[t>>2],i[o+4>>2]=i[t+4>>2],i[o+8>>2]=i[t+8>>2],void(i[o+12>>2]=i[t+12>>2]);if(A=+y(+ +s[e+8>>3],+ +s[e>>3]),(0|n)>0){e=0;do{l*=.37796447300922725,e=e+1|0}while((0|e)!=(0|n))}a=.3333333333333333*l,r?(n=0==(0|Ze(n)),l=+m(.381966011250105*(n?a:.37796447300922725*a))):(l=+m(.381966011250105*l),0|Ze(n)&&(A=+at(A+.3334731722518321))),function(e,t,n,r){e|=0,t=+t,n=+n,r|=0;var o=0,a=0,l=0,c=0;if(n<1e-16)return i[r>>2]=i[e>>2],i[r+4>>2]=i[e+4>>2],i[r+8>>2]=i[e+8>>2],void(i[r+12>>2]=i[e+12>>2]);a=t<0?t+6.283185307179586:t,a=t>=6.283185307179586?a+-6.283185307179586:a;do{if(!(a<1e-16)){if(o=+u(+(a+-3.141592653589793))<1e-16,t=+s[e>>3],o){t-=n,s[r>>3]=t,o=r;break}if(l=+h(+n),n=+d(+n),t=l*+d(+t)+ +h(+a)*(n*+h(+t)),t=+g(+((t=t>1?1:t)<-1?-1:t)),s[r>>3]=t,+u(+(t+-1.5707963267948966))<1e-16)return s[r>>3]=1.5707963267948966,void(s[r+8>>3]=0);if(+u(+(t+1.5707963267948966))<1e-16)return s[r>>3]=-1.5707963267948966,void(s[r+8>>3]=0);if(c=1/+h(+t),a=n*+d(+a)*c,n=+s[e>>3],t=c*((l-+d(+t)*+d(+n))/+h(+n)),l=a>1?1:a,t=t>1?1:t,(t=+s[e+8>>3]+ +y(+(l<-1?-1:l),+(t<-1?-1:t)))>3.141592653589793)do{t+=-6.283185307179586}while(t>3.141592653589793);if(t<-3.141592653589793)do{t+=6.283185307179586}while(t<-3.141592653589793);return void(s[r+8>>3]=t)}t=+s[e>>3]+n,s[r>>3]=t,o=r}while(0);if(+u(+(t+-1.5707963267948966))<1e-16)return s[o>>3]=1.5707963267948966,void(s[r+8>>3]=0);if(+u(+(t+1.5707963267948966))<1e-16)return s[o>>3]=-1.5707963267948966,void(s[r+8>>3]=0);if(t=+s[e+8>>3],t>3.141592653589793)do{t+=-6.283185307179586}while(t>3.141592653589793);if(t<-3.141592653589793)do{t+=6.283185307179586}while(t<-3.141592653589793);s[r+8>>3]=t}(15600+(t<<4)|0,+at(+s[15920+(24*t|0)>>3]-A),l,o)}function Re(e,t,n){t|=0,n|=0;var r,s;r=k,k=k+16|0,se((e|=0)+4|0,s=r),Fe(s,0|i[e>>2],t,0,n),k=r}function ke(e,t,n,r,o){e|=0,t|=0,n|=0,r|=0,o|=0;var a,l,u,c,A,h,d,f,p,g,m,y,v,_,b,w,E,x,D,S,T,I,F=0,R=0,P=0,M=0,B=0,L=0;if(I=k,k=k+272|0,M=I+240|0,D=I,S=I+224|0,T=I+208|0,m=I+176|0,y=I+160|0,v=I+192|0,_=I+144|0,b=I+128|0,w=I+112|0,E=I+96|0,x=I+80|0,i[(F=I+256|0)>>2]=t,i[M>>2]=i[e>>2],i[M+4>>2]=i[e+4>>2],i[M+8>>2]=i[e+8>>2],i[M+12>>2]=i[e+12>>2],Pe(M,F,D),i[o>>2]=0,(0|(M=r+n+(5==(0|r)&1)|0))<=(0|n))k=I;else{l=S+4|0,u=m+4|0,c=n+5|0,A=16880+((a=0|i[F>>2])<<2)|0,h=16960+(a<<2)|0,d=b+8|0,f=w+8|0,p=E+8|0,g=T+4|0,P=n;e:for(;;){R=D+((0|P)%5<<4)|0,i[T>>2]=i[R>>2],i[T+4>>2]=i[R+4>>2],i[T+8>>2]=i[R+8>>2],i[T+12>>2]=i[R+12>>2];do{}while(2==(0|Me(T,a,0,1)));if((0|P)>(0|n)&0!=(0|Ze(t))){if(i[m>>2]=i[T>>2],i[m+4>>2]=i[T+4>>2],i[m+8>>2]=i[T+8>>2],i[m+12>>2]=i[T+12>>2],se(l,y),r=0|i[m>>2],F=0|i[17040+(80*r|0)+(i[S>>2]<<2)>>2],i[m>>2]=i[18640+(80*r|0)+(20*F|0)>>2],(0|(R=0|i[18640+(80*r|0)+(20*F|0)+16>>2]))>0){e=0;do{me(u),e=e+1|0}while((0|e)<(0|R))}switch(R=18640+(80*r|0)+(20*F|0)+4|0,i[v>>2]=i[R>>2],i[v+4>>2]=i[R+4>>2],i[v+8>>2]=i[R+8>>2],le(v,3*(0|i[A>>2])|0),oe(u,v,u),ie(u),se(u,_),B=+(0|i[h>>2]),s[b>>3]=3*B,s[d>>3]=0,L=-1.5*B,s[w>>3]=L,s[f>>3]=2.598076211353316*B,s[E>>3]=L,s[p>>3]=-2.598076211353316*B,0|i[17040+(80*(0|i[m>>2])|0)+(i[T>>2]<<2)>>2]){case 1:e=w,r=b;break;case 3:e=E,r=w;break;case 2:e=b,r=E;break;default:e=12;break e}Bt(y,_,r,e,x),Fe(x,0|i[m>>2],a,1,o+8+(i[o>>2]<<4)|0),i[o>>2]=1+(0|i[o>>2])}if((0|P)<(0|c)&&(se(g,m),Fe(m,0|i[T>>2],a,1,o+8+(i[o>>2]<<4)|0),i[o>>2]=1+(0|i[o>>2])),i[S>>2]=i[T>>2],i[S+4>>2]=i[T+4>>2],i[S+8>>2]=i[T+8>>2],i[S+12>>2]=i[T+12>>2],(0|(P=P+1|0))>=(0|M)){e=3;break}}3!=(0|e)?12==(0|e)&&C(26970,27017,572,27027):k=I}}function Pe(e,t,n){e|=0,t|=0,n|=0;var r,s=0,o=0,a=0,l=0,u=0;r=k,k=k+128|0,o=r,l=20240,u=(a=s=r+64|0)+60|0;do{i[a>>2]=i[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|u));l=20304,u=(a=o)+60|0;do{i[a>>2]=i[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|u));s=(u=0==(0|Ze(0|i[t>>2])))?s:o,be(o=e+4|0),we(o),0|Ze(0|i[t>>2])&&(pe(o),i[t>>2]=1+(0|i[t>>2])),i[n>>2]=i[e>>2],oe(o,s,t=n+4|0),ie(t),i[n+16>>2]=i[e>>2],oe(o,s+12|0,t=n+20|0),ie(t),i[n+32>>2]=i[e>>2],oe(o,s+24|0,t=n+36|0),ie(t),i[n+48>>2]=i[e>>2],oe(o,s+36|0,t=n+52|0),ie(t),i[n+64>>2]=i[e>>2],oe(o,s+48|0,n=n+68|0),ie(n),k=r}function Me(e,t,n,r){n|=0,r|=0;var s,o,a,l,u,c,A=0,h=0,d=0,f=0,p=0;if(c=k,k=k+32|0,u=c+12|0,o=c,p=(e|=0)+4|0,f=0|i[16960+((t|=0)<<2)>>2],f=(l=0!=(0|r))?3*f|0:f,A=0|i[p>>2],s=0|i[(a=e+8|0)>>2],l){if((0|(A=s+A+(r=0|i[(h=e+12|0)>>2])|0))==(0|f))return k=c,0|(p=1);d=h}else A=s+A+(r=0|i[(d=e+12|0)>>2])|0;if((0|A)<=(0|f))return k=c,0|(p=0);do{if((0|r)>0){if(r=0|i[e>>2],(0|s)>0){h=18640+(80*r|0)+60|0,r=e;break}r=18640+(80*r|0)+40|0,n?(ne(u,f,0,0),ae(p,u,o),ye(o),oe(o,u,p),h=r,r=e):(h=r,r=e)}else h=18640+(80*(0|i[e>>2])|0)+20|0,r=e}while(0);if(i[r>>2]=i[h>>2],(0|i[(A=h+16|0)>>2])>0){r=0;do{me(p),r=r+1|0}while((0|r)<(0|i[A>>2]))}return e=h+4|0,i[u>>2]=i[e>>2],i[u+4>>2]=i[e+4>>2],i[u+8>>2]=i[e+8>>2],t=0|i[16880+(t<<2)>>2],le(u,l?3*t|0:t),oe(p,u,p),ie(p),r=l&&((0|i[a>>2])+(0|i[p>>2])+(0|i[d>>2])|0)==(0|f)?1:2,k=c,0|(p=r)}function Be(e,t){e|=0,t|=0;var n=0;do{n=0|Me(e,t,0,1)}while(2==(0|n));return 0|n}function Le(e,t,n,r,o){e|=0,t|=0,n|=0,r|=0,o|=0;var a,l,u,c,A,h,d,f,p,g,m,y,v,_,b,w,E,x,D=0,S=0,T=0,I=0,F=0;if(x=k,k=k+240|0,_=x+208|0,b=x,w=x+192|0,E=x+176|0,p=x+160|0,g=x+144|0,m=x+128|0,y=x+112|0,v=x+96|0,i[(D=x+224|0)>>2]=t,i[_>>2]=i[e>>2],i[_+4>>2]=i[e+4>>2],i[_+8>>2]=i[e+8>>2],i[_+12>>2]=i[e+12>>2],Oe(_,D,b),i[o>>2]=0,(0|(f=r+n+(6==(0|r)&1)|0))<=(0|n))k=x;else{l=n+6|0,u=16960+((a=0|i[D>>2])<<2)|0,c=g+8|0,A=m+8|0,h=y+8|0,d=w+4|0,S=0,T=n,r=-1;e:for(;;){if(e=b+((D=(0|T)%6|0)<<4)|0,i[w>>2]=i[e>>2],i[w+4>>2]=i[e+4>>2],i[w+8>>2]=i[e+8>>2],i[w+12>>2]=i[e+12>>2],e=S,S=0|Me(w,a,0,1),(0|T)>(0|n)&0!=(0|Ze(t))&&(1!=(0|e)&&(0|i[w>>2])!=(0|r))){switch(se(b+((D+5|0)%6<<4)+4|0,E),se(b+(D<<4)+4|0,p),I=+(0|i[u>>2]),s[g>>3]=3*I,s[c>>3]=0,F=-1.5*I,s[m>>3]=F,s[A>>3]=2.598076211353316*I,s[y>>3]=F,s[h>>3]=-2.598076211353316*I,D=0|i[_>>2],0|i[17040+(80*D|0)+(((0|r)==(0|D)?i[w>>2]:r)<<2)>>2]){case 1:e=m,r=g;break;case 3:e=y,r=m;break;case 2:e=g,r=y;break;default:e=8;break e}Bt(E,p,r,e,v),0|Lt(E,v)||0|Lt(p,v)||(Fe(v,0|i[_>>2],a,1,o+8+(i[o>>2]<<4)|0),i[o>>2]=1+(0|i[o>>2]))}if((0|T)<(0|l)&&(se(d,E),Fe(E,0|i[w>>2],a,1,o+8+(i[o>>2]<<4)|0),i[o>>2]=1+(0|i[o>>2])),(0|(T=T+1|0))>=(0|f)){e=3;break}r=0|i[w>>2]}3!=(0|e)?8==(0|e)&&C(27054,27017,737,27099):k=x}}function Oe(e,t,n){e|=0,t|=0,n|=0;var r,s=0,o=0,a=0,l=0,u=0;r=k,k=k+160|0,o=r,l=20368,u=(a=s=r+80|0)+72|0;do{i[a>>2]=i[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|u));l=20448,u=(a=o)+72|0;do{i[a>>2]=i[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|u));s=(u=0==(0|Ze(0|i[t>>2])))?s:o,be(o=e+4|0),we(o),0|Ze(0|i[t>>2])&&(pe(o),i[t>>2]=1+(0|i[t>>2])),i[n>>2]=i[e>>2],oe(o,s,t=n+4|0),ie(t),i[n+16>>2]=i[e>>2],oe(o,s+12|0,t=n+20|0),ie(t),i[n+32>>2]=i[e>>2],oe(o,s+24|0,t=n+36|0),ie(t),i[n+48>>2]=i[e>>2],oe(o,s+36|0,t=n+52|0),ie(t),i[n+64>>2]=i[e>>2],oe(o,s+48|0,t=n+68|0),ie(t),i[n+80>>2]=i[e>>2],oe(o,s+60|0,n=n+84|0),ie(n),k=r}function Ne(e,t){return t=0|an(0|(e|=0),0|(t|=0),45),D(),127&t}function Ue(e,t){e|=0;var n=0,i=0,s=0,o=0;return!0&134217728==(-16777216&(t|=0))?(i=0|an(0|e,0|t,52),D(),i&=15,n=0|an(0|e,0|t,45),D(),(n&=127)>>>0>121?0|(e=0):0==(613566756&(o=0|ln(0|(s=0|an(0|e,0|t,0|(o=3*(15^i)|0))),0|D(),0|o))&(0|Jt(-1227133514,-1171,0|o,0|(s=0|D()))))&0==(4681&s&D())&&15==(0|i)|0==(0|(o=0|an(0|(0|ln(0|~e,0|~t,0|(o=19+(3*i|0)|0))),0|D(),0|o)))&0==(0|D())?0|r[20528+n|0]?0==(0|e)&0==(0|(t&=8191))?0|(o=1):(o=0|un(0|e,0|t,0),D(),0!=((63-o|0)%3|0)|0):0|(o=1):0|(o=0)):0|(e=0)}function ze(e,t,n,r){e|=0,n|=0,r|=0;var s=0,o=0,a=0,l=0;if(s=0|ln(0|(t|=0),0,52),o=0|D(),n=0|ln(0|n,0,45),n=0|o|D()|134225919,(0|t)<1)return o=-1,r=n,i[(t=e)>>2]=o,void(i[(e=e+4|0)>>2]=r);for(o=1,s=-1;l=0|ln(7,0,0|(a=3*(15-o|0)|0)),n&=~D(),s=s&~l|(a=0|ln(0|r,0,0|a)),n=0|n|D(),(0|o)!=(0|t);)o=o+1|0;i[(a=l=e)>>2]=s,i[(l=l+4|0)>>2]=n}function je(e,t,n,r){n|=0,r|=0;var s=0,o=0;if(o=0|an(0|(e|=0),0|(t|=0),52),D(),n>>>0>15)return 0|(r=4);if((0|(o&=15))<(0|n))return 0|(r=12);if((0|o)==(0|n))return i[r>>2]=e,i[r+4>>2]=t,0|(r=0);if(s=0|ln(0|n,0,52),s|=e,e=D()|-15728641&t,(0|o)>(0|n))do{t=0|ln(7,0,3*(14-n|0)|0),n=n+1|0,s|=t,e=0|D()|e}while((0|n)<(0|o));return i[r>>2]=s,i[r+4>>2]=e,0|(r=0)}function Ve(e,t,n,r){n|=0,r|=0;var s=0,o=0,a=0;if(o=0|an(0|(e|=0),0|(t|=0),52),D(),!((0|n)<16&(0|(o&=15))<=(0|n)))return 0|(r=4);s=n-o|0,n=0|an(0|e,0|t,45),D();e:do{if(0|z(127&n)){t:do{if(0|o){for(n=1;0==((a=0|ln(7,0,3*(15-n|0)|0))&e|0)&0==((0|D())&t);){if(!(n>>>0<o>>>0))break t;n=n+1|0}n=0|wt(7,0,s,((0|s)<0)<<31>>31),s=0|D();break e}}while(0);n=0|Zt(0|(n=0|nn(0|(n=0|wt(7,0,s,((0|s)<0)<<31>>31)),0|D(),5,0)),0|D(),-5,-1),n=0|Zt(0|(n=0|tn(0|n,0|D(),6,0)),0|D(),1,0),s=0|D()}else n=0|wt(7,0,s,((0|s)<0)<<31>>31),s=0|D()}while(0);return i[(a=r)>>2]=n,i[a+4>>2]=s,0|(a=0)}function Ge(e,t){var n=0,r=0,i=0;if(i=0|an(0|(e|=0),0|(t|=0),45),D(),!(0|z(127&i)))return 0|(i=0);i=0|an(0|e,0|t,52),D(),i&=15;e:do{if(i)for(r=1;;){if(n=0|an(0|e,0|t,3*(15-r|0)|0),D(),0|(n&=7))break e;if(!(r>>>0<i>>>0)){n=0;break}r=r+1|0}else n=0}while(0);return 0|(i=0==(0|n)&1)}function We(e,t,n,r){return e|=0,t|=0,(0|(r|=0))<(0|(n|=0))?(r=e,x(0|(n=t)),0|r):(n=0|ln(-1,-1,3+(3*(r-n|0)|0)|0),r=0|ln(0|~n,0|~D(),3*(15-r|0)|0),n=~D()&t,r=~r&e,x(0|n),0|r)}function He(e,t,n,r){n|=0,r|=0;var s=0;return s=0|an(0|(e|=0),0|(t|=0),52),D(),(0|n)<16&(0|(s&=15))<=(0|n)?((0|s)<(0|n)&&(s=0|ln(-1,-1,3+(3*(n+-1-s|0)|0)|0),s=0|ln(0|~s,0|~D(),3*(15-n|0)|0),t=~D()&t,e&=~s),s=0|ln(0|n,0,52),n=-15728641&t|D(),i[r>>2]=e|s,i[r+4>>2]=n,0|(r=0)):0|(r=4)}function Qe(e,t){var n=0,r=0,i=0;if(i=0|an(0|(e|=0),0|(t|=0),52),D(),!(i&=15))return 0|(i=0);for(r=1;;){if(n=0|an(0|e,0|t,3*(15-r|0)|0),D(),0|(n&=7)){r=5;break}if(!(r>>>0<i>>>0)){n=0,r=5;break}r=r+1|0}return 5==(0|r)?0|n:0}function Xe(e,t){var n=0,r=0,i=0,s=0,o=0,a=0,l=0;if(l=0|an(0|(e|=0),0|(t|=0),52),D(),!(l&=15))return l=e,x(0|(a=t)),0|l;for(a=1,n=0;;){r=0|ln(7,0,0|(s=3*(15-a|0)|0)),i=0|D(),o=0|an(0|e,0|t,0|s),D(),e=(s=0|ln(0|ve(7&o),0,0|s))|e&~r,t=(o=0|D())|t&~i;e:do{if(!n)if(0==(s&r|0)&0==(o&i|0))n=0;else if(r=0|an(0|e,0|t,52),D(),r&=15){n=1;t:for(;;){switch(o=0|an(0|e,0|t,3*(15-n|0)|0),D(),7&o){case 1:break t;case 0:break;default:n=1;break e}if(!(n>>>0<r>>>0)){n=1;break e}n=n+1|0}for(n=1;;){if(i=0|an(0|e,0|t,0|(o=3*(15-n|0)|0)),D(),s=0|ln(7,0,0|o),t&=~D(),e=e&~s|(o=0|ln(0|ve(7&i),0,0|o)),t=0|t|D(),!(n>>>0<r>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<l>>>0))break;a=a+1|0}return x(0|t),0|e}function Ye(e,t){var n=0,r=0,i=0,s=0,o=0;if(r=0|an(0|(e|=0),0|(t|=0),52),D(),!(r&=15))return r=e,x(0|(n=t)),0|r;for(n=1;o=0|an(0|e,0|t,0|(s=3*(15-n|0)|0)),D(),i=0|ln(7,0,0|s),t&=~D(),e=(s=0|ln(0|ve(7&o),0,0|s))|e&~i,t=0|D()|t,n>>>0<r>>>0;)n=n+1|0;return x(0|t),0|e}function qe(e,t){var n=0,r=0,i=0,s=0,o=0,a=0,l=0;if(l=0|an(0|(e|=0),0|(t|=0),52),D(),!(l&=15))return l=e,x(0|(a=t)),0|l;for(a=1,n=0;;){r=0|ln(7,0,0|(s=3*(15-a|0)|0)),i=0|D(),o=0|an(0|e,0|t,0|s),D(),e=(s=0|ln(0|_e(7&o),0,0|s))|e&~r,t=(o=0|D())|t&~i;e:do{if(!n)if(0==(s&r|0)&0==(o&i|0))n=0;else if(r=0|an(0|e,0|t,52),D(),r&=15){n=1;t:for(;;){switch(o=0|an(0|e,0|t,3*(15-n|0)|0),D(),7&o){case 1:break t;case 0:break;default:n=1;break e}if(!(n>>>0<r>>>0)){n=1;break e}n=n+1|0}for(n=1;;){if(s=0|ln(7,0,0|(i=3*(15-n|0)|0)),o=t&~D(),t=0|an(0|e,0|t,0|i),D(),e=e&~s|(t=0|ln(0|_e(7&t),0,0|i)),t=0|o|D(),!(n>>>0<r>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<l>>>0))break;a=a+1|0}return x(0|t),0|e}function Ke(e,t){var n=0,r=0,i=0,s=0,o=0;if(r=0|an(0|(e|=0),0|(t|=0),52),D(),!(r&=15))return r=e,x(0|(n=t)),0|r;for(n=1;s=0|ln(7,0,0|(o=3*(15-n|0)|0)),i=t&~D(),t=0|an(0|e,0|t,0|o),D(),e=(t=0|ln(0|_e(7&t),0,0|o))|e&~s,t=0|D()|i,n>>>0<r>>>0;)n=n+1|0;return x(0|t),0|e}function Ze(e){return(0|(e|=0))%2|0}function Je(e,t,n){n|=0;var r,s=0;return r=k,k=k+16|0,s=r,(t|=0)>>>0>15?(k=r,0|(s=4)):2146435072==(2146435072&i[(e|=0)+4>>2])||2146435072==(2146435072&i[e+8+4>>2])?(k=r,0|(s=3)):(function(e,t,n){var r,i;r=k,k=k+16|0,Ie(e|=0,t|=0,n|=0,i=r),re(i,n+4|0),k=r}(e,t,s),t=0|function(e,t){e|=0;var n,r=0,s=0,o=0,a=0,l=0,u=0,c=0,A=0;if(n=k,k=k+64|0,u=n+40|0,s=n+24|0,o=n+12|0,a=n,ln(0|(t|=0),0,52),r=134225919|D(),!t)return(0|i[e+4>>2])>2||(0|i[e+8>>2])>2||(0|i[e+12>>2])>2?(u=0,x(0|(l=0)),k=n,0|u):(ln(0|V(e),0,45),l=0|D()|r,u=-1,x(0|l),k=n,0|u);if(i[u>>2]=i[e>>2],i[u+4>>2]=i[e+4>>2],i[u+8>>2]=i[e+8>>2],i[u+12>>2]=i[e+12>>2],l=u+4|0,(0|t)>0)for(e=-1;i[s>>2]=i[l>>2],i[s+4>>2]=i[l+4>>2],i[s+8>>2]=i[l+8>>2],1&t?(he(l),i[o>>2]=i[l>>2],i[o+4>>2]=i[l+4>>2],i[o+8>>2]=i[l+8>>2],fe(o)):(de(l),i[o>>2]=i[l>>2],i[o+4>>2]=i[l+4>>2],i[o+8>>2]=i[l+8>>2],pe(o)),ae(s,o,a),ie(a),c=0|ln(7,0,0|(A=3*(15-t|0)|0)),r&=~D(),e=(A=0|ln(0|ue(a),0,0|A))|e&~c,r=0|D()|r,(0|t)>1;)t=t+-1|0;else e=-1;e:do{if((0|i[l>>2])<=2&&(0|i[u+8>>2])<=2&&(0|i[u+12>>2])<=2){if(t=0|ln(0|(s=0|V(u)),0,45),t|=e,e=D()|-1040385&r,a=0|G(u),!(0|z(s))){if((0|a)<=0)break;for(o=0;;){if(s=0|an(0|t,0|e,52),D(),s&=15)for(r=1;u=0|an(0|t,0|e,0|(A=3*(15-r|0)|0)),D(),c=0|ln(7,0,0|A),e&=~D(),t=t&~c|(A=0|ln(0|ve(7&u),0,0|A)),e=0|e|D(),r>>>0<s>>>0;)r=r+1|0;if((0|(o=o+1|0))==(0|a))break e}}o=0|an(0|t,0|e,52),D(),o&=15;t:do{if(o){r=1;n:for(;;){switch(A=0|an(0|t,0|e,3*(15-r|0)|0),D(),7&A){case 1:break n;case 0:break;default:break t}if(!(r>>>0<o>>>0))break t;r=r+1|0}if(0|W(s,0|i[u>>2]))for(r=1;c=0|ln(7,0,0|(u=3*(15-r|0)|0)),A=e&~D(),e=0|an(0|t,0|e,0|u),D(),t=t&~c|(e=0|ln(0|_e(7&e),0,0|u)),e=0|A|D(),r>>>0<o>>>0;)r=r+1|0;else for(r=1;u=0|an(0|t,0|e,0|(A=3*(15-r|0)|0)),D(),c=0|ln(7,0,0|A),e&=~D(),t=t&~c|(A=0|ln(0|ve(7&u),0,0|A)),e=0|e|D(),r>>>0<o>>>0;)r=r+1|0}}while(0);if((0|a)>0){r=0;do{t=0|Xe(t,e),e=0|D(),r=r+1|0}while((0|r)!=(0|a))}}else t=0,e=0}while(0);return A=t,x(0|(c=e)),k=n,0|A}(s,t),s=0|D(),i[n>>2]=t,i[n+4>>2]=s,0==(0|t)&0==(0|s)&&C(27795,27122,959,27145),k=r,0|(s=0))}function $e(e,t,n){var r,s=0,o=0,a=0;if(r=(n|=0)+4|0,o=0|an(0|(e|=0),0|(t|=0),52),D(),o&=15,a=0|an(0|e,0|t,45),D(),s=0==(0|o),0|z(127&a)){if(s)return 0|(a=1);s=1}else{if(s)return 0|(a=0);s=0==(0|i[r>>2])&&0==(0|i[n+8>>2])?0!=(0|i[n+12>>2])&1:1}for(n=1;1&n?fe(r):pe(r),a=0|an(0|e,0|t,3*(15-n|0)|0),D(),ge(r,7&a),n>>>0<o>>>0;)n=n+1|0;return 0|s}function et(e,t,n){n|=0;var r,s,o=0,a=0,l=0,u=0,c=0,A=0;if(s=k,k=k+16|0,r=s,A=0|an(0|(e|=0),0|(t|=0),45),D(),(A&=127)>>>0>121)return i[n>>2]=0,i[n+4>>2]=0,i[n+8>>2]=0,i[n+12>>2]=0,k=s,0|(A=5);e:do{if(0!=(0|z(A))&&(l=0|an(0|e,0|t,52),D(),0!=(0|(l&=15)))){o=1;t:for(;;){switch(c=0|an(0|e,0|t,3*(15-o|0)|0),D(),7&c){case 5:break t;case 0:break;default:o=t;break e}if(!(o>>>0<l>>>0)){o=t;break e}o=o+1|0}for(a=1,o=t;u=0|ln(7,0,0|(t=3*(15-a|0)|0)),c=o&~D(),o=0|an(0|e,0|o,0|t),D(),e=e&~u|(o=0|ln(0|_e(7&o),0,0|t)),o=0|c|D(),a>>>0<l>>>0;)a=a+1|0}else o=t}while(0);if(c=7696+(28*A|0)|0,i[n>>2]=i[c>>2],i[n+4>>2]=i[c+4>>2],i[n+8>>2]=i[c+8>>2],i[n+12>>2]=i[c+12>>2],!(0|$e(e,o,n)))return k=s,0|(A=0);if(u=n+4|0,i[r>>2]=i[u>>2],i[r+4>>2]=i[u+4>>2],i[r+8>>2]=i[u+8>>2],l=0|an(0|e,0|o,52),D(),c=15&l,1&l?(pe(u),l=c+1|0):l=c,0|z(A)){e:do{if(c)for(t=1;;){if(a=0|an(0|e,0|o,3*(15-t|0)|0),D(),0|(a&=7)){o=a;break e}if(!(t>>>0<c>>>0)){o=0;break}t=t+1|0}else o=0}while(0);o=4==(0|o)&1}else o=0;if(0|Me(n,l,o,0)){if(0|z(A))do{}while(0!=(0|Me(n,l,0,0)));(0|l)!=(0|c)&&de(u)}else(0|l)!=(0|c)&&(i[u>>2]=i[r>>2],i[u+4>>2]=i[r+4>>2],i[u+8>>2]=i[r+8>>2]);return k=s,0|(A=0)}function tt(e,t,n){n|=0;var r,i,s=0;return i=k,k=k+16|0,0|(s=0|et(e|=0,t|=0,r=i))?(k=i,0|s):(s=0|an(0|e,0|t,52),D(),Re(r,15&s,n),k=i,0|(s=0))}function nt(e,t,n){n|=0;var r,i=0,s=0,o=0;if(r=k,k=k+16|0,0|(i=0|et(e|=0,t|=0,o=r)))return k=r,0|(o=i);i=0|an(0|e,0|t,45),D(),i=0==(0|z(127&i)),s=0|an(0|e,0|t,52),D(),s&=15;e:do{if(!i){if(0|s)for(i=1;;){if(!(0==((0|ln(7,0,3*(15-i|0)|0))&e|0)&0==((0|D())&t)))break e;if(!(i>>>0<s>>>0))break;i=i+1|0}return ke(o,s,0,5,n),k=r,0|0}}while(0);return Le(o,s,0,6,n),k=r,0|0}function rt(e,t){t|=0;var n=0,r=0,s=0,o=0,a=0,l=0,u=0;if((e|=0)>>>0>15)return 0|(l=4);if(ln(0|e,0,52),l=134225919|D(),!e){n=0,r=0;do{0|z(r)&&(ln(0|r,0,45),a=0|l|D(),i[(e=t+(n<<3)|0)>>2]=-1,i[e+4>>2]=a,n=n+1|0),r=r+1|0}while(122!=(0|r));return 0|(n=0)}n=0,a=0;do{if(0|z(a)){for(ln(0|a,0,45),r=1,s=-1,o=0|l|D();s&=~(u=0|ln(7,0,3*(15-r|0)|0)),o&=~D(),(0|r)!=(0|e);)r=r+1|0;i[(u=t+(n<<3)|0)>>2]=s,i[u+4>>2]=o,n=n+1|0}a=a+1|0}while(122!=(0|a));return 0|(n=0)}function it(e,t,n,r){e|=0,r|=0;var s=0,o=0,a=0;s=0|an(0|(t|=0),0|(n|=0),52),D(),0==(0|t)&0==(0|n)|(0|r)>15|(0|(s&=15))>(0|r)?(o=-1,t=-1,n=0,s=0):(t=0|We(t,n,s+1|0,r),a=-15728641&D(),n=0|ln(0|r,0,52),o=s,t=(t=0==(0|Ge(n|=t,a=0|a|D())))?-1:r,s=a),i[(a=e)>>2]=n,i[a+4>>2]=s,i[e+8>>2]=o,i[e+12>>2]=t}function st(e,t,n,r){n|=0,r|=0;var s=0,o=0;return s=0|an(0|(e|=0),0|(t|=0),52),D(),s&=15,i[(o=r+8|0)>>2]=s,0==(0|e)&0==(0|t)|(0|n)>15|(0|s)>(0|n)?(i[(n=r)>>2]=0,i[n+4>>2]=0,i[o>>2]=-1,void(i[r+12>>2]=-1)):(e=0|We(e,t,s+1|0,n),o=-15728641&D(),s=0|ln(0|n,0,52),s|=e,o=0|o|D(),i[(e=r)>>2]=s,i[e+4>>2]=o,e=r+12|0,0|Ge(s,o)?void(i[e>>2]=n):void(i[e>>2]=-1))}function ot(e){var t,n=0,r=0,s=0,o=0,a=0,l=0,u=0,c=0;if(!(0==(0|(n=0|i[(r=e|=0)>>2]))&0==(0|(r=0|i[r+4>>2])))&&(s=0|an(0|n,0|r,52),D(),n=0|Zt(0|(u=0|ln(1,0,3*(15^(s&=15))|0)),0|D(),0|n,0|r),r=0|D(),i[(u=e)>>2]=n,i[u+4>>2]=r,!((0|s)<(0|(l=0|i[(u=e+8|0)>>2]))))){for(t=e+12|0,a=s;;){if((0|a)==(0|l)){s=5;break}if(c=(0|a)==(0|i[t>>2]),s=0|an(0|n,0|r,0|(o=3*(15-a|0)|0)),D(),c&1==(0|(s&=7))&!0){s=7;break}if(!(7==(0|s)&!0)){s=10;break}if(n=0|Zt(0|n,0|r,0|(c=0|ln(1,0,0|o)),0|D()),r=0|D(),i[(c=e)>>2]=n,i[c+4>>2]=r,!((0|a)>(0|l))){s=10;break}a=a+-1|0}if(5==(0|s))return i[(c=e)>>2]=0,i[c+4>>2]=0,i[u>>2]=-1,void(i[t>>2]=-1);if(7==(0|s))return l=0|Zt(0|n,0|r,0|(l=0|ln(1,0,0|o)),0|D()),u=0|D(),i[(c=e)>>2]=l,i[c+4>>2]=u,void(i[t>>2]=a+-1)}}function at(e){var t;return t=(e=+e)<0?e+6.283185307179586:e,+(e>=6.283185307179586?t+-6.283185307179586:t)}function lt(e,t){return t|=0,+u(+(+s[(e|=0)>>3]-+s[t>>3]))<17453292519943298e-27?0|(t=+u(+(+s[e+8>>3]-+s[t+8>>3]))<17453292519943298e-27):0|(t=0)}function ut(e,t){switch(e=+e,0|(t|=0)){case 1:e=e<0?e+6.283185307179586:e;break;case 2:e=e>0?e+-6.283185307179586:e}return+e}function ct(e,t){e|=0;var n,r,i,o=0;return r=+s[(t|=0)>>3],n=+s[e>>3],o=(i=+d(.5*(r-n)))*i+(o=+d(.5*(+s[t+8>>3]-+s[e+8>>3])))*(+h(+r)*+h(+n)*o),2*+y(+ +c(+o),+ +c(+(1-o)))*6371.007180918475}function At(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(s[t>>3]=+s[20656+(e<<3)>>3],0|(t=0))}function ht(e,t){t|=0;var n=0;return(e|=0)>>>0>15?0|(t=4):(n=0|nn(0|(n=0|wt(7,0,e,((0|e)<0)<<31>>31)),0|D(),120,0),e=0|D(),i[t>>2]=2|n,i[t+4>>2]=e,0|(t=0))}function dt(e,t,n){e|=0,n|=0;var r,i,o,a,l=0,u=0,A=0,p=0,g=0,v=0;return v=+s[(t|=0)>>3],o=+s[e>>3],g=+d(.5*(v-o)),A=+s[t+8>>3],i=+s[e+8>>3],p=+d(.5*(A-i)),r=+h(+o),a=+h(+v),p=2*+y(+ +c(+(p=g*g+p*(a*r*p))),+ +c(+(1-p))),g=+s[n>>3],v=+d(.5*(g-v)),l=+s[n+8>>3],A=+d(.5*(l-A)),u=+h(+g),A=2*+y(+ +c(+(A=v*v+A*(a*u*A))),+ +c(+(1-A))),g=+d(.5*(o-g)),l=+d(.5*(i-l)),l=2*+y(+ +c(+(l=g*g+l*(r*u*l))),+ +c(+(1-l))),4*+m(+ +c(+ +f(.5*(u=.5*(p+A+l)))*+f(.5*(u-p))*+f(.5*(u-A))*+f(.5*(u-l))))}function ft(e,t,n){n|=0;var r,o,a,l=0,u=0;if(a=k,k=k+192|0,o=a,0|(u=0|tt(e|=0,t|=0,r=a+168|0)))return k=a,0|(n=u);if(0|nt(e,t,o)&&C(27795,27190,415,27199),(0|(t=0|i[o>>2]))>0){if(l=+dt(o+8|0,o+8+((1!=(0|t)&1)<<4)|0,r)+0,1!=(0|t)){e=1;do{l+=+dt(o+8+((u=e)<<4)|0,o+8+((0|(e=e+1|0))%(0|t)<<4)|0,r)}while((0|e)<(0|t))}}else l=0;return s[n>>3]=l,k=a,0|(n=0)}function pt(e){e|=0;var t,n,r=0;return(t=0|Kt(1,12))||C(27280,27235,49,27293),0|(r=0|i[(n=e+4|0)>>2])?(i[(r=r+8|0)>>2]=t,i[n>>2]=t,0|t):(0|i[e>>2]&&C(27310,27235,61,27333),i[(r=e)>>2]=t,i[n>>2]=t,0|t)}function gt(e,t){e|=0,t|=0;var n,r;return(r=0|Yt(24))||C(27347,27235,78,27361),i[r>>2]=i[t>>2],i[r+4>>2]=i[t+4>>2],i[r+8>>2]=i[t+8>>2],i[r+12>>2]=i[t+12>>2],i[r+16>>2]=0,0|(n=0|i[(t=e+4|0)>>2])?(i[n+16>>2]=r,i[t>>2]=r,0|r):(0|i[e>>2]&&C(27376,27235,82,27361),i[e>>2]=r,i[t>>2]=r,0|r)}function mt(e){var t=0,n=0,r=0,s=0;if(e|=0)for(r=1;;){if(0|(t=0|i[e>>2]))do{if(0|(n=0|i[t>>2]))do{s=n,n=0|i[n+16>>2],qt(s)}while(0!=(0|n));s=t,t=0|i[t+8>>2],qt(s)}while(0!=(0|t));if(t=e,e=0|i[e+8>>2],r||qt(t),!e)break;r=0}}function yt(e){var t,n,r=0,o=0,a=0,l=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0,b=0,w=0,E=0,x=0,D=0,S=0,T=0,I=0,F=0,R=0,k=0,P=0,M=0,B=0,L=0;if(0|i[(l=(e|=0)+8|0)>>2])return 0|(L=1);if(!(a=0|i[e>>2]))return 0|(L=0);r=a,o=0;do{o=o+1|0,r=0|i[r+8>>2]}while(0!=(0|r));if(o>>>0<2)return 0|(L=0);(n=0|Yt(o<<2))||C(27396,27235,317,27415),(t=0|Yt(o<<5))||C(27437,27235,321,27415),i[e>>2]=0,i[(T=e+4|0)>>2]=0,i[l>>2]=0,o=0,M=0,S=0,g=0;e:for(;;){if(p=0|i[a>>2]){c=0,A=p;do{if(d=+s[A+8>>3],r=A,A=0|i[A+16>>2],h=+s[(l=(f=0==(0|A))?p:A)+8>>3],+u(+(d-h))>3.141592653589793){L=14;break}c+=(h-d)*(+s[r>>3]+ +s[l>>3])}while(!f);if(14==(0|L)){L=0,c=0,r=p;do{D=+s[r+8>>3],k=0|i[(P=r+16|0)>>2],x=+s[(k=0==(0|k)?p:k)+8>>3],c+=(+s[r>>3]+ +s[k>>3])*((x<0?x+6.283185307179586:x)-(D<0?D+6.283185307179586:D)),r=0|i[(0==(0|r)?a:P)>>2]}while(0!=(0|r))}c>0?(i[n+(M<<2)>>2]=a,M=M+1|0,l=S,r=g):L=19}else L=19;if(19==(0|L)){L=0;do{if(!o){if(g){l=T,A=g+8|0,r=a,o=e;break}if(0|i[e>>2]){L=27;break e}l=T,A=e,r=a,o=e;break}if(0|i[(r=o+8|0)>>2]){L=21;break e}if(!(o=0|Kt(1,12))){L=23;break e}i[r>>2]=o,l=o+4|0,A=o,r=g}while(0);if(i[A>>2]=a,i[l>>2]=a,A=t+(S<<5)|0,f=0|i[a>>2]){for(s[(p=t+(S<<5)+8|0)>>3]=17976931348623157e292,s[(g=t+(S<<5)+24|0)>>3]=17976931348623157e292,s[A>>3]=-17976931348623157e292,s[(m=t+(S<<5)+16|0)>>3]=-17976931348623157e292,w=17976931348623157e292,E=-17976931348623157e292,l=0,y=f,d=17976931348623157e292,_=17976931348623157e292,b=-17976931348623157e292,h=-17976931348623157e292;c=+s[y>>3],D=+s[y+8>>3],y=0|i[y+16>>2],x=+s[((v=0==(0|y))?f:y)+8>>3],c<d&&(s[p>>3]=c,d=c),D<_&&(s[g>>3]=D,_=D),c>b?s[A>>3]=c:c=b,D>h&&(s[m>>3]=D,h=D),w=D>0&D<w?D:w,E=D<0&D>E?D:E,l|=+u(+(D-x))>3.141592653589793,!v;)b=c;l&&(s[m>>3]=E,s[g>>3]=w)}else i[A>>2]=0,i[A+4>>2]=0,i[A+8>>2]=0,i[A+12>>2]=0,i[A+16>>2]=0,i[A+20>>2]=0,i[A+24>>2]=0,i[A+28>>2]=0;l=S+1|0}if(a=0|i[(P=a+8|0)>>2],i[P>>2]=0,!a){L=45;break}S=l,g=r}if(21==(0|L))C(27213,27235,35,27247);else if(23==(0|L))C(27267,27235,37,27247);else if(27==(0|L))C(27310,27235,61,27333);else if(45==(0|L)){e:do{if((0|M)>0){for(P=0==(0|l),R=l<<2,k=0==(0|e),F=0,r=0;;){if(I=0|i[n+(F<<2)>>2],P)L=73;else{if(!(S=0|Yt(R))){L=50;break}if(!(T=0|Yt(R))){L=52;break}t:do{if(k)o=0;else{for(l=0,o=0,A=e;a=t+(l<<5)|0,0|vt(0|i[A>>2],a,0|i[I>>2])?(i[S+(o<<2)>>2]=A,i[T+(o<<2)>>2]=a,v=o+1|0):v=o,A=0|i[A+8>>2];)l=l+1|0,o=v;if((0|v)>0)if(a=0|i[S>>2],1==(0|v))o=a;else for(m=0,y=-1,o=a,g=a;;){for(f=0|i[g>>2],a=0,A=0;p=(0|(l=0|i[i[S+(A<<2)>>2]>>2]))==(0|f)?a:a+(1&vt(l,0|i[T+(A<<2)>>2],0|i[f>>2]))|0,(0|(A=A+1|0))!=(0|v);)a=p;if(o=(l=(0|p)>(0|y))?g:o,(0|(a=m+1|0))==(0|v))break t;m=a,y=l?p:y,g=0|i[S+(a<<2)>>2]}else o=0}}while(0);if(qt(S),qt(T),o){if(a=0|i[(l=o+4|0)>>2])o=a+8|0;else if(0|i[o>>2]){L=70;break}i[o>>2]=I,i[l>>2]=I}else L=73}if(73==(0|L)){if(L=0,0|(r=0|i[I>>2]))do{T=r,r=0|i[r+16>>2],qt(T)}while(0!=(0|r));qt(I),r=1}if((0|(F=F+1|0))>=(0|M)){B=r;break e}}50==(0|L)?C(27452,27235,249,27471):52==(0|L)?C(27490,27235,252,27471):70==(0|L)&&C(27310,27235,61,27333)}else B=0}while(0);return qt(n),qt(t),0|(L=B)}return 0}function vt(e,t,n){e|=0;var r=0,o=0,a=0,l=0,u=0,c=0,A=0,h=0;if(!(0|K(t|=0,n|=0)))return 0|(e=0);if(t=0|Y(t),r=+s[n>>3],o=t&(o=+s[n+8>>3])<0?o+6.283185307179586:o,!(e=0|i[e>>2]))return 0|(e=0);if(t){t=0,A=o,n=e;e:for(;;){for(;l=+s[n>>3],o=+s[n+8>>3],h=0|i[(n=n+16|0)>>2],a=+s[(h=0==(0|h)?e:h)>>3],u=+s[h+8>>3],l>a?(c=l,l=u):(c=a,a=l,l=o,o=u),(r=r==a|r==c?r+2220446049250313e-31:r)<a|r>c;)if(!(n=0|i[n>>2])){n=22;break e}if(((c=(u=l<0?l+6.283185307179586:l)+(r-a)/(c-a)*((l=o<0?o+6.283185307179586:o)-u))<0?c+6.283185307179586:c)>(A=u==A|l==A?A+-2220446049250313e-31:A)&&(t^=1),!(n=0|i[n>>2])){n=22;break}}if(22==(0|n))return 0|t}else{t=0,A=o,n=e;e:for(;;){for(;l=+s[n>>3],o=+s[n+8>>3],h=0|i[(n=n+16|0)>>2],a=+s[(h=0==(0|h)?e:h)>>3],u=+s[h+8>>3],l>a?(c=l,l=u):(c=a,a=l,l=o,o=u),(r=r==a|r==c?r+2220446049250313e-31:r)<a|r>c;)if(!(n=0|i[n>>2])){n=22;break e}if(l+(r-a)/(c-a)*(o-l)>(A=l==A|o==A?A+-2220446049250313e-31:A)&&(t^=1),!(n=0|i[n>>2])){n=22;break}}if(22==(0|n))return 0|t}return 0}function _t(e,t,n,s,o){n|=0,s|=0,o|=0;var a,l,u,c,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0;if(c=k,k=k+32|0,_=c+16|0,u=c,A=0|an(0|(e|=0),0|(t|=0),52),D(),A&=15,m=0|an(0|n,0|s,52),D(),(0|A)!=(15&m))return k=c,0|(_=12);if(p=0|an(0|e,0|t,45),D(),p&=127,g=0|an(0|n,0|s,45),D(),p>>>0>121|(g&=127)>>>0>121)return k=c,0|(_=5);if(m=(0|p)!=(0|g)){if(7==(0|(d=0|Q(p,g))))return k=c,0|(_=1);7==(0|(f=0|Q(g,p)))?C(27514,27538,161,27548):(y=d,h=f)}else y=0,h=0;a=0|z(p),l=0|z(g),i[_>>2]=0,i[_+4>>2]=0,i[_+8>>2]=0,i[_+12>>2]=0;do{if(y){if(d=(0|(g=0|i[4272+(28*p|0)+(y<<2)>>2]))>0,l)if(d){p=0,f=n,d=s;do{f=0|qe(f,d),d=0|D(),1==(0|(h=0|_e(h)))&&(h=0|_e(1)),p=p+1|0}while((0|p)!=(0|g));g=h,p=f,f=d}else g=h,p=n,f=s;else if(d){p=0,f=n,d=s;do{f=0|Ke(f,d),d=0|D(),h=0|_e(h),p=p+1|0}while((0|p)!=(0|g));g=h,p=f,f=d}else g=h,p=n,f=s;if($e(p,f,_),m||C(27563,27538,191,27548),(d=0!=(0|a))&(h=0!=(0|l))&&C(27590,27538,192,27548),d){if(7==(0|(h=0|Qe(e,t)))){A=5;break}if(0|r[22e3+(7*h|0)+y|0]){A=1;break}p=f=0|i[21168+(28*h|0)+(y<<2)>>2]}else if(h){if(7==(0|(h=0|Qe(p,f)))){A=5;break}if(0|r[22e3+(7*h|0)+g|0]){A=1;break}p=0,f=0|i[21168+(28*g|0)+(h<<2)>>2]}else p=0,f=0;if((p|f|0)<0)A=5;else{if((0|f)>0){d=_+4|0,h=0;do{ye(d),h=h+1|0}while((0|h)!=(0|f))}if(i[u>>2]=0,i[u+4>>2]=0,i[u+8>>2]=0,ge(u,y),0|A)for(;0|Ze(A)?fe(u):pe(u),(0|A)>1;)A=A+-1|0;if((0|p)>0){A=0;do{ye(u),A=A+1|0}while((0|A)!=(0|p))}oe(v=_+4|0,u,v),ie(v),v=51}}else if($e(n,s,_),0!=(0|a)&0!=(0|l))if((0|g)!=(0|p)&&C(27621,27538,261,27548),7==(0|(h=0|Qe(e,t)))|7==(0|(A=0|Qe(n,s))))A=5;else if(0|r[22e3+(7*h|0)+A|0])A=1;else if((0|(h=0|i[21168+(28*h|0)+(A<<2)>>2]))>0){d=_+4|0,A=0;do{ye(d),A=A+1|0}while((0|A)!=(0|h));v=51}else v=51;else v=51}while(0);return 51==(0|v)&&(A=_+4|0,i[o>>2]=i[A>>2],i[o+4>>2]=i[A+4>>2],i[o+8>>2]=i[A+8>>2],A=0),k=c,0|(_=A)}function bt(e,t,n,r){n|=0,r|=0;var s,o,a,l=0,u=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0;if(a=k,k=k+48|0,s=a+36|0,c=a+24|0,A=a+12|0,h=a,l=0|an(0|(e|=0),0|(t|=0),52),D(),l&=15,f=0|an(0|e,0|t,45),D(),(f&=127)>>>0>121)return k=a,0|(r=5);if(o=0|z(f),ln(0|l,0,52),m=134225919|D(),i[(u=r)>>2]=-1,i[u+4>>2]=m,!l)return 7==(0|(l=0|ue(n)))||127==(0|(l=0|H(f,l)))?(k=a,0|(m=1)):(p=0|ln(0|l,0,45),g=0|D(),g=-1040385&i[(f=r)+4>>2]|g,i[(m=r)>>2]=i[f>>2]|p,i[m+4>>2]=g,k=a,0|(m=0));for(i[s>>2]=i[n>>2],i[s+4>>2]=i[n+4>>2],i[s+8>>2]=i[n+8>>2],n=l;;){if(u=n,n=n+-1|0,i[c>>2]=i[s>>2],i[c+4>>2]=i[s+4>>2],i[c+8>>2]=i[s+8>>2],0|Ze(u)){if(0|(l=0|ce(s))){n=13;break}i[A>>2]=i[s>>2],i[A+4>>2]=i[s+4>>2],i[A+8>>2]=i[s+8>>2],fe(A)}else{if(0|(l=0|Ae(s))){n=13;break}i[A>>2]=i[s>>2],i[A+4>>2]=i[s+4>>2],i[A+8>>2]=i[s+8>>2],pe(A)}if(ae(c,A,h),ie(h),v=0|i[(l=r)>>2],l=0|i[l+4>>2],y=0|ln(7,0,0|(_=3*(15-u|0)|0)),l&=~D(),_=0|ln(0|ue(h),0,0|_),l=0|D()|l,i[(m=r)>>2]=_|v&~y,i[m+4>>2]=l,(0|u)<=1){n=14;break}}e:do{if(13!=(0|n)&&14==(0|n))if((0|i[s>>2])<=1&&(0|i[s+4>>2])<=1&&(0|i[s+8>>2])<=1){h=127==(0|(l=0|H(f,n=0|ue(s))))?0:0|z(l);t:do{if(n){if(o){if(7==(0|(l=0|Qe(e,t)))){l=5;break e}if((0|(u=0|i[21376+(28*l|0)+(n<<2)>>2]))>0){l=n,n=0;do{l=0|ve(l),n=n+1|0}while((0|n)!=(0|u))}else l=n;if(1==(0|l)){l=9;break e}127==(0|(n=0|H(f,l)))&&C(27648,27538,411,27678),0|z(n)?C(27693,27538,412,27678):(g=n,p=u,d=l)}else g=l,p=0,d=n;if((0|(A=0|i[4272+(28*f|0)+(d<<2)>>2]))<=-1&&C(27724,27538,419,27678),!h){if((0|p)<0){l=5;break e}if(0|p){l=0,n=0|i[(u=r)>>2],u=0|i[u+4>>2];do{n=0|Ye(n,u),u=0|D(),i[(_=r)>>2]=n,i[_+4>>2]=u,l=l+1|0}while((0|l)<(0|p))}if((0|A)<=0){l=g,n=58;break}for(l=0,n=0|i[(u=r)>>2],u=0|i[u+4>>2];;)if(n=0|Ye(n,u),u=0|D(),i[(_=r)>>2]=n,i[_+4>>2]=u,(0|(l=l+1|0))==(0|A)){l=g,n=58;break t}}if(7==(0|(c=0|Q(g,f)))&&C(27514,27538,428,27678),n=0|i[(l=r)>>2],l=0|i[l+4>>2],(0|A)>0){u=0;do{n=0|Ye(n,l),l=0|D(),i[(_=r)>>2]=n,i[_+4>>2]=l,u=u+1|0}while((0|u)!=(0|A))}if(7==(0|(l=0|Qe(n,l)))&&C(27795,27538,440,27678),n=0|j(g),(0|(n=0|i[(n?21792:21584)+(28*c|0)+(l<<2)>>2]))<0&&C(27795,27538,454,27678),n){l=0,u=0|i[(c=r)>>2],c=0|i[c+4>>2];do{u=0|Xe(u,c),c=0|D(),i[(_=r)>>2]=u,i[_+4>>2]=c,l=l+1|0}while((0|l)<(0|n));l=g,n=58}else l=g,n=58}else if(0!=(0|o)&0!=(0|h)){if(7==(0|(n=0|Qe(e,t)))|7==(0|(u=0|Qe(0|i[(u=r)>>2],0|i[u+4>>2])))){l=5;break e}if((0|(u=0|i[21376+(28*n|0)+(u<<2)>>2]))<0){l=5;break e}if(u){n=0,c=0|i[(A=r)>>2],A=0|i[A+4>>2];do{c=0|Ye(c,A),A=0|D(),i[(_=r)>>2]=c,i[_+4>>2]=A,n=n+1|0}while((0|n)<(0|u));n=58}else n=59}else n=58}while(0);if(58==(0|n)&&h&&(n=59),59==(0|n)&&1==(0|Qe(0|i[(_=r)>>2],0|i[_+4>>2]))){l=9;break}y=0|i[(_=r)>>2],_=-1040385&i[_+4>>2],v=0|ln(0|l,0,45),_=0|_|D(),i[(l=r)>>2]=y|v,i[l+4>>2]=_,l=0}else l=1}while(0);return k=a,0|(_=l)}function wt(e,t,n,r){e|=0,t|=0;var i=0,s=0,o=0;if(0==(0|(n|=0))&0==(0|(r|=0)))return s=1,x(0|(i=0)),0|s;s=e,i=t,e=1,t=0;do{e=0|nn(0|((o=0==(1&n)&!0)?1:s),0|(o?0:i),0|e,0|t),t=0|D(),n=0|on(0|n,0|r,1),r=0|D(),s=0|nn(0|s,0|i,0|s,0|i),i=0|D()}while(!(0==(0|n)&0==(0|r)));return x(0|t),0|e}function Et(e,t,n,r){n|=0,r|=0;var o,a=0,l=0,u=0,c=0,A=0,d=0;o=k,k=k+16|0,l=o,u=0|an(0|(e|=0),0|(t|=0),52),D(),u&=15;do{if(u){if(!(a=0|tt(e,t,l))){A=+s[l>>3],c=1/+h(+A),d=+s[25968+(u<<3)>>3],s[n>>3]=A+d,s[n+8>>3]=A-d,A=+s[l+8>>3],c*=d,s[n+16>>3]=c+A,s[n+24>>3]=A-c;break}return k=o,0|(u=a)}if(a=0|an(0|e,0|t,45),D(),(a&=127)>>>0>121)return k=o,0|(u=5);l=22064+(a<<5)|0,i[n>>2]=i[l>>2],i[n+4>>2]=i[l+4>>2],i[n+8>>2]=i[l+8>>2],i[n+12>>2]=i[l+12>>2],i[n+16>>2]=i[l+16>>2],i[n+20>>2]=i[l+20>>2],i[n+24>>2]=i[l+24>>2],i[n+28>>2]=i[l+28>>2];break}while(0);return function(e,t){t=+t;var n,r,i,o,a,l,u,c=0,A=0;c=(o=+s[(i=16+(e|=0)|0)>>3])-(r=+s[(n=e+24|0)>>3]),c=o<r?c+6.283185307179586:c,A=+s[e>>3],c=.5*(c*t-c),A+=t=.5*((u=A-(l=+s[(a=e+8|0)>>3]))*t-u),s[e>>3]=A>1.5707963267948966?1.5707963267948966:A,t=l-t,s[a>>3]=t<-1.5707963267948966?-1.5707963267948966:t,t=(t=o+c)>3.141592653589793?t+-6.283185307179586:t,s[i>>3]=t<-3.141592653589793?t+6.283185307179586:t,t=(t=r-c)>3.141592653589793?t+-6.283185307179586:t,s[n>>3]=t<-3.141592653589793?t+6.283185307179586:t}(n,r?1.4:1.1),(0|i[(r=26096+(u<<3)|0)>>2])==(0|e)&&(0|i[r+4>>2])==(0|t)&&(s[n>>3]=1.5707963267948966),(0|i[(u=26224+(u<<3)|0)>>2])==(0|e)&&(0|i[u+4>>2])==(0|t)&&(s[n+8>>3]=-1.5707963267948966),1.5707963267948966!=+s[n>>3]&&-1.5707963267948966!=+s[n+8>>3]?(k=o,0|(u=0)):(s[n+16>>3]=3.141592653589793,s[n+24>>3]=-3.141592653589793,k=o,0|(u=0))}function xt(e,t,n,s){e|=0,t|=0,n|=0,s|=0;var o,a,l,u=0,c=0,A=0,h=0;l=k,k=k+48|0,o=l+40|0,a=l,ze(c=l+32|0,0,0,0),A=0|i[c>>2],c=0|i[c+4>>2];do{if(n>>>0<=15){if(0|(u=0|It(s))){i[(s=a)>>2]=0,i[s+4>>2]=0,i[a+8>>2]=u,i[a+12>>2]=-1,A=a+29|0,i[(s=a+16|0)>>2]=0,i[s+4>>2]=0,i[s+8>>2]=0,r[s+12|0]=0,r[A|0]=0|r[o|0],r[A+1|0]=0|r[o+1|0],r[A+2|0]=0|r[o+2|0];break}if(u=0|Kt(1+(0|i[t+8>>2])|0,32)){Ft(t,u),i[(h=a)>>2]=A,i[h+4>>2]=c,i[a+8>>2]=0,i[a+12>>2]=n,i[a+16>>2]=s,i[a+20>>2]=t,i[a+24>>2]=u,r[a+28|0]=0,r[(A=a+29|0)|0]=0|r[o|0],r[A+1|0]=0|r[o+1|0],r[A+2|0]=0|r[o+2|0];break}i[(s=a)>>2]=0,i[s+4>>2]=0,i[a+8>>2]=13,i[a+12>>2]=-1,A=a+29|0,i[(s=a+16|0)>>2]=0,i[s+4>>2]=0,i[s+8>>2]=0,r[s+12|0]=0,r[A|0]=0|r[o|0],r[A+1|0]=0|r[o+1|0],r[A+2|0]=0|r[o+2|0];break}i[(A=a)>>2]=0,i[A+4>>2]=0,i[a+8>>2]=4,i[a+12>>2]=-1,h=a+29|0,i[(A=a+16|0)>>2]=0,i[A+4>>2]=0,i[A+8>>2]=0,r[A+12|0]=0,r[h|0]=0|r[o|0],r[h+1|0]=0|r[o+1|0],r[h+2|0]=0|r[o+2|0]}while(0);Dt(a),i[e>>2]=i[a>>2],i[e+4>>2]=i[a+4>>2],i[e+8>>2]=i[a+8>>2],i[e+12>>2]=i[a+12>>2],i[e+16>>2]=i[a+16>>2],i[e+20>>2]=i[a+20>>2],i[e+24>>2]=i[a+24>>2],i[e+28>>2]=i[a+28>>2],k=l}function Dt(e){var t,n,s,o,a=0,l=0,u=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0,b=0,w=0;if(o=k,k=k+336|0,t=o+168|0,n=o,0==(0|(l=0|i[(u=e|=0)>>2]))&0==(0|(u=0|i[u+4>>2])))k=o;else{if(0|r[(a=e+28|0)|0]?(l=0|Ct(l,u),u=0|D()):r[a|0]=1,!(0|i[i[(s=e+20|0)>>2]>>2]))return 0|(l=0|i[(a=e+24|0)>>2])&&qt(l),i[(w=e)>>2]=0,i[w+4>>2]=0,i[e+8>>2]=0,i[s>>2]=0,i[e+12>>2]=-1,i[e+16>>2]=0,i[a>>2]=0,void(k=o);c=15&(a=0|i[(w=e+16|0)>>2]);e:do{if(0==(0|l)&0==(0|u))b=e+24|0;else{v=e+12|0,m=3==(0|c),g=255&a,f=3==(1|c),y=e+24|0,p=(c+-1|0)>>>0<3,h=3==(2|c),d=n+8|0;t:for(;;){if(A=0|an(0|l,0|u,52),D(),(0|(A&=15))==(0|i[v>>2])){switch(15&g){case 0:case 2:case 3:if(0|(c=0|tt(l,u,t))){_=15;break t}if(0|Rt(0|i[s>>2],0|i[y>>2],t)){_=19;break t}}if(f&&(c=0|i[4+(0|i[s>>2])>>2],i[t>>2]=i[c>>2],i[t+4>>2]=i[c+4>>2],i[t+8>>2]=i[c+8>>2],i[t+12>>2]=i[c+12>>2],0|K(26832,t))){if(0|Je(0|i[4+(0|i[s>>2])>>2],A,n)){_=25;break}if((0|i[(c=n)>>2])==(0|l)&&(0|i[c+4>>2])==(0|u)){_=29;break}}if(p){if(0|(c=0|nt(l,u,t))){_=32;break}if(0|Et(l,u,n,0)){_=36;break}if(h&&0|kt(0|i[s>>2],0|i[y>>2],t,n)){_=42;break}if(f&&0|Mt(0|i[s>>2],0|i[y>>2],t,n)){_=42;break}}if(m){if(a=0|Et(l,u,t,1),c=0|i[y>>2],0|a){_=45;break}if(0|Z(c,t)){if($(n,t),0|J(t,0|i[y>>2])){_=53;break}if(0|Rt(0|i[s>>2],0|i[y>>2],d)){_=53;break}if(0|Mt(0|i[s>>2],0|i[y>>2],n,t)){_=53;break}}}}do{if((0|A)<(0|i[v>>2])){if(a=0|Et(l,u,t,1),c=0|i[y>>2],0|a){_=58;break t}if(!(0|Z(c,t))){_=73;break}if(0|J(0|i[y>>2],t)&&($(n,t),0|kt(0|i[s>>2],0|i[y>>2],n,t))){_=65;break t}if(0|(l=0|He(l,u,A+1|0,n))){_=67;break t}l=0|i[(u=n)>>2],u=0|i[u+4>>2]}else _=73}while(0);if(73==(0|_)&&(_=0,l=0|Ct(l,u),u=0|D()),0==(0|l)&0==(0|u)){b=y;break e}}switch(0|_){case 15:0|(a=0|i[y>>2])&&qt(a),i[(_=e)>>2]=0,i[_+4>>2]=0,i[s>>2]=0,i[v>>2]=-1,i[w>>2]=0,i[y>>2]=0,i[e+8>>2]=c,_=20;break;case 19:i[e>>2]=l,i[e+4>>2]=u,_=20;break;case 25:C(27795,27761,470,27772);break;case 29:case 42:return i[e>>2]=l,i[e+4>>2]=u,void(k=o);case 32:return 0|(a=0|i[y>>2])&&qt(a),i[(b=e)>>2]=0,i[b+4>>2]=0,i[s>>2]=0,i[v>>2]=-1,i[w>>2]=0,i[y>>2]=0,i[e+8>>2]=c,void(k=o);case 36:C(27795,27761,493,27772);break;case 45:0|c&&qt(c),i[(_=e)>>2]=0,i[_+4>>2]=0,i[s>>2]=0,i[v>>2]=-1,i[w>>2]=0,i[y>>2]=0,i[e+8>>2]=a,_=55;break;case 53:i[e>>2]=l,i[e+4>>2]=u,_=55;break;case 58:0|c&&qt(c),i[(_=e)>>2]=0,i[_+4>>2]=0,i[s>>2]=0,i[v>>2]=-1,i[w>>2]=0,i[y>>2]=0,i[e+8>>2]=a,_=71;break;case 65:i[e>>2]=l,i[e+4>>2]=u,_=71;break;case 67:return 0|(a=0|i[y>>2])&&qt(a),i[(b=e)>>2]=0,i[b+4>>2]=0,i[s>>2]=0,i[v>>2]=-1,i[w>>2]=0,i[y>>2]=0,i[e+8>>2]=l,void(k=o)}if(20==(0|_))return void(k=o);if(55==(0|_))return void(k=o);if(71==(0|_))return void(k=o)}}while(0);0|(a=0|i[b>>2])&&qt(a),i[(_=e)>>2]=0,i[_+4>>2]=0,i[e+8>>2]=0,i[s>>2]=0,i[e+12>>2]=-1,i[w>>2]=0,i[b>>2]=0,k=o}}function Ct(e,t){var n,r=0,s=0,o=0,a=0,l=0,u=0,c=0,A=0,h=0;n=k,k=k+16|0,h=n,s=0|an(0|(e|=0),0|(t|=0),52),D(),s&=15,r=0|an(0|e,0|t,45),D();do{if(s){for(;r=0|ln(s+4095|0,0,52),o=D()|-15728641&t,r=r|e|(l=0|ln(7,0,0|(a=3*(15-s|0)|0))),o|=u=0|D(),c=0|an(0|e,0|t,0|a),D(),s=s+-1|0,!((c&=7)>>>0<6);){if(!s){A=4;break}t=o,e=r}if(4==(0|A)){r=0|an(0|r,0|o,45),D();break}return h=0|ln(((h=0==(0|c)&0!=(0|Ge(r,o)))?2:1)+c|0,0,0|a),A=0|D()|t&~u,h|=e&~l,x(0|A),k=n,0|h}}while(0);return(r&=127)>>>0>120?(h=0,x(0|(A=0)),k=n,0|h):(ze(h,0,r+1|0,0),A=0|i[h+4>>2],h=0|i[h>>2],x(0|A),k=n,0|h)}function St(e,t,n){e|=0;var r,o=0,a=0,l=0,u=0,c=0,A=0,h=0,d=0,f=0;if(!(0|K(t|=0,n|=0)))return 0|(f=0);if(t=0|Y(t),o=+s[n>>3],a=t&(a=+s[n+8>>3])<0?a+6.283185307179586:a,(0|(f=0|i[e>>2]))<=0)return 0|(f=0);if(r=0|i[e+4>>2],t){t=0,d=a,n=-1,e=0;e:for(;;){for(h=e;u=+s[r+(h<<4)>>3],a=+s[r+(h<<4)+8>>3],l=+s[r+((e=(n+2|0)%(0|f)|0)<<4)>>3],c=+s[r+(e<<4)+8>>3],u>l?(A=u,u=c):(A=l,l=u,u=a,a=c),(o=o==l|o==A?o+2220446049250313e-31:o)<l|o>A;){if((0|(n=h+1|0))>=(0|f)){n=22;break e}e=h,h=n,n=e}if(((A=(c=u<0?u+6.283185307179586:u)+(o-l)/(A-l)*((u=a<0?a+6.283185307179586:a)-c))<0?A+6.283185307179586:A)>(d=c==d|u==d?d+-2220446049250313e-31:d)&&(t^=1),(0|(e=h+1|0))>=(0|f)){n=22;break}n=h}if(22==(0|n))return 0|t}else{t=0,d=a,n=-1,e=0;e:for(;;){for(h=e;u=+s[r+(h<<4)>>3],a=+s[r+(h<<4)+8>>3],l=+s[r+((e=(n+2|0)%(0|f)|0)<<4)>>3],c=+s[r+(e<<4)+8>>3],u>l?(A=u,u=c):(A=l,l=u,u=a,a=c),(o=o==l|o==A?o+2220446049250313e-31:o)<l|o>A;){if((0|(n=h+1|0))>=(0|f)){n=22;break e}e=h,h=n,n=e}if(u+(o-l)/(A-l)*(a-u)>(d=u==d|a==d?d+-2220446049250313e-31:d)&&(t^=1),(0|(e=h+1|0))>=(0|f)){n=22;break}n=h}if(22==(0|n))return 0|t}return 0}function Tt(e,t){t|=0;var n,r,o,a,l,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0,b=0;if(!(r=0|i[(e|=0)>>2]))return i[t>>2]=0,i[t+4>>2]=0,i[t+8>>2]=0,i[t+12>>2]=0,i[t+16>>2]=0,i[t+20>>2]=0,i[t+24>>2]=0,void(i[t+28>>2]=0);if(s[(o=t+8|0)>>3]=17976931348623157e292,s[(a=t+24|0)>>3]=17976931348623157e292,s[t>>3]=-17976931348623157e292,s[(l=t+16|0)>>3]=-17976931348623157e292,!((0|r)<=0)){for(n=0|i[e+4>>2],m=17976931348623157e292,y=-17976931348623157e292,v=0,e=-1,d=17976931348623157e292,f=17976931348623157e292,g=-17976931348623157e292,A=-17976931348623157e292,_=0;c=+s[n+(_<<4)>>3],p=+s[n+(_<<4)+8>>3],h=+s[n+(((0|(e=e+2|0))==(0|r)?0:e)<<4)+8>>3],c<d&&(s[o>>3]=c,d=c),p<f&&(s[a>>3]=p,f=p),c>g?s[t>>3]=c:c=g,p>A&&(s[l>>3]=p,A=p),m=p>0&p<m?p:m,y=p<0&p>y?p:y,v|=+u(+(p-h))>3.141592653589793,(0|(e=_+1|0))!=(0|r);)b=_,g=c,_=e,e=b;v&&(s[l>>3]=y,s[a>>3]=m)}}function It(e){return 0|((e|=0)>>>0<4?0:15)}function Ft(e,t){t|=0;var n,r=0,o=0,a=0,l=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0,b=0,w=0,E=0,x=0,D=0,C=0;if(y=0|i[(e|=0)>>2]){if(s[(v=t+8|0)>>3]=17976931348623157e292,s[(_=t+24|0)>>3]=17976931348623157e292,s[t>>3]=-17976931348623157e292,s[(b=t+16|0)>>3]=-17976931348623157e292,(0|y)>0){for(a=0|i[e+4>>2],g=17976931348623157e292,m=-17976931348623157e292,o=0,r=-1,h=17976931348623157e292,d=17976931348623157e292,p=-17976931348623157e292,c=-17976931348623157e292,w=0;l=+s[a+(w<<4)>>3],f=+s[a+(w<<4)+8>>3],A=+s[a+(((0|(D=r+2|0))==(0|y)?0:D)<<4)+8>>3],l<h&&(s[v>>3]=l,h=l),f<d&&(s[_>>3]=f,d=f),l>p?s[t>>3]=l:l=p,f>c&&(s[b>>3]=f,c=f),g=f>0&f<g?f:g,m=f<0&f>m?f:m,o|=+u(+(f-A))>3.141592653589793,(0|(r=w+1|0))!=(0|y);)D=w,p=l,w=r,r=D;o&&(s[b>>3]=m,s[_>>3]=g)}}else i[t>>2]=0,i[t+4>>2]=0,i[t+8>>2]=0,i[t+12>>2]=0,i[t+16>>2]=0,i[t+20>>2]=0,i[t+24>>2]=0,i[t+28>>2]=0;if(!((0|(r=0|i[(D=e+8|0)>>2]))<=0)){n=e+12|0,x=0;do{if(a=0|i[n>>2],o=x,_=t+((x=x+1|0)<<5)|0,b=0|i[a+(o<<3)>>2]){if(s[(w=t+(x<<5)+8|0)>>3]=17976931348623157e292,s[(e=t+(x<<5)+24|0)>>3]=17976931348623157e292,s[_>>3]=-17976931348623157e292,s[(E=t+(x<<5)+16|0)>>3]=-17976931348623157e292,(0|b)>0){for(y=0|i[a+(o<<3)+4>>2],g=17976931348623157e292,m=-17976931348623157e292,a=0,o=-1,v=0,h=17976931348623157e292,d=17976931348623157e292,f=-17976931348623157e292,c=-17976931348623157e292;l=+s[y+(v<<4)>>3],p=+s[y+(v<<4)+8>>3],A=+s[y+(((0|(o=o+2|0))==(0|b)?0:o)<<4)+8>>3],l<h&&(s[w>>3]=l,h=l),p<d&&(s[e>>3]=p,d=p),l>f?s[_>>3]=l:l=f,p>c&&(s[E>>3]=p,c=p),g=p>0&p<g?p:g,m=p<0&p>m?p:m,a|=+u(+(p-A))>3.141592653589793,(0|(o=v+1|0))!=(0|b);)C=v,v=o,f=l,o=C;a&&(s[E>>3]=m,s[e>>3]=g)}}else i[_>>2]=0,i[_+4>>2]=0,i[_+8>>2]=0,i[_+12>>2]=0,i[_+16>>2]=0,i[_+20>>2]=0,i[_+24>>2]=0,i[_+28>>2]=0,r=0|i[D>>2]}while((0|x)<(0|r))}}function Rt(e,t,n){var r=0,s=0,o=0;if(!(0|St(e|=0,t|=0,n|=0)))return 0|(s=0);if((0|i[(s=e+8|0)>>2])<=0)return 0|(s=1);for(r=e+12|0,e=0;;){if(o=e,e=e+1|0,0|St((0|i[r>>2])+(o<<3)|0,t+(e<<5)|0,n)){e=0,r=6;break}if((0|e)>=(0|i[s>>2])){e=1,r=6;break}}return 6==(0|r)?0|e:0}function kt(e,t,n,r){r|=0;var s,o,a=0,l=0,u=0,c=0,A=0;if(o=k,k=k+16|0,s=o,!(0|St(e|=0,t|=0,u=(n|=0)+8|0)))return k=o,0|(c=0);c=e+8|0;e:do{if((0|i[c>>2])>0){for(l=e+12|0,a=0;;){if(A=a,a=a+1|0,0|St((0|i[l>>2])+(A<<3)|0,t+(a<<5)|0,u)){a=0;break}if((0|a)>=(0|i[c>>2]))break e}return k=o,0|a}}while(0);if(0|Pt(e,t,n,r))return k=o,0|(A=0);i[s>>2]=i[n>>2],i[s+4>>2]=u,a=0|i[c>>2];e:do{if((0|a)>0)for(e=e+12|0,u=0,l=a;;){if(a=0|i[e>>2],(0|i[a+(u<<3)>>2])>0){if(0|St(s,r,0|i[a+(u<<3)+4>>2])){a=0;break e}if(a=u+1|0,0|Pt((0|i[e>>2])+(u<<3)|0,t+(a<<5)|0,n,r)){a=0;break e}l=0|i[c>>2]}else a=u+1|0;if(!((0|a)<(0|l))){a=1;break}u=a}else a=1}while(0);return k=o,0|(A=a)}function Pt(e,t,n,r){e|=0,n|=0;var o,a,l,u,c,A,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0,b=0,w=0,E=0,x=0,D=0,C=0;if(A=k,k=k+176|0,u=A+172|0,h=A+168|0,c=A,!(0|Z(t|=0,r|=0)))return k=A,0|(e=0);if(function(e,t,n,r){var o,a,l,u,c;t|=0,n|=0,r|=0,e=(a=+s[16+(e|=0)>>3])<(c=+s[e+24>>3]),o=(u=+s[t+16>>3])<(l=+s[t+24>>3]),t=c-u<l-a,i[n>>2]=e?o|t?1:2:0,i[r>>2]=o?e?1:t?2:1:0}(t,r,u,h),dn(0|c,0|n,168),(0|i[n>>2])>0){t=0;do{w=+ut(+s[(D=c+8+(t<<4)+8|0)>>3],0|i[h>>2]),s[D>>3]=w,t=t+1|0}while((0|t)<(0|i[n>>2]))}a=+s[r>>3],l=+s[r+8>>3],w=+ut(+s[r+16>>3],0|i[h>>2]),o=+ut(+s[r+24>>3],0|i[h>>2]);e:do{if((0|i[e>>2])>0){if(r=e+4|0,(0|(h=0|i[c>>2]))<=0)for(t=0;;)if((0|(t=t+1|0))>=(0|i[e>>2])){t=0;break e}for(n=0;;){if(t=0|i[r>>2],_=+s[t+(n<<4)>>3],b=+ut(+s[t+(n<<4)+8>>3],0|i[u>>2]),t=0|i[r>>2],D=(0|(n=n+1|0))%(0|i[e>>2])|0,d=+s[t+(D<<4)>>3],f=+ut(+s[t+(D<<4)+8>>3],0|i[u>>2]),!(_>=a)|!(d>=a)&&!(_<=l)|!(d<=l)&&!(b<=o)|!(f<=o)&&!(b>=w)|!(f>=w)){v=d-_,m=f-b,t=0;do{if(C=t,D=(0|(t=t+1|0))==(0|h)?0:t,d=+s[c+8+(C<<4)+8>>3],f=+s[c+8+(D<<4)+8>>3]-d,p=+s[c+8+(C<<4)>>3],!(0==(y=v*f-m*(g=+s[c+8+(D<<4)>>3]-p))||(E=b-d,x=_-p,g=(E*g-f*x)/y,g<0|g>1))&&(y=(v*E-m*x)/y)>=0&y<=1){t=1;break e}}while((0|t)<(0|h))}if((0|n)>=(0|i[e>>2])){t=0;break}}}else t=0}while(0);return k=A,0|(C=t)}function Mt(e,t,n,r){var s=0,o=0,a=0;if(0|Pt(e|=0,t|=0,n|=0,r|=0))return 0|(o=1);if((0|i[(o=e+8|0)>>2])<=0)return 0|(o=0);for(s=e+12|0,e=0;;){if(a=e,e=e+1|0,0|Pt((0|i[s>>2])+(a<<3)|0,t+(e<<5)|0,n,r)){e=1,s=6;break}if((0|e)>=(0|i[o>>2])){e=0,s=6;break}}return 6==(0|s)?0|e:0}function Bt(e,t,n,r,i){t|=0,n|=0,r|=0,i|=0;var o,a,l,u,c,A,h,d=0;u=+s[(e|=0)>>3],l=+s[t>>3]-u,a=+s[e+8>>3],o=+s[t+8>>3]-a,A=+s[n>>3],d=((d=+s[r>>3]-A)*(a-(h=+s[n+8>>3]))-(u-A)*(c=+s[r+8>>3]-h))/(l*c-o*d),s[i>>3]=u+l*d,s[i+8>>3]=a+o*d}function Lt(e,t){return t|=0,+u(+(+s[(e|=0)>>3]-+s[t>>3]))<1.1920928955078125e-7?0|(t=+u(+(+s[e+8>>3]-+s[t+8>>3]))<1.1920928955078125e-7):0|(t=0)}function Ot(e,t){t|=0;var n,r,i;return+((i=+s[(e|=0)>>3]-+s[t>>3])*i+(r=+s[e+8>>3]-+s[t+8>>3])*r+(n=+s[e+16>>3]-+s[t+16>>3])*n)}function Nt(e,t,n){n|=0;var r,s,o,a,l=0,u=0,c=0;if(a=k,k=k+32|0,c=a,0|(l=0|et(e|=0,t|=0,s=a+16|0)))return k=a,0|(n=l);r=0|Ne(e,t),o=0|Qe(e,t),function(e,t){e=7696+(28*(e|=0)|0)|0,i[(t|=0)>>2]=i[e>>2],i[t+4>>2]=i[e+4>>2],i[t+8>>2]=i[e+8>>2],i[t+12>>2]=i[e+12>>2]}(r,c),l=0|function(e,t){e|=0;var n=0,r=0;if((t|=0)>>>0>20)return-1;do{if((0|i[11120+(216*t|0)>>2])!=(0|e))if((0|i[11120+(216*t|0)+8>>2])!=(0|e))if((0|i[11120+(216*t|0)+16>>2])!=(0|e))if((0|i[11120+(216*t|0)+24>>2])!=(0|e))if((0|i[11120+(216*t|0)+32>>2])!=(0|e))if((0|i[11120+(216*t|0)+40>>2])!=(0|e))if((0|i[11120+(216*t|0)+48>>2])!=(0|e))if((0|i[11120+(216*t|0)+56>>2])!=(0|e))if((0|i[11120+(216*t|0)+64>>2])!=(0|e))if((0|i[11120+(216*t|0)+72>>2])!=(0|e))if((0|i[11120+(216*t|0)+80>>2])!=(0|e))if((0|i[11120+(216*t|0)+88>>2])!=(0|e))if((0|i[11120+(216*t|0)+96>>2])!=(0|e))if((0|i[11120+(216*t|0)+104>>2])!=(0|e))if((0|i[11120+(216*t|0)+112>>2])!=(0|e))if((0|i[11120+(216*t|0)+120>>2])!=(0|e))if((0|i[11120+(216*t|0)+128>>2])!=(0|e)){if((0|i[11120+(216*t|0)+136>>2])!=(0|e)){if((0|i[11120+(216*t|0)+144>>2])==(0|e)){e=0,n=2,r=0;break}if((0|i[11120+(216*t|0)+152>>2])==(0|e)){e=0,n=2,r=1;break}if((0|i[11120+(216*t|0)+160>>2])==(0|e)){e=0,n=2,r=2;break}if((0|i[11120+(216*t|0)+168>>2])==(0|e)){e=1,n=2,r=0;break}if((0|i[11120+(216*t|0)+176>>2])==(0|e)){e=1,n=2,r=1;break}if((0|i[11120+(216*t|0)+184>>2])==(0|e)){e=1,n=2,r=2;break}if((0|i[11120+(216*t|0)+192>>2])==(0|e)){e=2,n=2,r=0;break}if((0|i[11120+(216*t|0)+200>>2])==(0|e)){e=2,n=2,r=1;break}if((0|i[11120+(216*t|0)+208>>2])==(0|e)){e=2,n=2,r=2;break}return-1}e=2,n=1,r=2}else e=2,n=1,r=1;else e=2,n=1,r=0;else e=1,n=1,r=2;else e=1,n=1,r=1;else e=1,n=1,r=0;else e=0,n=1,r=2;else e=0,n=1,r=1;else e=0,n=1,r=0;else e=2,n=0,r=2;else e=2,n=0,r=1;else e=2,n=0,r=0;else e=1,n=0,r=2;else e=1,n=0,r=1;else e=1,n=0,r=0;else e=0,n=0,r=2;else e=0,n=0,r=1;else e=0,n=0,r=0}while(0);return 0|i[11120+(216*t|0)+(72*n|0)+(24*e|0)+(r<<3)+4>>2]}(r,0|i[s>>2]);e:do{if(0|z(r)){switch(0|r){case 4:e=0;break;case 14:e=1;break;case 24:e=2;break;case 38:e=3;break;case 49:e=4;break;case 58:e=5;break;case 63:e=6;break;case 72:e=7;break;case 83:e=8;break;case 97:e=9;break;case 107:e=10;break;case 117:e=11;break;default:l=1;break e}if(u=0|i[26416+(24*e|0)+8>>2],t=0|i[26416+(24*e|0)+16>>2],(0|(e=0|i[s>>2]))!=(0|i[c>>2])&&(c=0|j(r))|(0|(e=0|i[s>>2]))==(0|t)&&(l=(l+1|0)%6|0),3==(0|o)&(0|e)==(0|t)){l=(l+5|0)%6|0,u=22;break}5==(0|o)&(0|e)==(0|u)?(l=(l+1|0)%6|0,u=22):u=22}else u=22}while(0);return 22==(0|u)&&(i[n>>2]=l,l=0),k=a,0|(n=l)}function Ut(e,t,n,r){n|=0,r|=0;var s,o,a,l,u,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0;if(u=k,k=k+32|0,_=u+24|0,l=u+20|0,a=u+8|0,o=u+16|0,s=u,f=(f=0==(0|Ge(e|=0,t|=0)))?6:5,g=0|an(0|e,0|t,52),D(),f>>>0<=n>>>0)return k=u,0|(r=2);!(m=0==(0|(g&=15)))&&0==((y=0|ln(7,0,3*(15^g)|0))&e|0)&0==((0|D())&t)?c=n:A=4;e:do{if(4==(0|A)){if((0|((c=0!=(0|Ge(e,t)))?4:5))<(0|n))return k=u,0|(r=1);if(0|Nt(e,t,_))return k=u,0|(r=1);if(A=(0|i[_>>2])+n|0,7==(0|(y=0|i[(c=c?26704+((0|A)%5<<2)|0:26736+((0|A)%6<<2)|0)>>2])))return k=u,0|(r=1);i[l>>2]=0,c=0|O(e,t,y,l,a);do{if(!c){if(p=0|i[(d=a)>>2],A=(h=(d=0|i[d+4>>2])>>>0<t>>>0|(0|d)==(0|t)&p>>>0<e>>>0)?p:e,h=h?d:t,!m&&0==(p&(m=0|ln(7,0,3*(15^g)|0))|0)&0==(d&(0|D())))c=n;else{if(d=(n+-1+f|0)%(0|f)|0,c=0|Ge(e,t),(0|d)<0&&C(27795,27797,246,27806),(0|((f=0!=(0|c))?4:5))<(0|d)&&C(27795,27797,246,27806),0|Nt(e,t,_)&&C(27795,27797,246,27806),c=(0|i[_>>2])+d|0,7==(0|(d=0|i[(c=f?26704+((0|c)%5<<2)|0:26736+((0|c)%6<<2)|0)>>2]))&&C(27795,27797,246,27806),i[o>>2]=0,0|(c=0|O(e,t,d,o,s)))break;f=0|i[(p=s)>>2],p=0|i[p+4>>2];do{if(p>>>0<h>>>0|(0|p)==(0|h)&f>>>0<A>>>0){if(A=0|Ge(f,p)?0|N(f,p,e,t):0|i[26800+(((0|i[o>>2])+(0|i[26768+(d<<2)>>2])|0)%6<<2)>>2],c=0|Ge(f,p),(A+-1|0)>>>0>5){c=-1,A=f,h=p;break}if(1==(0|A)&(c=0!=(0|c))){c=-1,A=f,h=p;break}do{if(!(0|Nt(f,p,_))){if(c){c=(5+(0|i[26352+(A<<2)>>2])-(0|i[_>>2])|0)%5|0;break}c=(6+(0|i[26384+(A<<2)>>2])-(0|i[_>>2])|0)%6|0;break}c=-1}while(0);A=f,h=p}else c=n}while(0);p=0|i[(d=a)>>2],d=0|i[d+4>>2]}if((0|A)==(0|p)&(0|h)==(0|d)){if(e=(f=0!=(0|Ge(p,d)))?0|N(p,d,e,t):0|i[26800+(((0|i[l>>2])+(0|i[26768+(y<<2)>>2])|0)%6<<2)>>2],c=0|Ge(p,d),(e+-1|0)>>>0<=5&&!(1==(0|e)&(v=0!=(0|c))))do{if(!(0|Nt(p,d,_))){if(v){c=(5+(0|i[26352+(e<<2)>>2])-(0|i[_>>2])|0)%5|0;break}c=(6+(0|i[26384+(e<<2)>>2])-(0|i[_>>2])|0)%6|0;break}c=-1}while(0);else c=-1;c=6==(0|(c=c+1|0))|f&5==(0|c)?0:c}t=h,e=A;break e}}while(0);return k=u,0|(r=c)}}while(0);return v=0|ln(0|c,0,56),_=D()|-2130706433&t|536870912,i[r>>2]=v|e,i[r+4>>2]=_,k=u,0|(r=0)}function zt(e,t,n){e|=0,n|=0;var r=0;(0|(t|=0))>0?(r=0|Kt(t,4),i[e>>2]=r,r||C(27819,27842,40,27856)):i[e>>2]=0,i[e+4>>2]=t,i[e+8>>2]=0,i[e+12>>2]=n}function jt(e){var t,n,r,o=0,a=0,l=0,c=0;t=(e|=0)+4|0,n=e+12|0,r=e+8|0;e:for(;;){for(a=0|i[t>>2],o=0;;){if((0|o)>=(0|a))break e;if(l=0|i[e>>2],c=0|i[l+(o<<2)>>2])break;o=o+1|0}o=l+(~~(+u(+ +A(10,+ +(15-(0|i[n>>2])|0))*(+s[c>>3]+ +s[c+8>>3]))%+(0|a))>>>0<<2)|0,a=0|i[o>>2];t:do{if(0|a){if(l=c+32|0,(0|a)==(0|c))i[o>>2]=i[l>>2];else{if(!(o=0|i[(a=a+32|0)>>2]))break;for(;(0|o)!=(0|c);)if(!(o=0|i[(a=o+32|0)>>2]))break t;i[a>>2]=i[l>>2]}qt(c),i[r>>2]=(0|i[r>>2])-1}}while(0)}qt(0|i[e>>2])}function Vt(e){var t,n=0,r=0;for(t=0|i[(e|=0)+4>>2],r=0;;){if((0|r)>=(0|t)){n=0,r=4;break}if(n=0|i[(0|i[e>>2])+(r<<2)>>2]){r=4;break}r=r+1|0}return 4==(0|r)?0|n:0}function Gt(e,t){t|=0;var n=0,r=0,o=0,a=0;if(n=~~(+u(+ +A(10,+ +(15-(0|i[(e|=0)+12>>2])|0))*(+s[t>>3]+ +s[t+8>>3]))%+(0|i[e+4>>2]))>>>0,n=(0|i[e>>2])+(n<<2)|0,!(r=0|i[n>>2]))return 0|(a=1);a=t+32|0;do{if((0|r)!=(0|t)){if(!(n=0|i[r+32>>2]))return 0|(a=1);for(o=n;;){if((0|o)==(0|t)){o=8;break}if(!(n=0|i[o+32>>2])){n=1,o=10;break}r=o,o=n}if(8==(0|o)){i[r+32>>2]=i[a>>2];break}if(10==(0|o))return 0|n}else i[n>>2]=i[a>>2]}while(0);return qt(t),i[(a=e+8|0)>>2]=(0|i[a>>2])-1,0|(a=0)}function Wt(e,t,n){e|=0,t|=0,n|=0;var r,o=0,a=0,l=0;(r=0|Yt(40))||C(27872,27842,98,27885),i[r>>2]=i[t>>2],i[r+4>>2]=i[t+4>>2],i[r+8>>2]=i[t+8>>2],i[r+12>>2]=i[t+12>>2],i[(a=r+16|0)>>2]=i[n>>2],i[a+4>>2]=i[n+4>>2],i[a+8>>2]=i[n+8>>2],i[a+12>>2]=i[n+12>>2],i[r+32>>2]=0,a=~~(+u(+ +A(10,+ +(15-(0|i[e+12>>2])|0))*(+s[t>>3]+ +s[t+8>>3]))%+(0|i[e+4>>2]))>>>0,a=(0|i[e>>2])+(a<<2)|0,o=0|i[a>>2];do{if(o){for(;!(0|lt(o,t)&&0|lt(o+16|0,n));)if(a=0|i[o+32>>2],!(0|i[(o=0==(0|a)?o:a)+32>>2])){l=10;break}if(10==(0|l)){i[o+32>>2]=r;break}return qt(r),0|(l=o)}i[a>>2]=r}while(0);return i[(l=e+8|0)>>2]=1+(0|i[l>>2]),0|(l=r)}function Ht(e,t,n){t|=0,n|=0;var r=0,o=0;if(o=~~(+u(+ +A(10,+ +(15-(0|i[(e|=0)+12>>2])|0))*(+s[t>>3]+ +s[t+8>>3]))%+(0|i[e+4>>2]))>>>0,!(o=0|i[(0|i[e>>2])+(o<<2)>>2]))return 0|(n=0);if(!n){for(e=o;;){if(0|lt(e,t)){r=10;break}if(!(e=0|i[e+32>>2])){e=0,r=10;break}}if(10==(0|r))return 0|e}for(e=o;;){if(0|lt(e,t)&&0|lt(e+16|0,n)){r=10;break}if(!(e=0|i[e+32>>2])){e=0,r=10;break}}return 10==(0|r)?0|e:0}function Qt(e,t){t|=0;var n=0;if(n=~~(+u(+ +A(10,+ +(15-(0|i[(e|=0)+12>>2])|0))*(+s[t>>3]+ +s[t+8>>3]))%+(0|i[e+4>>2]))>>>0,!(e=0|i[(0|i[e>>2])+(n<<2)>>2]))return 0|(n=0);for(;;){if(0|lt(e,t)){t=5;break}if(!(e=0|i[e+32>>2])){e=0,t=5;break}}return 5==(0|t)?0|e:0}function Xt(e){return 0|+pn(+(e=+e))}function Yt(e){e|=0;var t,n=0,r=0,s=0,o=0,a=0,l=0,u=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0,b=0,w=0;t=k,k=k+16|0,f=t;do{if(e>>>0<245){if(e=(A=e>>>0<11?16:e+11&-8)>>>3,3&(r=(d=0|i[6977])>>>e))return s=0|i[(r=(e=27948+((n=(1&r^1)+e|0)<<1<<2)|0)+8|0)>>2],(0|(a=0|i[(o=s+8|0)>>2]))==(0|e)?i[6977]=d&~(1<<n):(i[a+12>>2]=e,i[r>>2]=a),w=n<<3,i[s+4>>2]=3|w,i[(w=s+w+4|0)>>2]=1|i[w>>2],k=t,0|(w=o);if(A>>>0>(h=0|i[6979])>>>0){if(0|r)return n=((n=r<<e&((n=2<<e)|0-n))&0-n)-1|0,a=0|i[(e=(n=27948+((s=((r=(n>>>=u=n>>>12&16)>>>5&8)|u|(a=(n>>>=r)>>>2&4)|(e=(n>>>=a)>>>1&2)|(s=(n>>>=e)>>>1&1))+(n>>>s)|0)<<1<<2)|0)+8|0)>>2],(0|(r=0|i[(u=a+8|0)>>2]))==(0|n)?(e=d&~(1<<s),i[6977]=e):(i[r+12>>2]=n,i[e>>2]=r,e=d),l=(w=s<<3)-A|0,i[a+4>>2]=3|A,i[(o=a+A|0)+4>>2]=1|l,i[a+w>>2]=l,0|h&&(s=0|i[6982],r=27948+((n=h>>>3)<<1<<2)|0,e&(n=1<<n)?n=0|i[(e=r+8|0)>>2]:(i[6977]=e|n,n=r,e=r+8|0),i[e>>2]=s,i[n+12>>2]=s,i[s+8>>2]=n,i[s+12>>2]=r),i[6979]=l,i[6982]=o,k=t,0|(w=u);if(a=0|i[6978]){for(r=(a&0-a)-1|0,r=c=0|i[28212+(((s=(r>>>=o=r>>>12&16)>>>5&8)|o|(l=(r>>>=s)>>>2&4)|(u=(r>>>=l)>>>1&2)|(c=(r>>>=u)>>>1&1))+(r>>>c)<<2)>>2],u=c,c=(-8&i[c+4>>2])-A|0;(e=0|i[r+16>>2])||(e=0|i[r+20>>2]);)r=e,u=(o=(l=(-8&i[e+4>>2])-A|0)>>>0<c>>>0)?e:u,c=o?l:c;if((l=u+A|0)>>>0>u>>>0){o=0|i[u+24>>2],n=0|i[u+12>>2];do{if((0|n)==(0|u)){if(!(n=0|i[(e=u+20|0)>>2])&&!(n=0|i[(e=u+16|0)>>2])){r=0;break}for(;;)if(r=0|i[(s=n+20|0)>>2])n=r,e=s;else{if(!(r=0|i[(s=n+16|0)>>2]))break;n=r,e=s}i[e>>2]=0,r=n}else r=0|i[u+8>>2],i[r+12>>2]=n,i[n+8>>2]=r,r=n}while(0);do{if(0|o){if(n=0|i[u+28>>2],(0|u)==(0|i[(e=28212+(n<<2)|0)>>2])){if(i[e>>2]=r,!r){i[6978]=a&~(1<<n);break}}else if(i[((0|i[(w=o+16|0)>>2])==(0|u)?w:o+20)>>2]=r,!r)break;i[r+24>>2]=o,0|(n=0|i[u+16>>2])&&(i[r+16>>2]=n,i[n+24>>2]=r),0|(n=0|i[u+20>>2])&&(i[r+20>>2]=n,i[n+24>>2]=r)}}while(0);return c>>>0<16?(w=c+A|0,i[u+4>>2]=3|w,i[(w=u+w+4|0)>>2]=1|i[w>>2]):(i[u+4>>2]=3|A,i[l+4>>2]=1|c,i[l+c>>2]=c,0|h&&(s=0|i[6982],r=27948+((n=h>>>3)<<1<<2)|0,(n=1<<n)&d?n=0|i[(e=r+8|0)>>2]:(i[6977]=n|d,n=r,e=r+8|0),i[e>>2]=s,i[n+12>>2]=s,i[s+8>>2]=n,i[s+12>>2]=r),i[6979]=c,i[6982]=l),k=t,0|(w=u+8|0)}d=A}else d=A}else d=A}else if(e>>>0<=4294967231)if(A=-8&(e=e+11|0),s=0|i[6978]){o=0-A|0,c=(e>>>=8)?A>>>0>16777215?31:A>>>((c=14-((u=((m=e<<(d=(e+1048320|0)>>>16&8))+520192|0)>>>16&4)|d|(c=((m<<=u)+245760|0)>>>16&2))+(m<<c>>>15)|0)+7|0)&1|c<<1:0,r=0|i[28212+(c<<2)>>2];e:do{if(r)for(e=0,u=A<<(31==(0|c)?0:25-(c>>>1)|0),a=0;;){if((l=(-8&i[r+4>>2])-A|0)>>>0<o>>>0){if(!l){e=r,o=0,m=65;break e}e=r,o=l}if(a=0==(0|(m=0|i[r+20>>2]))|(0|m)==(0|(r=0|i[r+16+(u>>>31<<2)>>2]))?a:m,!r){r=a,m=61;break}u<<=1}else r=0,e=0,m=61}while(0);if(61==(0|m)){if(0==(0|r)&0==(0|e)){if(!(e=((e=2<<c)|0-e)&s)){d=A;break}d=(e&0-e)-1|0,e=0,r=0|i[28212+(((a=(d>>>=l=d>>>12&16)>>>5&8)|l|(u=(d>>>=a)>>>2&4)|(c=(d>>>=u)>>>1&2)|(r=(d>>>=c)>>>1&1))+(d>>>r)<<2)>>2]}r?m=65:(u=e,l=o)}if(65==(0|m))for(a=r;;){if(o=(r=(d=(-8&i[a+4>>2])-A|0)>>>0<o>>>0)?d:o,e=r?a:e,(r=0|i[a+16>>2])||(r=0|i[a+20>>2]),!r){u=e,l=o;break}a=r}if(0!=(0|u)&&l>>>0<((0|i[6979])-A|0)>>>0&&(h=u+A|0)>>>0>u>>>0){a=0|i[u+24>>2],n=0|i[u+12>>2];do{if((0|n)==(0|u)){if(!(n=0|i[(e=u+20|0)>>2])&&!(n=0|i[(e=u+16|0)>>2])){n=0;break}for(;;)if(r=0|i[(o=n+20|0)>>2])n=r,e=o;else{if(!(r=0|i[(o=n+16|0)>>2]))break;n=r,e=o}i[e>>2]=0}else w=0|i[u+8>>2],i[w+12>>2]=n,i[n+8>>2]=w}while(0);do{if(a){if(e=0|i[u+28>>2],(0|u)==(0|i[(r=28212+(e<<2)|0)>>2])){if(i[r>>2]=n,!n){s&=~(1<<e),i[6978]=s;break}}else if(i[((0|i[(w=a+16|0)>>2])==(0|u)?w:a+20)>>2]=n,!n)break;i[n+24>>2]=a,0|(e=0|i[u+16>>2])&&(i[n+16>>2]=e,i[e+24>>2]=n),(e=0|i[u+20>>2])&&(i[n+20>>2]=e,i[e+24>>2]=n)}}while(0);e:do{if(l>>>0<16)w=l+A|0,i[u+4>>2]=3|w,i[(w=u+w+4|0)>>2]=1|i[w>>2];else{if(i[u+4>>2]=3|A,i[h+4>>2]=1|l,i[h+l>>2]=l,n=l>>>3,l>>>0<256){r=27948+(n<<1<<2)|0,(e=0|i[6977])&(n=1<<n)?n=0|i[(e=r+8|0)>>2]:(i[6977]=e|n,n=r,e=r+8|0),i[e>>2]=h,i[n+12>>2]=h,i[h+8>>2]=n,i[h+12>>2]=r;break}if(n=28212+((r=(n=l>>>8)?l>>>0>16777215?31:l>>>((r=14-((_=((w=n<<(b=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|b|(r=((w<<=_)+245760|0)>>>16&2))+(w<<r>>>15)|0)+7|0)&1|r<<1:0)<<2)|0,i[h+28>>2]=r,i[(e=h+16|0)+4>>2]=0,i[e>>2]=0,!(s&(e=1<<r))){i[6978]=s|e,i[n>>2]=h,i[h+24>>2]=n,i[h+12>>2]=h,i[h+8>>2]=h;break}n=0|i[n>>2];t:do{if((-8&i[n+4>>2])!=(0|l)){for(s=l<<(31==(0|r)?0:25-(r>>>1)|0);e=0|i[(r=n+16+(s>>>31<<2)|0)>>2];){if((-8&i[e+4>>2])==(0|l)){n=e;break t}s<<=1,n=e}i[r>>2]=h,i[h+24>>2]=n,i[h+12>>2]=h,i[h+8>>2]=h;break e}}while(0);w=0|i[(b=n+8|0)>>2],i[w+12>>2]=h,i[b>>2]=h,i[h+8>>2]=w,i[h+12>>2]=n,i[h+24>>2]=0}}while(0);return k=t,0|(w=u+8|0)}d=A}else d=A;else d=-1}while(0);if((r=0|i[6979])>>>0>=d>>>0)return n=r-d|0,e=0|i[6982],n>>>0>15?(w=e+d|0,i[6982]=w,i[6979]=n,i[w+4>>2]=1|n,i[e+r>>2]=n,i[e+4>>2]=3|d):(i[6979]=0,i[6982]=0,i[e+4>>2]=3|r,i[(w=e+r+4|0)>>2]=1|i[w>>2]),k=t,0|(w=e+8|0);if((l=0|i[6980])>>>0>d>>>0)return _=l-d|0,i[6980]=_,b=(w=0|i[6983])+d|0,i[6983]=b,i[b+4>>2]=1|_,i[w+4>>2]=3|d,k=t,0|(w=w+8|0);if(0|i[7095]?e=0|i[7097]:(i[7097]=4096,i[7096]=4096,i[7098]=-1,i[7099]=-1,i[7100]=0,i[7088]=0,i[7095]=-16&f^1431655768,e=4096),u=d+48|0,(A=(a=e+(c=d+47|0)|0)&(o=0-e|0))>>>0<=d>>>0)return k=t,0|(w=0);if(0|(e=0|i[7087])&&(f=(h=0|i[7085])+A|0)>>>0<=h>>>0|f>>>0>e>>>0)return k=t,0|(w=0);e:do{if(4&i[7088])n=0,m=143;else{r=0|i[6983];t:do{if(r){for(s=28356;!((f=0|i[s>>2])>>>0<=r>>>0&&(f+(0|i[s+4>>2])|0)>>>0>r>>>0);){if(!(e=0|i[s+8>>2])){m=128;break t}s=e}if((n=a-l&o)>>>0<2147483647)if((0|(e=0|gn(0|n)))==((0|i[s>>2])+(0|i[s+4>>2])|0)){if(-1!=(0|e)){l=n,a=e,m=145;break e}}else s=e,m=136;else n=0}else m=128}while(0);do{if(128==(0|m))if(-1!=(0|(r=0|gn(0)))&&(n=r,g=(n=(0==((g=(p=0|i[7096])+-1|0)&n|0)?0:(g+n&0-p)-n|0)+A|0)+(p=0|i[7085])|0,n>>>0>d>>>0&n>>>0<2147483647)){if(0|(f=0|i[7087])&&g>>>0<=p>>>0|g>>>0>f>>>0){n=0;break}if((0|(e=0|gn(0|n)))==(0|r)){l=n,a=r,m=145;break e}s=e,m=136}else n=0}while(0);do{if(136==(0|m)){if(r=0-n|0,!(u>>>0>n>>>0&n>>>0<2147483647&-1!=(0|s))){if(-1==(0|s)){n=0;break}l=n,a=s,m=145;break e}if((e=c-n+(e=0|i[7097])&0-e)>>>0>=2147483647){l=n,a=s,m=145;break e}if(-1==(0|gn(0|e))){gn(0|r),n=0;break}l=e+n|0,a=s,m=145;break e}}while(0);i[7088]=4|i[7088],m=143}}while(0);if(143==(0|m)&&A>>>0<2147483647&&!(-1==(0|(_=0|gn(0|A)))|1^(v=(y=(g=0|gn(0))-_|0)>>>0>(d+40|0)>>>0)|_>>>0<g>>>0&-1!=(0|_)&-1!=(0|g)^1)&&(l=v?y:n,a=_,m=145),145==(0|m)){n=(0|i[7085])+l|0,i[7085]=n,n>>>0>(0|i[7086])>>>0&&(i[7086]=n),c=0|i[6983];e:do{if(c){for(n=28356;;){if((0|a)==((e=0|i[n>>2])+(r=0|i[n+4>>2])|0)){m=154;break}if(!(s=0|i[n+8>>2]))break;n=s}if(154==(0|m)&&(b=n+4|0,0==(8&i[n+12>>2]))&&a>>>0>c>>>0&e>>>0<=c>>>0){i[b>>2]=r+l,b=c+(_=0==(7&(_=c+8|0))?0:0-_&7)|0,_=(w=(0|i[6980])+l|0)-_|0,i[6983]=b,i[6980]=_,i[b+4>>2]=1|_,i[c+w+4>>2]=40,i[6984]=i[7099];break}for(a>>>0<(0|i[6981])>>>0&&(i[6981]=a),r=a+l|0,n=28356;;){if((0|i[n>>2])==(0|r)){m=162;break}if(!(e=0|i[n+8>>2]))break;n=e}if(162==(0|m)&&0==(8&i[n+12>>2])){i[n>>2]=a,i[(h=n+4|0)>>2]=(0|i[h>>2])+l,A=(h=a+(0==(7&(h=a+8|0))?0:0-h&7)|0)+d|0,u=(n=r+(0==(7&(n=r+8|0))?0:0-n&7)|0)-h-d|0,i[h+4>>2]=3|d;t:do{if((0|c)==(0|n))w=(0|i[6980])+u|0,i[6980]=w,i[6983]=A,i[A+4>>2]=1|w;else{if((0|i[6982])==(0|n)){w=(0|i[6979])+u|0,i[6979]=w,i[6982]=A,i[A+4>>2]=1|w,i[A+w>>2]=w;break}if(1==(3&(e=0|i[n+4>>2]))){l=-8&e,s=e>>>3;n:do{if(e>>>0<256){if(e=0|i[n+8>>2],(0|(r=0|i[n+12>>2]))==(0|e)){i[6977]=i[6977]&~(1<<s);break}i[e+12>>2]=r,i[r+8>>2]=e;break}a=0|i[n+24>>2],e=0|i[n+12>>2];do{if((0|e)==(0|n)){if(e=0|i[(s=(r=n+16|0)+4|0)>>2])r=s;else if(!(e=0|i[r>>2])){e=0;break}for(;;)if(s=0|i[(o=e+20|0)>>2])e=s,r=o;else{if(!(s=0|i[(o=e+16|0)>>2]))break;e=s,r=o}i[r>>2]=0}else w=0|i[n+8>>2],i[w+12>>2]=e,i[e+8>>2]=w}while(0);if(!a)break;s=28212+((r=0|i[n+28>>2])<<2)|0;do{if((0|i[s>>2])==(0|n)){if(i[s>>2]=e,0|e)break;i[6978]=i[6978]&~(1<<r);break n}if(i[((0|i[(w=a+16|0)>>2])==(0|n)?w:a+20)>>2]=e,!e)break n}while(0);if(i[e+24>>2]=a,0|(s=0|i[(r=n+16|0)>>2])&&(i[e+16>>2]=s,i[s+24>>2]=e),!(r=0|i[r+4>>2]))break;i[e+20>>2]=r,i[r+24>>2]=e}while(0);n=n+l|0,o=l+u|0}else o=u;if(i[(n=n+4|0)>>2]=-2&i[n>>2],i[A+4>>2]=1|o,i[A+o>>2]=o,n=o>>>3,o>>>0<256){r=27948+(n<<1<<2)|0,(e=0|i[6977])&(n=1<<n)?n=0|i[(e=r+8|0)>>2]:(i[6977]=e|n,n=r,e=r+8|0),i[e>>2]=A,i[n+12>>2]=A,i[A+8>>2]=n,i[A+12>>2]=r;break}n=o>>>8;do{if(n){if(o>>>0>16777215){s=31;break}s=o>>>((s=14-((_=((w=n<<(b=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|b|(s=((w<<=_)+245760|0)>>>16&2))+(w<<s>>>15)|0)+7|0)&1|s<<1}else s=0}while(0);if(n=28212+(s<<2)|0,i[A+28>>2]=s,i[(e=A+16|0)+4>>2]=0,i[e>>2]=0,!((e=0|i[6978])&(r=1<<s))){i[6978]=e|r,i[n>>2]=A,i[A+24>>2]=n,i[A+12>>2]=A,i[A+8>>2]=A;break}n=0|i[n>>2];n:do{if((-8&i[n+4>>2])!=(0|o)){for(s=o<<(31==(0|s)?0:25-(s>>>1)|0);e=0|i[(r=n+16+(s>>>31<<2)|0)>>2];){if((-8&i[e+4>>2])==(0|o)){n=e;break n}s<<=1,n=e}i[r>>2]=A,i[A+24>>2]=n,i[A+12>>2]=A,i[A+8>>2]=A;break t}}while(0);w=0|i[(b=n+8|0)>>2],i[w+12>>2]=A,i[b>>2]=A,i[A+8>>2]=w,i[A+12>>2]=n,i[A+24>>2]=0}}while(0);return k=t,0|(w=h+8|0)}for(n=28356;!((e=0|i[n>>2])>>>0<=c>>>0&&(w=e+(0|i[n+4>>2])|0)>>>0>c>>>0);)n=0|i[n+8>>2];n=(e=(e=(o=w+-47|0)+(0==(7&(e=o+8|0))?0:0-e&7)|0)>>>0<(o=c+16|0)>>>0?c:e)+8|0,b=a+(_=0==(7&(_=a+8|0))?0:0-_&7)|0,_=(r=l+-40|0)-_|0,i[6983]=b,i[6980]=_,i[b+4>>2]=1|_,i[a+r+4>>2]=40,i[6984]=i[7099],i[(r=e+4|0)>>2]=27,i[n>>2]=i[7089],i[n+4>>2]=i[7090],i[n+8>>2]=i[7091],i[n+12>>2]=i[7092],i[7089]=a,i[7090]=l,i[7092]=0,i[7091]=n,n=e+24|0;do{b=n,i[(n=n+4|0)>>2]=7}while((b+8|0)>>>0<w>>>0);if((0|e)!=(0|c)){if(a=e-c|0,i[r>>2]=-2&i[r>>2],i[c+4>>2]=1|a,i[e>>2]=a,n=a>>>3,a>>>0<256){r=27948+(n<<1<<2)|0,(e=0|i[6977])&(n=1<<n)?n=0|i[(e=r+8|0)>>2]:(i[6977]=e|n,n=r,e=r+8|0),i[e>>2]=c,i[n+12>>2]=c,i[c+8>>2]=n,i[c+12>>2]=r;break}if(r=28212+((s=(n=a>>>8)?a>>>0>16777215?31:a>>>((s=14-((_=((w=n<<(b=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|b|(s=((w<<=_)+245760|0)>>>16&2))+(w<<s>>>15)|0)+7|0)&1|s<<1:0)<<2)|0,i[c+28>>2]=s,i[c+20>>2]=0,i[o>>2]=0,!((n=0|i[6978])&(e=1<<s))){i[6978]=n|e,i[r>>2]=c,i[c+24>>2]=r,i[c+12>>2]=c,i[c+8>>2]=c;break}n=0|i[r>>2];t:do{if((-8&i[n+4>>2])!=(0|a)){for(s=a<<(31==(0|s)?0:25-(s>>>1)|0);e=0|i[(r=n+16+(s>>>31<<2)|0)>>2];){if((-8&i[e+4>>2])==(0|a)){n=e;break t}s<<=1,n=e}i[r>>2]=c,i[c+24>>2]=n,i[c+12>>2]=c,i[c+8>>2]=c;break e}}while(0);w=0|i[(b=n+8|0)>>2],i[w+12>>2]=c,i[b>>2]=c,i[c+8>>2]=w,i[c+12>>2]=n,i[c+24>>2]=0}}else 0==(0|(w=0|i[6981]))|a>>>0<w>>>0&&(i[6981]=a),i[7089]=a,i[7090]=l,i[7092]=0,i[6986]=i[7095],i[6985]=-1,i[6990]=27948,i[6989]=27948,i[6992]=27956,i[6991]=27956,i[6994]=27964,i[6993]=27964,i[6996]=27972,i[6995]=27972,i[6998]=27980,i[6997]=27980,i[7e3]=27988,i[6999]=27988,i[7002]=27996,i[7001]=27996,i[7004]=28004,i[7003]=28004,i[7006]=28012,i[7005]=28012,i[7008]=28020,i[7007]=28020,i[7010]=28028,i[7009]=28028,i[7012]=28036,i[7011]=28036,i[7014]=28044,i[7013]=28044,i[7016]=28052,i[7015]=28052,i[7018]=28060,i[7017]=28060,i[7020]=28068,i[7019]=28068,i[7022]=28076,i[7021]=28076,i[7024]=28084,i[7023]=28084,i[7026]=28092,i[7025]=28092,i[7028]=28100,i[7027]=28100,i[7030]=28108,i[7029]=28108,i[7032]=28116,i[7031]=28116,i[7034]=28124,i[7033]=28124,i[7036]=28132,i[7035]=28132,i[7038]=28140,i[7037]=28140,i[7040]=28148,i[7039]=28148,i[7042]=28156,i[7041]=28156,i[7044]=28164,i[7043]=28164,i[7046]=28172,i[7045]=28172,i[7048]=28180,i[7047]=28180,i[7050]=28188,i[7049]=28188,i[7052]=28196,i[7051]=28196,b=a+(_=0==(7&(_=a+8|0))?0:0-_&7)|0,_=(w=l+-40|0)-_|0,i[6983]=b,i[6980]=_,i[b+4>>2]=1|_,i[a+w+4>>2]=40,i[6984]=i[7099]}while(0);if((n=0|i[6980])>>>0>d>>>0)return _=n-d|0,i[6980]=_,b=(w=0|i[6983])+d|0,i[6983]=b,i[b+4>>2]=1|_,i[w+4>>2]=3|d,k=t,0|(w=w+8|0)}return i[(w=27904)>>2]=12,k=t,0|(w=0)}function qt(e){var t=0,n=0,r=0,s=0,o=0,a=0,l=0,u=0;if(e|=0){n=e+-8|0,s=0|i[6981],u=n+(t=-8&(e=0|i[e+-4>>2]))|0;do{if(1&e)l=n,a=n;else{if(r=0|i[n>>2],!(3&e))return;if(o=r+t|0,(a=n+(0-r)|0)>>>0<s>>>0)return;if((0|i[6982])==(0|a)){if(3!=(3&(t=0|i[(e=u+4|0)>>2]))){l=a,t=o;break}return i[6979]=o,i[e>>2]=-2&t,i[a+4>>2]=1|o,void(i[a+o>>2]=o)}if(n=r>>>3,r>>>0<256){if(e=0|i[a+8>>2],(0|(t=0|i[a+12>>2]))==(0|e)){i[6977]=i[6977]&~(1<<n),l=a,t=o;break}i[e+12>>2]=t,i[t+8>>2]=e,l=a,t=o;break}s=0|i[a+24>>2],e=0|i[a+12>>2];do{if((0|e)==(0|a)){if(e=0|i[(n=(t=a+16|0)+4|0)>>2])t=n;else if(!(e=0|i[t>>2])){e=0;break}for(;;)if(n=0|i[(r=e+20|0)>>2])e=n,t=r;else{if(!(n=0|i[(r=e+16|0)>>2]))break;e=n,t=r}i[t>>2]=0}else l=0|i[a+8>>2],i[l+12>>2]=e,i[e+8>>2]=l}while(0);if(s){if(t=0|i[a+28>>2],(0|i[(n=28212+(t<<2)|0)>>2])==(0|a)){if(i[n>>2]=e,!e){i[6978]=i[6978]&~(1<<t),l=a,t=o;break}}else if(i[((0|i[(l=s+16|0)>>2])==(0|a)?l:s+20)>>2]=e,!e){l=a,t=o;break}i[e+24>>2]=s,0|(n=0|i[(t=a+16|0)>>2])&&(i[e+16>>2]=n,i[n+24>>2]=e),(t=0|i[t+4>>2])?(i[e+20>>2]=t,i[t+24>>2]=e,l=a,t=o):(l=a,t=o)}else l=a,t=o}}while(0);if(!(a>>>0>=u>>>0)&&1&(r=0|i[(e=u+4|0)>>2])){if(2&r)i[e>>2]=-2&r,i[l+4>>2]=1|t,i[a+t>>2]=t,s=t;else{if((0|i[6983])==(0|u)){if(u=(0|i[6980])+t|0,i[6980]=u,i[6983]=l,i[l+4>>2]=1|u,(0|l)!=(0|i[6982]))return;return i[6982]=0,void(i[6979]=0)}if((0|i[6982])==(0|u))return u=(0|i[6979])+t|0,i[6979]=u,i[6982]=a,i[l+4>>2]=1|u,void(i[a+u>>2]=u);s=(-8&r)+t|0,n=r>>>3;do{if(r>>>0<256){if(t=0|i[u+8>>2],(0|(e=0|i[u+12>>2]))==(0|t)){i[6977]=i[6977]&~(1<<n);break}i[t+12>>2]=e,i[e+8>>2]=t;break}o=0|i[u+24>>2],e=0|i[u+12>>2];do{if((0|e)==(0|u)){if(e=0|i[(n=(t=u+16|0)+4|0)>>2])t=n;else if(!(e=0|i[t>>2])){n=0;break}for(;;)if(n=0|i[(r=e+20|0)>>2])e=n,t=r;else{if(!(n=0|i[(r=e+16|0)>>2]))break;e=n,t=r}i[t>>2]=0,n=e}else n=0|i[u+8>>2],i[n+12>>2]=e,i[e+8>>2]=n,n=e}while(0);if(0|o){if(e=0|i[u+28>>2],(0|i[(t=28212+(e<<2)|0)>>2])==(0|u)){if(i[t>>2]=n,!n){i[6978]=i[6978]&~(1<<e);break}}else if(i[((0|i[(r=o+16|0)>>2])==(0|u)?r:o+20)>>2]=n,!n)break;i[n+24>>2]=o,0|(t=0|i[(e=u+16|0)>>2])&&(i[n+16>>2]=t,i[t+24>>2]=n),0|(e=0|i[e+4>>2])&&(i[n+20>>2]=e,i[e+24>>2]=n)}}while(0);if(i[l+4>>2]=1|s,i[a+s>>2]=s,(0|l)==(0|i[6982]))return void(i[6979]=s)}if(e=s>>>3,s>>>0<256)return n=27948+(e<<1<<2)|0,(t=0|i[6977])&(e=1<<e)?e=0|i[(t=n+8|0)>>2]:(i[6977]=t|e,e=n,t=n+8|0),i[t>>2]=l,i[e+12>>2]=l,i[l+8>>2]=e,void(i[l+12>>2]=n);e=28212+((r=(e=s>>>8)?s>>>0>16777215?31:s>>>((r=14-((o=((u=e<<(a=(e+1048320|0)>>>16&8))+520192|0)>>>16&4)|a|(r=((u<<=o)+245760|0)>>>16&2))+(u<<r>>>15)|0)+7|0)&1|r<<1:0)<<2)|0,i[l+28>>2]=r,i[l+20>>2]=0,i[l+16>>2]=0,t=0|i[6978],n=1<<r;e:do{if(t&n){e=0|i[e>>2];t:do{if((-8&i[e+4>>2])!=(0|s)){for(r=s<<(31==(0|r)?0:25-(r>>>1)|0);t=0|i[(n=e+16+(r>>>31<<2)|0)>>2];){if((-8&i[t+4>>2])==(0|s)){e=t;break t}r<<=1,e=t}i[n>>2]=l,i[l+24>>2]=e,i[l+12>>2]=l,i[l+8>>2]=l;break e}}while(0);u=0|i[(a=e+8|0)>>2],i[u+12>>2]=l,i[a>>2]=l,i[l+8>>2]=u,i[l+12>>2]=e,i[l+24>>2]=0}else i[6978]=t|n,i[e>>2]=l,i[l+24>>2]=e,i[l+12>>2]=l,i[l+8>>2]=l}while(0);if(u=(0|i[6985])-1|0,i[6985]=u,!(0|u)){for(e=28364;e=0|i[e>>2];)e=e+8|0;i[6985]=-1}}}}function Kt(e,t){t|=0;var n=0;return(e|=0)?(n=0|_(t,e),(t|e)>>>0>65535&&(n=((n>>>0)/(e>>>0)|0)==(0|t)?n:-1)):n=0,(e=0|Yt(n))&&3&i[e+-4>>2]?(fn(0|e,0,0|n),0|e):0|e}function Zt(e,t,n,r){return 0|(x((t|=0)+(r|=0)+((n=(e|=0)+(n|=0)>>>0)>>>0<e>>>0|0)>>>0|0),n)}function Jt(e,t,n,r){return 0|(x(0|(r=(t|=0)-(r|=0)-((n|=0)>>>0>(e|=0)>>>0|0)>>>0)),e-n>>>0)}function $t(e){return 0|((e|=0)?31-(0|E(e^e-1)):32)}function en(e,t,n,r,s){s|=0;var o=0,a=0,l=0,u=0,c=0,A=0,h=0,d=0,f=0,p=0;if(A=e|=0,a=n|=0,l=d=r|=0,!(c=u=t|=0))return o=0!=(0|s),l?o?(i[s>>2]=0|e,i[s+4>>2]=0&t,s=0,0|(x(0|(d=0)),s)):(s=0,0|(x(0|(d=0)),s)):(o&&(i[s>>2]=(A>>>0)%(a>>>0),i[s+4>>2]=0),s=(A>>>0)/(a>>>0)>>>0,0|(x(0|(d=0)),s));o=0==(0|l);do{if(a){if(!o){if((o=(0|E(0|l))-(0|E(0|c))|0)>>>0<=31){a=h=o+1|0,e=A>>>(h>>>0)&(t=o-31>>31)|c<<(l=31-o|0),t&=c>>>(h>>>0),o=0,l=A<<l;break}return s?(i[s>>2]=0|e,i[s+4>>2]=u|0&t,s=0,0|(x(0|(d=0)),s)):(s=0,0|(x(0|(d=0)),s))}if((o=a-1|0)&a|0){a=l=33+(0|E(0|a))-(0|E(0|c))|0,e=(h=32-l|0)-1>>31&c>>>((f=l-32|0)>>>0)|(c<<h|A>>>(l>>>0))&(t=f>>31),t&=c>>>(l>>>0),o=A<<(p=64-l|0)&(u=h>>31),l=(c<<p|A>>>(f>>>0))&u|A<<h&l-33>>31;break}return 0|s&&(i[s>>2]=o&A,i[s+4>>2]=0),1==(0|a)?(p=0|e,0|(x(0|(f=u|0&t)),p)):(f=c>>>((p=0|$t(0|a))>>>0)|0,p=c<<32-p|A>>>(p>>>0),0|(x(0|f),p))}if(o)return 0|s&&(i[s>>2]=(c>>>0)%(a>>>0),i[s+4>>2]=0),p=(c>>>0)/(a>>>0)>>>0,0|(x(0|(f=0)),p);if(!A)return 0|s&&(i[s>>2]=0,i[s+4>>2]=(c>>>0)%(l>>>0)),p=(c>>>0)/(l>>>0)>>>0,0|(x(0|(f=0)),p);if(!((o=l-1|0)&l))return 0|s&&(i[s>>2]=0|e,i[s+4>>2]=o&c|0&t),f=0,p=c>>>((0|$t(0|l))>>>0),0|(x(0|f),p);if((o=(0|E(0|l))-(0|E(0|c))|0)>>>0<=30){a=t=o+1|0,e=c<<(l=31-o|0)|A>>>(t>>>0),t=c>>>(t>>>0),o=0,l=A<<l;break}return s?(i[s>>2]=0|e,i[s+4>>2]=u|0&t,p=0,0|(x(0|(f=0)),p)):(p=0,0|(x(0|(f=0)),p))}while(0);if(a){c=0|Zt(0|(h=0|n),0|(A=d|0&r),-1,-1),n=0|D(),u=l,l=0;do{r=u,u=o>>>31|u<<1,o=l|o<<1,Jt(0|c,0|n,0|(r=e<<1|r>>>31),0|(d=e>>>31|t<<1)),l=1&(f=(p=0|D())>>31|((0|p)<0?-1:0)<<1),e=0|Jt(0|r,0|d,f&h|0,(((0|p)<0?-1:0)>>31|((0|p)<0?-1:0)<<1)&A),t=0|D(),a=a-1|0}while(0!=(0|a));c=u,u=0}else c=l,u=0,l=0;return a=0,0|s&&(i[s>>2]=e,i[s+4>>2]=t),p=o<<1&-2|l,0|(x(0|(f=(0|o)>>>31|(c|a)<<1|u)),p)}function tn(e,t,n,r){n|=0;var i,s,o,a,l;return s=(r|=0)>>31|((0|r)<0?-1:0)<<1,i=((0|r)<0?-1:0)>>31|((0|r)<0?-1:0)<<1,o=0|Jt((l=(t|=0)>>31|((0|t)<0?-1:0)<<1)^(e|=0)|0,(a=((0|t)<0?-1:0)>>31|((0|t)<0?-1:0)<<1)^t|0,0|l,0|a),e=s^l,t=i^a,0|Jt((0|en(o,0|D(),0|Jt(s^n|0,i^r|0,0|s,0|i),0|D(),0))^e,(0|D())^t,0|e,0|t)}function nn(e,t,n,r){t|=0,r|=0;var i,s;return n=0|function(e,t){var n,r,i,s=0;return e=((n=0|_(s=65535&(t|=0),i=65535&(e|=0)))>>>16)+(0|_(s,r=e>>>16))|0,t=0|_(s=t>>>16,i),0|(x((e>>>16)+(0|_(s,r))+(((65535&e)+t|0)>>>16)|0),e+t<<16|65535&n)}(i=e|=0,s=n|=0),e=0|D(),0|(x((0|_(t,s))+(0|_(r,i))+e|0&e),n)}function rn(e,t,n,r){n|=0;var s,o,a,l,u,c;return s=k,k=k+16|0,l=0|s,c=(r|=0)>>31|((0|r)<0?-1:0)<<1,u=((0|r)<0?-1:0)>>31|((0|r)<0?-1:0)<<1,en(e=0|Jt((a=(t|=0)>>31|((0|t)<0?-1:0)<<1)^(e|=0)|0,(o=((0|t)<0?-1:0)>>31|((0|t)<0?-1:0)<<1)^t|0,0|a,0|o),t=0|D(),0|Jt(c^n|0,u^r|0,0|c,0|u),0|D(),l),r=0|Jt(i[l>>2]^a|0,i[l+4>>2]^o|0,0|a,0|o),n=0|D(),k=s,0|(x(0|n),r)}function sn(e,t,n,r){var s,o;return o=k,k=k+16|0,en(e|=0,t|=0,n|=0,r|=0,s=0|o),k=o,0|(x(0|i[s+4>>2]),i[s>>2])}function on(e,t,n){return e|=0,t|=0,(0|(n|=0))<32?(x(t>>n|0),e>>>n|(t&(1<<n)-1)<<32-n):(x(0|((0|t)<0?-1:0)),t>>n-32)}function an(e,t,n){return e|=0,t|=0,(0|(n|=0))<32?(x(t>>>n|0),e>>>n|(t&(1<<n)-1)<<32-n):(x(0),t>>>n-32|0)}function ln(e,t,n){return e|=0,t|=0,(0|(n|=0))<32?(x(t<<n|(e&(1<<n)-1<<32-n)>>>32-n),e<<n):(x(e<<n-32),0)}function un(e,t,n){return e|=0,32==(0|(t=0|E(t|=0)))&&(t=t+(0|E(e))|0),x(0),0|t}function cn(e,t){return t=+t,(e=+e)!=e?+t:t!=t?+e:+w(+e,+t)}function An(e,t){return t=+t,(e=+e)!=e?+t:t!=t?+e:+b(+e,+t)}function hn(e){return(e=+e)>=0?+l(e+.5):+v(e-.5)}function dn(e,t,n){e|=0,t|=0;var s,o,a=0;if((0|(n|=0))>=8192)return I(0|e,0|t,0|n),0|e;if(o=0|e,s=e+n|0,(3&e)==(3&t)){for(;3&e;){if(!n)return 0|o;r[e|0]=0|r[t|0],e=e+1|0,t=t+1|0,n=n-1|0}for(a=(n=-4&s)-64|0;(0|e)<=(0|a);)i[e>>2]=i[t>>2],i[e+4>>2]=i[t+4>>2],i[e+8>>2]=i[t+8>>2],i[e+12>>2]=i[t+12>>2],i[e+16>>2]=i[t+16>>2],i[e+20>>2]=i[t+20>>2],i[e+24>>2]=i[t+24>>2],i[e+28>>2]=i[t+28>>2],i[e+32>>2]=i[t+32>>2],i[e+36>>2]=i[t+36>>2],i[e+40>>2]=i[t+40>>2],i[e+44>>2]=i[t+44>>2],i[e+48>>2]=i[t+48>>2],i[e+52>>2]=i[t+52>>2],i[e+56>>2]=i[t+56>>2],i[e+60>>2]=i[t+60>>2],e=e+64|0,t=t+64|0;for(;(0|e)<(0|n);)i[e>>2]=i[t>>2],e=e+4|0,t=t+4|0}else for(n=s-4|0;(0|e)<(0|n);)r[e|0]=0|r[t|0],r[e+1|0]=0|r[t+1|0],r[e+2|0]=0|r[t+2|0],r[e+3|0]=0|r[t+3|0],e=e+4|0,t=t+4|0;for(;(0|e)<(0|s);)r[e|0]=0|r[t|0],e=e+1|0,t=t+1|0;return 0|o}function fn(e,t,n){t|=0;var s,o=0,a=0,l=0;if(s=(e|=0)+(n|=0)|0,t&=255,(0|n)>=67){for(;3&e;)r[e|0]=t,e=e+1|0;for(l=t|t<<8|t<<16|t<<24,a=(o=-4&s)-64|0;(0|e)<=(0|a);)i[e>>2]=l,i[e+4>>2]=l,i[e+8>>2]=l,i[e+12>>2]=l,i[e+16>>2]=l,i[e+20>>2]=l,i[e+24>>2]=l,i[e+28>>2]=l,i[e+32>>2]=l,i[e+36>>2]=l,i[e+40>>2]=l,i[e+44>>2]=l,i[e+48>>2]=l,i[e+52>>2]=l,i[e+56>>2]=l,i[e+60>>2]=l,e=e+64|0;for(;(0|e)<(0|o);)i[e>>2]=l,e=e+4|0}for(;(0|e)<(0|s);)r[e|0]=t,e=e+1|0;return s-n|0}function pn(e){return(e=+e)>=0?+l(e+.5):+v(e-.5)}function gn(e){e|=0;var t,n,r;return r=0|T(),(0|e)>0&(0|(t=(n=0|i[a>>2])+e|0))<(0|n)|(0|t)<0?(R(0|t),S(12),-1):(0|t)>(0|r)&&!(0|F(0|t))?(S(12),-1):(i[a>>2]=t,0|n)}return{___divdi3:tn,___muldi3:nn,___remdi3:rn,___uremdi3:sn,_areNeighborCells:function(e,t,n,r,s){s|=0;var o,a,l,u=0,c=0,A=0,h=0;if(l=k,k=k+64|0,a=l,o=l+56|0,!(!0&134217728==(2013265920&(t|=0))&!0&134217728==(2013265920&(r|=0))))return k=l,0|(s=5);if((0|(e|=0))==(0|(n|=0))&(0|t)==(0|r))return i[s>>2]=0,k=l,0|(s=0);if(c=0|an(0|e,0|t,52),D(),c&=15,h=0|an(0|n,0|r,52),D(),(0|c)!=(15&h))return k=l,0|(s=12);if(u=c+-1|0,c>>>0>1){je(e,t,u,a),je(n,r,u,o),A=0|i[(h=a)>>2],h=0|i[h+4>>2];e:do{if((0|A)==(0|i[o>>2])&&(0|h)==(0|i[o+4>>2])){u=0|an(0|e,0|t,0|(c=3*(15^c)|0)),D(),u&=7,c=0|an(0|n,0|r,0|c),D(),c&=7;do{if(0==(0|u)|0==(0|c))i[s>>2]=1,u=0;else if(7==(0|u))u=5;else{if(1==(0|u)|1==(0|c)&&0|Ge(A,h)){u=5;break}if((0|i[15536+(u<<2)>>2])!=(0|c)&&(0|i[15568+(u<<2)>>2])!=(0|c))break e;i[s>>2]=1,u=0}}while(0);return k=l,0|(s=u)}}while(0)}c=(u=a)+56|0;do{i[u>>2]=0,u=u+4|0}while((0|u)<(0|c));return P(e,t,1,a),u=(0|i[(t=a)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=a+8|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=a+16|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=a+24|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=a+32|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=a+40|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)?1:1&((0|i[(u=a+48|0)>>2])==(0|n)?(0|i[u+4>>2])==(0|r):0),i[s>>2]=u,k=l,0|(s=0)},_bitshift64Ashr:on,_bitshift64Lshr:an,_bitshift64Shl:ln,_calloc:Kt,_cellAreaKm2:function(e,t,n){return 0|(e=0|ft(e|=0,t|=0,n|=0))||(s[n>>3]=6371.007180918475*+s[n>>3]*6371.007180918475),0|e},_cellAreaM2:function(e,t,n){return 0|(e=0|ft(e|=0,t|=0,n|=0))||(s[n>>3]=6371.007180918475*+s[n>>3]*6371.007180918475*1e3*1e3),0|e},_cellAreaRads2:ft,_cellToBoundary:nt,_cellToCenterChild:He,_cellToChildPos:function(e,t,n,r){n|=0,r|=0;var s,o=0,a=0,l=0,u=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0;if(s=k,k=k+16|0,y=s,v=0|an(0|(e|=0),0|(t|=0),52),D(),v&=15,n>>>0>15)return k=s,0|(v=4);if((0|v)<(0|n))return k=s,0|(v=12);if((0|v)!=(0|n))if(a=0|ln(0|n,0,52),a|=e,u=D()|-15728641&t,(0|v)>(0|n)){c=n;do{m=0|ln(7,0,3*(14-c|0)|0),c=c+1|0,a|=m,u=0|D()|u}while((0|c)<(0|v));m=a}else m=a;else m=e,u=t;g=0|an(0|m,0|u,45),D();e:do{if(0|z(127&g)){if(c=0|an(0|m,0|u,52),D(),0|(c&=15))for(a=1;;){if(!(0==((g=0|ln(7,0,3*(15-a|0)|0))&m|0)&0==((0|D())&u))){A=33;break e}if(!(a>>>0<c>>>0))break;a=a+1|0}if(i[(g=r)>>2]=0,i[g+4>>2]=0,(0|v)>(0|n)){for(g=-15728641&t,p=v;;){if(f=p,(p=p+-1|0)>>>0>15|(0|v)<(0|p)){A=19;break}if((0|v)!=(0|p))if(a=0|ln(0|p,0,52),a|=e,c=0|D()|g,(0|v)<(0|f))d=a;else{A=p;do{d=0|ln(7,0,3*(14-A|0)|0),A=A+1|0,a|=d,c=0|D()|c}while((0|A)<(0|v));d=a}else d=e,c=t;if(h=0|an(0|d,0|c,45),D(),0|z(127&h)){h=0|an(0|d,0|c,52),D(),h&=15;t:do{if(h)for(A=1;;){if(a=0|an(0|d,0|c,3*(15-A|0)|0),D(),0|(a&=7))break t;if(!(A>>>0<h>>>0)){a=0;break}A=A+1|0}else a=0}while(0);a=0==(0|a)&1}else a=0;if(c=0|an(0|e,0|t,3*(15-f|0)|0),D(),7==(0|(c&=7))){o=5,A=42;break}if(1==(0|c)&(a=0!=(0|a))){o=5,A=42;break}if(0|(d=c+((0!=(0|c)&a)<<31>>31)|0)&&(A=0|wt(7,0,A=v-f|0,((0|A)<0)<<31>>31),h=0|D(),a?(a=0|Zt(0|(a=0|nn(0|A,0|h,5,0)),0|D(),-5,-1),a=0|Zt(0|(a=0|tn(0|a,0|D(),6,0)),0|D(),1,0),c=0|D()):(a=A,c=h),f=0|Zt(0|a,0|c,0|(f=0|nn(0|A,0|h,0|(f=d+-1|0),((0|f)<0)<<31>>31)),0|D()),h=0|Zt(0|f,0|(d=0|D()),0|i[(h=r)>>2],0|i[h+4>>2]),d=0|D(),i[(f=r)>>2]=h,i[f+4>>2]=d),(0|p)<=(0|n)){A=37;break}}if(19==(0|A))C(27795,27122,1276,27158);else{if(37==(0|A)){o=0|i[(l=r)+4>>2],l=0|i[l>>2];break}if(42==(0|A))return k=s,0|o}}else o=0,l=0}else A=33}while(0);e:do{if(33==(0|A)){if(i[(g=r)>>2]=0,i[g+4>>2]=0,(0|v)>(0|n)){for(a=v;;){if(o=0|an(0|e,0|t,3*(15-a|0)|0),D(),7==(0|(o&=7))){o=5;break}if(o=0|nn(0|(l=0|wt(7,0,l=v-a|0,((0|l)<0)<<31>>31)),0|D(),0|o,0),l=0|D(),l=0|Zt(0|i[(g=r)>>2],0|i[g+4>>2],0|o,0|l),o=0|D(),i[(g=r)>>2]=l,i[g+4>>2]=o,(0|(a=a+-1|0))<=(0|n))break e}return k=s,0|o}o=0,l=0}}while(0);return 0|Ve(m,u,v,y)&&C(27795,27122,1236,27173),((0|o)>-1|-1==(0|o)&l>>>0>4294967295)&((0|(y=0|i[(v=y)+4>>2]))>(0|o)|((0|y)==(0|o)?(0|i[v>>2])>>>0>l>>>0:0))?(k=s,0|(v=0)):(C(27795,27122,1316,27158),0)},_cellToChildren:function(e,t,n,r){r|=0;var s,o,a=0,l=0;if(o=k,k=k+16|0,it(s=o,e|=0,t|=0,n|=0),0==(0|(e=0|i[(t=s)>>2]))&0==(0|(t=0|i[t+4>>2])))return k=o,0;a=0,n=0;do{i[(l=r+(a<<3)|0)>>2]=e,i[l+4>>2]=t,a=0|Zt(0|a,0|n,1,0),n=0|D(),ot(s),e=0|i[(l=s)>>2],t=0|i[l+4>>2]}while(!(0==(0|e)&0==(0|t)));return k=o,0},_cellToChildrenSize:Ve,_cellToLatLng:tt,_cellToLocalIj:function(e,t,n,r,i,s){var o,a;return e|=0,t|=0,n|=0,r|=0,s|=0,a=k,k=k+16|0,o=a,(i|=0)?e=15:(e=0|_t(e,t,n,r,o))||(xe(o,s),e=0),k=a,0|e},_cellToParent:je,_cellToVertex:Ut,_cellToVertexes:function(e,t,n){n|=0;var r,s=0,o=0;return o=0==(0|Ge(e|=0,t|=0)),r=0==(0|(s=0|Ut(e,t,0,n))),o?r?0|(s=0|Ut(e,t,1,n+8|0))||0|(s=0|Ut(e,t,2,n+16|0))||0|(s=0|Ut(e,t,3,n+24|0))||(s=0|Ut(e,t,4,n+32|0))?0|(o=s):0|Ut(e,t,5,n+40|0):0|(o=s):r?0|(s=0|Ut(e,t,1,n+8|0))||0|(s=0|Ut(e,t,2,n+16|0))||0|(s=0|Ut(e,t,3,n+24|0))||0|(s=0|Ut(e,t,4,n+32|0))?0|(o=s):(i[(o=n+40|0)>>2]=0,i[o+4>>2]=0,0|(o=0)):0|(o=s)},_cellsToDirectedEdge:function(e,t,n,r,s){return s|=0,7==(0|(n=0|N(e|=0,t|=0,n|=0,r|=0)))?0|(s=11):(r=0|ln(0|n,0,56),t=-2130706433&t|D()|268435456,i[s>>2]=e|r,i[s+4>>2]=t,0|(s=0))},_cellsToLinkedMultiPolygon:function(e,t,n){n|=0;var r,s,o,a=0;if(o=k,k=k+32|0,r=o,e=0|function(e,t,n){e|=0,n|=0;var r,s,o=0,a=0,l=0,u=0,c=0,A=0;if(s=k,k=k+176|0,r=s,(0|(t|=0))<1)return zt(n,0,0),k=s,0;for(c=0|an(0|i[(c=e)>>2],0|i[c+4>>2],52),D(),zt(n,(0|t)>6?t:6,15&c),c=0;!(0|(o=0|nt(0|i[(o=e+(c<<3)|0)>>2],0|i[o+4>>2],r)));){if((0|(o=0|i[r>>2]))>0){u=0;do{l=r+8+(u<<4)|0,(a=0|Ht(n,o=r+8+((0|(u=u+1|0))%(0|o)<<4)|0,l))?Gt(n,a):Wt(n,l,o),o=0|i[r>>2]}while((0|u)<(0|o))}if((0|(c=c+1|0))>=(0|t)){o=0,A=13;break}}return 13==(0|A)?(k=s,0|o):(jt(n),k=s,0|(A=o))}(e|=0,t|=0,s=o+16|0),0|e)return k=o,0|(n=e);if(i[n>>2]=0,i[n+4>>2]=0,i[n+8>>2]=0,0|(e=0|Vt(s)))do{t=0|pt(n);do{gt(t,e),a=e+16|0,i[r>>2]=i[a>>2],i[r+4>>2]=i[a+4>>2],i[r+8>>2]=i[a+8>>2],i[r+12>>2]=i[a+12>>2],Gt(s,e),e=0|Qt(s,r)}while(0!=(0|e));e=0|Vt(s)}while(0!=(0|e));return jt(s),(e=0|yt(n))?(mt(n),k=o,0|(a=e)):(k=o,0|(a=0))},_childPosToCell:function(e,t,n,r,s,o){e|=0,t|=0,o|=0;var a,l=0,u=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0;if(a=k,k=k+16|0,l=a,(s|=0)>>>0>15)return k=a,0|(o=4);if(u=0|an(0|(n|=0),0|(r|=0),52),D(),(0|(u&=15))>(0|s))return k=a,0|(o=12);if(0|Ve(n,r,s,l)&&C(27795,27122,1236,27173),!(((0|t)>-1|-1==(0|t)&e>>>0>4294967295)&((0|(A=0|i[(h=l)+4>>2]))>(0|t)|((0|A)==(0|t)?(0|i[h>>2])>>>0>e>>>0:0))))return k=a,0|(o=2);h=s-u|0,s=0|ln(0|s,0,52),c=D()|-15728641&r,i[(A=o)>>2]=s|n,i[A+4>>2]=c,A=0|an(0|n,0|r,45),D();e:do{if(0|z(127&A)){if(0|u)for(l=1;;){if(!(0==((A=0|ln(7,0,3*(15-l|0)|0))&n|0)&0==((0|D())&r)))break e;if(!(l>>>0<u>>>0))break;l=l+1|0}if((0|h)<1)return k=a,0|(o=0);for(A=15^u,r=-1,c=1,l=1;;){u=0|wt(7,0,u=h-c|0,((0|u)<0)<<31>>31),n=0|D();do{if(l){if(l=0|tn(0|(l=0|Zt(0|(l=0|nn(0|u,0|n,5,0)),0|D(),-5,-1)),0|D(),6,0),(0|t)>(0|(s=0|D()))|(0|t)==(0|s)&e>>>0>l>>>0){t=0|Jt(0|(t=0|Zt(0|e,0|t,-1,-1)),0|D(),0|l,0|s),l=0|D(),p=0|i[(d=o)>>2],d=0|i[d+4>>2],f=0|ln(7,0,0|(g=3*(A+r|0)|0)),d&=~D(),g=0|ln(0|(s=0|Zt(0|(r=0|tn(0|t,0|l,0|u,0|n)),0|(e=0|D()),2,0)),0|D(),0|g),d=0|D()|d,i[(s=o)>>2]=g|p&~f,i[s+4>>2]=d,e=0|Jt(0|t,0|l,0|(e=0|nn(0|r,0|e,0|u,0|n)),0|D()),l=0,t=0|D();break}f=0|i[(g=o)>>2],g=0|i[g+4>>2],p=0|ln(7,0,3*(A+r|0)|0),g&=~D(),i[(l=o)>>2]=f&~p,i[l+4>>2]=g,l=1;break}s=0|i[(f=o)>>2],f=0|i[f+4>>2],d=0|ln(7,0,0|(r=3*(A+r|0)|0)),f&=~D(),r=0|ln(0|(g=0|tn(0|e,0|t,0|u,0|n)),0|(l=0|D()),0|r),f=0|D()|f,i[(p=o)>>2]=r|s&~d,i[p+4>>2]=f,e=0|Jt(0|e,0|t,0|(l=0|nn(0|g,0|l,0|u,0|n)),0|D()),l=0,t=0|D()}while(0);if(!((0|h)>(0|c))){t=0;break}r=~c,c=c+1|0}return k=a,0|t}}while(0);if((0|h)<1)return k=a,0|(g=0);for(s=15^u,l=1;;){if(p=0|wt(7,0,p=h-l|0,((0|p)<0)<<31>>31),g=0|D(),n=0|i[(c=o)>>2],c=0|i[c+4>>2],r=0|ln(7,0,0|(u=3*(s-l|0)|0)),c&=~D(),u=0|ln(0|(d=0|tn(0|e,0|t,0|p,0|g)),0|(f=0|D()),0|u),c=0|D()|c,i[(A=o)>>2]=u|n&~r,i[A+4>>2]=c,e=0|Jt(0|e,0|t,0|(g=0|nn(0|d,0|f,0|p,0|g)),0|D()),t=0|D(),(0|h)<=(0|l)){t=0;break}l=l+1|0}return k=a,0|t},_compactCells:function(e,t,n,r){t|=0;var s,o=0,a=0,l=0,u=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0,b=0,w=0,E=0,x=0,S=0,T=0,I=0,F=0,R=0,k=0;if(0==(0|(n|=0))&0==(0|(r|=0)))return 0|(k=0);if(a=0|i[(o=e|=0)>>2],!0&0==(15728640&(o=0|i[o+4>>2]))){if(!((0|r)>0|0==(0|r)&n>>>0>0))return 0|(k=0);if(i[(k=t)>>2]=a,i[k+4>>2]=o,1==(0|n)&0==(0|r))return 0|(k=0);o=1,a=0;do{R=0|i[(F=e+(o<<3)|0)+4>>2],i[(k=t+(o<<3)|0)>>2]=i[F>>2],i[k+4>>2]=R,o=0|Zt(0|o,0|a,1,0),a=0|D()}while((0|a)<(0|r)|(0|a)==(0|r)&o>>>0<n>>>0);return 0|(o=0)}if(!(R=0|Yt(s=n<<3)))return 0|(k=13);if(dn(0|R,0|e,0|s),!(F=0|Kt(n,8)))return qt(R),0|(k=13);e:for(;;){T=0|an(0|(A=0|i[(o=R)>>2]),0|(o=0|i[o+4>>2]),52),D(),I=(T&=15)+-1|0,S=0!=(0|T),x=(0|r)>0|0==(0|r)&n>>>0>0;t:do{if(S&x){if(_=0|ln(0|I,0,52),b=0|D(),I>>>0>15){if(!(0==(0|A)&0==(0|o))){k=16;break e}for(a=0,e=0;;){if(a=0|Zt(0|a,0|e,1,0),!((0|(e=0|D()))<(0|r)|(0|e)==(0|r)&a>>>0<n>>>0))break t;if(!(0==(0|(E=0|i[(l=R+(a<<3)|0)>>2]))&0==(0|(l=0|i[l+4>>2])))){o=l,k=16;break e}}}for(u=A,e=o,a=0,l=0;;){if(!(0==(0|u)&0==(0|e))){if(!(!0&0==(117440512&e))){k=21;break e}if(h=0|an(0|u,0|e,52),D(),(0|(h&=15))<(0|I)){o=12,k=27;break e}if((0|h)!=(0|I)&&(u|=_,e=-15728641&e|b,h>>>0>=T>>>0)){c=I;do{E=0|ln(7,0,3*(14-c|0)|0),c=c+1|0,u|=E,e=0|D()|e}while(c>>>0<h>>>0)}if(f=0|sn(0|u,0|e,0|n,0|r),p=0|D(),!(0==(0|(d=0|i[(h=c=F+(f<<3)|0)>>2]))&0==(0|(h=0|i[h+4>>2])))){y=0,v=0;do{if((0|y)>(0|r)|(0|y)==(0|r)&v>>>0>n>>>0){k=31;break e}if((0|d)==(0|u)&(-117440513&h)==(0|e)){g=0|an(0|d,0|h,56),D(),m=(g&=7)+1|0,E=0|an(0|d,0|h,45),D();n:do{if(0|z(127&E)){if(d=0|an(0|d,0|h,52),D(),!(d&=15)){h=6;break}for(h=1;;){if(!(0==((E=0|ln(7,0,3*(15-h|0)|0))&u|0)&0==((0|D())&e))){h=7;break n}if(!(h>>>0<d>>>0)){h=6;break}h=h+1|0}}else h=7}while(0);if((g+2|0)>>>0>h>>>0){k=41;break e}E=0|ln(0|m,0,56),e=D()|-117440513&e,i[(w=c)>>2]=0,i[w+4>>2]=0,u|=E}else f=0|rn(0|(f=0|Zt(0|f,0|p,1,0)),0|D(),0|n,0|r),p=0|D();v=0|Zt(0|v,0|y,1,0),y=0|D(),d=0|i[(h=c=F+(f<<3)|0)>>2],h=0|i[h+4>>2]}while(!(0==(0|d)&0==(0|h)))}i[(E=c)>>2]=u,i[E+4>>2]=e}if(a=0|Zt(0|a,0|l,1,0),!((0|(l=0|D()))<(0|r)|(0|l)==(0|r)&a>>>0<n>>>0))break t;u=0|i[(e=R+(a<<3)|0)>>2],e=0|i[e+4>>2]}}}while(0);if(E=0|Zt(0|n,0|r,5,0),(w=0|D())>>>0<0|0==(0|w)&E>>>0<11){k=85;break}if(E=0|tn(0|n,0|r,6,0),D(),!(E=0|Kt(E,8))){k=48;break}do{if(x){for(m=0,e=0,g=0,y=0;;){if(0==(0|(a=0|i[(l=h=F+(m<<3)|0)>>2]))&0==(0|(l=0|i[l+4>>2])))w=g;else{d=0|an(0|a,0|l,56),D(),u=(d&=7)+1|0,f=-117440513&l,w=0|an(0|a,0|l,45),D();t:do{if(0|z(127&w)){if(p=0|an(0|a,0|l,52),D(),0|(p&=15))for(c=1;;){if(!(0==(a&(w=0|ln(7,0,3*(15-c|0)|0))|0)&0==(f&(0|D()))))break t;if(!(c>>>0<p>>>0))break;c=c+1|0}a|=l=0|ln(0|u,0,56),l=0|D()|f,i[(u=h)>>2]=a,i[u+4>>2]=l,u=d+2|0}}while(0);7==(0|u)?(i[(w=E+(e<<3)|0)>>2]=a,i[w+4>>2]=-117440513&l,e=0|Zt(0|e,0|g,1,0),w=0|D()):w=g}if(m=0|Zt(0|m,0|y,1,0),!((0|(y=0|D()))<(0|r)|(0|y)==(0|r)&m>>>0<n>>>0))break;g=w}if(x){if(v=I>>>0>15,_=0|ln(0|I,0,52),b=0|D(),!S){for(a=0,c=0,u=0,l=0;0==(0|A)&0==(0|o)||(i[(I=t+(a<<3)|0)>>2]=A,i[I+4>>2]=o,a=0|Zt(0|a,0|c,1,0),c=0|D()),u=0|Zt(0|u,0|l,1,0),(0|(l=0|D()))<(0|r)|(0|l)==(0|r)&u>>>0<n>>>0;)A=0|i[(o=R+(u<<3)|0)>>2],o=0|i[o+4>>2];o=w;break}for(a=0,c=0,l=0,u=0;;){do{if(!(0==(0|A)&0==(0|o))){if(p=0|an(0|A,0|o,52),D(),v|(0|(p&=15))<(0|I)){k=80;break e}if((0|p)!=(0|I)){if(h=A|_,d=-15728641&o|b,p>>>0>=T>>>0){f=I;do{S=0|ln(7,0,3*(14-f|0)|0),f=f+1|0,h|=S,d=0|D()|d}while(f>>>0<p>>>0)}}else h=A,d=o;g=0|sn(0|h,0|d,0|n,0|r),f=0,p=0,y=0|D();do{if((0|f)>(0|r)|(0|f)==(0|r)&p>>>0>n>>>0){k=81;break e}if((-117440513&(m=0|i[(S=F+(g<<3)|0)+4>>2]))==(0|d)&&(0|i[S>>2])==(0|h)){k=65;break}g=0|rn(0|(S=0|Zt(0|g,0|y,1,0)),0|D(),0|n,0|r),y=0|D(),p=0|Zt(0|p,0|f,1,0),f=0|D(),S=F+(g<<3)|0}while((0|i[S>>2])!=(0|h)||(0|i[S+4>>2])!=(0|d));if(65==(0|k)&&(k=0,!0&100663296==(117440512&m)))break;i[(S=t+(a<<3)|0)>>2]=A,i[S+4>>2]=o,a=0|Zt(0|a,0|c,1,0),c=0|D()}}while(0);if(l=0|Zt(0|l,0|u,1,0),!((0|(u=0|D()))<(0|r)|(0|u)==(0|r)&l>>>0<n>>>0))break;A=0|i[(o=R+(l<<3)|0)>>2],o=0|i[o+4>>2]}o=w}else a=0,o=w}else a=0,e=0,o=0}while(0);if(fn(0|F,0,0|s),dn(0|R,0|E,e<<3),qt(E),0==(0|e)&0==(0|o)){k=89;break}t=t+(a<<3)|0,r=o,n=e}if(16==(0|k))!0&0==(117440512&o)?(o=4,k=27):k=21;else if(31==(0|k))C(27795,27122,529,27132);else{if(41==(0|k))return qt(R),qt(F),0|(k=10);if(48==(0|k))return qt(R),qt(F),0|(k=13);80==(0|k)?C(27795,27122,620,27132):81==(0|k)?C(27795,27122,632,27132):85==(0|k)&&(dn(0|t,0|R,n<<3),k=89)}return 21==(0|k)?(qt(R),qt(F),0|(k=5)):27==(0|k)?(qt(R),qt(F),0|(k=o)):89==(0|k)?(qt(R),qt(F),0|(k=0)):0},_destroyLinkedMultiPolygon:mt,_directedEdgeToBoundary:Te,_directedEdgeToCells:function(e,t,n){e|=0;var r,s,o,a=0;return r=k,k=k+16|0,a=r,!0&268435456==(2013265920&(t|=0))?(s=-2130706433&t|134217728,i[(o=n|=0)>>2]=e,i[o+4>>2]=s,i[a>>2]=0,t=0|an(0|e,0|t,56),D(),a=0|O(e,s,7&t,a,n+8|0),k=r,0|a):(k=r,0|(a=6))},_edgeLengthKm:function(e,t,n){n|=0;var r,o=0,a=0,l=0,u=0,A=0,f=0,p=0;if(r=k,k=k+176|0,0|(e=0|Te(e|=0,t|=0,u=r)))return u=e,l=+s[n>>3],l*=6371.007180918475,s[n>>3]=l,k=r,0|u;if(s[n>>3]=0,(0|(e=0|i[u>>2]))<=1)return u=0,l=0,l*=6371.007180918475,s[n>>3]=l,k=r,0|u;t=e+-1|0,e=0,o=+s[u+8>>3],a=+s[u+16>>3],l=0;do{f=o,o=+s[u+8+((e=e+1|0)<<4)>>3],p=+d(.5*(o-f)),A=a,a=+s[u+8+(e<<4)+8>>3],A=p*p+(A=+d(.5*(a-A)))*(+h(+f)*+h(+o)*A),l+=2*+y(+ +c(+A),+ +c(+(1-A)))}while((0|e)!=(0|t));return s[n>>3]=l,u=0,p=l,p*=6371.007180918475,s[n>>3]=p,k=r,0|u},_edgeLengthM:function(e,t,n){n|=0;var r,o=0,a=0,l=0,u=0,A=0,f=0,p=0;if(r=k,k=k+176|0,0|(e=0|Te(e|=0,t|=0,u=r)))return u=e,l=+s[n>>3],l*=6371.007180918475,l*=1e3,s[n>>3]=l,k=r,0|u;if(s[n>>3]=0,(0|(e=0|i[u>>2]))<=1)return u=0,l=0,l*=6371.007180918475,l*=1e3,s[n>>3]=l,k=r,0|u;t=e+-1|0,e=0,o=+s[u+8>>3],a=+s[u+16>>3],l=0;do{f=o,o=+s[u+8+((e=e+1|0)<<4)>>3],p=+d(.5*(o-f)),A=a,a=+s[u+8+(e<<4)+8>>3],A=p*p+(A=+d(.5*(a-A)))*(+h(+f)*+h(+o)*A),l+=2*+y(+ +c(+A),+ +c(+(1-A)))}while((0|e)!=(0|t));return s[n>>3]=l,u=0,p=l,p*=6371.007180918475,p*=1e3,s[n>>3]=p,k=r,0|u},_edgeLengthRads:function(e,t,n){n|=0;var r,o=0,a=0,l=0,u=0,A=0,f=0,p=0;if(r=k,k=k+176|0,0|(e=0|Te(e|=0,t|=0,u=r)))return k=r,0|(u=e);if(s[n>>3]=0,(0|(e=0|i[u>>2]))<=1)return k=r,0|(u=0);t=e+-1|0,e=0,o=+s[u+8>>3],a=+s[u+16>>3],l=0;do{f=o,o=+s[u+8+((e=e+1|0)<<4)>>3],p=+d(.5*(o-f)),A=a,a=+s[u+8+(e<<4)+8>>3],A=p*p+(A=+d(.5*(a-A)))*(+h(+o)*+h(+f)*A),l+=2*+y(+ +c(+A),+ +c(+(1-A)))}while((0|e)<(0|t));return s[n>>3]=l,k=r,0|(u=0)},_emscripten_replace_memory:function(e){return r=new Int8Array(e),new Uint8Array(e),i=new Int32Array(e),new Float32Array(e),s=new Float64Array(e),n=e,!0},_free:qt,_getBaseCellNumber:Ne,_getDirectedEdgeDestination:function(e,t,n){e|=0,t|=0,n|=0;var r,s,o=0;return r=k,k=k+16|0,i[(o=r)>>2]=0,!0&268435456==(2013265920&t)?(s=0|an(0|e,0|t,56),D(),o=0|O(e,-2130706433&t|134217728,7&s,o,n),k=r,0|o):(k=r,0|(o=6))},_getDirectedEdgeOrigin:function(e,t,n){return e|=0,n|=0,!0&268435456==(2013265920&(t|=0))?(i[n>>2]=e,i[n+4>>2]=-2130706433&t|134217728,0|(n=0)):0|(n=6)},_getHexagonAreaAvgKm2:At,_getHexagonAreaAvgM2:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(s[t>>3]=+s[20784+(e<<3)>>3],0|(t=0))},_getHexagonEdgeLengthAvgKm:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(s[t>>3]=+s[20912+(e<<3)>>3],0|(t=0))},_getHexagonEdgeLengthAvgM:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(s[t>>3]=+s[21040+(e<<3)>>3],0|(t=0))},_getIcosahedronFaces:function e(t,n,r){r|=0;var s,o=0,a=0,l=0,u=0,c=0,A=0,h=0,d=0;s=k,k=k+128|0,h=s+112|0,l=s+96|0,d=s,a=0|an(0|(t|=0),0|(n|=0),52),D(),c=15&a,i[h>>2]=c,u=0|an(0|t,0|n,45),D(),u&=127;e:do{if(0|z(u)){if(0|c)for(o=1;;){if(!(0==((A=0|ln(7,0,3*(15-o|0)|0))&t|0)&0==((0|D())&n))){a=0;break e}if(!(o>>>0<c>>>0))break;o=o+1|0}if(!(1&a))return A=0|ln(c+1|0,0,52),d=D()|-15728641&n,d=0|e((A|t)&~(h=0|ln(7,0,3*(14-c|0)|0)),d&~D(),r),k=s,0|d;a=1}else a=0}while(0);if(!(o=0|et(t,n,l))){a?(Pe(l,h,d),A=5):(Oe(l,h,d),A=6);e:do{if(0|z(u))if(c)for(o=1;;){if(!(0==((u=0|ln(7,0,3*(15-o|0)|0))&t|0)&0==((0|D())&n))){t=2;break e}if(!(o>>>0<c>>>0)){t=5;break}o=o+1|0}else t=5;else t=2}while(0);fn(0|r,-1,t<<2);e:do{if(a)for(l=0;;){if(Be(u=d+(l<<4)|0,0|i[h>>2]),u=0|i[u>>2],-1==(0|(c=0|i[r>>2]))|(0|c)==(0|u))o=r;else{a=0;do{if((a=a+1|0)>>>0>=t>>>0){o=1;break e}c=0|i[(o=r+(a<<2)|0)>>2]}while(!(-1==(0|c)|(0|c)==(0|u)))}if(i[o>>2]=u,(l=l+1|0)>>>0>=A>>>0){o=0;break}}else for(l=0;;){if(Me(u=d+(l<<4)|0,0|i[h>>2],0,1),u=0|i[u>>2],-1==(0|(c=0|i[r>>2]))|(0|c)==(0|u))o=r;else{a=0;do{if((a=a+1|0)>>>0>=t>>>0){o=1;break e}c=0|i[(o=r+(a<<2)|0)>>2]}while(!(-1==(0|c)|(0|c)==(0|u)))}if(i[o>>2]=u,(l=l+1|0)>>>0>=A>>>0){o=0;break}}}while(0)}return k=s,0|(d=o)},_getNumCells:ht,_getPentagons:rt,_getRes0Cells:function(e){e|=0;var t=0,n=0,r=0;t=0;do{ln(0|t,0,45),r=134225919|D(),i[(n=e+(t<<3)|0)>>2]=-1,i[n+4>>2]=r,t=t+1|0}while(122!=(0|t));return 0},_getResolution:function(e,t){return t=0|an(0|(e|=0),0|(t|=0),52),D(),15&t},_greatCircleDistanceKm:ct,_greatCircleDistanceM:function(e,t){e|=0;var n,r,i,o=0;return r=+s[(t|=0)>>3],n=+s[e>>3],o=(i=+d(.5*(r-n)))*i+(o=+d(.5*(+s[t+8>>3]-+s[e+8>>3])))*(+h(+r)*+h(+n)*o),2*+y(+ +c(+o),+ +c(+(1-o)))*6371.007180918475*1e3},_greatCircleDistanceRads:function(e,t){e|=0;var n,r,i,o=0;return r=+s[(t|=0)>>3],n=+s[e>>3],o=(i=+d(.5*(r-n)))*i+(o=+d(.5*(+s[t+8>>3]-+s[e+8>>3])))*(+h(+r)*+h(+n)*o),2*+y(+ +c(+o),+ +c(+(1-o)))},_gridDisk:P,_gridDiskDistances:M,_gridDistance:function(e,t,n,r,s){n|=0,r|=0,s|=0;var o,a,l=0,u=0;return a=k,k=k+32|0,u=a,0|(o=0|_t(e|=0,t|=0,e,t,l=a+12|0))?(k=a,0|(u=o)):0|(e=0|_t(e,t,n,r,u))?(k=a,0|(u=e)):(l=0|Ee(l,u),i[(u=s)>>2]=l,i[u+4>>2]=((0|l)<0)<<31>>31,k=a,0|(u=0))},_gridPathCells:function(e,t,n,r,s){n|=0,r|=0,s|=0;var o,a,l=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0,b=0,w=0,E=0,x=0,S=0,T=0;if(a=k,k=k+48|0,c=a+12|0,S=a,!(l=0|_t(e|=0,t|=0,e,t,o=a+24|0))&&!(l=0|_t(e,t,n,r,c))){x=((0|(E=0|Ee(o,c)))<0)<<31>>31,i[o>>2]=0,i[o+4>>2]=0,i[o+8>>2]=0,i[c>>2]=0,i[c+4>>2]=0,i[c+8>>2]=0,0|_t(e,t,e,t,o)&&C(27795,27538,692,27747),0|_t(e,t,n,r,c)&&C(27795,27538,697,27747),Ce(o),Ce(c),f=0==(0|E)?0:1/+(0|E),n=0|i[o>>2],v=f*+((0|i[c>>2])-n|0),r=0|i[(_=o+4|0)>>2],b=f*+((0|i[c+4>>2])-r|0),l=0|i[(w=o+8|0)>>2],f*=+((0|i[c+8>>2])-l|0),i[S>>2]=n,i[(p=S+4|0)>>2]=r,i[(g=S+8|0)>>2]=l;e:do{if((0|E)<0)l=0;else for(m=0,y=0;;){T=v*(h=+(y>>>0)+4294967296*+(0|m))+ +(0|n),A=b*h+ +(0|r),h=f*h+ +(0|l),n=~~+hn(+T),c=~~+hn(+A),l=~~+hn(+h),T=+u(+(+(0|n)-T)),A=+u(+(+(0|c)-A)),h=+u(+(+(0|l)-h));do{if(!(T>A&T>h)){if(d=0-n|0,A>h){r=d-l|0;break}r=c,l=d-c|0;break}n=0-(c+l)|0,r=c}while(0);if(i[S>>2]=n,i[p>>2]=r,i[g>>2]=l,Se(S),0|(l=0|bt(e,t,S,s+(y<<3)|0)))break e;if(!((0|m)<(0|x)|(0|m)==(0|x)&y>>>0<E>>>0)){l=0;break e}n=0|Zt(0|y,0|m,1,0),m=r=0|D(),y=n,n=0|i[o>>2],r=0|i[_>>2],l=0|i[w>>2]}}while(0);return k=a,0|(S=l)}return k=a,0|(S=l)},_gridPathCellsSize:function(e,t,n,r,s){n|=0,r|=0,s|=0;var o,a=0,l=0,u=0;return o=k,k=k+32|0,u=o,(a=0|_t(e|=0,t|=0,e,t,l=o+12|0))||(a=0|_t(e,t,n,r,u))?(k=o,0|(u=a)):(r=0|Zt(0|(r=0|Ee(l,u)),((0|r)<0)<<31>>31,1,0),l=0|D(),i[(u=s)>>2]=r,i[u+4>>2]=l,k=o,0|(u=0))},_gridRingUnsafe:function(e,t,n,r){e|=0,t|=0,n|=0,r|=0;var s,o,a=0,l=0,u=0,c=0,A=0,h=0,d=0,f=0,p=0;if(o=k,k=k+16|0,p=o+8|0,i[(f=s=o)>>2]=e,i[f+4>>2]=t,!n)return i[(p=r)>>2]=e,i[p+4>>2]=t,k=o,0|(p=0);i[p>>2]=0;e:do{if(0|Ge(e,t))e=9;else{if(l=(0|n)>0){a=0,f=e;do{if(0|(e=0|O(f,t,4,p,s)))break e;if(a=a+1|0,0|Ge(f=0|i[(t=s)>>2],t=0|i[t+4>>2])){e=9;break e}}while((0|a)<(0|n));if(i[(d=r)>>2]=f,i[d+4>>2]=t,d=n+-1|0,l){h=0,e=1;do{if(a=26800+(h<<2)|0,5==(0|h))for(u=0|i[a>>2],l=0,a=e;;){if(0|(e=0|O(0|i[(e=s)>>2],0|i[e+4>>2],u,p,s)))break e;if((0|l)!=(0|d)){if(c=0|i[(A=s)>>2],A=0|i[A+4>>2],i[(e=r+(a<<3)|0)>>2]=c,i[e+4>>2]=A,0|Ge(c,A)){e=9;break e}e=a+1|0}else e=a;if((0|(l=l+1|0))>=(0|n))break;a=e}else for(u=s,A=0|i[a>>2],c=0,a=e,l=0|i[u>>2],u=0|i[u+4>>2];;){if(0|(e=0|O(l,u,A,p,s)))break e;if(l=0|i[(u=s)>>2],u=0|i[u+4>>2],i[(e=r+(a<<3)|0)>>2]=l,i[e+4>>2]=u,e=a+1|0,0|Ge(l,u)){e=9;break e}if((0|(c=c+1|0))>=(0|n))break;a=e}h=h+1|0}while(h>>>0<6);u=f,a=0|i[(e=s)>>2],l=t,e=0|i[e+4>>2]}else u=f,a=f,l=t,e=t}else i[(u=r)>>2]=e,i[u+4>>2]=t,u=e,a=e,l=t,e=t;e=(0|u)==(0|a)&(0|l)==(0|e)?0:9}}while(0);return k=o,0|(p=e)},_i64Add:Zt,_i64Subtract:Jt,_isPentagon:Ge,_isResClassIII:function(e,t){return t=0|an(0|(e|=0),0|(t|=0),52),D(),1&t},_isValidCell:Ue,_isValidDirectedEdge:function(e,t){var n=0;switch(n=0|an(0|(e|=0),0|(t|=0),56),D(),7&n){case 0:case 7:return 0|(n=0)}return n=-2130706433&t|134217728,!0&268435456==(2013265920&t)?!0&16777216==(117440512&t)&0!=(0|Ge(e,n))?0|(n=0):0|(n=0|Ue(e,n)):0|(n=0)},_isValidVertex:function(e,t){e|=0;var n,r,s=0,o=0;return r=k,k=k+16|0,n=r,!0&536870912==(2013265920&(t|=0))&&0|Ue(e,s=-2130706433&t|134217728)?(o=0|an(0|e,0|t,56),D(),s=(o=0==(0|Ut(e,s,7&o,n)))&((0|i[(s=n)>>2])==(0|e)?(0|i[s+4>>2])==(0|t):0)&1,k=r,0|s):(k=r,0|(s=0))},_latLngToCell:Je,_llvm_ctlz_i64:un,_llvm_maxnum_f64:cn,_llvm_minnum_f64:An,_llvm_round_f64:hn,_localIjToCell:function(e,t,n,r,i){var s,o;return e|=0,t|=0,n|=0,i|=0,o=k,k=k+16|0,s=o,(r|=0)?n=15:(n=0|De(n,s))||(n=0|bt(e,t,s,i)),k=o,0|n},_malloc:Yt,_maxFaceCount:function(e,t,n){n|=0;var r=0,s=0;if(s=0|an(0|(e|=0),0|(t|=0),45),D(),!(0|z(127&s)))return s=2,i[n>>2]=s,0;if(s=0|an(0|e,0|t,52),D(),!(s&=15))return s=5,i[n>>2]=s,0;for(r=1;;){if(!(0==((0|ln(7,0,3*(15-r|0)|0))&e|0)&0==((0|D())&t))){r=2,e=6;break}if(!(r>>>0<s>>>0)){r=5,e=6;break}r=r+1|0}return 6==(0|e)?(i[n>>2]=r,0):0},_maxGridDiskSize:function(e,t){t|=0;var n=0,r=0,s=0;return(0|(e|=0))<0?0|(t=2):(0|e)>13780509?0|(t=0|ht(15,t)):(s=0|nn(0|e,0|(n=((0|e)<0)<<31>>31),3,0),r=0|D(),n=0|Zt(0|e,0|n,1,0),n=0|Zt(0|(n=0|nn(0|s,0|r,0|n,0|D())),0|D(),1,0),e=0|D(),i[t>>2]=n,i[t+4>>2]=e,0|(t=0))},_maxPolygonToCellsSize:function(e,t,n,r){e|=0,t|=0,r|=0;var s,o=0,a=0,l=0,u=0,c=0;if(s=k,k=k+48|0,o=s+16|0,a=s+8|0,l=s,0|(n=0|It(n|=0)))return k=s,0|(l=n);if(u=0|i[(c=e)+4>>2],i[(n=a)>>2]=i[c>>2],i[n+4>>2]=u,Tt(a,o),!(n=0|ee(o,t,l))){if(t=0|i[a>>2],(0|(a=0|i[e+8>>2]))>0){o=0|i[e+12>>2],n=0;do{t=(0|i[o+(n<<3)>>2])+t|0,n=n+1|0}while((0|n)<(0|a))}o=0|i[(n=l)>>2],(0|(n=0|i[n+4>>2]))<(0|(a=((0|t)<0)<<31>>31))|(0|n)==(0|a)&o>>>0<t>>>0?(i[(n=l)>>2]=t,i[n+4>>2]=a,n=a):t=o,u=0|Zt(0|t,0|n,12,0),c=0|D(),i[(n=l)>>2]=u,i[n+4>>2]=c,i[(n=r)>>2]=u,i[n+4>>2]=c,n=0}return k=s,0|(c=n)},_maxPolygonToCellsSizeExperimental:function(e,t,n,o){t|=0,n|=0,o|=0;var a,l,c=0,A=0,d=0,f=0,p=0,g=0,m=0,y=0;if(l=k,k=k+48|0,p=l+32|0,f=l+40|0,a=l,!(0|i[(e|=0)>>2]))return i[(g=o)>>2]=0,i[g+4>>2]=0,k=l,0|(g=0);ze(p,0,0,0),c=0|i[(d=p)>>2],d=0|i[d+4>>2];do{if(t>>>0>15)i[(g=a)>>2]=0,i[g+4>>2]=0,i[a+8>>2]=4,i[a+12>>2]=-1,n=a+29|0,i[(g=a+16|0)>>2]=0,i[g+4>>2]=0,i[g+8>>2]=0,r[g+12|0]=0,r[n|0]=0|r[f|0],r[n+1|0]=0|r[f+1|0],r[n+2|0]=0|r[f+2|0],n=4,g=9;else{if(0|(n=0|It(n))){i[(p=a)>>2]=0,i[p+4>>2]=0,i[a+8>>2]=n,i[a+12>>2]=-1,g=a+29|0,i[(p=a+16|0)>>2]=0,i[p+4>>2]=0,i[p+8>>2]=0,r[p+12|0]=0,r[g|0]=0|r[f|0],r[g+1|0]=0|r[f+1|0],r[g+2|0]=0|r[f+2|0],g=9;break}if(!(n=0|Kt(1+(0|i[e+8>>2])|0,32))){i[(g=a)>>2]=0,i[g+4>>2]=0,i[a+8>>2]=13,i[a+12>>2]=-1,n=a+29|0,i[(g=a+16|0)>>2]=0,i[g+4>>2]=0,i[g+8>>2]=0,r[g+12|0]=0,r[n|0]=0|r[f|0],r[n+1|0]=0|r[f+1|0],r[n+2|0]=0|r[f+2|0],n=13,g=9;break}Ft(e,n),i[(y=a)>>2]=c,i[y+4>>2]=d,i[(d=a+8|0)>>2]=0,i[a+12>>2]=t,i[a+20>>2]=e,i[a+24>>2]=n,r[a+28|0]=0,r[(c=a+29|0)|0]=0|r[f|0],r[c+1|0]=0|r[f+1|0],r[c+2|0]=0|r[f+2|0],i[a+16>>2]=3,m=+q(n),m*=+X(n),A=+u(+ +s[n>>3]),A=m/+h(+ +An(+A,+ +u(+ +s[n+8>>3])))*6371.007180918475*6371.007180918475,n=0|i[(c=a+12|0)>>2];e:do{if((0|n)>0)do{if(At(n+-1|0,p),!(A/+s[p>>3]>10))break e;n=(y=0|i[c>>2])+-1|0,i[c>>2]=n}while((0|y)>1)}while(0);if(Dt(a),i[(c=o)>>2]=0,i[c+4>>2]=0,!(0==(0|(n=0|i[(c=a)>>2]))&0==(0|(c=0|i[c+4>>2]))))do{Ve(n,c,t,p),f=p,f=0|Zt(0|i[(e=o)>>2],0|i[e+4>>2],0|i[f>>2],0|i[f+4>>2]),e=0|D(),i[(y=o)>>2]=f,i[y+4>>2]=e,Dt(a),n=0|i[(y=a)>>2],c=0|i[y+4>>2]}while(!(0==(0|n)&0==(0|c)));n=0|i[d>>2]}}while(0);return k=l,0|(y=n)},_memcpy:dn,_memset:fn,_originToDirectedEdges:function(e,t,n){n|=0;var r,s=0;return r=0==(0|Ge(e|=0,t|=0)),t&=-2130706433,i[(s=n)>>2]=r?e:0,i[s+4>>2]=r?285212672|t:0,i[(s=n+8|0)>>2]=e,i[s+4>>2]=301989888|t,i[(s=n+16|0)>>2]=e,i[s+4>>2]=318767104|t,i[(s=n+24|0)>>2]=e,i[s+4>>2]=335544320|t,i[(s=n+32|0)>>2]=e,i[s+4>>2]=352321536|t,i[(n=n+40|0)>>2]=e,i[n+4>>2]=369098752|t,0},_pentagonCount:function(){return 12},_polygonToCells:function(e,t,n,r){e|=0,t|=0,r|=0;var s,o,a,l,u=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0,y=0,v=0,_=0,b=0,w=0,E=0,x=0,C=0,S=0,T=0,I=0,F=0,R=0,P=0,M=0,O=0,N=0,z=0;if(l=k,k=k+112|0,s=l+80|0,d=l+72|0,o=l,a=l+56|0,0|(u=0|It(n|=0)))return k=l,0|(z=u);if(!(z=0|Yt(32+(i[(f=e+8|0)>>2]<<5)|0)))return k=l,0|(z=13);if(Ft(e,z),!(u=0|It(n))){if(N=0|i[(O=e)+4>>2],i[(u=d)>>2]=i[O>>2],i[u+4>>2]=N,Tt(d,s),u=0|ee(s,t,o))O=0,N=0;else{if(u=0|i[d>>2],(0|(c=0|i[f>>2]))>0){A=0|i[e+12>>2],n=0;do{u=(0|i[A+(n<<3)>>2])+u|0,n=n+1|0}while((0|n)!=(0|c));n=u}else n=u;c=0|i[(u=o)>>2],(0|(u=0|i[u+4>>2]))<(0|(A=((0|n)<0)<<31>>31))|(0|u)==(0|A)&c>>>0<n>>>0?(i[(u=o)>>2]=n,i[u+4>>2]=A,u=A):n=c,O=0|Zt(0|n,0|u,12,0),N=0|D(),i[(u=o)>>2]=O,i[u+4>>2]=N,u=0}if(!u){if(!(n=0|Kt(O,8)))return qt(z),k=l,0|(z=13);if(!(h=0|Kt(O,8)))return qt(z),qt(n),k=l,0|(z=13);i[(P=s)>>2]=0,i[P+4>>2]=0,M=0|i[(P=e)+4>>2],i[(u=d)>>2]=i[P>>2],i[u+4>>2]=M,u=0|U(d,O,N,t,s,n,h);e:do{if(u)qt(n),qt(h),qt(z);else{t:do{if((0|i[f>>2])>0){for(A=e+12|0,c=0;u=0|U((0|i[A>>2])+(c<<3)|0,O,N,t,s,n,h),c=c+1|0,!(0|u);)if((0|c)>=(0|i[f>>2]))break t;qt(n),qt(h),qt(z);break e}}while(0);(0|N)>0|0==(0|N)&O>>>0>0&&fn(0|h,0,O<<3),P=0|i[(M=s)+4>>2];t:do{if((0|P)>0|0==(0|P)&(0|i[M>>2])>>>0>0){I=n,F=h,R=n,P=h,M=n,u=n,C=n,S=h,T=h,n=h;n:for(;;){for(b=0,w=0,E=0,x=0,c=0,A=0;;){d=(h=o)+56|0;do{i[h>>2]=0,h=h+4|0}while((0|h)<(0|d));if(0|B(f=0|i[(t=I+(b<<3)|0)>>2],t=0|i[t+4>>2],1,o,0)){d=(h=o)+56|0;do{i[h>>2]=0,h=h+4|0}while((0|h)<(0|d));0|(h=0|Kt(7,4))&&(L(f,t,1,o,h,7,0,0),qt(h))}for(_=0;;){y=0|i[(v=o+(_<<3)|0)>>2],v=0|i[v+4>>2];r:do{if(0==(0|y)&0==(0|v))h=c,d=A;else{if(p=0|sn(0|y,0|v,0|O,0|N),f=0|D(),!(0==(0|(d=0|i[(t=h=r+(p<<3)|0)>>2]))&0==(0|(t=0|i[t+4>>2])))){g=0,m=0;do{if((0|g)>(0|N)|(0|g)==(0|N)&m>>>0>O>>>0)break n;if((0|d)==(0|y)&(0|t)==(0|v)){h=c,d=A;break r}p=0|rn(0|(h=0|Zt(0|p,0|f,1,0)),0|D(),0|O,0|N),f=0|D(),m=0|Zt(0|m,0|g,1,0),g=0|D(),d=0|i[(t=h=r+(p<<3)|0)>>2],t=0|i[t+4>>2]}while(!(0==(0|d)&0==(0|t)))}if(0==(0|y)&0==(0|v)){h=c,d=A;break}tt(y,v,a),0|Rt(e,z,a)&&(m=0|Zt(0|c,0|A,1,0),A=0|D(),i[(g=h)>>2]=y,i[g+4>>2]=v,i[(c=F+(c<<3)|0)>>2]=y,i[c+4>>2]=v,c=m),h=c,d=A}}while(0);if((_=_+1|0)>>>0>=7)break;c=h,A=d}if(b=0|Zt(0|b,0|w,1,0),w=0|D(),E=0|Zt(0|E,0|x,1,0),x=0|D(),c=0|i[(A=s)>>2],!((0|x)<(0|(A=0|i[A+4>>2]))|(0|x)==(0|A)&E>>>0<c>>>0))break;c=h,A=d}if((0|A)>0|0==(0|A)&c>>>0>0){c=0,A=0;do{i[(x=I+(c<<3)|0)>>2]=0,i[x+4>>2]=0,c=0|Zt(0|c,0|A,1,0),A=0|D(),E=0|i[(x=s)+4>>2]}while((0|A)<(0|E)|((0|A)==(0|E)?c>>>0<(0|i[x>>2])>>>0:0))}if(i[(x=s)>>2]=h,i[x+4>>2]=d,!((0|d)>0|0==(0|d)&h>>>0>0))break t;_=n,b=T,w=M,E=S,x=F,n=C,T=u,S=R,C=_,u=b,M=P,P=w,R=E,F=I,I=x}qt(R),qt(P),qt(z),u=1;break e}u=h}while(0);qt(z),qt(n),qt(u),u=0}}while(0);return k=l,0|(z=u)}}return qt(z),k=l,0|(z=u)},_polygonToCellsExperimental:function(e,t,n,r,s,o){r|=0,s|=0,o|=0;var a,l,u,c=0,A=0,h=0,d=0,f=0,p=0,g=0,m=0;u=k,k=k+160|0,A=u+64|0,f=u+112|0,m=u,xt(d=u+80|0,e|=0,t|=0,n|=0),it(A,0|i[(h=d)>>2],0|i[h+4>>2],t),a=0|i[(h=A)>>2],h=0|i[h+4>>2],c=0|i[d+8>>2],i[(p=f+4|0)>>2]=i[d>>2],i[p+4>>2]=i[d+4>>2],i[p+8>>2]=i[d+8>>2],i[p+12>>2]=i[d+12>>2],i[p+16>>2]=i[d+16>>2],i[p+20>>2]=i[d+20>>2],i[p+24>>2]=i[d+24>>2],i[p+28>>2]=i[d+28>>2],i[(p=m)>>2]=a,i[p+4>>2]=h,i[(p=m+8|0)>>2]=c,t=f,n=(e=m+12|0)+36|0;do{i[e>>2]=i[t>>2],e=e+4|0,t=t+4|0}while((0|e)<(0|n));if(i[(f=m+48|0)>>2]=i[A>>2],i[f+4>>2]=i[A+4>>2],i[f+8>>2]=i[A+8>>2],i[f+12>>2]=i[A+12>>2],0==(0|a)&0==(0|h))return k=u,0|(m=c);n=m+16|0,l=m+24|0,d=m+28|0,c=0,A=0,t=a,e=h;do{if(!((0|c)<(0|s)|(0|c)==(0|s)&A>>>0<r>>>0)){g=4;break}if(h=A,A=0|Zt(0|A,0|c,1,0),c=0|D(),i[(h=o+(h<<3)|0)>>2]=t,i[h+4>>2]=e,ot(f),0==(0|(t=0|i[(e=f)>>2]))&0==(0|(e=0|i[e+4>>2]))){if(Dt(n),0==(0|(e=0|i[(t=n)>>2]))&0==(0|(t=0|i[t+4>>2]))){g=10;break}st(e,t,0|i[d>>2],f),t=0|i[(e=f)>>2],e=0|i[e+4>>2]}i[(h=m)>>2]=t,i[h+4>>2]=e}while(!(0==(0|t)&0==(0|e)));return 4==(0|g)?(0|(t=0|i[(e=m+40|0)>>2])&&qt(t),i[(g=m+16|0)>>2]=0,i[g+4>>2]=0,i[l>>2]=0,i[m+36>>2]=0,i[d>>2]=-1,i[m+32>>2]=0,i[e>>2]=0,st(0,0,0,f),i[m>>2]=0,i[m+4>>2]=0,i[p>>2]=0,k=u,0|(m=14)):(10==(0|g)&&(i[m>>2]=0,i[m+4>>2]=0,i[p>>2]=i[l>>2]),m=0|i[p>>2],k=u,0|m)},_readInt64AsDoubleFromPointer:function(e){return+(+((0|i[(e|=0)>>2])>>>0)+4294967296*+(0|i[e+4>>2]))},_res0CellCount:function(){return 122},_round:pn,_sbrk:gn,_sizeOfCellBoundary:function(){return 168},_sizeOfCoordIJ:function(){return 8},_sizeOfGeoLoop:function(){return 8},_sizeOfGeoPolygon:function(){return 16},_sizeOfH3Index:function(){return 8},_sizeOfLatLng:function(){return 16},_sizeOfLinkedGeoPolygon:function(){return 12},_uncompactCells:function(e,t,n,r,s,o,a){e|=0,r|=0,s|=0,o|=0;var l,u=0,c=0,A=0,h=0,d=0,f=0,p=0,g=0;if(l=k,k=k+16|0,g=l,!((0|(n|=0))>0|0==(0|n)&(t|=0)>>>0>0))return k=l,0|(g=0);if((0|(a|=0))>=16)return k=l,0|(g=12);f=0,p=0,d=0,u=0;e:for(;;){if(h=0|an(0|(c=0|i[(A=e+(f<<3)|0)>>2]),0|(A=0|i[A+4>>2]),52),D(),(15&h)>(0|a)){u=12,c=11;break}if(it(g,c,A,a),0==(0|(A=0|i[(h=g)>>2]))&0==(0|(h=0|i[h+4>>2])))c=d;else{c=d;do{if(!((0|u)<(0|o)|(0|u)==(0|o)&c>>>0<s>>>0)){c=10;break e}i[(d=r+(c<<3)|0)>>2]=A,i[d+4>>2]=h,c=0|Zt(0|c,0|u,1,0),u=0|D(),ot(g),A=0|i[(d=g)>>2],h=0|i[d+4>>2]}while(!(0==(0|A)&0==(0|h)))}if(f=0|Zt(0|f,0|p,1,0),!((0|(p=0|D()))<(0|n)|(0|p)==(0|n)&f>>>0<t>>>0)){u=0,c=11;break}d=c}return 10==(0|c)?(k=l,0|(g=14)):11==(0|c)?(k=l,0|u):0},_uncompactCellsSize:function(e,t,n,r,s){e|=0,t|=0,n|=0,r|=0,s|=0;var o,a,l=0,u=0,c=0,A=0,h=0,d=0;a=k,k=k+16|0,o=a;e:do{if((0|n)>0|0==(0|n)&t>>>0>0){for(h=0,u=0,l=0,d=0;;){if(!(0==(0|(c=0|i[(A=e+(h<<3)|0)>>2]))&0==(0|(A=0|i[A+4>>2])))&&(A=0==(0|Ve(c,A,r,o)),u=0|Zt(0|i[(c=o)>>2],0|i[c+4>>2],0|u,0|l),l=0|D(),!A)){l=12;break}if(h=0|Zt(0|h,0|d,1,0),!((0|(d=0|D()))<(0|n)|(0|d)==(0|n)&h>>>0<t>>>0))break e}return k=a,0|l}u=0,l=0}while(0);return i[s>>2]=u,i[s+4>>2]=l,k=a,0|(s=0)},_vertexToLatLng:function(e,t,n){n|=0;var r,s,o,a,l=0,u=0;return a=k,k=k+192|0,s=a,o=a+168|0,l=0|an(0|(e|=0),0|(t|=0),56),D(),l&=7,0|(r=0|et(e,u=-2130706433&t|134217728,o))?(k=a,0|(u=r)):(t=0|an(0|e,0|t,52),D(),t&=15,0|Ge(e,u)?ke(o,t,l,1,s):Le(o,t,l,1,s),u=s+8|0,i[n>>2]=i[u>>2],i[n+4>>2]=i[u+4>>2],i[n+8>>2]=i[u+8>>2],i[n+12>>2]=i[u+12>>2],k=a,0|(u=0))},establishStackSpace:function(e,t){k=e|=0},stackAlloc:function(e){var t;return t=k,k=(k=k+(e|=0)|0)+15&-16,0|t},stackRestore:function(e){k=e|=0},stackSave:function(){return 0|k}}}({Math:Math,Int8Array:Int8Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Float32Array:Float32Array,Float64Array:Float64Array},J,p),ee=(n.___divdi3=$.___divdi3,n.___muldi3=$.___muldi3,n.___remdi3=$.___remdi3,n.___uremdi3=$.___uremdi3,n._areNeighborCells=$._areNeighborCells,n._bitshift64Ashr=$._bitshift64Ashr,n._bitshift64Lshr=$._bitshift64Lshr,n._bitshift64Shl=$._bitshift64Shl,n._calloc=$._calloc,n._cellAreaKm2=$._cellAreaKm2,n._cellAreaM2=$._cellAreaM2,n._cellAreaRads2=$._cellAreaRads2,n._cellToBoundary=$._cellToBoundary,n._cellToCenterChild=$._cellToCenterChild,n._cellToChildPos=$._cellToChildPos,n._cellToChildren=$._cellToChildren,n._cellToChildrenSize=$._cellToChildrenSize,n._cellToLatLng=$._cellToLatLng,n._cellToLocalIj=$._cellToLocalIj,n._cellToParent=$._cellToParent,n._cellToVertex=$._cellToVertex,n._cellToVertexes=$._cellToVertexes,n._cellsToDirectedEdge=$._cellsToDirectedEdge,n._cellsToLinkedMultiPolygon=$._cellsToLinkedMultiPolygon,n._childPosToCell=$._childPosToCell,n._compactCells=$._compactCells,n._destroyLinkedMultiPolygon=$._destroyLinkedMultiPolygon,n._directedEdgeToBoundary=$._directedEdgeToBoundary,n._directedEdgeToCells=$._directedEdgeToCells,n._edgeLengthKm=$._edgeLengthKm,n._edgeLengthM=$._edgeLengthM,n._edgeLengthRads=$._edgeLengthRads,n._emscripten_replace_memory=$._emscripten_replace_memory),te=(n._free=$._free,n._getBaseCellNumber=$._getBaseCellNumber,n._getDirectedEdgeDestination=$._getDirectedEdgeDestination,n._getDirectedEdgeOrigin=$._getDirectedEdgeOrigin,n._getHexagonAreaAvgKm2=$._getHexagonAreaAvgKm2,n._getHexagonAreaAvgM2=$._getHexagonAreaAvgM2,n._getHexagonEdgeLengthAvgKm=$._getHexagonEdgeLengthAvgKm,n._getHexagonEdgeLengthAvgM=$._getHexagonEdgeLengthAvgM,n._getIcosahedronFaces=$._getIcosahedronFaces,n._getNumCells=$._getNumCells,n._getPentagons=$._getPentagons,n._getRes0Cells=$._getRes0Cells,n._getResolution=$._getResolution,n._greatCircleDistanceKm=$._greatCircleDistanceKm,n._greatCircleDistanceM=$._greatCircleDistanceM,n._greatCircleDistanceRads=$._greatCircleDistanceRads,n._gridDisk=$._gridDisk,n._gridDiskDistances=$._gridDiskDistances,n._gridDistance=$._gridDistance,n._gridPathCells=$._gridPathCells,n._gridPathCellsSize=$._gridPathCellsSize,n._gridRingUnsafe=$._gridRingUnsafe,n._i64Add=$._i64Add,n._i64Subtract=$._i64Subtract,n._isPentagon=$._isPentagon,n._isResClassIII=$._isResClassIII,n._isValidCell=$._isValidCell,n._isValidDirectedEdge=$._isValidDirectedEdge,n._isValidVertex=$._isValidVertex,n._latLngToCell=$._latLngToCell,n._llvm_ctlz_i64=$._llvm_ctlz_i64,n._llvm_maxnum_f64=$._llvm_maxnum_f64,n._llvm_minnum_f64=$._llvm_minnum_f64,n._llvm_round_f64=$._llvm_round_f64,n._localIjToCell=$._localIjToCell,n._malloc=$._malloc,n._maxFaceCount=$._maxFaceCount,n._maxGridDiskSize=$._maxGridDiskSize,n._maxPolygonToCellsSize=$._maxPolygonToCellsSize,n._maxPolygonToCellsSizeExperimental=$._maxPolygonToCellsSizeExperimental,n._memcpy=$._memcpy,n._memset=$._memset,n._originToDirectedEdges=$._originToDirectedEdges,n._pentagonCount=$._pentagonCount,n._polygonToCells=$._polygonToCells,n._polygonToCellsExperimental=$._polygonToCellsExperimental,n._readInt64AsDoubleFromPointer=$._readInt64AsDoubleFromPointer,n._res0CellCount=$._res0CellCount,n._round=$._round,n._sbrk=$._sbrk,n._sizeOfCellBoundary=$._sizeOfCellBoundary,n._sizeOfCoordIJ=$._sizeOfCoordIJ,n._sizeOfGeoLoop=$._sizeOfGeoLoop,n._sizeOfGeoPolygon=$._sizeOfGeoPolygon,n._sizeOfH3Index=$._sizeOfH3Index,n._sizeOfLatLng=$._sizeOfLatLng,n._sizeOfLinkedGeoPolygon=$._sizeOfLinkedGeoPolygon,n._uncompactCells=$._uncompactCells,n._uncompactCellsSize=$._uncompactCellsSize,n._vertexToLatLng=$._vertexToLatLng,n.establishStackSpace=$.establishStackSpace,n.stackAlloc=$.stackAlloc),ne=n.stackRestore=$.stackRestore,re=n.stackSave=$.stackSave;if(n.asm=$,n.cwrap=function(e,t,n,r){var i=(n=n||[]).every(function(e){return"number"===e});return"string"!==t&&i&&!r?A(e):function(){return h(e,t,n,arguments)}},n.setValue=function(e,t,n,r){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":g[e|0]=t;break;case"i16":y[e>>1]=t;break;case"i32":v[e>>2]=t;break;case"i64":z=[t>>>0,(U=t,+k(U)>=1?U>0?(0|B(+M(U/4294967296),4294967295))>>>0:~~+P((U-+(~~U>>>0))/4294967296)>>>0:0)],v[e>>2]=z[0],v[e+4>>2]=z[1];break;case"float":_[e>>2]=t;break;case"double":b[e>>3]=t;break;default:ue("invalid type for setValue: "+n)}},n.getValue=function(e,t,n){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return g[e|0];case"i16":return y[e>>1];case"i32":case"i64":return v[e>>2];case"float":return _[e>>2];case"double":return b[e>>3];default:ue("invalid type for getValue: "+t)}return null},j){G(j)||(j=function(e){return n.locateFile?n.locateFile(e,o):o+e}(j)),L++,n.monitorRunDependencies&&n.monitorRunDependencies(L);var ie=function(e){e.byteLength&&(e=new Uint8Array(e)),m.set(e,8),n.memoryInitializerRequest&&delete n.memoryInitializerRequest.response,function(){if(L--,n.monitorRunDependencies&&n.monitorRunDependencies(L),0==L&&(null!==O&&(clearInterval(O),O=null),N)){var e=N;N=null,e()}}()},se=function(){i(j,ie,function(){throw"could not load memory initializer "+j})},oe=K(j);if(oe)ie(oe.buffer);else if(n.memoryInitializerRequest){var ae=function(){var e=n.memoryInitializerRequest,t=e.response;if(200!==e.status&&0!==e.status){var r=K(n.memoryInitializerRequestURL);if(!r)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+e.status+", retrying "+j),void se();t=r.buffer}ie(t)};n.memoryInitializerRequest.response?setTimeout(ae,0):n.memoryInitializerRequest.addEventListener("load",ae)}else se()}function le(e){function t(){Z||(Z=!0,c||(D(S),D(T),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)R(n.postRun.shift());D(I)}()))}e=e||s,L>0||(!function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)F(n.preRun.shift());D(C)}(),L>0||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),t()},1)):t()))}function ue(e){throw n.onAbort&&n.onAbort(e),a(e+=""),l(e),c=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(N=function e(){Z||le(),Z||(N=e)},n.run=le,n.abort=ue,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return le(),e}("object"===typeof GP?GP:{}),WP="number",HP={0:"Success",1:"The operation failed but a more specific error is not available",2:"Argument was outside of acceptable range",3:"Latitude or longitude arguments were outside of acceptable range",4:"Resolution argument was outside of acceptable range",5:"Cell argument was not valid",6:"Directed edge argument was not valid",7:"Undirected edge argument was not valid",8:"Vertex argument was not valid",9:"Pentagon distortion was encountered",10:"Duplicate input",11:"Cell arguments were not neighbors",12:"Cell arguments had incompatible resolutions",13:"Memory allocation failed",14:"Bounds of provided memory were insufficient",15:"Mode or flags argument was not valid"},QP=1e3,XP={1e3:"Unknown unit",1001:"Array length out of bounds",1002:"Got unexpected null value for H3 index"};function YP(e,t,n){var r=n&&"value"in n,i=new Error((e[t]||"Unknown error")+" (code: "+t+(r?", value: "+n.value:"")+")");return i.code=t,i}function qP(e,t){return YP(HP,e,2===arguments.length?{value:t}:{})}function KP(e,t){return YP(XP,e,2===arguments.length?{value:t}:{})}function ZP(e){if(0!==e)throw qP(e)}var JP={};[["sizeOfH3Index",WP],["sizeOfLatLng",WP],["sizeOfCellBoundary",WP],["sizeOfGeoLoop",WP],["sizeOfGeoPolygon",WP],["sizeOfLinkedGeoPolygon",WP],["sizeOfCoordIJ",WP],["readInt64AsDoubleFromPointer",WP],["isValidCell",WP,[WP,WP]],["latLngToCell",WP,[WP,WP,WP,WP]],["cellToLatLng",WP,[WP,WP,WP]],["cellToBoundary",WP,[WP,WP,WP]],["maxGridDiskSize",WP,[WP,WP]],["gridDisk",WP,[WP,WP,WP,WP]],["gridDiskDistances",WP,[WP,WP,WP,WP,WP]],["gridRingUnsafe",WP,[WP,WP,WP,WP]],["maxPolygonToCellsSize",WP,[WP,WP,WP,WP]],["polygonToCells",WP,[WP,WP,WP,WP]],["maxPolygonToCellsSizeExperimental",WP,[WP,WP,WP,WP]],["polygonToCellsExperimental",WP,[WP,WP,WP,WP,WP,WP]],["cellsToLinkedMultiPolygon",WP,[WP,WP,WP]],["destroyLinkedMultiPolygon",null,[WP]],["compactCells",WP,[WP,WP,WP,WP]],["uncompactCells",WP,[WP,WP,WP,WP,WP,WP]],["uncompactCellsSize",WP,[WP,WP,WP,WP,WP]],["isPentagon",WP,[WP,WP]],["isResClassIII",WP,[WP,WP]],["getBaseCellNumber",WP,[WP,WP]],["getResolution",WP,[WP,WP]],["maxFaceCount",WP,[WP,WP,WP]],["getIcosahedronFaces",WP,[WP,WP,WP]],["cellToParent",WP,[WP,WP,WP,WP]],["cellToChildren",WP,[WP,WP,WP,WP]],["cellToCenterChild",WP,[WP,WP,WP,WP]],["cellToChildrenSize",WP,[WP,WP,WP,WP]],["cellToChildPos",WP,[WP,WP,WP,WP]],["childPosToCell",WP,[WP,WP,WP,WP,WP,WP]],["areNeighborCells",WP,[WP,WP,WP,WP,WP]],["cellsToDirectedEdge",WP,[WP,WP,WP,WP,WP]],["getDirectedEdgeOrigin",WP,[WP,WP,WP]],["getDirectedEdgeDestination",WP,[WP,WP,WP]],["isValidDirectedEdge",WP,[WP,WP]],["directedEdgeToCells",WP,[WP,WP,WP]],["originToDirectedEdges",WP,[WP,WP,WP]],["directedEdgeToBoundary",WP,[WP,WP,WP]],["gridDistance",WP,[WP,WP,WP,WP,WP]],["gridPathCells",WP,[WP,WP,WP,WP,WP]],["gridPathCellsSize",WP,[WP,WP,WP,WP,WP]],["cellToLocalIj",WP,[WP,WP,WP,WP,WP,WP]],["localIjToCell",WP,[WP,WP,WP,WP,WP]],["getHexagonAreaAvgM2",WP,[WP,WP]],["getHexagonAreaAvgKm2",WP,[WP,WP]],["getHexagonEdgeLengthAvgM",WP,[WP,WP]],["getHexagonEdgeLengthAvgKm",WP,[WP,WP]],["greatCircleDistanceM",WP,[WP,WP]],["greatCircleDistanceKm",WP,[WP,WP]],["greatCircleDistanceRads",WP,[WP,WP]],["cellAreaM2",WP,[WP,WP,WP]],["cellAreaKm2",WP,[WP,WP,WP]],["cellAreaRads2",WP,[WP,WP,WP]],["edgeLengthM",WP,[WP,WP,WP]],["edgeLengthKm",WP,[WP,WP,WP]],["edgeLengthRads",WP,[WP,WP,WP]],["getNumCells",WP,[WP,WP]],["getRes0Cells",WP,[WP]],["res0CellCount",WP],["getPentagons",WP,[WP,WP]],["pentagonCount",WP],["cellToVertex",WP,[WP,WP,WP,WP]],["cellToVertexes",WP,[WP,WP,WP]],["vertexToLatLng",WP,[WP,WP,WP]],["isValidVertex",WP,[WP,WP]]].forEach(function(e){JP[e[0]]=GP.cwrap.apply(GP,e)});var $P=16,eM=JP.sizeOfH3Index(),tM=JP.sizeOfLatLng(),nM=JP.sizeOfCellBoundary(),rM=(JP.sizeOfGeoPolygon(),JP.sizeOfGeoLoop(),JP.sizeOfLinkedGeoPolygon(),JP.sizeOfCoordIJ(),"m"),iM="km";function sM(e){if("number"!==typeof e||e<0||e>15||Math.floor(e)!==e)throw qP(4,e);return e}function oM(e){if(!e)throw KP(1002);return e}Math.pow(2,32);var aM=/[^0-9a-fA-F]/;function lM(e){if(Array.isArray(e)&&2===e.length&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if("string"!==typeof e||aM.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),$P);return[parseInt(e.substring(e.length-8),$P),t]}function uM(e){if(e>=0)return e.toString($P);var t=cM(8,(e&=2147483647).toString($P));return t=(parseInt(t[0],$P)+8).toString($P)+t.substring(1)}function cM(e,t){for(var n=e-t.length,r="",i=0;i<n;i++)r+="0";return r+=t}Math.pow(2,32);function AM(e,t){void 0===t&&(t=0);var n=GP.getValue(e+eM*t,"i32"),r=GP.getValue(e+eM*t+4,"i32");return r?function(e,t){return uM(t)+cM(8,uM(e))}(n,r):null}function hM(e,t){return void 0===t&&(t=0),GP.getValue(e+8*t,"double")}function dM(e){return JP.readInt64AsDoubleFromPointer(e)}function fM(e){return 180*GP.getValue(e,"double")/Math.PI}function pM(e){return[fM(e),fM(e+8)]}function gM(e){return[fM(e+8),fM(e)]}function mM(e,t,n){for(var r=GP.getValue(e,"i32"),i=e+8,s=[],o=t?gM:pM,a=0;a<2*r;a+=2)s.push(o(i+8*a));return n&&s.push(s[0]),s}function yM(e){var t=lM(e),n=t[0],r=t[1];return Boolean(JP.isPentagon(n,r))}function vM(e){var t=lM(e),n=t[0],r=t[1];return JP.isValidCell(n,r)?JP.getResolution(n,r):-1}function _M(e){var t=GP._malloc(tM),n=lM(e),r=n[0],i=n[1];try{return ZP(JP.cellToLatLng(r,i,t)),pM(t)}finally{GP._free(t)}}function bM(e,t){sM(e);var n=GP._malloc(8);try{switch(t){case rM:ZP(JP.getHexagonEdgeLengthAvgM(e,n));break;case iM:ZP(JP.getHexagonEdgeLengthAvgKm(e,n));break;default:throw KP(QP,t)}return hM(n)}finally{GP._free(n)}}function wM(e){return e*Math.PI/180}const EM=[0,0,0,255],xM={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:e=>e.polygon},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:EM},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class DM extends lI{initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&Me.removed("getLineDashArray","PathStyleExtension")()}updateState(e){let{changeFlags:t}=e;const n=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getPolygon);if(n&&Array.isArray(t.dataChanged)){const e=this.state.paths.slice(),n=t.dataChanged.map(t=>cI({data:e,getIndex:e=>e.__source.index,dataRange:t,replace:this._getPaths(t)}));this.setState({paths:e,pathsDiff:n})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{data:t,getPolygon:n,positionFormat:r,_normalize:i}=this.props,s=[],o="XY"===r?2:3,{startRow:a,endRow:l}=e,{iterable:u,objectInfo:c}=fA(t,a,l);for(const A of u){c.index++;let e=n(A,c);i&&(e=lR(e,o));const{holeIndices:t}=e,r=e.positions||e;if(t)for(let n=0;n<=t.length;n++){const e=r.slice(t[n-1]||0,t[n]||r.length);s.push(this.getSubLayerRow({path:e},A,c.index))}else s.push(this.getSubLayerRow({path:r},A,c.index))}return s}renderLayers(){const{data:e,_dataDiff:t,stroked:n,filled:r,extruded:i,wireframe:s,_normalize:o,_windingOrder:a,elevationScale:l,transitions:u,positionFormat:c}=this.props,{lineWidthUnits:A,lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f,lineJointRounded:p,lineMiterLimit:g,lineDashJustified:m}=this.props,{getFillColor:y,getLineColor:v,getLineWidth:_,getLineDashArray:b,getElevation:w,getPolygon:E,updateTriggers:x,material:D}=this.props,{paths:C,pathsDiff:S}=this.state,T=this.getSubLayerClass("fill",wR),I=this.getSubLayerClass("stroke",HF),F=this.shouldRenderSubLayer("fill",C)&&new T({_dataDiff:t,extruded:i,elevationScale:l,filled:r,wireframe:s,_normalize:o,_windingOrder:a,getElevation:w,getFillColor:y,getLineColor:i&&s?v:EM,material:D,transitions:u},this.getSubLayerProps({id:"fill",updateTriggers:x&&{getPolygon:x.getPolygon,getElevation:x.getElevation,getFillColor:x.getFillColor,lineColors:i&&s,getLineColor:x.getLineColor}}),{data:e,positionFormat:c,getPolygon:E}),R=!i&&n&&this.shouldRenderSubLayer("stroke",C)&&new I({_dataDiff:S&&(()=>S),widthUnits:A,widthScale:h,widthMinPixels:d,widthMaxPixels:f,jointRounded:p,miterLimit:g,dashJustified:m,_pathType:"loop",transitions:u&&{getWidth:u.getLineWidth,getColor:u.getLineColor,getPath:u.getPolygon},getColor:this.getSubLayerAccessor(v),getWidth:this.getSubLayerAccessor(_),getDashArray:this.getSubLayerAccessor(b)},this.getSubLayerProps({id:"stroke",updateTriggers:x&&{getWidth:x.getLineWidth,getColor:x.getLineColor,getDashArray:x.getLineDashArray}}),{data:C,positionFormat:c,getPath:e=>e.path});return[!i&&F,R,i&&F]}}DM.layerName="PolygonLayer",DM.defaultProps=xM;const CM=DM,SM={name:"phongMaterial",dependencies:[YF],source:JF,vs:KF,fs:ZF,defines:{LIGHTING_FRAGMENT:1},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(e){const t=u({},e);return t.specularColor&&(t.specularColor=t.specularColor.map(e=>e/255)),u(u({},SM.defaultUniforms),t)}};class TM extends pI{constructor(e){const{indices:t,attributes:n}=function(e){const{radius:t,height:n=1,nradial:r=10}=e;let{vertices:i}=e;i&&(Me.assert(i.length>=r),i=i.flatMap(e=>[e[0],e[1]]),yF(i,mF));const s=n>0,o=r+1,a=s?3*o+1:r,l=2*Math.PI/r,u=new Uint16Array(s?3*r*2:0),c=new Float32Array(3*a),A=new Float32Array(3*a);let h=0;if(s){for(let e=0;e<o;e++){const s=e*l,o=e%r,a=Math.sin(s),u=Math.cos(s);for(let e=0;e<2;e++)c[h+0]=i?i[2*o]:u*t,c[h+1]=i?i[2*o+1]:a*t,c[h+2]=(.5-e)*n,A[h+0]=i?i[2*o]:u,A[h+1]=i?i[2*o+1]:a,h+=3}c[h+0]=c[h-3],c[h+1]=c[h-2],c[h+2]=c[h-1],h+=3}for(let d=s?0:1;d<o;d++){const e=Math.floor(d/2)*Math.sign(.5-d%2),s=e*l,o=(e+r)%r,a=Math.sin(s),u=Math.cos(s);c[h+0]=i?i[2*o]:u*t,c[h+1]=i?i[2*o+1]:a*t,c[h+2]=n/2,A[h+2]=1,h+=3}if(s){let e=0;for(let t=0;t<r;t++)u[e++]=2*t+0,u[e++]=2*t+2,u[e++]=2*t+0,u[e++]=2*t+1,u[e++]=2*t+1,u[e++]=2*t+3}return{indices:u,attributes:{POSITION:{size:3,value:c},NORMAL:{size:3,value:A}}}}(e);super(u(u({},e),{},{indices:t,attributes:n}))}}const IM="uniform columnUniforms {\n  float radius;\n  float angle;\n  vec2 offset;\n  bool extruded;\n  bool stroked;\n  bool isStroke;\n  float coverage;\n  float elevationScale;\n  float edgeDistance;\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  highp int radiusUnits;\n  highp int widthUnits;\n} column;\n",FM={name:"column",vs:IM,fs:IM,uniformTypes:{radius:"f32",angle:"f32",offset:"vec2<f32>",extruded:"f32",stroked:"f32",isStroke:"f32",coverage:"f32",elevationScale:"f32",edgeDistance:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",radiusUnits:"i32",widthUnits:"i32"}},RM=[0,0,0,255],kM={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:e=>e.position},getFillColor:{type:"accessor",value:RM},getLineColor:{type:"accessor",value:RM},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class PM extends Cp{getShaders(){const e={},{flatShading:t}=this.props;return t&&(e.FLAT_SHADING=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME column-layer-vertex-shader\nin vec3 positions;\nin vec3 normals;\nin vec3 instancePositions;\nin float instanceElevations;\nin vec3 instancePositions64Low;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin float instanceStrokeWidths;\nin vec3 instancePickingColors;\nout vec4 vColor;\n#ifdef FLAT_SHADING\nout vec3 cameraPosition;\nout vec4 position_commonspace;\n#endif\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nvec4 color = column.isStroke ? instanceLineColors : instanceFillColors;\nmat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));\nfloat elevation = 0.0;\nfloat strokeOffsetRatio = 1.0;\nif (column.extruded) {\nelevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;\n} else if (column.stroked) {\nfloat widthPixels = clamp(\nproject_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),\ncolumn.widthMinPixels, column.widthMaxPixels) / 2.0;\nfloat halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);\nif (column.isStroke) {\nstrokeOffsetRatio -= sign(positions.z) * halfOffset;\n} else {\nstrokeOffsetRatio -= halfOffset;\n}\n}\nfloat shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\nfloat dotRadius = column.radius * column.coverage * shouldRender;\ngeometry.pickingColor = instancePickingColors;\nvec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\nvec3 centroidPosition64Low = instancePositions64Low;\nvec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;\nif (column.radiusUnits == UNIT_METERS) {\noffset = project_size(offset);\n}\nvec3 pos = vec3(offset, 0.);\nDECKGL_FILTER_SIZE(pos, geometry);\ngl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\ngeometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nif (column.extruded && !column.isStroke) {\n#ifdef FLAT_SHADING\ncameraPosition = project.cameraPosition;\nposition_commonspace = geometry.position;\nvColor = vec4(color.rgb, color.a * layer.opacity);\n#else\nvec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, color.a * layer.opacity);\n#endif\n} else {\nvColor = vec4(color.rgb, color.a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME column-layer-fragment-shader\nprecision highp float;\nout vec4 fragColor;\nin vec4 vColor;\n#ifdef FLAT_SHADING\nin vec3 cameraPosition;\nin vec4 position_commonspace;\n#endif\nvoid main(void) {\nfragColor = vColor;\ngeometry.uv = vec2(0.);\n#ifdef FLAT_SHADING\nif (column.extruded && !column.isStroke && !bool(picking.isActive)) {\nvec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\nfragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);\n}\n#endif\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:e,modules:[hI,t?SM:$F,fI,FM]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:RM},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:RM},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:r}=e,i=r.extensionsChanged||t.flatShading!==n.flatShading;var s;i&&(null===(s=this.state.models)||void 0===s||s.forEach(e=>e.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const o=this.getNumInstances();this.state.fillModel.setInstanceCount(o),this.state.wireframeModel.setInstanceCount(o),(i||t.diskResolution!==n.diskResolution||t.vertices!==n.vertices||(t.extruded||t.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(t)}getGeometry(e,t,n){const r=new TM({radius:1,height:n?2:0,vertices:t,nradial:e});let i=0;if(t)for(let s=0;s<e;s++){const n=t[s];i+=Math.sqrt(n[0]*n[0]+n[1]*n[1])/e}else i=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*i}),r}_getModels(){const e=this.getShaders(),t=this.getAttributeManager().getBufferLayouts(),n=new df(this.context.device,u(u({},e),{},{id:"".concat(this.props.id,"-fill"),bufferLayout:t,isInstanced:!0})),r=new df(this.context.device,u(u({},e),{},{id:"".concat(this.props.id,"-wireframe"),bufferLayout:t,isInstanced:!0}));return{fillModel:n,wireframeModel:r,models:[r,n]}}_updateGeometry(e){let{diskResolution:t,vertices:n,extruded:r,stroked:i}=e;const s=this.getGeometry(t,n,r||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3});const o=this.state.fillModel,a=this.state.wireframeModel;o.setGeometry(s),o.setTopology("triangle-strip"),o.setIndexBuffer(null),a.setGeometry(s),a.setTopology("line-list")}draw(e){let{uniforms:t}=e;const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:l,filled:c,stroked:A,wireframe:h,offset:d,coverage:f,radius:p,angle:g}=this.props,m=this.state.fillModel,y=this.state.wireframeModel,{fillVertexCount:v,edgeDistance:_}=this.state,b={radius:p,angle:g/180*Math.PI,offset:d,extruded:l,stroked:A,coverage:f,elevationScale:a,edgeDistance:_,radiusUnits:As[o],widthUnits:As[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s};l&&h&&(y.shaderInputs.setProps({column:u(u({},b),{},{isStroke:!0})}),y.draw(this.context.renderPass)),c&&(m.setVertexCount(v),m.shaderInputs.setProps({column:u(u({},b),{},{isStroke:!1})}),m.draw(this.context.renderPass)),!l&&A&&(m.setVertexCount(2*v/3),m.shaderInputs.setProps({column:u(u({},b),{},{isStroke:!0})}),m.draw(this.context.renderPass))}}PM.layerName="ColumnLayer",PM.defaultProps=kM;const MM=PM;function BM(e,t){t=void 0===t?e[0][0]:t;for(const n of e){const e=n[0]-t;e>180?n[0]-=360:e<-180&&(n[0]+=360)}}function LM(e,t,n){const r=e(t,n),[i,s]=_M(r);return[s,i]}function OM(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=function(e,t){var n=GP._malloc(nM),r=lM(e),i=r[0],s=r[1];try{return ZP(JP.cellToBoundary(i,s,n)),mM(n,t,t)}finally{GP._free(n)}}(e,!0);return 1!==t?function(e,t,n){const[r,i]=_M(e),s=t.length;BM(t,i);const o=t[0]===t[s-1]?s-1:s;for(let a=0;a<o;a++)t[a][0]=Ln(i,t[a][0],n),t[a][1]=Ln(r,t[a][1],n)}(e,n,t):BM(n),n}const NM=u(u({},CM.defaultProps),{},{highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:e=>e.hexagon},extruded:!0});class UM extends lI{initializeState(){UM._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState(e){let{changeFlags:t}=e;return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}updateState(e){let{props:t,changeFlags:n}=e;if(!0!==t.highPrecision&&(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagon)){const e=this._calculateH3DataProps();this.setState(e)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let e=-1,t=!1,n=!1;const{iterable:r,objectInfo:i}=fA(this.props.data);for(const s of r){i.index++;const r=this.props.getHexagon(s,i),o=vM(r);if(e<0){if(e=o,!this.props.highPrecision)break}else if(e!==o){n=!0;break}if(yM(r)){t=!0;break}}return{resolution:e,edgeLengthKM:e>=0?bM(e,"km"):0,hasMultipleRes:n,hasPentagon:t}}_shouldUseHighPrecision(){if("auto"===this.props.highPrecision){const{resolution:e,hasPentagon:t,hasMultipleRes:n}=this.state,{viewport:r}=this.context;return Boolean(null===r||void 0===r?void 0:r.resolution)||n||t||e>=0&&e<=5}return this.props.highPrecision}_updateVertices(e){if(this._shouldUseHighPrecision())return;const{resolution:t,edgeLengthKM:n,centerHex:r}=this.state;if(t<0)return;const i=this.props.centerHexagon||function(e,t,n){var r=GP._malloc(tM);GP.HEAPF64.set([e,t].map(wM),r/8);var i=GP._malloc(eM);try{return ZP(JP.latLngToCell(r,n,i)),oM(AM(i))}finally{GP._free(i),GP._free(r)}}(e.latitude,e.longitude,t);if(r===i)return;if(r)try{if(function(e,t){var n=lM(e),r=n[0],i=n[1],s=lM(t),o=s[0],a=s[1],l=GP._malloc(8);try{return ZP(JP.gridDistance(r,i,o,a,l)),dM(l)}finally{GP._free(l)}}(r,i)*n<10)return}catch(A){}const{unitsPerMeter:s}=e.distanceScales;let o=OM(i);const[a,l]=_M(i),[u,c]=e.projectFlat([l,a]);o=o.map(t=>{const n=e.projectFlat(t);return[(n[0]-u)/s[0],(n[1]-c)/s[1]]}),this.setState({centerHex:i,vertices:o})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:e,material:t,coverage:n,extruded:r,wireframe:i,stroked:s,filled:o,lineWidthUnits:a,lineWidthScale:l,lineWidthMinPixels:u,lineWidthMaxPixels:c,getFillColor:A,getElevation:h,getLineColor:d,getLineWidth:f,transitions:p,updateTriggers:g}=this.props;return{elevationScale:e,extruded:r,coverage:n,wireframe:i,stroked:s,filled:o,lineWidthUnits:a,lineWidthScale:l,lineWidthMinPixels:u,lineWidthMaxPixels:c,material:t,getElevation:h,getFillColor:A,getLineColor:d,getLineWidth:f,transitions:p,updateTriggers:{getFillColor:g.getFillColor,getElevation:g.getElevation,getLineColor:g.getLineColor,getLineWidth:g.getLineWidth}}}_renderPolygonLayer(){const{data:e,getHexagon:t,updateTriggers:n,coverage:r}=this.props,i=this.getSubLayerClass("hexagon-cell-hifi",CM),s=this._getForwardProps();return s.updateTriggers.getPolygon=function(e,t){let n;return n=void 0===e||null===e?t:"object"===typeof e?u(u({},e),{},{coverage:t}):{getHexagon:e,coverage:t},n}(n.getHexagon,r),new i(s,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:s.updateTriggers}),{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(e,n)=>function(e){const t=new Float64Array(2*e.length);let n=0;for(const r of e)t[n++]=r[0],t[n++]=r[1];return t}(OM(t(e,n),r))})}_renderColumnLayer(){const{data:e,getHexagon:t,updateTriggers:n}=this.props,r=this.getSubLayerClass("hexagon-cell",MM),i=this._getForwardProps();return i.updateTriggers.getPosition=n.getHexagon,new r(i,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:i.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:LM.bind(null,t)})}}UM.defaultProps=NM,UM.layerName="H3HexagonLayer",UM._checkH3Lib=()=>{};const zM=UM,jM=new Uint32Array([0,2,1,0,3,2]),VM=new Float32Array([0,1,0,0,1,0,1,1]);function GM(e,t){if(!t)return function(e){const t=new Float64Array(12);for(let n=0;n<e.length;n++)t[3*n+0]=e[n][0],t[3*n+1]=e[n][1],t[3*n+2]=e[n][2]||0;return{vertexCount:6,positions:t,indices:jM,texCoords:VM}}(e);const n=Math.max(Math.abs(e[0][0]-e[3][0]),Math.abs(e[1][0]-e[2][0])),r=Math.max(Math.abs(e[1][1]-e[0][1]),Math.abs(e[2][1]-e[3][1])),i=Math.ceil(n/t)+1,s=Math.ceil(r/t)+1,o=(i-1)*(s-1)*6,a=new Uint32Array(o),l=new Float32Array(i*s*2),u=new Float64Array(i*s*3);let c=0,A=0;for(let h=0;h<i;h++){const t=h/(i-1);for(let n=0;n<s;n++){const r=n/(s-1),i=WM(e,t,r);u[3*c+0]=i[0],u[3*c+1]=i[1],u[3*c+2]=i[2]||0,l[2*c+0]=t,l[2*c+1]=1-r,h>0&&n>0&&(a[A++]=c-s,a[A++]=c-s-1,a[A++]=c-1,a[A++]=c-s,a[A++]=c-1,a[A++]=c),c++}}return{vertexCount:o,positions:u,indices:a,texCoords:l}}function WM(e,t,n){return Ln(Ln(e[0],e[1],n),Ln(e[3],e[2],n),t)}const HM="uniform bitmapUniforms {\n  vec4 bounds;\n  float coordinateConversion;\n  float desaturate;\n  vec3 tintColor;\n  vec4 transparentColor;\n} bitmap;\n",QM={name:"bitmap",vs:HM,fs:HM,uniformTypes:{bounds:"vec4<f32>",coordinateConversion:"f32",desaturate:"f32",tintColor:"vec3<f32>",transparentColor:"vec4<f32>"}},XM="#version 300 es\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nin vec2 vTexCoord;\nin vec2 vTexPos;\n\nout vec4 fragColor;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), bitmap.desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * bitmap.tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (bitmap.transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + bitmap.transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(bitmap.transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bitmap.bounds[0]) / (bitmap.bounds[2] - bitmap.bounds[0]),\n    (pos.y - bitmap.bounds[3]) / (bitmap.bounds[1] - bitmap.bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (bitmap.coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (bitmap.coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture(bitmapTexture, uv);\n\n  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * layer.opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n\n  if (bool(picking.isActive) && !bool(picking.isAttribute)) {\n    // Since instance information is not used, we can use picking color for pixel index\n    fragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n"),YM={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:us.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0,value:null}};class qM extends Cp{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nin vec2 texCoords;\nin vec3 positions;\nin vec3 positions64Low;\n\nout vec2 vTexCoord;\nout vec2 vTexPos;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (bitmap.coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project.commonOrigin.xy;\n  } else if (bitmap.coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:XM,modules:[hI,fI,QM]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const t=!0;e.add({indices:{size:1,isIndexed:!0,update:e=>e.value=this.state.mesh.indices,noAlloc:t},positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:e=>e.value=this.state.mesh.positions,noAlloc:t},texCoords:{size:2,update:e=>e.value=this.state.mesh.texCoords,noAlloc:t}})}updateState(e){let{props:t,oldProps:n,changeFlags:r}=e;const i=this.getAttributeManager();var s;r.extensionsChanged&&(null===(s=this.state.model)||void 0===s||s.destroy(),this.state.model=this._getModel(),i.invalidateAll());if(t.bounds!==n.bounds){const e=this.state.mesh,t=this._createMesh();this.state.model.setVertexCount(t.vertexCount);for(const n in t)e&&e[n]!==t[n]&&i.invalidate(n);this.setState(u({mesh:t},this._getCoordinateUniforms()))}else t._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:t}=this.props,n=e.info;if(!n.color||!t)return n.bitmap=null,n;const{width:r,height:i}=t;n.index=0;const s=function(e){const[t,n,r]=e;return[(t+(15&r)/16)/256,(n+(240&r)/256)/256]}(n.color);return n.bitmap={size:{width:r,height:i},uv:s,pixel:[Math.floor(s[0]*r),Math.floor(s[1]*i)]},n}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight(u(u({},e),{},{color:this.encodePickingColor(0)}))}_createMesh(){const{bounds:e}=this.props;let t=e;return ZM(e)&&(t=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),GM(t,this.context.viewport.resolution)}_getModel(){return new df(this.context.device,u(u({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1}))}draw(e){const{shaderModuleProps:t}=e,{model:n,coordinateConversion:r,bounds:i,disablePicking:s}=this.state,{image:o,desaturate:a,transparentColor:l,tintColor:u}=this.props;if((!t.picking.isActive||!s)&&o&&n){const e={bitmapTexture:o,bounds:i,coordinateConversion:r,desaturate:a,tintColor:u.slice(0,3).map(e=>e/255),transparentColor:l.map(e=>e/255)};n.shaderInputs.setProps({bitmap:e}),n.draw(this.context.renderPass)}}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:t,DEFAULT:n}=us;let{_imageCoordinateSystem:r}=this.props;if(r!==n){const{bounds:n}=this.props;if(!ZM(n))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const i=this.context.viewport.resolution?e:t;if(r=r===e?e:t,r===e&&i===t)return{coordinateConversion:-1,bounds:n};if(r===t&&i===e){const e=Jr([n[0],n[1]]),t=Jr([n[2],n[3]]);return{coordinateConversion:1,bounds:[e[0],e[1],t[0],t[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}qM.layerName="BitmapLayer",qM.defaultProps=YM;const KM=qM;function ZM(e){return Number.isFinite(e[0])}function JM(e){let{label:t,onRemove:n}=e;return(0,fE.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:6,background:"#e2e8f0",color:"#0f172a",borderRadius:999,padding:"4px 8px",marginRight:8,marginBottom:8,fontSize:12,fontWeight:500},children:[t,(0,fE.jsx)("button",{onClick:n,style:{border:"none",background:"transparent",cursor:"pointer"},children:"\xd7"})]})}const $M=()=>{var e,t,n,r,i,s;const{filters:o,set:a}=vE(),l=[];if(null!==(e=o.bairros)&&void 0!==e&&e.length)for(const u of o.bairros)l.push({key:"bairro:".concat(u),label:"Bairro: ".concat(u),remove:()=>a({bairros:(o.bairros||[]).filter(e=>e!==u)||void 0})});if(null!==(t=o.h3)&&void 0!==t&&t.length)for(const u of o.h3)l.push({key:"h3:".concat(u),label:"H3: ".concat(u.slice(-6)),remove:()=>a({h3:(o.h3||[]).filter(e=>e!==u)||void 0})});if(null!==(n=o.unitTypes)&&void 0!==n&&n.length)for(const u of o.unitTypes)l.push({key:"type:".concat(u),label:"Tipo: ".concat(u),remove:()=>a({unitTypes:(o.unitTypes||[]).filter(e=>e!==u)||void 0})});if(null!==(r=o.bedrooms)&&void 0!==r&&r.length)for(const u of o.bedrooms)l.push({key:"bed:".concat(u),label:"Quartos: ".concat(u),remove:()=>a({bedrooms:(o.bedrooms||[]).filter(e=>e!==u)||void 0})});if(null!==(i=o.bathrooms)&&void 0!==i&&i.length)for(const u of o.bathrooms)l.push({key:"bath:".concat(u),label:"Banheiros: ".concat(u),remove:()=>a({bathrooms:(o.bathrooms||[]).filter(e=>e!==u)||void 0})});if(null!==(s=o.parking)&&void 0!==s&&s.length)for(const u of o.parking)l.push({key:"park:".concat(u),label:"Vagas: ".concat(u),remove:()=>a({parking:(o.parking||[]).filter(e=>e!==u)||void 0})});return l.length?(0,fE.jsx)("div",{style:{marginTop:8},children:l.map(e=>(0,fE.jsx)(JM,{label:e.label,onRemove:e.remove},e.key))}):null},eB=e=>{let{value:t,label:n,loading:r=!1}=e;return(0,fE.jsxs)("div",{className:"ban-container",children:[(0,fE.jsx)("div",{className:"ban-value",children:r?"...":t}),(0,fE.jsx)("div",{className:"ban-label",children:n})]})},tB={longitude:-38.5167,latitude:-3.7827,zoom:10,pitch:30,bearing:0},nB=e=>{if(null===e||void 0===e)return"N/A";if(e>=1e6){const t=e/1e6;return"".concat(t%1===0?t:t.toFixed(1),"M")}if(e>=1e3){const t=e/1e3;return"".concat(t%1===0?t:t.toFixed(1),"K")}return e.toFixed(0)};const rB=function(){const{isLoading:e,isReady:t,error:n,useQuery:i,query:s}=dE(),[o,a]=(0,r.useState)([]),{isLoading:l,error:c}=i(t?"\nSELECT \n    neighborhood,\n    median_price_per_m2,\n    count\nFROM properties_db.main_marts.price_per_neighborhood\nWHERE median_price_per_m2 IS NOT NULL \n  AND median_price_per_m2 > 0\nORDER BY median_price_per_m2 DESC;\n":null),{data:A,isLoading:h,error:d}=i(t?"\nSELECT \n    diff,\n    count_with,\n    amenity\nFROM properties_db.main_marts.amenity_price_analysis\nORDER BY diff DESC;\n":null),[f,p]=(0,r.useState)(!1),[g,m]=(0,r.useState)(!1);r.useEffect(()=>{const e=()=>{const e=window.innerWidth<1024;m(e),e||p(!1)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const[y,v]=(0,r.useState)(null),[_,b]=(0,r.useState)(tB),w=r.useMemo(()=>{const e=_.zoom;return e<=10?.8:e>=13?.2:.8-.2*(e-10)},[_.zoom]),{filters:E,set:x}=vE(),[D,C]=(0,r.useState)([]),[S,T]=(0,r.useState)(null),[I,F]=(0,r.useState)(null);r.useEffect(()=>{t&&!I&&(async()=>{try{const e=await s("\n        WITH h3_agg AS (\n          SELECT h3_7,\n                 AVG(sum_price / NULLIF(sum_area, 0)) AS price_per_m2\n          FROM properties_db.main_cube.cube_rollup_mean\n          WHERE sum_price IS NOT NULL AND sum_area > 0\n          GROUP BY h3_7\n        )\n        SELECT MIN(price_per_m2) AS min_price,\n               MAX(price_per_m2) AS max_price\n        FROM h3_agg;\n      ");e.length>0&&F({min:e[0].min_price,max:e[0].max_price})}catch(kA){console.error("Failed to calculate global price range:",kA)}})()},[t,I,s]),r.useEffect(()=>{t&&(async()=>{const e=bE(E,["bairros"]),t="\n        SELECT bairro AS neighborhood,\n               SUM(property_count) AS count,\n               AVG(sum_price / NULLIF(sum_area, 0)) AS median_price_per_m2\n        FROM properties_db.main_cube.cube_rollup_mean\n        ".concat(e,"\n        GROUP BY 1\n        ORDER BY median_price_per_m2 DESC;\n      ");try{const e=await s(t);C(e)}catch(n){}})()},[t,E,s]);const[R,k]=(0,r.useState)([]);r.useEffect(()=>{t&&(async()=>{const e=bE(E,["unitTypes"]),t="\n        SELECT unit_type, SUM(property_count) AS count\n        FROM properties_db.main_cube.cube_rollup_mean\n        ".concat(e,"\n        GROUP BY 1\n        ORDER BY count DESC;\n      ");try{const e=await s(t);k(e)}catch(n){}})()},[t,E,s]);const[P,M]=(0,r.useState)([]);r.useEffect(()=>{t&&(async()=>{const e=bE(E,["areaTier"]),t="\n        SELECT area_tier, SUM(property_count) AS count\n        FROM properties_db.main_cube.cube_rollup_mean\n        ".concat(e,"\n        GROUP BY 1\n        ORDER BY \n          CASE area_tier\n            WHEN '0-30m\xb2' THEN 1\n            WHEN '30-50m\xb2' THEN 2\n            WHEN '50-70m\xb2' THEN 3\n            WHEN '70-100m\xb2' THEN 4\n            WHEN '100-150m\xb2' THEN 5\n            WHEN '150-200m\xb2' THEN 6\n            WHEN '200-300m\xb2' THEN 7\n            WHEN '300+m\xb2' THEN 8\n            ELSE 0\n          END;\n      ");try{const e=await s(t);M(e)}catch(n){}})()},[t,E,s]);const[B,L]=(0,r.useState)([]);r.useEffect(()=>{t&&(async()=>{const e=bE(E),t="\n        SELECT \n          area_tier,\n          SUM(sum_area) / NULLIF(SUM(property_count), 0) AS avg_area,\n          AVG(sum_price / NULLIF(sum_area, 0)) AS avg_price_per_m2\n        FROM properties_db.main_cube.cube_rollup_mean\n        ".concat(e,"\n        GROUP BY 1\n        ORDER BY \n          CASE area_tier\n            WHEN '0-30m\xb2' THEN 1\n            WHEN '30-50m\xb2' THEN 2\n            WHEN '50-70m\xb2' THEN 3\n            WHEN '70-100m\xb2' THEN 4\n            WHEN '100-150m\xb2' THEN 5\n            WHEN '150-200m\xb2' THEN 6\n            WHEN '200-300m\xb2' THEN 7\n            WHEN '300+m\xb2' THEN 8\n            ELSE 0\n          END;\n      ");try{const e=await s(t);L(e)}catch(n){}})()},[t,E,s]);const[O,N]=(0,r.useState)([]);r.useEffect(()=>{t&&(async()=>{const e=bE(E,["bedrooms"]),t="\n        SELECT bedrooms_bin, SUM(property_count) AS count\n        FROM properties_db.main_cube.cube_rollup_mean\n        ".concat(e,"\n        GROUP BY 1\n        ORDER BY 1;\n      ");try{const e=await s(t);N(e)}catch(n){}})()},[t,E,s]);const[U,z]=(0,r.useState)([]);r.useEffect(()=>{t&&(async()=>{const e=bE(E,["priceRange"]),t="\n        SELECT price_m2_bucket, SUM(property_count) AS count\n        FROM properties_db.main_cube.cube_rollup_mean\n        ".concat(e,"\n        GROUP BY price_m2_bucket\n        ORDER BY 1;\n      ");try{const e=await s(t);z(e)}catch(n){}})()},[t,E,s]),r.useEffect(()=>{t&&(async()=>{const e=bE(E),t="\n        SELECT\n          SUM(property_count) AS total_properties,\n          AVG(sum_price / NULLIF(sum_area, 0)) AS avg_price_per_m2,\n          SUM(sum_price) / NULLIF(SUM(property_count), 0) AS avg_rental_price,\n          AVG(sum_sale_price / NULLIF(count_sale_price, 0)) AS avg_sale_price,\n          (SUM(CASE WHEN unit_type = 'APARTMENT' THEN property_count ELSE 0 END)::FLOAT / NULLIF(SUM(property_count), 0) * 100) AS pct_apartments,\n          SUM(sum_area) / NULLIF(SUM(property_count), 0) AS avg_area\n        FROM properties_db.main_cube.cube_rollup_mean\n        ".concat(e,";\n      ");try{const e=await s(t);e.length>0&&T(e[0])}catch(kA){console.error("Failed to load metrics:",kA)}})()},[t,E,s]);const[j,V]=(0,r.useState)([]);r.useEffect(()=>{t&&(async()=>{const e=bE(E,["floor"]),t="\n        SELECT floor_level AS unit_per_floor,\n               AVG(sum_price / NULLIF(sum_area, 0)) AS median_price_per_m2,\n               SUM(property_count) AS listing_count\n        FROM properties_db.main_cube.cube_rollup_mean\n        ".concat(e,"\n        GROUP BY 1\n        ORDER BY 1;\n      ");try{const e=await s(t);V(e)}catch(n){}})()},[t,E,s]),r.useEffect(()=>{t&&(async()=>{const e=bE(E),t="\n        WITH agg AS (\n          SELECT h3_7,\n                 SUM(property_count) AS count,\n                 AVG(sum_price / NULLIF(sum_area, 0)) AS median_price_per_m2,\n                 STRING_AGG(DISTINCT bairro, ', ') AS neighborhoods\n          FROM properties_db.main_cube.cube_rollup_mean\n          ".concat(e,"\n          GROUP BY 1\n        )\n        SELECT h3_7 AS h3_index_7,\n               median_price_per_m2,\n               percent_rank() OVER (ORDER BY median_price_per_m2 DESC) AS median_price_per_m2_percent_rank,\n               count,\n               neighborhoods\n        FROM agg\n        WHERE median_price_per_m2 IS NOT NULL AND count > 3\n        ORDER BY median_price_per_m2 DESC;\n      ");try{const e=await s(t);a(e)}catch(n){console.error("Failed to load H3 data:",n)}})()},[t,E,s]);const G=(0,r.useMemo)(()=>{if(I)return I;if(!o.length)return{min:0,max:100};const e=o.map(e=>e.median_price_per_m2);return{min:Math.min(...e),max:Math.max(...e)}},[I,o]),W=(0,r.useMemo)(()=>{if(!o.length)return[];const e=[...o].sort((e,t)=>t.median_price_per_m2-e.median_price_per_m2),t=Math.ceil(1*e.length),n=e.slice(0,t);if(E.priceRange&&E.priceRange.length>0){const e=n.filter(e=>{const t=e.median_price_per_m2,n=10*Math.floor(t/10);return E.priceRange.some(e=>e>=100?t>=100:n===e)});return e}return n},[o,E.priceRange]),{layers:H,colorScaleFunc:Q}=function(e){let{filteredH3Data:t,priceRange:n,coverage:i,opacity:s,onHexHover:o,hoveredHex:a}=e;const l=(0,r.useMemo)(()=>nD().domain([n.min,n.max]).range(["rgba(41, 121, 255, 0.8)","rgba(255, 87, 51, 0.8)"]).clamp(!0),[n]),c=(0,r.useMemo)(()=>{const e=[];return e.push(new VP({id:"carto-dark-basemap",data:"https://cartodb-basemaps-a.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",minZoom:0,maxZoom:18,tileSize:256,renderSubLayers:e=>new KM(u(u({},e),{},{id:"tile-".concat(e.tile.index.x,"-").concat(e.tile.index.y,"-").concat(e.tile.index.z),data:void 0,image:e.data,bounds:[e.tile.bbox.west,e.tile.bbox.south,e.tile.bbox.east,e.tile.bbox.north]}))})),e.push(new VP({id:"area-names-smart",data:"https://cartodb-basemaps-a.global.ssl.fastly.net/dark_only_labels/{z}/{x}/{y}.png",minZoom:8,maxZoom:14,tileSize:256,renderSubLayers:e=>new KM(u(u({},e),{},{id:"smart-labels-".concat(e.tile.index.x,"-").concat(e.tile.index.y,"-").concat(e.tile.index.z),data:void 0,image:e.data,bounds:[e.tile.bbox.west,e.tile.bbox.south,e.tile.bbox.east,e.tile.bbox.north]}))})),[...e,new zM({id:"h3-hexagon-layer-extreme",data:t,pickable:!0,wireframe:!1,filled:!0,extruded:!0,coverage:i,elevationScale:60,updateTriggers:{getFillColor:[s,a]},getHexagon:e=>e.h3_index_7,getElevation:e=>{const t=1-e.median_price_per_m2_percent_rank;return 100*Math.pow(t,5)},getFillColor:e=>{const t=(null===a||void 0===a?void 0:a.h3_index_7)===e.h3_index_7,n=Math.round(255*s);if(t)return[255,255,0,n];const r=l(e.median_price_per_m2).match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(r){const e=r[4]?parseFloat(r[4]):1;return[parseInt(r[1]),parseInt(r[2]),parseInt(r[3]),Math.round(e*n)]}return[128,128,128,n]},getLineColor:[255,255,255,80],lineWidthMinPixels:2,material:{ambient:.64,diffuse:.6,shininess:32,specularColor:[51,51,51]},onHover:e=>{let{object:t}=e;if(t){const e=1-t.median_price_per_m2_percent_rank,n=100*Math.pow(e,5);console.log("[H3 Debug]",{h3_index:t.h3_index_7,price_per_m2:t.median_price_per_m2,count:t.count,percentile:e.toFixed(3),height_units:n.toFixed(2),elevation_scale:60,curve_exponent:5,opacity:s.toFixed(2)})}o(t)}})]},[t,l,i,s,o,a]);return{layers:c,colorScaleFunc:l}}({filteredH3Data:W,priceRange:G,coverage:.9,opacity:w,onHexHover:e=>{v(e||null)},hoveredHex:y});return e?(0,fE.jsxs)("div",{className:"loading",children:[(0,fE.jsx)("div",{className:"loading-spinner"}),(0,fE.jsx)("h2",{children:"Carregando DuckDB..."}),(0,fE.jsx)("p",{children:"Inicializando banco de dados e carregando dados H3..."})]}):n?(0,fE.jsxs)("div",{className:"error",children:[(0,fE.jsx)("h2",{children:"Erro no Banco de Dados"}),(0,fE.jsx)("p",{children:n}),(0,fE.jsx)("p",{children:"Certifique-se de que properties_webapp.duckdb est\xe1 dispon\xedvel na pasta public"})]}):l||h?(0,fE.jsxs)("div",{className:"loading",children:[(0,fE.jsx)("div",{className:"loading-spinner"}),(0,fE.jsx)("h2",{children:"Carregando Dados..."}),(0,fE.jsx)("p",{children:"Consultando dados de pre\xe7o de aluguel do DuckDB..."})]}):c||d?(0,fE.jsxs)("div",{className:"error",children:[(0,fE.jsx)("h2",{children:"Erro na Consulta"}),(0,fE.jsx)("p",{children:c||d}),(0,fE.jsx)("p",{children:"Falha ao consultar os dados de pre\xe7o"})]}):(0,fE.jsxs)("div",{className:"app",children:[(0,fE.jsxs)("div",{className:"app-header",children:[(0,fE.jsx)("h1",{children:"Imoveis residenciais em Fortaleza"}),(0,fE.jsx)("div",{className:"header-info",children:(0,fE.jsx)("button",{onClick:()=>x({bairros:void 0,h3:void 0,unitTypes:void 0,bedrooms:void 0,bathrooms:void 0,parking:void 0,priceRange:void 0}),style:{marginLeft:12,padding:"6px 10px",borderRadius:6,border:"1px solid #cbd5e1",background:"#f8fafc",cursor:"pointer"},children:"Limpar filtros"})}),(0,fE.jsx)($M,{})]}),(0,fE.jsx)("div",{className:"section-header",children:(0,fE.jsx)("h2",{children:"M\xe9tricas Principais"})}),(0,fE.jsx)("div",{className:"bans-section",children:(0,fE.jsxs)("div",{className:"bans-grid",children:[(0,fE.jsx)(eB,{value:S?new Intl.NumberFormat("pt-BR").format(S.total_properties):"...",label:"Im\xf3veis",loading:!S}),(0,fE.jsx)(eB,{value:S?"R$ ".concat(Math.round(S.avg_price_per_m2)):"...",label:"Aluguel M\xe9dio (m\xb2)",loading:!S}),(0,fE.jsx)(eB,{value:S&&S.avg_rental_price?"R$ ".concat(Math.round(S.avg_rental_price)):"...",label:"Aluguel M\xe9dio",loading:!S}),(0,fE.jsx)(eB,{value:S?"R$ ".concat(nB(S.avg_sale_price)):"...",label:"Valor M\xe9dio",loading:!S}),(0,fE.jsx)(eB,{value:S?"".concat(S.pct_apartments.toFixed(1),"%"):"...",label:"% de Apartamentos",loading:!S}),(0,fE.jsx)(eB,{value:S&&S.avg_area?"".concat(Math.round(S.avg_area),"m\xb2"):"...",label:"\xc1rea M\xe9dia",loading:!S})]})}),(0,fE.jsx)("div",{className:"section-header",children:(0,fE.jsx)("h2",{children:"Visualiza\xe7\xe3o em Mapa"})}),g&&(0,fE.jsxs)("button",{className:"sidebar-toggle",onClick:()=>p(!0),"aria-label":"Abrir filtros",children:[(0,fE.jsx)("span",{children:"\u2630"})," Filtros"]}),g&&f&&(0,fE.jsx)("div",{className:"sidebar-overlay",onClick:()=>p(!1),"aria-label":"Fechar filtros",children:(0,fE.jsxs)("div",{className:"sidebar-drawer",onClick:e=>e.stopPropagation(),children:[(0,fE.jsxs)("div",{className:"sidebar-drawer-header",children:[(0,fE.jsx)("h2",{className:"sidebar-drawer-title",children:"Filtros"}),(0,fE.jsx)("button",{className:"sidebar-close",onClick:()=>p(!1),"aria-label":"Fechar",children:"\xd7"})]}),(0,fE.jsx)(oI,{})]})}),(0,fE.jsxs)("div",{className:"app-body",children:[!g&&(0,fE.jsx)(oI,{}),(0,fE.jsx)("div",{className:"map-wrapper",children:(0,fE.jsxs)("div",{className:"map-container",children:[(0,fE.jsx)(Bp,{viewState:_,onViewStateChange:e=>{let{viewState:t}=e;return b(t)},controller:!0,layers:H,width:"100%",height:"100%",children:y&&(()=>{const e=1-y.median_price_per_m2_percent_rank,t=e>.5?"Mais caro que ".concat((100*e).toFixed(0),"% das \xe1reas"):"Mais barato que ".concat((100*(1-e)).toFixed(0),"% das \xe1reas");return(0,fE.jsxs)("div",{className:"tooltip",children:[(0,fE.jsx)("div",{className:"tooltip-header",children:(0,fE.jsx)("strong",{children:"Vis\xe3o Geral da \xc1rea"})}),(0,fE.jsxs)("div",{className:"tooltip-body",children:[(0,fE.jsxs)("div",{children:[(0,fE.jsx)("strong",{children:"Pre\xe7o:"})," R$",y.median_price_per_m2.toFixed(2),"/m\xb2"]}),(0,fE.jsxs)("div",{children:[(0,fE.jsx)("strong",{children:"Im\xf3veis:"})," ",Number(y.count)]}),(0,fE.jsxs)("div",{children:[(0,fE.jsx)("strong",{children:"Bairros:"})," ",y.neighborhoods]}),(0,fE.jsx)("div",{style:{fontSize:"11px",color:"#cbd5e0",marginTop:"4px"},children:t})]})]})})()}),(0,fE.jsxs)("div",{className:"horizontal-legend",children:[(0,fE.jsx)("span",{className:"legend-label",children:"pre\xe7o por m\xb2"}),(0,fE.jsxs)("div",{className:"horizontal-legend-content",children:[(0,fE.jsxs)("span",{className:"legend-value",children:["R$",G.min.toFixed(0)]}),(0,fE.jsx)("div",{className:"horizontal-gradient-bar",style:{background:"linear-gradient(to right, \n                      ".concat(Q(G.min),", \n                      ").concat(Q(G.min+.25*(G.max-G.min)),", \n                      ").concat(Q(G.min+.5*(G.max-G.min)),", \n                      ").concat(Q(G.min+.75*(G.max-G.min)),", \n                      ").concat(Q(G.max),")")}}),(0,fE.jsxs)("span",{className:"legend-value",children:["R$",G.max.toFixed(0)]})]})]})]})})]}),(0,fE.jsx)("div",{className:"section-header",children:(0,fE.jsx)("h2",{children:"Painel de An\xe1lise de Mercado"})}),(0,fE.jsx)("div",{className:"charts-section",children:(0,fE.jsx)("div",{className:"charts-container",children:(0,fE.jsxs)("div",{className:"charts-grid",children:[(0,fE.jsx)(iD,{data:D,colorScaleFunc:Q}),(0,fE.jsx)(sD,{data:R}),(0,fE.jsx)(qT,{data:U}),(0,fE.jsx)(pD,{data:O}),(0,fE.jsx)(YT,{data:j||[],colorScaleFunc:Q}),(0,fE.jsx)(pE,{data:(A||[]).slice(0,10)}),(0,fE.jsx)(ZT,{data:P}),(0,fE.jsx)(eI,{data:B,colorScaleFunc:Q})]})})})]})};i.createRoot(document.getElementById("root")).render((0,fE.jsx)(r.StrictMode,{children:(0,fE.jsx)(rB,{})}))})();
//# sourceMappingURL=main.a787dae4.js.map